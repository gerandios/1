typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef pointer32 ImageBaseOffset32;

typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    wchar16;
typedef short    wchar_t;
typedef unsigned short    word;
typedef struct _s__RTTIBaseClassDescriptor _s__RTTIBaseClassDescriptor, *P_s__RTTIBaseClassDescriptor;

typedef struct _s__RTTIBaseClassDescriptor RTTIBaseClassDescriptor;

typedef RTTIBaseClassDescriptor * RTTIBaseClassDescriptor *32 __((image-base-relative));

typedef RTTIBaseClassDescriptor *32 __((image-base-relative)) * RTTIBaseClassDescriptor *32 __((image-base-relative)) *32 __((image-base-relative));

typedef struct PMD PMD, *PPMD;

struct PMD {
    int mdisp;
    int pdisp;
    int vdisp;
};

struct _s__RTTIBaseClassDescriptor {
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    dword numContainedBases; // count of extended classes in BaseClassArray (RTTI 2)
    struct PMD where; // member displacement structure
    dword attributes; // bit flags
    ImageBaseOffset32 pClassHierarchyDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3) for class
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _s__RTTIClassHierarchyDescriptor _s__RTTIClassHierarchyDescriptor, *P_s__RTTIClassHierarchyDescriptor;

struct _s__RTTIClassHierarchyDescriptor {
    dword signature;
    dword attributes; // bit flags
    dword numBaseClasses; // number of base classes (i.e. rtti1Count)
    RTTIBaseClassDescriptor *32 __((image-base-relative)) *32 __((image-base-relative)) pBaseClassArray; // ref to BaseClassArray (RTTI 2)
};

typedef struct _s_FuncInfo _s_FuncInfo, *P_s_FuncInfo;

typedef int __ehstate_t;

struct _s_FuncInfo {
    uint magicNumber_and_bbtFlags;
    __ehstate_t maxState;
    ImageBaseOffset32 dispUnwindMap;
    uint nTryBlocks;
    ImageBaseOffset32 dispTryBlockMap;
    uint nIPMapEntries;
    ImageBaseOffset32 dispIPToStateMap;
    int dispUnwindHelp;
    ImageBaseOffset32 dispESTypeList;
    int EHFlags;
};

typedef struct _s_UnwindMapEntry _s_UnwindMapEntry, *P_s_UnwindMapEntry;

struct _s_UnwindMapEntry {
    __ehstate_t toState;
    ImageBaseOffset32 action;
};

typedef struct _s__RTTICompleteObjectLocator _s__RTTICompleteObjectLocator, *P_s__RTTICompleteObjectLocator;

struct _s__RTTICompleteObjectLocator {
    dword signature;
    dword offset; // offset of vbtable within class
    dword cdOffset; // constructor displacement offset
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    ImageBaseOffset32 pClassDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3)
};

typedef struct _IMAGE_RUNTIME_FUNCTION_ENTRY _IMAGE_RUNTIME_FUNCTION_ENTRY, *P_IMAGE_RUNTIME_FUNCTION_ENTRY;

struct _IMAGE_RUNTIME_FUNCTION_ENTRY {
    ImageBaseOffset32 BeginAddress;
    ImageBaseOffset32 EndAddress;
    ImageBaseOffset32 UnwindInfoAddressOrData;
};

typedef struct _s_IPToStateMapEntry _s_IPToStateMapEntry, *P_s_IPToStateMapEntry;

struct _s_IPToStateMapEntry {
    ImageBaseOffset32 Ip;
    __ehstate_t state;
};

typedef struct _s_UnwindMapEntry UnwindMapEntry;

typedef struct _s_IPToStateMapEntry IPToStateMapEntry;

typedef struct CLIENT_ID CLIENT_ID, *PCLIENT_ID;

struct CLIENT_ID {
    void * UniqueProcess;
    void * UniqueThread;
};

typedef struct _s__RTTIClassHierarchyDescriptor RTTIClassHierarchyDescriptor;

typedef struct _s_FuncInfo FuncInfo;

typedef ulonglong __uint64;

typedef struct TypeDescriptor TypeDescriptor, *PTypeDescriptor;

struct TypeDescriptor {
    void * pVFTable;
    void * spare;
    char name[0];
};

typedef struct _s__RTTICompleteObjectLocator RTTICompleteObjectLocator;

typedef struct _cpinfo _cpinfo, *P_cpinfo;

typedef uint UINT;

typedef uchar BYTE;

struct _cpinfo {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
};

typedef struct _cpinfo * LPCPINFO;

typedef struct GuardCfgTableEntry GuardCfgTableEntry, *PGuardCfgTableEntry;

struct GuardCfgTableEntry {
    ImageBaseOffset32 Offset;
};

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef ulonglong ULONG_PTR;

typedef union _union_540 _union_540, *P_union_540;

typedef void * HANDLE;

typedef struct _struct_541 _struct_541, *P_struct_541;

typedef void * PVOID;

typedef ulong DWORD;

struct _struct_541 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_540 {
    struct _struct_541 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_540 u;
    HANDLE hEvent;
};

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef void * LPVOID;

typedef int BOOL;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

typedef struct _SYSTEMTIME SYSTEMTIME;

typedef ushort WORD;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

typedef enum _FINDEX_INFO_LEVELS {
    FindExInfoStandard=0,
    FindExInfoBasic=1,
    FindExInfoMaxInfoLevel=2
} _FINDEX_INFO_LEVELS;

typedef struct _TIME_ZONE_INFORMATION _TIME_ZONE_INFORMATION, *P_TIME_ZONE_INFORMATION;

typedef struct _TIME_ZONE_INFORMATION * LPTIME_ZONE_INFORMATION;

typedef long LONG;

typedef wchar_t WCHAR;

struct _TIME_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    SYSTEMTIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    SYSTEMTIME DaylightDate;
    LONG DaylightBias;
};

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef WCHAR * LPWSTR;

typedef BYTE * LPBYTE;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

typedef struct _WIN32_FIND_DATAW _WIN32_FIND_DATAW, *P_WIN32_FIND_DATAW;

typedef struct _WIN32_FIND_DATAW * LPWIN32_FIND_DATAW;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME FILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

struct _WIN32_FIND_DATAW {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    WCHAR cFileName[260];
    WCHAR cAlternateFileName[14];
};

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef DWORD (* PTHREAD_START_ROUTINE)(LPVOID);

typedef PTHREAD_START_ROUTINE LPTHREAD_START_ROUTINE;

typedef enum _FINDEX_SEARCH_OPS {
    FindExSearchNameMatch=0,
    FindExSearchLimitToDirectories=1,
    FindExSearchLimitToDevices=2,
    FindExSearchMaxSearchOp=3
} _FINDEX_SEARCH_OPS;

typedef enum _FINDEX_SEARCH_OPS FINDEX_SEARCH_OPS;

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef struct _PROCESS_INFORMATION _PROCESS_INFORMATION, *P_PROCESS_INFORMATION;

struct _PROCESS_INFORMATION {
    HANDLE hProcess;
    HANDLE hThread;
    DWORD dwProcessId;
    DWORD dwThreadId;
};

typedef enum _FINDEX_INFO_LEVELS FINDEX_INFO_LEVELS;

typedef struct _PROCESS_INFORMATION * LPPROCESS_INFORMATION;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION * PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG * PRTL_CRITICAL_SECTION_DEBUG;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * Flink;
    struct _LIST_ENTRY * Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION * CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT * PCONTEXT;

typedef ulonglong DWORD64;

typedef union _union_54 _union_54, *P_union_54;

typedef struct _M128A _M128A, *P_M128A;

typedef struct _M128A M128A;

typedef struct _XSAVE_FORMAT _XSAVE_FORMAT, *P_XSAVE_FORMAT;

typedef struct _XSAVE_FORMAT XSAVE_FORMAT;

typedef XSAVE_FORMAT XMM_SAVE_AREA32;

typedef struct _struct_55 _struct_55, *P_struct_55;

typedef ulonglong ULONGLONG;

typedef longlong LONGLONG;

struct _M128A {
    ULONGLONG Low;
    LONGLONG High;
};

struct _XSAVE_FORMAT {
    WORD ControlWord;
    WORD StatusWord;
    BYTE TagWord;
    BYTE Reserved1;
    WORD ErrorOpcode;
    DWORD ErrorOffset;
    WORD ErrorSelector;
    WORD Reserved2;
    DWORD DataOffset;
    WORD DataSelector;
    WORD Reserved3;
    DWORD MxCsr;
    DWORD MxCsr_Mask;
    M128A FloatRegisters[8];
    M128A XmmRegisters[16];
    BYTE Reserved4[96];
};

struct _struct_55 {
    M128A Header[2];
    M128A Legacy[8];
    M128A Xmm0;
    M128A Xmm1;
    M128A Xmm2;
    M128A Xmm3;
    M128A Xmm4;
    M128A Xmm5;
    M128A Xmm6;
    M128A Xmm7;
    M128A Xmm8;
    M128A Xmm9;
    M128A Xmm10;
    M128A Xmm11;
    M128A Xmm12;
    M128A Xmm13;
    M128A Xmm14;
    M128A Xmm15;
};

union _union_54 {
    XMM_SAVE_AREA32 FltSave;
    struct _struct_55 s;
};

struct _CONTEXT {
    DWORD64 P1Home;
    DWORD64 P2Home;
    DWORD64 P3Home;
    DWORD64 P4Home;
    DWORD64 P5Home;
    DWORD64 P6Home;
    DWORD ContextFlags;
    DWORD MxCsr;
    WORD SegCs;
    WORD SegDs;
    WORD SegEs;
    WORD SegFs;
    WORD SegGs;
    WORD SegSs;
    DWORD EFlags;
    DWORD64 Dr0;
    DWORD64 Dr1;
    DWORD64 Dr2;
    DWORD64 Dr3;
    DWORD64 Dr6;
    DWORD64 Dr7;
    DWORD64 Rax;
    DWORD64 Rcx;
    DWORD64 Rdx;
    DWORD64 Rbx;
    DWORD64 Rsp;
    DWORD64 Rbp;
    DWORD64 Rsi;
    DWORD64 Rdi;
    DWORD64 R8;
    DWORD64 R9;
    DWORD64 R10;
    DWORD64 R11;
    DWORD64 R12;
    DWORD64 R13;
    DWORD64 R14;
    DWORD64 R15;
    DWORD64 Rip;
    union _union_54 u;
    M128A VectorRegister[26];
    DWORD64 VectorControl;
    DWORD64 DebugControl;
    DWORD64 LastBranchToRip;
    DWORD64 LastBranchFromRip;
    DWORD64 LastExceptionToRip;
    DWORD64 LastExceptionFromRip;
};

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef enum _EXCEPTION_DISPOSITION {
    ExceptionContinueExecution=0,
    ExceptionContinueSearch=1,
    ExceptionNestedException=2,
    ExceptionCollidedUnwind=3
} _EXCEPTION_DISPOSITION;

typedef enum _EXCEPTION_DISPOSITION EXCEPTION_DISPOSITION;

typedef DWORD ULONG;

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbpath[22];
};

typedef struct _iobuf _iobuf, *P_iobuf;

struct _iobuf {
    char * _ptr;
    int _cnt;
    char * _base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char * _tmpfname;
};

typedef struct _iobuf FILE;

typedef struct _CONSOLE_READCONSOLE_CONTROL _CONSOLE_READCONSOLE_CONTROL, *P_CONSOLE_READCONSOLE_CONTROL;


// WARNING! conflicting data type names: /WinDef.h/ULONG - /wtypes.h/ULONG

struct _CONSOLE_READCONSOLE_CONTROL {
    ULONG nLength;
    ULONG nInitialChars;
    ULONG dwCtrlWakeupMask;
    ULONG dwControlKeyState;
};

typedef struct _CONSOLE_READCONSOLE_CONTROL * PCONSOLE_READCONSOLE_CONTROL;

typedef int PMFN;

typedef struct _s_ThrowInfo _s_ThrowInfo, *P_s_ThrowInfo;

struct _s_ThrowInfo {
    uint attributes;
    PMFN pmfnUnwind;
    int pForwardCompat;
    int pCatchableTypeArray;
};

typedef struct _s_ThrowInfo ThrowInfo;

typedef ulonglong uintptr_t;

typedef struct lconv lconv, *Plconv;

struct lconv {
    char * decimal_point;
    char * thousands_sep;
    char * grouping;
    char * int_curr_symbol;
    char * currency_symbol;
    char * mon_decimal_point;
    char * mon_thousands_sep;
    char * mon_grouping;
    char * positive_sign;
    char * negative_sign;
    char int_frac_digits;
    char frac_digits;
    char p_cs_precedes;
    char p_sep_by_space;
    char n_cs_precedes;
    char n_sep_by_space;
    char p_sign_posn;
    char n_sign_posn;
    wchar_t * _W_decimal_point;
    wchar_t * _W_thousands_sep;
    wchar_t * _W_int_curr_symbol;
    wchar_t * _W_currency_symbol;
    wchar_t * _W_mon_decimal_point;
    wchar_t * _W_mon_thousands_sep;
    wchar_t * _W_positive_sign;
    wchar_t * _W_negative_sign;
};

typedef ulonglong size_t;

typedef ushort wint_t;

typedef struct threadlocaleinfostruct threadlocaleinfostruct, *Pthreadlocaleinfostruct;

typedef struct threadlocaleinfostruct * pthreadlocinfo;

typedef struct localerefcount localerefcount, *Plocalerefcount;

typedef struct localerefcount locrefcount;

typedef struct __lc_time_data __lc_time_data, *P__lc_time_data;

struct localerefcount {
    char * locale;
    wchar_t * wlocale;
    int * refcount;
    int * wrefcount;
};

struct threadlocaleinfostruct {
    int refcount;
    uint lc_codepage;
    uint lc_collate_cp;
    uint lc_time_cp;
    locrefcount lc_category[6];
    int lc_clike;
    int mb_cur_max;
    int * lconv_intl_refcount;
    int * lconv_num_refcount;
    int * lconv_mon_refcount;
    struct lconv * lconv;
    int * ctype1_refcount;
    ushort * ctype1;
    ushort * pctype;
    uchar * pclmap;
    uchar * pcumap;
    struct __lc_time_data * lc_time_curr;
    wchar_t * locale_name[6];
};

struct __lc_time_data {
    char * wday_abbr[7];
    char * wday[7];
    char * month_abbr[12];
    char * month[12];
    char * ampm[2];
    char * ww_sdatefmt;
    char * ww_ldatefmt;
    char * ww_timefmt;
    int ww_caltype;
    int refcount;
    wchar_t * _W_wday_abbr[7];
    wchar_t * _W_wday[7];
    wchar_t * _W_month_abbr[12];
    wchar_t * _W_month[12];
    wchar_t * _W_ampm[2];
    wchar_t * _W_ww_sdatefmt;
    wchar_t * _W_ww_ldatefmt;
    wchar_t * _W_ww_timefmt;
    wchar_t * _W_ww_locale_name;
};

typedef long __time32_t;

typedef struct localeinfo_struct localeinfo_struct, *Plocaleinfo_struct;

typedef struct threadmbcinfostruct threadmbcinfostruct, *Pthreadmbcinfostruct;

typedef struct threadmbcinfostruct * pthreadmbcinfo;

struct threadmbcinfostruct {
    int refcount;
    int mbcodepage;
    int ismbcodepage;
    ushort mbulinfo[6];
    uchar mbctype[257];
    uchar mbcasemap[256];
    wchar_t * mblocalename;
};

struct localeinfo_struct {
    pthreadlocinfo locinfo;
    pthreadmbcinfo mbcinfo;
};

typedef int errno_t;

typedef longlong intptr_t;

typedef struct localeinfo_struct * _locale_t;

typedef longlong __time64_t;

typedef size_t rsize_t;


// WARNING! conflicting data type names: /guiddef.h/GUID - /GUID

typedef struct _GUID _GUID, *P_GUID;

struct _GUID {
    ulong Data1;
    ushort Data2;
    ushort Data3;
    uchar Data4[8];
};

typedef ushort * RPC_WSTR;

typedef GUID UUID;

typedef struct SERVICE_STATUS_HANDLE__ SERVICE_STATUS_HANDLE__, *PSERVICE_STATUS_HANDLE__;

typedef struct SERVICE_STATUS_HANDLE__ * SERVICE_STATUS_HANDLE;

struct SERVICE_STATUS_HANDLE__ {
    int unused;
};

typedef struct _QUERY_SERVICE_CONFIGW _QUERY_SERVICE_CONFIGW, *P_QUERY_SERVICE_CONFIGW;

struct _QUERY_SERVICE_CONFIGW {
    DWORD dwServiceType;
    DWORD dwStartType;
    DWORD dwErrorControl;
    LPWSTR lpBinaryPathName;
    LPWSTR lpLoadOrderGroup;
    DWORD dwTagId;
    LPWSTR lpDependencies;
    LPWSTR lpServiceStartName;
    LPWSTR lpDisplayName;
};

typedef struct _SERVICE_STATUS _SERVICE_STATUS, *P_SERVICE_STATUS;

struct _SERVICE_STATUS {
    DWORD dwServiceType;
    DWORD dwCurrentState;
    DWORD dwControlsAccepted;
    DWORD dwWin32ExitCode;
    DWORD dwServiceSpecificExitCode;
    DWORD dwCheckPoint;
    DWORD dwWaitHint;
};

typedef struct _SERVICE_TABLE_ENTRYW _SERVICE_TABLE_ENTRYW, *P_SERVICE_TABLE_ENTRYW;

typedef struct _SERVICE_TABLE_ENTRYW SERVICE_TABLE_ENTRYW;

typedef void (* LPSERVICE_MAIN_FUNCTIONW)(DWORD, LPWSTR *);

struct _SERVICE_TABLE_ENTRYW {
    LPWSTR lpServiceName;
    LPSERVICE_MAIN_FUNCTIONW lpServiceProc;
};

typedef struct _QUERY_SERVICE_CONFIGW * LPQUERY_SERVICE_CONFIGW;

typedef struct SC_HANDLE__ SC_HANDLE__, *PSC_HANDLE__;

struct SC_HANDLE__ {
    int unused;
};

typedef struct _SERVICE_STATUS * LPSERVICE_STATUS;

typedef enum _SC_STATUS_TYPE {
    SC_STATUS_PROCESS_INFO=0
} _SC_STATUS_TYPE;

typedef enum _SC_STATUS_TYPE SC_STATUS_TYPE;

typedef struct SC_HANDLE__ * SC_HANDLE;

typedef void (* LPHANDLER_FUNCTION)(DWORD);

typedef long RPC_STATUS;

typedef PVOID PSECURITY_DESCRIPTOR;

typedef struct _TOKEN_PRIVILEGES _TOKEN_PRIVILEGES, *P_TOKEN_PRIVILEGES;

typedef struct _LUID_AND_ATTRIBUTES _LUID_AND_ATTRIBUTES, *P_LUID_AND_ATTRIBUTES;

typedef struct _LUID_AND_ATTRIBUTES LUID_AND_ATTRIBUTES;

typedef struct _LUID _LUID, *P_LUID;

typedef struct _LUID LUID;

struct _LUID {
    DWORD LowPart;
    LONG HighPart;
};

struct _LUID_AND_ATTRIBUTES {
    LUID Luid;
    DWORD Attributes;
};

struct _TOKEN_PRIVILEGES {
    DWORD PrivilegeCount;
    LUID_AND_ATTRIBUTES Privileges[1];
};

typedef struct _RUNTIME_FUNCTION _RUNTIME_FUNCTION, *P_RUNTIME_FUNCTION;

struct _RUNTIME_FUNCTION {
    DWORD BeginAddress;
    DWORD EndAddress;
    DWORD UnwindData;
};

typedef struct _IMAGE_SECTION_HEADER _IMAGE_SECTION_HEADER, *P_IMAGE_SECTION_HEADER;

typedef union _union_238 _union_238, *P_union_238;

union _union_238 {
    DWORD PhysicalAddress;
    DWORD VirtualSize;
};

struct _IMAGE_SECTION_HEADER {
    BYTE Name[8];
    union _union_238 Misc;
    DWORD VirtualAddress;
    DWORD SizeOfRawData;
    DWORD PointerToRawData;
    DWORD PointerToRelocations;
    DWORD PointerToLinenumbers;
    WORD NumberOfRelocations;
    WORD NumberOfLinenumbers;
    DWORD Characteristics;
};

typedef struct _RUNTIME_FUNCTION * PRUNTIME_FUNCTION;

typedef WCHAR * PCNZWCH;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY _UNWIND_HISTORY_TABLE_ENTRY, *P_UNWIND_HISTORY_TABLE_ENTRY;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY UNWIND_HISTORY_TABLE_ENTRY;

struct _UNWIND_HISTORY_TABLE_ENTRY {
    DWORD64 ImageBase;
    PRUNTIME_FUNCTION FunctionEntry;
};

typedef union _union_61 _union_61, *P_union_61;

typedef struct _M128A * PM128A;

typedef struct _struct_62 _struct_62, *P_struct_62;

struct _struct_62 {
    PM128A Xmm0;
    PM128A Xmm1;
    PM128A Xmm2;
    PM128A Xmm3;
    PM128A Xmm4;
    PM128A Xmm5;
    PM128A Xmm6;
    PM128A Xmm7;
    PM128A Xmm8;
    PM128A Xmm9;
    PM128A Xmm10;
    PM128A Xmm11;
    PM128A Xmm12;
    PM128A Xmm13;
    PM128A Xmm14;
    PM128A Xmm15;
};

union _union_61 {
    PM128A FloatingContext[16];
    struct _struct_62 s;
};

typedef struct _struct_64 _struct_64, *P_struct_64;

typedef ulonglong * PDWORD64;

struct _struct_64 {
    PDWORD64 Rax;
    PDWORD64 Rcx;
    PDWORD64 Rdx;
    PDWORD64 Rbx;
    PDWORD64 Rsp;
    PDWORD64 Rbp;
    PDWORD64 Rsi;
    PDWORD64 Rdi;
    PDWORD64 R8;
    PDWORD64 R9;
    PDWORD64 R10;
    PDWORD64 R11;
    PDWORD64 R12;
    PDWORD64 R13;
    PDWORD64 R14;
    PDWORD64 R15;
};

typedef union _union_63 _union_63, *P_union_63;

union _union_63 {
    PDWORD64 IntegerContext[16];
    struct _struct_64 s;
};

typedef EXCEPTION_DISPOSITION (EXCEPTION_ROUTINE)(struct _EXCEPTION_RECORD *, PVOID, struct _CONTEXT *, PVOID);

typedef struct _UNWIND_HISTORY_TABLE _UNWIND_HISTORY_TABLE, *P_UNWIND_HISTORY_TABLE;

struct _UNWIND_HISTORY_TABLE {
    DWORD Count;
    BYTE LocalHint;
    BYTE GlobalHint;
    BYTE Search;
    BYTE Once;
    DWORD64 LowAddress;
    DWORD64 HighAddress;
    UNWIND_HISTORY_TABLE_ENTRY Entry[12];
};

typedef struct _ACL _ACL, *P_ACL;

typedef struct _ACL ACL;

typedef ACL * PACL;

struct _ACL {
    BYTE AclRevision;
    BYTE Sbz1;
    WORD AclSize;
    WORD AceCount;
    WORD Sbz2;
};

typedef struct _LUID * PLUID;

typedef char CHAR;

typedef CHAR * LPCSTR;

typedef CHAR * LPSTR;

typedef struct _TOKEN_PRIVILEGES * PTOKEN_PRIVILEGES;

typedef DWORD ACCESS_MASK;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS _KNONVOLATILE_CONTEXT_POINTERS, *P_KNONVOLATILE_CONTEXT_POINTERS;

struct _KNONVOLATILE_CONTEXT_POINTERS {
    union _union_61 u;
    union _union_63 u2;
};

typedef PVOID PSID;

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef struct _IMAGE_SECTION_HEADER * PIMAGE_SECTION_HEADER;

typedef DWORD SECURITY_INFORMATION;

typedef WCHAR * LPWCH;

typedef WCHAR * LPCWSTR;

typedef struct _UNWIND_HISTORY_TABLE * PUNWIND_HISTORY_TABLE;

typedef enum enum_87 {
    WinNullSid=0,
    WinWorldSid=1,
    WinLocalSid=2,
    WinCreatorOwnerSid=3,
    WinCreatorGroupSid=4,
    WinCreatorOwnerServerSid=5,
    WinCreatorGroupServerSid=6,
    WinNtAuthoritySid=7,
    WinDialupSid=8,
    WinNetworkSid=9,
    WinBatchSid=10,
    WinInteractiveSid=11,
    WinServiceSid=12,
    WinAnonymousSid=13,
    WinProxySid=14,
    WinEnterpriseControllersSid=15,
    WinSelfSid=16,
    WinAuthenticatedUserSid=17,
    WinRestrictedCodeSid=18,
    WinTerminalServerSid=19,
    WinRemoteLogonIdSid=20,
    WinLogonIdsSid=21,
    WinLocalSystemSid=22,
    WinLocalServiceSid=23,
    WinNetworkServiceSid=24,
    WinBuiltinDomainSid=25,
    WinBuiltinAdministratorsSid=26,
    WinBuiltinUsersSid=27,
    WinBuiltinGuestsSid=28,
    WinBuiltinPowerUsersSid=29,
    WinBuiltinAccountOperatorsSid=30,
    WinBuiltinSystemOperatorsSid=31,
    WinBuiltinPrintOperatorsSid=32,
    WinBuiltinBackupOperatorsSid=33,
    WinBuiltinReplicatorSid=34,
    WinBuiltinPreWindows2000CompatibleAccessSid=35,
    WinBuiltinRemoteDesktopUsersSid=36,
    WinBuiltinNetworkConfigurationOperatorsSid=37,
    WinAccountAdministratorSid=38,
    WinAccountGuestSid=39,
    WinAccountKrbtgtSid=40,
    WinAccountDomainAdminsSid=41,
    WinAccountDomainUsersSid=42,
    WinAccountDomainGuestsSid=43,
    WinAccountComputersSid=44,
    WinAccountControllersSid=45,
    WinAccountCertAdminsSid=46,
    WinAccountSchemaAdminsSid=47,
    WinAccountEnterpriseAdminsSid=48,
    WinAccountPolicyAdminsSid=49,
    WinAccountRasAndIasServersSid=50,
    WinNTLMAuthenticationSid=51,
    WinDigestAuthenticationSid=52,
    WinSChannelAuthenticationSid=53,
    WinThisOrganizationSid=54,
    WinOtherOrganizationSid=55,
    WinBuiltinIncomingForestTrustBuildersSid=56,
    WinBuiltinPerfMonitoringUsersSid=57,
    WinBuiltinPerfLoggingUsersSid=58,
    WinBuiltinAuthorizationAccessSid=59,
    WinBuiltinTerminalServerLicenseServersSid=60,
    WinBuiltinDCOMUsersSid=61,
    WinBuiltinIUsersSid=62,
    WinIUserSid=63,
    WinBuiltinCryptoOperatorsSid=64,
    WinUntrustedLabelSid=65,
    WinLowLabelSid=66,
    WinMediumLabelSid=67,
    WinHighLabelSid=68,
    WinSystemLabelSid=69,
    WinWriteRestrictedCodeSid=70,
    WinCreatorOwnerRightsSid=71,
    WinCacheablePrincipalsGroupSid=72,
    WinNonCacheablePrincipalsGroupSid=73,
    WinEnterpriseReadonlyControllersSid=74,
    WinAccountReadonlyControllersSid=75,
    WinBuiltinEventLogReadersGroup=76,
    WinNewEnterpriseReadonlyControllersSid=77,
    WinBuiltinCertSvcDComAccessGroup=78,
    WinMediumPlusLabelSid=79,
    WinLocalLogonSid=80,
    WinConsoleLogonSid=81,
    WinThisOrganizationCertificateSid=82
} enum_87;

typedef LARGE_INTEGER * PLARGE_INTEGER;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS * PKNONVOLATILE_CONTEXT_POINTERS;

typedef EXCEPTION_ROUTINE * PEXCEPTION_ROUTINE;

typedef DWORD LCID;

typedef enum enum_87 WELL_KNOWN_SID_TYPE;

typedef HANDLE * PHANDLE;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[56]; // Actual DOS program
};

typedef struct _CRYPTOAPI_BLOB _CRYPTOAPI_BLOB, *P_CRYPTOAPI_BLOB;

typedef struct _CRYPTOAPI_BLOB CRYPT_INTEGER_BLOB;

struct _CRYPTOAPI_BLOB {
    DWORD cbData;
    BYTE * pbData;
};

typedef struct _CRYPTOAPI_BLOB CRYPT_OBJID_BLOB;

typedef void * HCRYPTMSG;

typedef void * HCERTSTORE;

typedef uint ALG_ID;

typedef ULONG_PTR HCRYPTPROV;

typedef struct _CRYPT_BIT_BLOB _CRYPT_BIT_BLOB, *P_CRYPT_BIT_BLOB;

struct _CRYPT_BIT_BLOB {
    DWORD cbData;
    BYTE * pbData;
    DWORD cUnusedBits;
};

typedef ULONG_PTR HCRYPTHASH;

typedef struct _CERT_PUBLIC_KEY_INFO _CERT_PUBLIC_KEY_INFO, *P_CERT_PUBLIC_KEY_INFO;

typedef struct _CERT_PUBLIC_KEY_INFO CERT_PUBLIC_KEY_INFO;

typedef struct _CRYPT_ALGORITHM_IDENTIFIER _CRYPT_ALGORITHM_IDENTIFIER, *P_CRYPT_ALGORITHM_IDENTIFIER;

typedef struct _CRYPT_ALGORITHM_IDENTIFIER CRYPT_ALGORITHM_IDENTIFIER;

typedef struct _CRYPT_BIT_BLOB CRYPT_BIT_BLOB;

struct _CRYPT_ALGORITHM_IDENTIFIER {
    LPSTR pszObjId;
    CRYPT_OBJID_BLOB Parameters;
};

struct _CERT_PUBLIC_KEY_INFO {
    CRYPT_ALGORITHM_IDENTIFIER Algorithm;
    CRYPT_BIT_BLOB PublicKey;
};

typedef struct _CERT_INFO _CERT_INFO, *P_CERT_INFO;

typedef struct _CERT_INFO * PCERT_INFO;

typedef struct _CRYPTOAPI_BLOB CERT_NAME_BLOB;

typedef struct _CERT_EXTENSION _CERT_EXTENSION, *P_CERT_EXTENSION;

typedef struct _CERT_EXTENSION * PCERT_EXTENSION;

struct _CERT_EXTENSION {
    LPSTR pszObjId;
    BOOL fCritical;
    CRYPT_OBJID_BLOB Value;
};

struct _CERT_INFO {
    DWORD dwVersion;
    CRYPT_INTEGER_BLOB SerialNumber;
    CRYPT_ALGORITHM_IDENTIFIER SignatureAlgorithm;
    CERT_NAME_BLOB Issuer;
    FILETIME NotBefore;
    FILETIME NotAfter;
    CERT_NAME_BLOB Subject;
    CERT_PUBLIC_KEY_INFO SubjectPublicKeyInfo;
    CRYPT_BIT_BLOB IssuerUniqueId;
    CRYPT_BIT_BLOB SubjectUniqueId;
    DWORD cExtension;
    PCERT_EXTENSION rgExtension;
};

typedef struct _CERT_CONTEXT _CERT_CONTEXT, *P_CERT_CONTEXT;

typedef struct _CERT_CONTEXT CERT_CONTEXT;

struct _CERT_CONTEXT {
    DWORD dwCertEncodingType;
    BYTE * pbCertEncoded;
    DWORD cbCertEncoded;
    PCERT_INFO pCertInfo;
    HCERTSTORE hCertStore;
};

typedef ULONG_PTR HCRYPTKEY;

typedef CERT_CONTEXT * PCCERT_CONTEXT;

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
};

typedef longlong INT_PTR;

typedef ULONG_PTR DWORD_PTR;

typedef ULONG_PTR SIZE_T;

typedef struct _FILETIME * LPFILETIME;

typedef INT_PTR (* FARPROC)(void);

typedef struct HKEY__ HKEY__, *PHKEY__;

struct HKEY__ {
    int unused;
};

typedef DWORD * LPDWORD;

typedef WORD * LPWORD;

typedef struct HKEY__ * HKEY;

typedef HKEY * PHKEY;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

struct HINSTANCE__ {
    int unused;
};

typedef DWORD * PDWORD;

typedef BOOL * LPBOOL;

typedef BYTE * PBYTE;

typedef struct HINSTANCE__ * HINSTANCE;

typedef HINSTANCE HMODULE;

typedef uint * PUINT;

typedef void * LPCVOID;

typedef struct _FILETIME * PFILETIME;

typedef struct HWND__ HWND__, *PHWND__;

typedef struct HWND__ * HWND;

struct HWND__ {
    int unused;
};

typedef HANDLE HLOCAL;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY IMAGE_LOAD_CONFIG_CODE_INTEGRITY, *PIMAGE_LOAD_CONFIG_CODE_INTEGRITY;

struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY {
    word Flags;
    word Catalog;
    dword CatalogOffset;
    dword Reserved;
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_TYPE_NO_PAD=8,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_WRITE=2147483648
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_NT_HEADERS64 IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

typedef struct IMAGE_OPTIONAL_HEADER64 IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

struct IMAGE_OPTIONAL_HEADER64 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    pointer64 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    qword SizeOfStackReserve;
    qword SizeOfStackCommit;
    qword SizeOfHeapReserve;
    qword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

struct IMAGE_FILE_HEADER {
    word Machine; // 34404
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

struct IMAGE_NT_HEADERS64 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER64 OptionalHeader;
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY64 IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;

typedef enum IMAGE_GUARD_FLAGS {
    IMAGE_GUARD_CF_INSTRUMENTED=256,
    IMAGE_GUARD_CFW_INSTRUMENTED=512,
    IMAGE_GUARD_CF_FUNCTION_TABLE_PRESENT=1024,
    IMAGE_GUARD_SECURITY_COOKIE_UNUSED=2048,
    IMAGE_GUARD_PROTECT_DELAYLOAD_IAT=4096,
    IMAGE_GUARD_DELAYLOAD_IAT_IN_ITS_OWN_SECTION=8192,
    IMAGE_GUARD_CF_EXPORT_SUPPRESSION_INFO_PRESENT=16384,
    IMAGE_GUARD_CF_ENABLE_EXPORT_SUPPRESSION=32768,
    IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT=65536,
    IMAGE_GUARD_RF_INSTRUMENTED=131072,
    IMAGE_GUARD_RF_ENABLE=262144,
    IMAGE_GUARD_RF_STRICT=524288,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_1=268435456,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_2=536870912,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_4=1073741824,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_8=2147483648
} IMAGE_GUARD_FLAGS;

struct IMAGE_LOAD_CONFIG_DIRECTORY64 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    qword DeCommitFreeBlockThreshold;
    qword DeCommitTotalFreeThreshold;
    pointer64 LockPrefixTable;
    qword MaximumAllocationSize;
    qword VirtualMemoryThreshold;
    qword ProcessAffinityMask;
    dword ProcessHeapFlags;
    word CsdVersion;
    word DependentLoadFlags;
    pointer64 EditList;
    pointer64 SecurityCookie;
    pointer64 SEHandlerTable;
    qword SEHandlerCount;
    pointer64 GuardCFCCheckFunctionPointer;
    pointer64 GuardCFDispatchFunctionPointer;
    pointer64 GuardCFFunctionTable;
    qword GuardCFFunctionCount;
    enum IMAGE_GUARD_FLAGS GuardFlags;
    struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY CodeIntegrity;
    pointer64 GuardAddressTakenIatEntryTable;
    qword GuardAddressTakenIatEntryCount;
    pointer64 GuardLongJumpTargetTable;
    qword GuardLongJumpTargetCount;
    pointer64 DynamicValueRelocTable;
    pointer64 CHPEMetadataPointer;
    pointer64 GuardRFFailureRoutine;
    pointer64 GuardRFFailureRoutineFunctionPointer;
    dword DynamicValueRelocTableOffset;
    word DynamicValueRelocTableSection;
    word Reserved1;
    pointer64 GuardRFVerifyStackPointerFunctionPointer;
    dword HotPatchTableOffset;
    dword Reserved2;
    qword Reserved3;
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct IMAGE_THUNK_DATA64 IMAGE_THUNK_DATA64, *PIMAGE_THUNK_DATA64;

struct IMAGE_THUNK_DATA64 {
    qword StartAddressOfRawData;
    qword EndAddressOfRawData;
    qword AddressOfIndex;
    qword AddressOfCallBacks;
    dword SizeOfZeroFill;
    dword Characteristics;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct _EXPLICIT_ACCESS_W _EXPLICIT_ACCESS_W, *P_EXPLICIT_ACCESS_W;

typedef enum _ACCESS_MODE {
    NOT_USED_ACCESS=0,
    GRANT_ACCESS=1,
    SET_ACCESS=2,
    DENY_ACCESS=3,
    REVOKE_ACCESS=4,
    SET_AUDIT_SUCCESS=5,
    SET_AUDIT_FAILURE=6
} _ACCESS_MODE;

typedef enum _ACCESS_MODE ACCESS_MODE;

typedef struct _TRUSTEE_W _TRUSTEE_W, *P_TRUSTEE_W;

typedef struct _TRUSTEE_W TRUSTEE_W;

typedef enum _MULTIPLE_TRUSTEE_OPERATION {
    NO_MULTIPLE_TRUSTEE=0,
    TRUSTEE_IS_IMPERSONATE=1
} _MULTIPLE_TRUSTEE_OPERATION;

typedef enum _MULTIPLE_TRUSTEE_OPERATION MULTIPLE_TRUSTEE_OPERATION;

typedef enum _TRUSTEE_FORM {
    TRUSTEE_IS_SID=0,
    TRUSTEE_IS_NAME=1,
    TRUSTEE_BAD_FORM=2,
    TRUSTEE_IS_OBJECTS_AND_SID=3,
    TRUSTEE_IS_OBJECTS_AND_NAME=4
} _TRUSTEE_FORM;

typedef enum _TRUSTEE_FORM TRUSTEE_FORM;

typedef enum _TRUSTEE_TYPE {
    TRUSTEE_IS_UNKNOWN=0,
    TRUSTEE_IS_USER=1,
    TRUSTEE_IS_GROUP=2,
    TRUSTEE_IS_DOMAIN=3,
    TRUSTEE_IS_ALIAS=4,
    TRUSTEE_IS_WELL_KNOWN_GROUP=5,
    TRUSTEE_IS_DELETED=6,
    TRUSTEE_IS_INVALID=7,
    TRUSTEE_IS_COMPUTER=8
} _TRUSTEE_TYPE;

typedef enum _TRUSTEE_TYPE TRUSTEE_TYPE;

struct _TRUSTEE_W {
    struct _TRUSTEE_W * pMultipleTrustee;
    MULTIPLE_TRUSTEE_OPERATION MultipleTrusteeOperation;
    TRUSTEE_FORM TrusteeForm;
    TRUSTEE_TYPE TrusteeType;
    LPWSTR ptstrName;
};

struct _EXPLICIT_ACCESS_W {
    DWORD grfAccessPermissions;
    ACCESS_MODE grfAccessMode;
    DWORD grfInheritance;
    TRUSTEE_W Trustee;
};

typedef struct _EXPLICIT_ACCESS_W * PEXPLICIT_ACCESS_W;

typedef LONG LSTATUS;

typedef ACCESS_MASK REGSAM;

typedef struct __acrt_ptd __acrt_ptd, *P__acrt_ptd;

struct __acrt_ptd { // PlaceHolder Structure
};

typedef struct __crt_multibyte_data __crt_multibyte_data, *P__crt_multibyte_data;

struct __crt_multibyte_data { // PlaceHolder Structure
};

typedef struct <lambda_9a32fed5bf61b6b509b2d3f6003082a1> <lambda_9a32fed5bf61b6b509b2d3f6003082a1>, *P<lambda_9a32fed5bf61b6b509b2d3f6003082a1>;

struct <lambda_9a32fed5bf61b6b509b2d3f6003082a1> { // PlaceHolder Structure
};

typedef struct <lambda_3e16ef9562a7dcce91392c22ab16ea36> <lambda_3e16ef9562a7dcce91392c22ab16ea36>, *P<lambda_3e16ef9562a7dcce91392c22ab16ea36>;

struct <lambda_3e16ef9562a7dcce91392c22ab16ea36> { // PlaceHolder Structure
};

typedef struct <lambda_f7f22ab5edc0698d5f6905b0d3f44752> <lambda_f7f22ab5edc0698d5f6905b0d3f44752>, *P<lambda_f7f22ab5edc0698d5f6905b0d3f44752>;

struct <lambda_f7f22ab5edc0698d5f6905b0d3f44752> { // PlaceHolder Structure
};

typedef struct _s_HandlerType _s_HandlerType, *P_s_HandlerType;

struct _s_HandlerType { // PlaceHolder Structure
};

typedef struct <lambda_6978c1fb23f02e42e1d9e99668cc68aa> <lambda_6978c1fb23f02e42e1d9e99668cc68aa>, *P<lambda_6978c1fb23f02e42e1d9e99668cc68aa>;

struct <lambda_6978c1fb23f02e42e1d9e99668cc68aa> { // PlaceHolder Structure
};

typedef struct EHExceptionRecord EHExceptionRecord, *PEHExceptionRecord;

struct EHExceptionRecord { // PlaceHolder Structure
};

typedef struct <lambda_7777bce6b2f8c936911f934f8298dc43> <lambda_7777bce6b2f8c936911f934f8298dc43>, *P<lambda_7777bce6b2f8c936911f934f8298dc43>;

struct <lambda_7777bce6b2f8c936911f934f8298dc43> { // PlaceHolder Structure
};

typedef struct _s_ESTypeList _s_ESTypeList, *P_s_ESTypeList;

struct _s_ESTypeList { // PlaceHolder Structure
};

typedef struct <lambda_efdfa57d1f175319df784efa44bb7b81> <lambda_efdfa57d1f175319df784efa44bb7b81>, *P<lambda_efdfa57d1f175319df784efa44bb7b81>;

struct <lambda_efdfa57d1f175319df784efa44bb7b81> { // PlaceHolder Structure
};

typedef struct <lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec> <lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec>, *P<lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec>;

struct <lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec> { // PlaceHolder Structure
};

typedef struct _Mbstatet _Mbstatet, *P_Mbstatet;

struct _Mbstatet { // PlaceHolder Structure
};

typedef struct <lambda_410d79af7f07d98d83a3f525b3859a53> <lambda_410d79af7f07d98d83a3f525b3859a53>, *P<lambda_410d79af7f07d98d83a3f525b3859a53>;

struct <lambda_410d79af7f07d98d83a3f525b3859a53> { // PlaceHolder Structure
};

typedef struct <lambda_237c231691f317818eb88cc1d5d642d6> <lambda_237c231691f317818eb88cc1d5d642d6>, *P<lambda_237c231691f317818eb88cc1d5d642d6>;

struct <lambda_237c231691f317818eb88cc1d5d642d6> { // PlaceHolder Structure
};

typedef struct _s_TryBlockMapEntry _s_TryBlockMapEntry, *P_s_TryBlockMapEntry;

struct _s_TryBlockMapEntry { // PlaceHolder Structure
};

typedef struct __crt_locale_data __crt_locale_data, *P__crt_locale_data;

struct __crt_locale_data { // PlaceHolder Structure
};

typedef struct _s_CatchableType _s_CatchableType, *P_s_CatchableType;

struct _s_CatchableType { // PlaceHolder Structure
};

typedef struct <lambda_2e8a7d3640ea6ccb4c2413664c2db6fd> <lambda_2e8a7d3640ea6ccb4c2413664c2db6fd>, *P<lambda_2e8a7d3640ea6ccb4c2413664c2db6fd>;

struct <lambda_2e8a7d3640ea6ccb4c2413664c2db6fd> { // PlaceHolder Structure
};

typedef struct <lambda_886d6c58226a84441f68b9f2b8217b83> <lambda_886d6c58226a84441f68b9f2b8217b83>, *P<lambda_886d6c58226a84441f68b9f2b8217b83>;

struct <lambda_886d6c58226a84441f68b9f2b8217b83> { // PlaceHolder Structure
};

typedef struct __crt_deferred_errno_cache __crt_deferred_errno_cache, *P__crt_deferred_errno_cache;

struct __crt_deferred_errno_cache { // PlaceHolder Structure
};

typedef struct <lambda_c376a267cfb53b6959b3b692ec76b120> <lambda_c376a267cfb53b6959b3b692ec76b120>, *P<lambda_c376a267cfb53b6959b3b692ec76b120>;

struct <lambda_c376a267cfb53b6959b3b692ec76b120> { // PlaceHolder Structure
};

typedef struct <lambda_38119f0e861e05405d8a144b9b982f0a> <lambda_38119f0e861e05405d8a144b9b982f0a>, *P<lambda_38119f0e861e05405d8a144b9b982f0a>;

struct <lambda_38119f0e861e05405d8a144b9b982f0a> { // PlaceHolder Structure
};

typedef struct <lambda_572fbb9fa0ab338edf41edfd4b5fcc8d> <lambda_572fbb9fa0ab338edf41edfd4b5fcc8d>, *P<lambda_572fbb9fa0ab338edf41edfd4b5fcc8d>;

struct <lambda_572fbb9fa0ab338edf41edfd4b5fcc8d> { // PlaceHolder Structure
};

typedef struct <lambda_ab61a845afdef5b7c387490eaf3616ee> <lambda_ab61a845afdef5b7c387490eaf3616ee>, *P<lambda_ab61a845afdef5b7c387490eaf3616ee>;

struct <lambda_ab61a845afdef5b7c387490eaf3616ee> { // PlaceHolder Structure
};

typedef struct <lambda_b521505b218e5242e90febf6bfebc422> <lambda_b521505b218e5242e90febf6bfebc422>, *P<lambda_b521505b218e5242e90febf6bfebc422>;

struct <lambda_b521505b218e5242e90febf6bfebc422> { // PlaceHolder Structure
};

typedef struct <lambda_f03950bc5685219e0bcd2087efbe011e> <lambda_f03950bc5685219e0bcd2087efbe011e>, *P<lambda_f03950bc5685219e0bcd2087efbe011e>;

struct <lambda_f03950bc5685219e0bcd2087efbe011e> { // PlaceHolder Structure
};

typedef struct <lambda_c5860995281e5c4ce005b3de8f5874ee> <lambda_c5860995281e5c4ce005b3de8f5874ee>, *P<lambda_c5860995281e5c4ce005b3de8f5874ee>;

struct <lambda_c5860995281e5c4ce005b3de8f5874ee> { // PlaceHolder Structure
};

typedef struct <lambda_5f0a4c1567f8adc6734073e5d1e1b35c> <lambda_5f0a4c1567f8adc6734073e5d1e1b35c>, *P<lambda_5f0a4c1567f8adc6734073e5d1e1b35c>;

struct <lambda_5f0a4c1567f8adc6734073e5d1e1b35c> { // PlaceHolder Structure
};

typedef struct <lambda_842d9ff0dc9ef11c61343bbaebe7f885> <lambda_842d9ff0dc9ef11c61343bbaebe7f885>, *P<lambda_842d9ff0dc9ef11c61343bbaebe7f885>;

struct <lambda_842d9ff0dc9ef11c61343bbaebe7f885> { // PlaceHolder Structure
};

typedef struct __crt_locale_pointers __crt_locale_pointers, *P__crt_locale_pointers;

struct __crt_locale_pointers { // PlaceHolder Structure
};

typedef struct _xDISPATCHER_CONTEXT _xDISPATCHER_CONTEXT, *P_xDISPATCHER_CONTEXT;

struct _xDISPATCHER_CONTEXT { // PlaceHolder Structure
};

typedef struct __crt_seh_guarded_call<void> __crt_seh_guarded_call<void>, *P__crt_seh_guarded_call<void>;

struct __crt_seh_guarded_call<void> { // PlaceHolder Structure
};

typedef struct _LocaleUpdate _LocaleUpdate, *P_LocaleUpdate;

struct _LocaleUpdate { // PlaceHolder Structure
};

typedef struct <lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0> <lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0>, *P<lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0>;

struct <lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0> { // PlaceHolder Structure
};

typedef struct _timespec64 _timespec64, *P_timespec64;

struct _timespec64 { // PlaceHolder Structure
};

typedef struct <lambda_3883c3dff614d5e0c5f61bb1ac94921c> <lambda_3883c3dff614d5e0c5f61bb1ac94921c>, *P<lambda_3883c3dff614d5e0c5f61bb1ac94921c>;

struct <lambda_3883c3dff614d5e0c5f61bb1ac94921c> { // PlaceHolder Structure
};

typedef struct <lambda_d90129c13df834fdcbf8d2b88dafcf2d> <lambda_d90129c13df834fdcbf8d2b88dafcf2d>, *P<lambda_d90129c13df834fdcbf8d2b88dafcf2d>;

struct <lambda_d90129c13df834fdcbf8d2b88dafcf2d> { // PlaceHolder Structure
};


// WARNING! conflicting data type names: /Demangler/wchar_t - /wchar_t

typedef struct <lambda_314360699dd331753a4119843814e9a7> <lambda_314360699dd331753a4119843814e9a7>, *P<lambda_314360699dd331753a4119843814e9a7>;

struct <lambda_314360699dd331753a4119843814e9a7> { // PlaceHolder Structure
};

typedef enum __crt_lowio_text_mode {
} __crt_lowio_text_mode;

typedef struct __crt_stdio_stream __crt_stdio_stream, *P__crt_stdio_stream;

struct __crt_stdio_stream { // PlaceHolder Structure
};

typedef struct _strflt _strflt, *P_strflt;

struct _strflt { // PlaceHolder Structure
};

typedef struct __crt_seh_guarded_call<int> __crt_seh_guarded_call<int>, *P__crt_seh_guarded_call<int>;

struct __crt_seh_guarded_call<int> { // PlaceHolder Structure
};

typedef struct pair<class___FrameHandler3::TryBlockMap::iterator,class___FrameHandler3::TryBlockMap::iterator> pair<class___FrameHandler3::TryBlockMap::iterator,class___FrameHandler3::TryBlockMap::iterator>, *Ppair<class___FrameHandler3::TryBlockMap::iterator,class___FrameHandler3::TryBlockMap::iterator>;

struct pair<class___FrameHandler3::TryBlockMap::iterator,class___FrameHandler3::TryBlockMap::iterator> { // PlaceHolder Structure
};

typedef enum module_id {
} module_id;

typedef struct TryBlockMap TryBlockMap, *PTryBlockMap;

struct TryBlockMap { // PlaceHolder Structure
};

typedef struct stream_output_adapter<char> stream_output_adapter<char>, *Pstream_output_adapter<char>;

struct stream_output_adapter<char> { // PlaceHolder Structure
};

typedef struct string_output_adapter<char> string_output_adapter<char>, *Pstring_output_adapter<char>;

struct string_output_adapter<char> { // PlaceHolder Structure
};

typedef enum length_modifier {
} length_modifier;

typedef struct string_output_adapter<wchar_t> string_output_adapter<wchar_t>, *Pstring_output_adapter<wchar_t>;

struct string_output_adapter<wchar_t> { // PlaceHolder Structure
};

typedef struct output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_> output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_>, *Poutput_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_>;

struct output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_> { // PlaceHolder Structure
};

typedef enum function_id {
} function_id;

typedef struct file_options file_options, *Pfile_options;

struct file_options { // PlaceHolder Structure
};

typedef int (* _onexit_t)(void);




int FUN_140001000(undefined *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  ulonglong uVar2;
  ulonglong *puVar3;
  undefined8 local_res20;
  undefined auStackY_58 [32];
  
  uVar2 = DAT_140038010 ^ (ulonglong)auStackY_58;
  local_res20 = param_4;
  puVar3 = (ulonglong *)FUN_140001080();
  iVar1 = common_vsprintf__(*puVar3 | 2,param_1,0x19,(longlong)"%d",(__crt_locale_pointers *)0x0,
                            &local_res20);
  if (iVar1 < 0) {
    iVar1 = -1;
  }
  __security_check_cookie(uVar2 ^ (ulonglong)auStackY_58);
  return iVar1;
}



undefined * FUN_140001080(void)

{
  return &DAT_14003a330;
}



undefined (**) [16]
FUN_140001090(undefined (**param_1) [16],uint param_2,longlong param_3,uint param_4,longlong param_5
             )

{
  int iVar1;
  size_t sVar2;
  wchar_t *pwVar3;
  wchar_t *pwVar4;
  undefined (*pauVar5) [16];
  wchar_t wVar6;
  int iVar7;
  ulonglong uVar8;
  __uint64 _Var9;
  wchar_t *pwVar10;
  int iVar11;
  ulonglong uVar12;
  
  if ((int)param_2 < 1) {
    iVar11 = 0;
  }
  else {
    uVar12 = 0;
    iVar11 = 0;
    do {
      pwVar10 = *(wchar_t **)(param_3 + uVar12 * 8);
      sVar2 = wcslen(pwVar10);
      pwVar3 = wcschr(pwVar10,L'\"');
      pwVar4 = wcspbrk(pwVar10,L" \t");
      uVar8 = (ulonglong)((int)sVar2 + 2);
      if (pwVar4 == (wchar_t *)0x0) {
        uVar8 = sVar2 & 0xffffffff;
      }
      iVar7 = (int)uVar8;
      if (pwVar3 != (wchar_t *)0x0) {
        iVar1 = 0;
        do {
          iVar7 = (int)uVar8;
          wVar6 = *pwVar10;
          if (wVar6 == L'\"') {
            uVar8 = (ulonglong)(iVar7 + iVar1 + 1);
LAB_140001215:
            iVar1 = 0;
          }
          else {
            if (wVar6 != L'\\') {
              if (wVar6 != L'\0') goto LAB_140001215;
              break;
            }
            iVar1 = iVar1 + 1;
          }
          pwVar10 = pwVar10 + 1;
        } while( true );
      }
      iVar11 = iVar11 + iVar7 + 1;
      uVar12 = uVar12 + 1;
    } while (uVar12 != param_2);
  }
  if (0 < (int)param_4) {
    uVar12 = 0;
    do {
      pwVar10 = *(wchar_t **)(param_5 + uVar12 * 8);
      sVar2 = wcslen(pwVar10);
      pwVar3 = wcschr(pwVar10,L'\"');
      pwVar4 = wcspbrk(pwVar10,L" \t");
      uVar8 = (ulonglong)((int)sVar2 + 2);
      if (pwVar4 == (wchar_t *)0x0) {
        uVar8 = sVar2 & 0xffffffff;
      }
      iVar7 = (int)uVar8;
      if (pwVar3 != (wchar_t *)0x0) {
        iVar1 = 0;
        do {
          iVar7 = (int)uVar8;
          wVar6 = *pwVar10;
          if (wVar6 == L'\"') {
            uVar8 = (ulonglong)(iVar7 + iVar1 + 1);
LAB_1400012f3:
            iVar1 = 0;
          }
          else {
            if (wVar6 != L'\\') {
              if (wVar6 != L'\0') goto LAB_1400012f3;
              break;
            }
            iVar1 = iVar1 + 1;
          }
          pwVar10 = pwVar10 + 1;
        } while( true );
      }
      iVar11 = iVar11 + iVar7 + 1;
      uVar12 = uVar12 + 1;
    } while (uVar12 != param_4);
  }
  iVar7 = 1;
  if (iVar11 != 0) {
    iVar7 = iVar11;
  }
  uVar12 = (ulonglong)iVar7;
  _Var9 = 0xffffffffffffffff;
  if (!CARRY8(uVar12,uVar12)) {
    _Var9 = uVar12 * 2;
  }
  pauVar5 = (undefined (*) [16])operator_new(_Var9);
  FUN_14000ce30(pauVar5,0,_Var9);
  *param_1 = pauVar5;
  if (0 < (int)param_2) {
    uVar12 = 0;
    do {
      pwVar10 = *(wchar_t **)(param_3 + uVar12 * 8);
      pwVar3 = wcschr(pwVar10,L'\"');
      pwVar4 = wcspbrk(pwVar10,L" \t");
      if (pwVar4 != (wchar_t *)0x0) {
        *(undefined2 *)*pauVar5 = 0x22;
        pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
      }
      if (pwVar3 != (wchar_t *)0x0) {
        iVar11 = 0;
        do {
          wVar6 = *pwVar10;
          if (wVar6 == L'\"') {
            if (iVar11 < 0) {
              wVar6 = L'\"';
            }
            else {
              iVar11 = iVar11 + 1;
              do {
                *(undefined2 *)*pauVar5 = 0x5c;
                pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
                iVar11 = iVar11 + -1;
              } while (iVar11 != 0);
              wVar6 = *pwVar10;
            }
LAB_140001247:
            iVar11 = 0;
          }
          else {
            if (wVar6 != L'\\') {
              if (wVar6 != L'\0') goto LAB_140001247;
              goto LAB_1400011ac;
            }
            iVar11 = iVar11 + 1;
            wVar6 = L'\\';
          }
          *(wchar_t *)*pauVar5 = wVar6;
          pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
          pwVar10 = pwVar10 + 1;
        } while( true );
      }
      FUN_14000af20((longlong)pauVar5,pwVar10);
      sVar2 = wcslen(pwVar10);
      pauVar5 = (undefined (*) [16])(*pauVar5 + sVar2 * 2);
LAB_1400011ac:
      if (pwVar4 != (wchar_t *)0x0) {
        *(undefined2 *)*pauVar5 = 0x22;
        pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
      }
      uVar12 = uVar12 + 1;
      if (uVar12 != param_2 + param_4) {
        *(undefined2 *)*pauVar5 = 0x20;
        pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
      }
    } while (uVar12 != param_2);
  }
  if (0 < (int)param_4) {
    uVar12 = 0;
    do {
      pwVar10 = *(wchar_t **)(param_5 + uVar12 * 8);
      pwVar3 = wcschr(pwVar10,L'\"');
      pwVar4 = wcspbrk(pwVar10,L" \t");
      if (pwVar4 != (wchar_t *)0x0) {
        *(undefined2 *)*pauVar5 = 0x22;
        pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
      }
      if (pwVar3 != (wchar_t *)0x0) {
        iVar11 = 0;
        do {
          wVar6 = *pwVar10;
          if (wVar6 == L'\"') {
            if (iVar11 < 0) {
              wVar6 = L'\"';
            }
            else {
              iVar11 = iVar11 + 1;
              do {
                *(undefined2 *)*pauVar5 = 0x5c;
                pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
                iVar11 = iVar11 + -1;
              } while (iVar11 != 0);
              wVar6 = *pwVar10;
            }
LAB_14000136e:
            iVar11 = 0;
          }
          else {
            if (wVar6 != L'\\') {
              if (wVar6 != L'\0') goto LAB_14000136e;
              goto LAB_1400013ba;
            }
            iVar11 = iVar11 + 1;
            wVar6 = L'\\';
          }
          *(wchar_t *)*pauVar5 = wVar6;
          pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
          pwVar10 = pwVar10 + 1;
        } while( true );
      }
      FUN_14000af20((longlong)pauVar5,pwVar10);
      sVar2 = wcslen(pwVar10);
      pauVar5 = (undefined (*) [16])(*pauVar5 + sVar2 * 2);
LAB_1400013ba:
      if (pwVar4 != (wchar_t *)0x0) {
        *(undefined2 *)*pauVar5 = 0x22;
        pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
      }
      uVar12 = uVar12 + 1;
      if (uVar12 == param_4) break;
      *(undefined2 *)*pauVar5 = 0x20;
      pauVar5 = (undefined (*) [16])(*pauVar5 + 2);
    } while( true );
  }
  *(undefined2 *)*pauVar5 = 0;
  return param_1;
}



undefined4 FUN_1400013f0(longlong param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  ulonglong uVar2;
  undefined8 *puVar3;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStackY_58 [32];
  
  uVar2 = DAT_140038010 ^ (ulonglong)auStackY_58;
  local_res18 = param_3;
  local_res20 = param_4;
  puVar3 = (undefined8 *)FUN_140001080();
  uVar1 = FID_conflict___stdio_common_vfwprintf(*puVar3,param_1,param_2,0,&local_res18);
  __security_check_cookie(uVar2 ^ (ulonglong)auStackY_58);
  return uVar1;
}



undefined8 FUN_140001460(wchar_t *param_1,short *param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  size_t sVar3;
  undefined (*_String) [16];
  undefined (*pbData) [16];
  __uint64 _Var4;
  ulonglong uVar5;
  LPWSTR pWVar6;
  undefined8 uVar7;
  undefined auStackY_78 [32];
  uint local_50;
  DWORD local_4c;
  HCRYPTHASH local_48;
  HCRYPTPROV local_40;
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStackY_78;
  sVar3 = wcslen(param_1);
  if (sVar3 == 0) {
    uVar7 = 0;
    goto LAB_14000166a;
  }
  if ((param_1[sVar3 - 1] == L'\\') || (param_1[sVar3 - 1] == L'/')) {
    sVar3 = sVar3 - 1;
  }
  uVar5 = sVar3 + 2;
  _Var4 = 0xffffffffffffffff;
  if (!CARRY8(uVar5,uVar5)) {
    _Var4 = uVar5 * 2;
  }
  _String = (undefined (*) [16])operator_new(_Var4);
  FUN_14000ce30(_String,0,sVar3 * 2 + 4);
  FUN_14000b198((short *)_String,(longlong)param_1,sVar3 + 1);
  _wcslwr((wchar_t *)_String);
  local_50 = 0;
  local_40 = 0;
  local_48 = 0;
  BVar1 = CryptAcquireContextA(&local_40,(LPCSTR)0x0,(LPCSTR)0x0,1,0xf0000000);
  if ((((BVar1 == 0) &&
       ((DVar2 = GetLastError(), DVar2 != 0x80090016 ||
        (BVar1 = CryptAcquireContextA(&local_40,(LPCSTR)0x0,(LPCSTR)0x0,1,0xf0000008), BVar1 == 0)))
       ) || (BVar1 = CryptCreateHash(local_40,0x8003,0,0,&local_48), BVar1 == 0)) ||
     (BVar1 = CryptHashData(local_48,(BYTE *)_String,(int)sVar3 * 2,0), BVar1 == 0)) {
LAB_1400016c7:
    uVar7 = 0;
    pbData = _String;
  }
  else {
    local_4c = 4;
    BVar1 = CryptGetHashParam(local_48,4,(BYTE *)&local_50,&local_4c,0);
    if (BVar1 == 0) goto LAB_1400016c7;
    uVar5 = (ulonglong)local_50;
    pbData = (undefined (*) [16])operator_new(uVar5);
    FUN_14000ce30(pbData,0,uVar5);
    BVar1 = CryptGetHashParam(local_48,2,(BYTE *)pbData,&local_50,0);
    if (BVar1 == 0) goto LAB_1400016c7;
    if (local_48 != 0) {
      CryptDestroyHash(local_48);
    }
    if (local_40 != 0) {
      CryptReleaseContext(local_40,0);
    }
    thunk_FUN_140013ed8(_String);
    FUN_14000b198(param_2,(longlong)L"SOFTWARE\\Mozilla\\MaintenanceService\\",0x104);
    uVar7 = 1;
    if (local_50 != 0) {
      pWVar6 = param_2 + 0x24;
      uVar5 = 0;
      do {
        wsprintfW(pWVar6,L"%.2x");
        pWVar6 = pWVar6 + 2;
        uVar5 = uVar5 + 1;
      } while (uVar5 < local_50);
    }
  }
  thunk_FUN_140013ed8(pbData);
LAB_14000166a:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY_78);
  return uVar7;
}



bool FUN_1400016d0(int param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  BOOL BVar4;
  DWORD DVar5;
  undefined8 uVar6;
  char *pcVar7;
  bool bVar8;
  undefined auStack_258 [32];
  undefined local_238 [8];
  undefined4 uStack_230;
  undefined4 uStack_22c;
  undefined4 local_228;
  undefined4 uStack_224;
  undefined4 uStack_220;
  undefined4 uStack_21c;
  ulonglong local_28;
  
  local_28 = DAT_140038010 ^ (ulonglong)auStack_258;
  iVar1 = lstrcmpiW(*(LPCWSTR *)(param_2 + 8),L"forceinstall");
  iVar2 = lstrcmpiW(*(LPCWSTR *)(param_2 + 8),L"install");
  if ((iVar2 == 0) || (iVar1 == 0)) {
    uVar6 = 0x104;
    DVar5 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)local_238,0x104);
    if (DVar5 != 0) {
      BVar4 = PathRemoveFileSpecW((LPWSTR)local_238);
      if (BVar4 != 0) {
        BVar4 = FUN_140028000((wchar_t *)local_238,L"logs");
        if (BVar4 != 0) {
          CreateDirectoryW((LPCWSTR)local_238,(LPSECURITY_ATTRIBUTES)0x0);
          BVar4 = FUN_140028000((wchar_t *)local_238,L"maintenanceservice-install.log");
          if (BVar4 != 0) {
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = (FILE *)0x0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            FUN_140008e50(&DAT_14003a118,(wchar_t *)local_238);
          }
        }
      }
    }
    iVar2 = *(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4);
    if (iVar1 == 0) {
      if (iVar2 < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        uVar3 = 2;
        pcVar7 = "Installing service with force specified...";
        goto LAB_140001d4a;
      }
      uVar3 = 2;
      pcVar7 = "Installing service with force specified...";
    }
    else if (iVar2 < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      uVar3 = 1;
      pcVar7 = "Installing service...";
LAB_140001d4a:
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    else {
      uVar3 = 1;
      pcVar7 = "Installing service...";
    }
    FUN_140008ee0(&DAT_14003a118,(longlong)pcVar7,uVar6,param_4);
    iVar2 = FUN_140002fa0(uVar3,pcVar7,uVar6,param_4);
    iVar1 = *(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4);
    if (iVar2 != 0) {
      if (iVar1 < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = "The service was installed successfully";
      goto LAB_1400019cc;
    }
    if (iVar1 < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    uVar3 = GetLastError();
    pcVar7 = "Could not install service.  (%lu)";
LAB_140001ab1:
    FUN_140008ff0(&DAT_14003a118,(longlong)pcVar7,(ulonglong)uVar3,param_4);
    bVar8 = true;
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      bVar8 = true;
      goto LAB_140001cfd;
    }
  }
  else {
    iVar1 = lstrcmpiW(*(LPCWSTR *)(param_2 + 8),L"upgrade");
    if (iVar1 == 0) {
      uVar6 = 0x104;
      DVar5 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)local_238,0x104);
      if (DVar5 != 0) {
        BVar4 = PathRemoveFileSpecW((LPWSTR)local_238);
        if (BVar4 != 0) {
          BVar4 = FUN_140028000((wchar_t *)local_238,L"logs");
          if (BVar4 != 0) {
            CreateDirectoryW((LPCWSTR)local_238,(LPSECURITY_ATTRIBUTES)0x0);
            BVar4 = FUN_140028000((wchar_t *)local_238,L"maintenanceservice-install.log");
            if (BVar4 != 0) {
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                if (DAT_14003a328 == -1) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
              }
              FUN_140008e50(&DAT_14003a118,(wchar_t *)local_238);
            }
          }
        }
      }
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = "Upgrading service if installed...";
      FUN_140008ee0(&DAT_14003a118,(longlong)"Upgrading service if installed...",uVar6,param_4);
      iVar2 = FUN_140002fa0(0,pcVar7,uVar6,param_4);
      iVar1 = *(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4);
      if (iVar2 == 0) {
        if (iVar1 < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = (FILE *)0x0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        uVar3 = GetLastError();
        pcVar7 = "Could not upgrade service.  (%lu)";
        goto LAB_140001ab1;
      }
      if (iVar1 < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = "The service was upgraded successfully";
    }
    else {
      iVar1 = lstrcmpiW(*(LPCWSTR *)(param_2 + 8),L"uninstall");
      if (iVar1 != 0) {
        iVar1 = lstrcmpiW(*(LPCWSTR *)(param_2 + 8),L"check-cert");
        if ((param_1 < 3) || (iVar1 != 0)) {
          local_228 = 0;
          uStack_224 = 0;
          uStack_220 = 0;
          uStack_21c = 0;
          local_238._0_4_ = 0x40031180;
          local_238._4_4_ = 1;
          uStack_230 = 0x400020c0;
          uStack_22c = 1;
          BVar4 = StartServiceCtrlDispatcherW((SERVICE_TABLE_ENTRYW *)local_238);
          if (BVar4 == 0) {
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = (FILE *)0x0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            DVar5 = GetLastError();
            FUN_140008ff0(&DAT_14003a118,(longlong)"StartServiceCtrlDispatcher failed.  (%lu)",
                          (ulonglong)DVar5,param_4);
          }
          bVar8 = false;
        }
        else {
          uVar6 = FUN_140008420(*(wchar_t **)(param_2 + 0x10),*(void **)(param_2 + 0x18),0);
          bVar8 = (int)uVar6 == 0;
        }
        goto LAB_140001aff;
      }
      uVar6 = 0x104;
      DVar5 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)local_238,0x104);
      if (DVar5 != 0) {
        BVar4 = PathRemoveFileSpecW((LPWSTR)local_238);
        if (BVar4 != 0) {
          BVar4 = FUN_140028000((wchar_t *)local_238,L"logs");
          if (BVar4 != 0) {
            CreateDirectoryW((LPCWSTR)local_238,(LPSECURITY_ATTRIBUTES)0x0);
            BVar4 = FUN_140028000((wchar_t *)local_238,L"maintenanceservice-uninstall.log");
            if (BVar4 != 0) {
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                if (DAT_14003a328 == -1) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
              }
              FUN_140008e50(&DAT_14003a118,(wchar_t *)local_238);
            }
          }
        }
      }
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      FUN_140008ee0(&DAT_14003a118,(longlong)"Uninstalling service...",uVar6,param_4);
      uVar3 = FUN_1400048d0();
      iVar1 = *(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4);
      if (uVar3 == 0) {
        if (iVar1 < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = (FILE *)0x0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        uVar3 = GetLastError();
        pcVar7 = "Could not uninstall service.  (%lu)";
        goto LAB_140001ab1;
      }
      if (iVar1 < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = "The service was uninstalled successfully";
    }
LAB_1400019cc:
    FUN_140008ee0(&DAT_14003a118,(longlong)pcVar7,uVar6,param_4);
    bVar8 = false;
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      bVar8 = false;
LAB_140001cfd:
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
  }
  if (DAT_14003a118 != (FILE *)0x0) {
    FUN_140013618(DAT_14003a118);
    DAT_14003a118 = (FILE *)0x0;
  }
LAB_140001aff:
  __security_check_cookie(local_28 ^ (ulonglong)auStack_258);
  return bVar8;
}



void FUN_140002050(void)

{
  if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
      DAT_14003a328) {
    _Init_thread_header(&DAT_14003a328);
    if (DAT_14003a328 == -1) {
      DAT_14003a118 = 0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
      return;
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1400020c0(uint param_1,ulonglong param_2,undefined8 param_3,undefined (*param_4) [16])

{
  uint uVar1;
  DWORD DVar2;
  BOOL BVar3;
  uint uVar4;
  HANDLE hObject;
  undefined (*pauVar5) [16];
  undefined (*pauVar6) [16];
  undefined auStackY_748 [32];
  WCHAR local_718 [264];
  wchar_t local_508 [264];
  wchar_t local_2f8 [264];
  undefined local_e8 [16];
  undefined local_d8 [16];
  undefined local_c8 [16];
  undefined local_b8 [16];
  undefined local_a8 [16];
  undefined local_98 [16];
  undefined local_88 [16];
  undefined local_78 [16];
  ulonglong local_60;
  
  local_60 = DAT_140038010 ^ (ulonglong)auStackY_748;
  DVar2 = GetModuleFileNameW((HMODULE)0x0,local_718,0x104);
  if (DVar2 != 0) {
    BVar3 = PathRemoveFileSpecW(local_718);
    if (BVar3 != 0) {
      BVar3 = FUN_140028000(local_718,L"logs");
      if (BVar3 != 0) {
        CreateDirectoryW(local_718,(LPSECURITY_ATTRIBUTES)0x0);
        uVar4 = 9;
        do {
          pauVar5 = (undefined (*) [16])(ulonglong)uVar4;
          local_78 = ZEXT816(0);
          local_88 = ZEXT816(0);
          local_98 = ZEXT816(0);
          local_a8 = ZEXT816(0);
          local_b8 = ZEXT816(0);
          local_c8 = ZEXT816(0);
          local_d8 = ZEXT816(0);
          local_e8 = ZEXT816(0);
          FUN_14000b198(local_2f8,(longlong)local_718,0x3f);
          if (uVar4 == 0) {
            FUN_140027f10((undefined2 *)local_e8,0x40,(longlong)L"maintenanceservice.log",param_4);
          }
          else {
            FUN_140027f10((undefined2 *)local_e8,0x40,(longlong)L"maintenanceservice-%d.log",pauVar5
                         );
            param_4 = pauVar5;
          }
          BVar3 = FUN_140028000(local_2f8,(wchar_t *)local_e8);
          if (BVar3 != 0) {
            local_78 = ZEXT816(0);
            local_88 = ZEXT816(0);
            local_98 = ZEXT816(0);
            local_a8 = ZEXT816(0);
            local_b8 = ZEXT816(0);
            local_c8 = ZEXT816(0);
            local_d8 = ZEXT816(0);
            local_e8 = ZEXT816(0);
            FUN_14000b198(local_508,(longlong)local_718,0x3f);
            param_4 = (undefined (*) [16])(ulonglong)(uVar4 + 1);
            FUN_140027f10((undefined2 *)local_e8,0x40,(longlong)L"maintenanceservice-%d.log",param_4
                         );
            BVar3 = FUN_140028000(local_508,(wchar_t *)local_e8);
            if (BVar3 != 0) {
              MoveFileExW(local_2f8,local_508,1);
            }
          }
          uVar1 = uVar4 + 1;
          uVar4 = uVar4 - 1;
        } while (1 < uVar1);
        BVar3 = FUN_140028000(local_718,L"maintenanceservice.log");
        if (BVar3 != 0) {
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = (FILE *)0x0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          FUN_140008e50(&DAT_14003a118,local_718);
        }
      }
    }
  }
  FUN_140008bb0((HANDLE)0x0,(longlong)&PTR_s_SeAssignPrimaryTokenPrivilege_140038b00,0x22,param_4);
  DAT_14003a100 = RegisterServiceCtrlHandlerW(L"MozillaMaintenance",FUN_1400025d0);
  if (DAT_14003a100 == (SERVICE_STATUS_HANDLE)0x0) {
    FUN_140002050();
    DVar2 = GetLastError();
    pauVar5 = (undefined (*) [16])(ulonglong)DVar2;
    FUN_140008ff0(&DAT_14003a118,(longlong)"RegisterServiceCtrlHandler failed.  (%lu)",pauVar5,
                  param_4);
    FUN_140005f80(param_1,param_2,pauVar5,param_4);
    FUN_140002050();
    FUN_140008eb0(&DAT_14003a118);
    FUN_140010a70(1);
LAB_140002524:
    uVar4 = (uint)param_2;
    _Init_thread_header(&DAT_14003a328);
    if (DAT_14003a328 == -1) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
LAB_140002229:
    if (DAT_14003a118 != (FILE *)0x0) {
      FUN_140013618(DAT_14003a118);
      DAT_14003a118 = (FILE *)0x0;
    }
    SetEvent(DAT_14003a108);
    if (DAT_14003a110 != '\0') goto LAB_1400022ed;
    _DAT_14003a0f0 = (uint)(uVar4 == 0);
  }
  else {
    _DAT_14003a0e4 = 0x10;
    _DAT_14003a0e8 = 2;
    _DAT_14003a0f0 = 0;
    _DAT_14003a0f4 = 0;
    _DAT_14003a0f8 = CONCAT44(3000,DAT_140038af4);
    DAT_140038af4 = DAT_140038af4 + 1;
    SetServiceStatus(DAT_14003a100,(LPSERVICE_STATUS)&DAT_14003a0e4);
    pauVar5 = (undefined (*) [16])0x0;
    pauVar6 = (undefined (*) [16])0x0;
    DAT_14003a108 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
    if (DAT_14003a108 != (HANDLE)0x0) {
      _DAT_14003a0e8 = 0x500000004;
      _DAT_14003a0f0 = 0;
      _DAT_14003a0f8 = 0;
      SetServiceStatus(DAT_14003a100,(LPSERVICE_STATUS)&DAT_14003a0e4);
      uVar4 = FUN_140005f80(param_1,param_2,pauVar5,pauVar6);
      param_2 = (ulonglong)uVar4;
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) goto LAB_140002524;
      goto LAB_140002229;
    }
    _DAT_14003a0f0 = 1;
  }
  _DAT_14003a0e8 = 0x500000001;
  _DAT_14003a0f8 = 0;
  SetServiceStatus(DAT_14003a100,(LPSERVICE_STATUS)&DAT_14003a0e4);
  hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_1400025b0,(LPVOID)0x0,0,(LPDWORD)0x0);
  if (hObject != (HANDLE)0x0) {
    CloseHandle(hObject);
  }
LAB_1400022ed:
  __security_check_cookie(local_60 ^ (ulonglong)auStackY_748);
  return;
}



void FUN_1400025b0(void)

{
  code *pcVar1;
  
  Sleep(5000);
  FUN_140010a70(0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1400025d0(uint param_1)

{
  HANDLE hObject;
  
  if ((DAT_14003a110 == '\0') && ((param_1 | 4) == 5)) {
    DAT_14003a110 = 1;
    _DAT_14003a0e8 = 3;
    _DAT_14003a0f0 = 0;
    _DAT_14003a0fc = 1000;
    _DAT_14003a0f8 = DAT_140038af4;
    DAT_140038af4 = DAT_140038af4 + 1;
    SetServiceStatus(DAT_14003a100,(LPSERVICE_STATUS)&DAT_14003a0e4);
    hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_140002690,(LPVOID)0x0,0,(LPDWORD)0x0);
    if (hObject != (HANDLE)0x0) {
                    // WARNING: Could not recover jumptable at 0x000140002669. Too many branches
                    // WARNING: Treating indirect jump as call
      CloseHandle(hObject);
      return;
    }
    FUN_140002690();
    return;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_140002690(void)

{
  DWORD DVar1;
  HANDLE hObject;
  
  do {
    _DAT_14003a0e8 = 3;
    _DAT_14003a0f0 = 0;
    _DAT_14003a0f8 = CONCAT44(1000,DAT_140038af4);
    DAT_140038af4 = DAT_140038af4 + 1;
    SetServiceStatus(DAT_14003a100,(LPSERVICE_STATUS)&DAT_14003a0e4);
    DVar1 = WaitForSingleObject(DAT_14003a108,100);
  } while (DVar1 == 0x102);
  CloseHandle(DAT_14003a108);
  DAT_14003a108 = (HANDLE)0x0;
  _DAT_14003a0e8 = 0x500000001;
  _DAT_14003a0f0 = 0;
  _DAT_14003a0f8 = 0;
  SetServiceStatus(DAT_14003a100,(LPSERVICE_STATUS)&DAT_14003a0e4);
  hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_1400025b0,(LPVOID)0x0,0,(LPDWORD)0x0);
  if (hObject != (HANDLE)0x0) {
    CloseHandle(hObject);
  }
  return 0;
}



void FUN_140002780(void)

{
  if (DAT_14003a118 != (FILE *)0x0) {
    FUN_140013618(DAT_14003a118);
    DAT_14003a118 = (FILE *)0x0;
  }
  return;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

undefined8 FUN_1400027b0(LPCWSTR param_1,LPCWSTR param_2,undefined4 *param_3)

{
  DWORD DVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  HANDLE hFile;
  HANDLE hFile_00;
  undefined8 uVar5;
  undefined8 uVar6;
  uint uVar7;
  undefined auStackY_10090 [32];
  uint uStack_10054;
  undefined auStack_10050 [32768];
  undefined local_8050 [32768];
  ulonglong local_50;
  undefined8 uStack_48;
  
  uStack_48 = 0x1400027c6;
  local_50 = DAT_140038010 ^ (ulonglong)auStackY_10090;
  uVar5 = 0;
  *param_3 = 0;
  hFile = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffffffffffff) goto LAB_140002944;
  hFile_00 = CreateFileW(param_2,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  uVar5 = 0;
  if (hFile_00 != (HANDLE)0xffffffffffffffff) {
    DVar1 = GetFileSize(hFile,(LPDWORD)0x0);
    DVar2 = GetFileSize(hFile_00,(LPDWORD)0x0);
    uVar5 = 0;
    if (((DVar1 != 0xffffffff) && (DVar2 != 0xffffffff)) && (uVar5 = 1, DVar1 == DVar2)) {
      if (0x7fff < DVar1) {
        uVar7 = DVar1 >> 0xf;
        do {
          BVar3 = ReadFile(hFile,local_8050,0x8000,&uStack_10054,(LPOVERLAPPED)0x0);
          uVar6 = 0;
          uVar5 = 0;
          if (((BVar3 == 0) || (uVar5 = uVar6, uStack_10054 != 0x8000)) ||
             ((BVar3 = ReadFile(hFile_00,auStack_10050,0x8000,&uStack_10054,(LPOVERLAPPED)0x0),
              BVar3 == 0 || (uStack_10054 != 0x8000)))) goto LAB_14000292f;
          iVar4 = memcmp(local_8050,auStack_10050,0x8000);
          if (iVar4 != 0) goto LAB_14000292a;
          uVar7 = uVar7 - 1;
        } while (uVar7 != 0);
      }
      uVar7 = DVar1 & 0x7fff;
      if (uVar7 == 0) {
LAB_140002923:
        *param_3 = 1;
LAB_14000292a:
        uVar5 = 1;
      }
      else {
        BVar3 = ReadFile(hFile,local_8050,uVar7,&uStack_10054,(LPOVERLAPPED)0x0);
        uVar5 = 0;
        if (((BVar3 != 0) && (uStack_10054 == uVar7)) &&
           ((BVar3 = ReadFile(hFile_00,auStack_10050,uVar7,&uStack_10054,(LPOVERLAPPED)0x0),
            BVar3 != 0 && (uStack_10054 == uVar7)))) {
          iVar4 = memcmp(local_8050,auStack_10050,(ulonglong)uVar7);
          uVar5 = 1;
          if (iVar4 == 0) goto LAB_140002923;
        }
      }
    }
  }
LAB_14000292f:
  if (1 < (longlong)hFile_00 + 1U) {
    CloseHandle(hFile_00);
  }
LAB_140002944:
  if (1 < (longlong)hFile + 1U) {
    CloseHandle(hFile);
  }
  __security_check_cookie(local_50 ^ (ulonglong)auStackY_10090);
  return uVar5;
}



void FUN_140002a30(SC_HANDLE param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined (*lpMultiByteStr) [16];
  char cVar1;
  DWORD DVar2;
  BOOL BVar3;
  uint uVar4;
  int iVar5;
  undefined7 extraout_var;
  undefined (*lpWideCharStr) [16];
  char *pcVar6;
  ulonglong uVar7;
  __uint64 _Var8;
  undefined8 uVar9;
  undefined (**ppauVar10) [16];
  undefined auStackY_288 [32];
  undefined (*local_250) [16];
  WCHAR local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStackY_288;
  DVar2 = GetModuleFileNameW((HMODULE)0x0,local_248,0x105);
  if (DVar2 == 0) {
    if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                 ) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = 0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    uVar4 = GetLastError();
    pcVar6 = 
    "Could not obtain module filename when attempting to modify service description.  (%lu)";
  }
  else {
    BVar3 = PathRemoveFileSpecW(local_248);
    if (BVar3 == 0) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      uVar4 = GetLastError();
      pcVar6 = "Could not remove file spec when attempting to modify service description.  (%lu)";
    }
    else {
      BVar3 = FUN_140028000(local_248,L"updater.ini");
      if (BVar3 == 0) {
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        uVar4 = GetLastError();
        pcVar6 = 
        "Could not append updater.ini filename when attempting to modify service description.  (%lu)"
        ;
      }
      else {
        DVar2 = GetFileAttributesW(local_248);
        if (DVar2 != 0xffffffff) {
          ppauVar10 = &local_250;
          local_250 = (undefined (*) [16])0x0;
          uVar9 = 1;
          cVar1 = FUN_1400080f0(local_248,"MozillaMaintenanceDescription",1,(longlong)ppauVar10,
                                (char *)0x0);
          lpMultiByteStr = local_250;
          if (((int)CONCAT71(extraout_var,cVar1) == 0) && ((*local_250)[0] != '\0')) {
            iVar5 = MultiByteToWideChar(0xfde9,0,(LPCSTR)local_250,-1,(LPWSTR)0x0,0);
            uVar7 = (ulonglong)iVar5;
            _Var8 = 0xffffffffffffffff;
            if (!CARRY8(uVar7,uVar7)) {
              _Var8 = uVar7 * 2;
            }
            lpWideCharStr = (undefined (*) [16])operator_new(_Var8);
            FUN_14000ce30(lpWideCharStr,0,_Var8);
            uVar9 = 0xffffffff;
            iVar5 = MultiByteToWideChar(0xfde9,0,(LPCSTR)lpMultiByteStr,-1,(LPWSTR)lpWideCharStr,
                                        iVar5);
            if (iVar5 == 0) {
              if ((*(int *)(*(longlong *)
                             ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                   < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
              uVar4 = GetLastError();
              pcVar6 = "Could not convert description to wide string format.  (%lu)";
LAB_140002d6f:
              FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar6,(ulonglong)uVar4,uVar9);
            }
            else {
              ppauVar10 = &local_250;
              local_250 = lpWideCharStr;
              BVar3 = ChangeServiceConfig2W(param_1,1,ppauVar10);
              iVar5 = *(int *)(*(longlong *)
                                ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                              4);
              if (BVar3 == 0) {
                if ((iVar5 < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = 0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                uVar4 = GetLastError();
                pcVar6 = "Could not change service config.  (%lu)";
                goto LAB_140002d6f;
              }
              if ((iVar5 < DAT_14003a328) &&
                 (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
              FUN_140008ee0((FILE **)&DAT_14003a118,
                            (longlong)"The service description was updated successfully.",ppauVar10,
                            uVar9);
            }
            thunk_FUN_140013ed8(lpWideCharStr);
          }
          else {
            if ((*(int *)(*(longlong *)
                           ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                 DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
            FUN_140008ff0((FILE **)&DAT_14003a118,
                          (longlong)
                          "updater.ini file does not contain a maintenance service description.",
                          uVar9,ppauVar10);
            if (lpMultiByteStr == (undefined (*) [16])0x0) goto LAB_140002afb;
          }
          thunk_FUN_140013ed8(lpMultiByteStr);
          goto LAB_140002afb;
        }
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        uVar4 = GetLastError();
        pcVar6 = "updater.ini file does not exist, will not modify service description.  (%lu)";
      }
    }
  }
  FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar6,(ulonglong)uVar4,param_4);
LAB_140002afb:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY_288);
  return;
}



undefined4 FUN_140002fa0(uint param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  uint uVar2;
  BOOL BVar3;
  int iVar4;
  LSTATUS LVar5;
  SC_HANDLE hSCManager;
  SC_HANDLE pSVar6;
  ulonglong uVar7;
  LPQUERY_SERVICE_CONFIGW lpServiceConfig;
  undefined8 uVar8;
  undefined8 uVar9;
  SC_HANDLE hService;
  size_t sVar10;
  ulonglong uVar11;
  undefined (*lpNewFileName) [16];
  wchar_t *pwVar12;
  __uint64 _Var13;
  char *pcVar14;
  uint *puVar15;
  undefined4 uVar16;
  uint *puVar17;
  LPSERVICE_STATUS lpServiceStatus;
  wchar_t *pwVar18;
  LPDWORD pDVar19;
  undefined (*pauVar20) [16];
  undefined auStackY_508 [32];
  uint local_494;
  uint local_490;
  uint local_48c;
  uint local_488;
  uint local_484;
  uint local_480;
  uint local_47c;
  uint local_478;
  uint local_474;
  HKEY local_470;
  WCHAR local_468 [264];
  HLOCAL local_258;
  ulonglong local_40;
  
  uVar11 = (ulonglong)param_1;
  local_40 = DAT_140038010 ^ (ulonglong)auStackY_508;
  hSCManager = OpenSCManagerW((LPCWSTR)0x0,(LPCWSTR)0x0,0xf003f);
  if (hSCManager == (SC_HANDLE)0x0) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    DVar1 = GetLastError();
    FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open service manager.  (%lu)",
                  (ulonglong)DVar1,param_4);
    uVar16 = 0;
    goto LAB_14000391a;
  }
  DVar1 = GetModuleFileNameW((HMODULE)0x0,local_468,0x105);
  if (DVar1 == 0) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    uVar2 = GetLastError();
    pcVar14 = "Could not obtain module filename when attempting to install service.  (%lu)";
LAB_1400030f4:
    FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar14,(ulonglong)uVar2,param_4);
    uVar16 = 0;
  }
  else {
    pSVar6 = OpenServiceW(hSCManager,L"MozillaMaintenance",0xf01ff);
    DVar1 = GetLastError();
    if ((pSVar6 == (SC_HANDLE)0x0) && (DVar1 != 0x424)) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      uVar2 = GetLastError();
      pcVar14 = "Could not open service.  (%lu)";
      goto LAB_1400030f4;
    }
    if (pSVar6 == (SC_HANDLE)0x0) {
      if (param_1 != 0) {
        PathQuoteSpacesW(local_468);
        pwVar18 = L"Mozilla Maintenance Service";
        param_4 = 0xf01ff;
        pSVar6 = CreateServiceW(hSCManager,L"MozillaMaintenance",L"Mozilla Maintenance Service",
                                0xf01ff,0x10,3,1,local_468,(LPCWSTR)0x0,(LPDWORD)0x0,(LPCWSTR)0x0,
                                (LPCWSTR)0x0,(LPCWSTR)0x0);
        if (pSVar6 == (SC_HANDLE)0x0) {
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          uVar2 = GetLastError();
          pcVar14 = 
          "Could not create Windows service. This error should never happen since a service install should only be called when elevated.  (%lu)"
          ;
          goto LAB_1400030f4;
        }
        pcVar14 = (char *)&local_258;
        local_258 = (HLOCAL)0x0;
        uVar11 = FUN_140004ae0(pSVar6,(PACL *)pcVar14);
        if (local_258 != (HLOCAL)0x0) {
          LocalFree(local_258);
        }
        if ((int)uVar11 != 0) {
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          DVar1 = GetLastError();
          pcVar14 = 
          "Could not set security ACE on service handle, the service will not be able to be started from unelevated processes. This error should never happen.  (%lu)"
          ;
          pwVar18 = (wchar_t *)(ulonglong)DVar1;
          FUN_140008ff0((FILE **)&DAT_14003a118,
                        (longlong)
                        "Could not set security ACE on service handle, the service will not be able to be started from unelevated processes. This error should never happen.  (%lu)"
                        ,pwVar18,param_4);
        }
        FUN_140002a30(pSVar6,pcVar14,pwVar18,param_4);
        uVar16 = 1;
        goto LAB_140003908;
      }
      uVar16 = 1;
    }
    else {
      local_258 = (HLOCAL)0x0;
      uVar7 = FUN_140004ae0(pSVar6,(PACL *)&local_258);
      if (local_258 != (HLOCAL)0x0) {
        LocalFree(local_258);
      }
      if ((int)uVar7 != 0) {
        if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4) < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = 0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        DVar1 = GetLastError();
        FUN_140008ff0((FILE **)&DAT_14003a118,
                      (longlong)
                      "Could not reset security ACE on service handle. It might not be possible to start the service. This error should never happen.  (%lu)"
                      ,(ulonglong)DVar1,param_4);
      }
      pDVar19 = &local_474;
      BVar3 = QueryServiceConfigW(pSVar6,(LPQUERY_SERVICE_CONFIGW)0x0,0,pDVar19);
      if (BVar3 == 0) {
        DVar1 = GetLastError();
        if (DVar1 == 0x7a) goto LAB_1400031a4;
        if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4) < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = 0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        DVar1 = GetLastError();
        FUN_140008ff0((FILE **)&DAT_14003a118,
                      (longlong)"Could not determine buffer size for query service config.  (%lu)",
                      (ulonglong)DVar1,pDVar19);
      }
      else {
LAB_1400031a4:
        pDVar19 = &local_474;
        lpServiceConfig = (LPQUERY_SERVICE_CONFIGW)operator_new((ulonglong)local_474);
        uVar7 = (ulonglong)local_474;
        BVar3 = QueryServiceConfigW(pSVar6,lpServiceConfig,local_474,pDVar19);
        if (BVar3 != 0) {
          if (DAT_14003a338 == '\0') {
            pwVar18 = lpServiceConfig->lpBinaryPathName;
            sVar10 = wcslen(pwVar18);
            if (2 < sVar10) {
              pwVar12 = wcsstr(pwVar18,L"maintenanceservice_tmp.exe");
              if (((pwVar12 == (wchar_t *)0x0) && (*pwVar18 == L'\"')) &&
                 (pwVar18[sVar10 - 1] == L'\"')) {
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                FUN_140008ee0((FILE **)&DAT_14003a118,
                              (longlong)"The MozillaMaintenance service path is correct.",uVar7,
                              pDVar19);
                goto LAB_1400031e0;
              }
            }
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            FUN_140008ee0((FILE **)&DAT_14003a118,
                          (longlong)"The MozillaMaintenance path is NOT correct. It was: %ls",
                          pwVar18,pDVar19);
            FUN_14000ce30((undefined (*) [16])(_SERVICE_STATUS *)&local_258,0,0x20a);
            FUN_14000b198((short *)(_SERVICE_STATUS *)&local_258,(longlong)pwVar18,0x104);
            PathUnquoteSpacesW((LPWSTR)(_SERVICE_STATUS *)&local_258);
            BVar3 = PathRemoveFileSpecW((LPWSTR)(_SERVICE_STATUS *)&local_258);
            if (BVar3 == 0) {
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                pcVar14 = "Couldn\'t remove file spec.  (%lu)";
LAB_140004050:
                if (DAT_14003a328 == -1) {
                  DAT_14003a118 = 0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
              }
              else {
                pcVar14 = "Couldn\'t remove file spec.  (%lu)";
              }
            }
            else {
              BVar3 = FUN_140028000((wchar_t *)(_SERVICE_STATUS *)&local_258,
                                    L"maintenanceservice.exe");
              if (BVar3 == 0) {
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  pcVar14 = "Couldn\'t append file spec.  (%lu)";
                  goto LAB_140004050;
                }
                pcVar14 = "Couldn\'t append file spec.  (%lu)";
              }
              else {
                PathQuoteSpacesW((LPWSTR)(_SERVICE_STATUS *)&local_258);
                pDVar19 = (LPDWORD)0xffffffff;
                BVar3 = ChangeServiceConfigW
                                  (pSVar6,0xffffffff,0xffffffff,0xffffffff,
                                   (LPCWSTR)(_SERVICE_STATUS *)&local_258,(LPCWSTR)0x0,(LPDWORD)0x0,
                                   (LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0);
                iVar4 = *(int *)(*(longlong *)
                                  ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                + 4);
                if (BVar3 != 0) {
                  if (iVar4 < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  FUN_140008ee0((FILE **)&DAT_14003a118,(longlong)"Fixed service path to: %ls.",
                                (_SERVICE_STATUS *)&local_258,pDVar19);
                  DAT_14003a338 = '\x01';
                  if (*(int *)(*(longlong *)
                                ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                              4) < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  pcVar14 = "Restarting install action: %d";
                  FUN_140008ee0((FILE **)&DAT_14003a118,(longlong)"Restarting install action: %d",
                                uVar11,pDVar19);
                  uVar16 = FUN_140002fa0(param_1,pcVar14,uVar11,pDVar19);
                  goto LAB_140003900;
                }
                if (iVar4 < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  pcVar14 = "Could not fix service path.  (%lu)";
                  goto LAB_140004050;
                }
                pcVar14 = "Could not fix service path.  (%lu)";
              }
            }
            DVar1 = GetLastError();
            FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar14,(ulonglong)DVar1,pDVar19);
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            DVar1 = GetLastError();
            FUN_140008ff0((FILE **)&DAT_14003a118,
                          (longlong)"Could not fix service path. This should never happen.  (%lu)",
                          (ulonglong)DVar1,pDVar19);
LAB_14000382c:
            uVar16 = 1;
          }
          else {
LAB_1400031e0:
            PathUnquoteSpacesW(lpServiceConfig->lpBinaryPathName);
            uVar8 = FUN_140004710(lpServiceConfig->lpBinaryPathName,&local_478,&local_47c,&local_480
                                  ,&local_484);
            puVar15 = &local_488;
            puVar17 = &local_48c;
            pauVar20 = (undefined (*) [16])&local_490;
            uVar9 = FUN_140004710(local_468,puVar15,puVar17,(uint *)pauVar20,&local_494);
            if ((int)uVar9 != 0) {
              if ((((param_1 != 2) && ((int)uVar8 != 0)) && (local_488 <= local_478)) &&
                 ((local_478 != local_488 ||
                  ((local_48c <= local_47c &&
                   ((local_47c != local_48c ||
                    ((local_490 <= local_480 &&
                     ((local_480 != local_490 || (local_494 <= local_484)))))))))))) {
                MoveFileExW(local_468,(LPCWSTR)0x0,4);
                goto LAB_14000382c;
              }
              FUN_140002a30(pSVar6,puVar15,puVar17,pauVar20);
              CloseServiceHandle(pSVar6);
              pSVar6 = OpenSCManagerW((LPCWSTR)0x0,(LPCWSTR)0x0,0xf003f);
              if (pSVar6 == (SC_HANDLE)0x0) {
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                DVar1 = GetLastError();
                FUN_140008ff0((FILE **)&DAT_14003a118,
                              (longlong)"Could not open service manager.  (%lu)",(ulonglong)DVar1,
                              pauVar20);
LAB_140003a05:
                uVar16 = 0;
              }
              else {
                uVar8 = 0xf01ff;
                hService = OpenServiceW(pSVar6,L"MozillaMaintenance",0xf01ff);
                iVar4 = *(int *)(*(longlong *)
                                  ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                + 4);
                if (hService == (SC_HANDLE)0x0) {
                  if (iVar4 < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  DVar1 = GetLastError();
                  FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open service.  (%lu)",
                                (ulonglong)DVar1,pauVar20);
                  CloseServiceHandle(pSVar6);
                  goto LAB_140003a05;
                }
                if (iVar4 < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                FUN_140008ee0((FILE **)&DAT_14003a118,(longlong)"Sending stop request...",uVar8,
                              pauVar20);
                SetLastError(0);
                lpServiceStatus = (LPSERVICE_STATUS)&local_258;
                BVar3 = ControlService(hService,1,lpServiceStatus);
                if (BVar3 == 0) {
                  DVar1 = GetLastError();
                  if (DVar1 != 0x426) {
                    if (*(int *)(*(longlong *)
                                  ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                + 4) < DAT_14003a328) {
                      _Init_thread_header(&DAT_14003a328);
                      if (DAT_14003a328 == -1) {
                        DAT_14003a118 = 0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                    }
                    DVar1 = GetLastError();
                    lpServiceStatus = (LPSERVICE_STATUS)(ulonglong)DVar1;
                    FUN_140008ff0((FILE **)&DAT_14003a118,
                                  (longlong)"Error sending stop request.  (%lu)",lpServiceStatus,
                                  pauVar20);
                  }
                }
                CloseServiceHandle(pSVar6);
                CloseServiceHandle(hService);
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                FUN_140008ee0((FILE **)&DAT_14003a118,(longlong)"Waiting for service stop...",
                              lpServiceStatus,pauVar20);
                uVar2 = FUN_140009f70(L"MozillaMaintenance",0x1e);
                FUN_14000a2d0((wint_t *)L"maintenanceservice.exe",0x1e);
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                FUN_140008ee0((FILE **)&DAT_14003a118,
                              (longlong)"Done waiting for service stop, last service state: %lu",
                              (ulonglong)uVar2,pauVar20);
                uVar16 = 0;
                if (uVar2 == 1) {
                  iVar4 = wcscmp(local_468,lpServiceConfig->lpBinaryPathName);
                  if (iVar4 == 0) {
                    if (*(int *)(*(longlong *)
                                  ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                + 4) < DAT_14003a328) {
                      _Init_thread_header(&DAT_14003a328);
                      if (DAT_14003a328 == -1) {
                        DAT_14003a118 = 0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                    }
                    FUN_140008ee0((FILE **)&DAT_14003a118,
                                  (longlong)
                                  "File is already in the correct location, no action needed for upgrade.  The path is: \"%ls\""
                                  ,local_468,pauVar20);
                    uVar16 = 1;
                  }
                  else {
                    BVar3 = CopyFileW(local_468,lpServiceConfig->lpBinaryPathName,0);
                    if (BVar3 == 0) {
                      if (*(int *)(*(longlong *)
                                    ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8
                                    ) + 4) < DAT_14003a328) {
                        _Init_thread_header(&DAT_14003a328);
                        if (DAT_14003a328 == -1) {
                          DAT_14003a118 = 0;
                          atexit(FUN_140002780);
                          _Init_thread_footer(&DAT_14003a328);
                        }
                      }
                      DVar1 = GetLastError();
                      uVar11 = (ulonglong)DVar1;
                      FUN_140008ff0((FILE **)&DAT_14003a118,
                                    (longlong)
                                    "Could not overwrite old service binary file. This should never happen, but if it does the next upgrade will fix it, the service is not a critical component that needs to be installed for upgrades to work.  (%lu)"
                                    ,uVar11,pauVar20);
                      pwVar18 = lpServiceConfig->lpBinaryPathName;
                      sVar10 = wcslen(pwVar18);
                      if (sVar10 < 4) {
                        if (*(int *)(*(longlong *)
                                      ((longlong)ThreadLocalStoragePointer +
                                      (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) {
                          _Init_thread_header(&DAT_14003a328);
                          if (DAT_14003a328 == -1) {
                            DAT_14003a118 = 0;
                            atexit(FUN_140002780);
                            _Init_thread_footer(&DAT_14003a328);
                          }
                        }
                        FUN_140008ff0((FILE **)&DAT_14003a118,
                                      (longlong)
                                      "Service binary path was less than 3, service will not be updated.  This should never happen."
                                      ,uVar11,pauVar20);
                        uVar16 = 0;
                      }
                      else {
                        uVar11 = sVar10 + 1;
                        _Var13 = 0xffffffffffffffff;
                        if (!CARRY8(uVar11,uVar11)) {
                          _Var13 = uVar11 * 2;
                        }
                        lpNewFileName = (undefined (*) [16])operator_new(_Var13);
                        FUN_14000ce30(lpNewFileName,0,sVar10 * 2 + 2);
                        FUN_14000b198((short *)lpNewFileName,(longlong)pwVar18,sVar10);
                        FUN_14000b198((short *)(lpNewFileName[-1] + sVar10 * 2 + 10),
                                      (longlong)&DAT_14003128c,3);
                        BVar3 = MoveFileExW(lpServiceConfig->lpBinaryPathName,(LPCWSTR)lpNewFileName
                                            ,9);
                        if (BVar3 == 0) {
                          if (*(int *)(*(longlong *)
                                        ((longlong)ThreadLocalStoragePointer +
                                        (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) {
                            _Init_thread_header(&DAT_14003a328);
                            if (DAT_14003a328 == -1) {
                              DAT_14003a118 = 0;
                              atexit(FUN_140002780);
                              _Init_thread_footer(&DAT_14003a328);
                            }
                          }
                          GetLastError();
                          pauVar20 = lpNewFileName;
                          FUN_140008ff0((FILE **)&DAT_14003a118,
                                        (longlong)
                                        "Could not move old service file out of the way from: \"%ls\" to \"%ls\". Service will not be upgraded.  (%lu)"
                                        ,lpServiceConfig->lpBinaryPathName,lpNewFileName);
                          uVar16 = 0;
                        }
                        else {
                          uVar8 = 0;
                          BVar3 = CopyFileW(local_468,lpServiceConfig->lpBinaryPathName,0);
                          iVar4 = *(int *)(*(longlong *)
                                            ((longlong)ThreadLocalStoragePointer +
                                            (ulonglong)_tls_index * 8) + 4);
                          if (BVar3 == 0) {
                            if (iVar4 < DAT_14003a328) {
                              _Init_thread_header(&DAT_14003a328);
                              if (DAT_14003a328 == -1) {
                                DAT_14003a118 = 0;
                                atexit(FUN_140002780);
                                _Init_thread_footer(&DAT_14003a328);
                              }
                            }
                            FUN_140008ff0((FILE **)&DAT_14003a118,
                                          (longlong)
                                          "The new service binary could not be copied in. The service will not be upgraded."
                                          ,uVar8,pauVar20);
                            uVar16 = 0;
                          }
                          else {
                            if (iVar4 < DAT_14003a328) {
                              _Init_thread_header(&DAT_14003a328);
                              if (DAT_14003a328 == -1) {
                                DAT_14003a118 = 0;
                                atexit(FUN_140002780);
                                _Init_thread_footer(&DAT_14003a328);
                              }
                            }
                            FUN_140008ee0((FILE **)&DAT_14003a118,
                                          (longlong)
                                          "The new service binary was copied in by first moving the old one out of the way."
                                          ,uVar8,pauVar20);
                            uVar16 = 1;
                          }
                          BVar3 = DeleteFileW((LPCWSTR)lpNewFileName);
                          iVar4 = *(int *)(*(longlong *)
                                            ((longlong)ThreadLocalStoragePointer +
                                            (ulonglong)_tls_index * 8) + 4);
                          if (BVar3 == 0) {
                            if (iVar4 < DAT_14003a328) {
                              _Init_thread_header(&DAT_14003a328);
                              if (DAT_14003a328 == -1) {
                                DAT_14003a118 = 0;
                                atexit(FUN_140002780);
                                _Init_thread_footer(&DAT_14003a328);
                              }
                            }
                            FUN_140008ff0((FILE **)&DAT_14003a118,
                                          (longlong)"The old temp service path was not deleted.",
                                          uVar8,pauVar20);
                          }
                          else {
                            if (iVar4 < DAT_14003a328) {
                              _Init_thread_header(&DAT_14003a328);
                              if (DAT_14003a328 == -1) {
                                DAT_14003a118 = 0;
                                atexit(FUN_140002780);
                                _Init_thread_footer(&DAT_14003a328);
                              }
                            }
                            FUN_140008ee0((FILE **)&DAT_14003a118,
                                          (longlong)"The old temp service path was deleted: %ls.",
                                          lpNewFileName,pauVar20);
                          }
                        }
                        thunk_FUN_140013ed8(lpNewFileName);
                      }
                    }
                    else {
                      FUN_14000ce30((undefined (*) [16])(_SERVICE_STATUS *)&local_258,0,0x100);
                      FUN_140027f10((undefined2 *)(_SERVICE_STATUS *)&local_258,0x80,
                                    (longlong)L"%d.%d.%d.%d",(ulonglong)local_488);
                      uVar8 = 0;
                      pauVar20 = (undefined (*) [16])0x20206;
                      LVar5 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                                            L"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\MozillaMaintenanceService"
                                            ,0,0x20206,&local_470);
                      if (LVar5 == 0) {
                        sVar10 = wcslen((wchar_t *)(_SERVICE_STATUS *)&local_258);
                        uVar8 = 0;
                        pauVar20 = (undefined (*) [16])0x1;
                        LVar5 = RegSetValueExW(local_470,L"DisplayVersion",0,1,
                                               (BYTE *)(_SERVICE_STATUS *)&local_258,
                                               (int)sVar10 * 2 + 2);
                        RegCloseKey(local_470);
                        if (LVar5 != 0) goto LAB_140003dfc;
                      }
                      else {
LAB_140003dfc:
                        if (*(int *)(*(longlong *)
                                      ((longlong)ThreadLocalStoragePointer +
                                      (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) {
                          _Init_thread_header(&DAT_14003a328);
                          if (DAT_14003a328 == -1) {
                            DAT_14003a118 = 0;
                            atexit(FUN_140002780);
                            _Init_thread_footer(&DAT_14003a328);
                          }
                        }
                        FUN_140008ee0((FILE **)&DAT_14003a118,
                                      (longlong)
                                      "The uninstaller version string could not be updated.",uVar8,
                                      pauVar20);
                      }
                      if (*(int *)(*(longlong *)
                                    ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8
                                    ) + 4) < DAT_14003a328) {
                        _Init_thread_header(&DAT_14003a328);
                        if (DAT_14003a328 == -1) {
                          DAT_14003a118 = 0;
                          atexit(FUN_140002780);
                          _Init_thread_footer(&DAT_14003a328);
                        }
                      }
                      FUN_140008ee0((FILE **)&DAT_14003a118,
                                    (longlong)"The new service binary was copied in.",uVar8,pauVar20
                                   );
                      uVar16 = 1;
                    }
                    BVar3 = MoveFileExW(local_468,(LPCWSTR)0x0,4);
                    iVar4 = *(int *)(*(longlong *)
                                      ((longlong)ThreadLocalStoragePointer +
                                      (ulonglong)_tls_index * 8) + 4);
                    if (BVar3 == 0) {
                      if (iVar4 < DAT_14003a328) {
                        _Init_thread_header(&DAT_14003a328);
                        if (DAT_14003a328 == -1) {
                          DAT_14003a118 = 0;
                          atexit(FUN_140002780);
                          _Init_thread_footer(&DAT_14003a328);
                        }
                      }
                      FUN_140008ff0((FILE **)&DAT_14003a118,
                                    (longlong)"Call to delete the old file path failed: %ls.",
                                    local_468,pauVar20);
                    }
                    else {
                      if (iVar4 < DAT_14003a328) {
                        _Init_thread_header(&DAT_14003a328);
                        if (DAT_14003a328 == -1) {
                          DAT_14003a118 = 0;
                          atexit(FUN_140002780);
                          _Init_thread_footer(&DAT_14003a328);
                        }
                      }
                      FUN_140008ee0((FILE **)&DAT_14003a118,
                                    (longlong)"Deleting the old file path on the next reboot: %ls.",
                                    local_468,pauVar20);
                    }
                  }
                }
              }
              thunk_FUN_140013ed8(lpServiceConfig);
              goto LAB_140003911;
            }
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            FUN_140008ff0((FILE **)&DAT_14003a118,
                          (longlong)"Could not obtain version number from new path",puVar17,pauVar20
                         );
            uVar16 = 0;
          }
LAB_140003900:
          thunk_FUN_140013ed8(lpServiceConfig);
          goto LAB_140003908;
        }
        if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4) < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = 0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        DVar1 = GetLastError();
        FUN_140008ff0((FILE **)&DAT_14003a118,
                      (longlong)"Could open service but could not query service config.  (%lu)",
                      (ulonglong)DVar1,pDVar19);
        thunk_FUN_140013ed8(lpServiceConfig);
      }
      uVar16 = 0;
LAB_140003908:
      CloseServiceHandle(pSVar6);
    }
  }
LAB_140003911:
  CloseServiceHandle(hSCManager);
LAB_14000391a:
  __security_check_cookie(local_40 ^ (ulonglong)auStackY_508);
  return uVar16;
}



undefined8 FUN_140004710(LPCWSTR param_1,uint *param_2,uint *param_3,uint *param_4,uint *param_5)

{
  DWORD dwLen;
  BOOL BVar1;
  uint uVar2;
  PUINT lpData;
  char *pcVar3;
  undefined8 uVar4;
  PUINT puLen;
  undefined auStack_68 [36];
  uint local_44;
  PUINT local_40;
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStack_68;
  dwLen = GetFileVersionInfoSizeW(param_1,(LPDWORD)0x0);
  lpData = (PUINT)operator_new((ulonglong)dwLen);
  puLen = lpData;
  BVar1 = GetFileVersionInfoW(param_1,0,dwLen,lpData);
  if (BVar1 == 0) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    uVar2 = GetLastError();
    pcVar3 = "Could not obtain file info of old service.  (%lu)";
  }
  else {
    puLen = &local_44;
    local_40 = lpData;
    BVar1 = VerQueryValueW(lpData,L"\\",&local_40,puLen);
    if (BVar1 != 0) {
      *param_2 = (uint)*(ushort *)((longlong)local_40 + 10);
      *param_3 = (uint)*(ushort *)(local_40 + 2);
      *param_4 = (uint)*(ushort *)((longlong)local_40 + 0xe);
      *param_5 = (uint)*(ushort *)(local_40 + 3);
      uVar4 = 1;
      goto LAB_140004826;
    }
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    uVar2 = GetLastError();
    pcVar3 = "Could not query file version info of old service.  (%lu)";
  }
  FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar3,(ulonglong)uVar2,puLen);
  uVar4 = 0;
LAB_140004826:
  thunk_FUN_140013ed8(lpData);
  __security_check_cookie(local_38 ^ (ulonglong)auStack_68);
  return uVar4;
}



uint FUN_1400048d0(void)

{
  BOOL BVar1;
  DWORD DVar2;
  SC_HANDLE hSCManager;
  SC_HANDLE hService;
  uint uVar3;
  undefined8 in_R9;
  undefined auStack_78 [32];
  _SERVICE_STATUS local_58;
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStack_78;
  hSCManager = OpenSCManagerW((LPCWSTR)0x0,(LPCWSTR)0x0,0xf003f);
  if (hSCManager == (SC_HANDLE)0x0) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    DVar2 = GetLastError();
    FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open service manager.  (%lu)",
                  (ulonglong)DVar2,in_R9);
    uVar3 = 0;
  }
  else {
    hService = OpenServiceW(hSCManager,L"MozillaMaintenance",0xf01ff);
    if (hService == (SC_HANDLE)0x0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      DVar2 = GetLastError();
      FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open service.  (%lu)",
                    (ulonglong)DVar2,in_R9);
      uVar3 = 0;
    }
    else {
      BVar1 = ControlService(hService,1,&local_58);
      if (BVar1 != 0) {
        uVar3 = 0;
        do {
          Sleep(local_58.dwWaitHint);
          if ((local_58.dwCurrentState == 1) ||
             (uVar3 = uVar3 + local_58.dwWaitHint + 10, 60000 < uVar3)) break;
          BVar1 = QueryServiceStatus(hService,&local_58);
        } while (BVar1 != 0);
      }
      uVar3 = DeleteService(hService);
      if (uVar3 == 0) {
        DVar2 = GetLastError();
        uVar3 = (uint)(DVar2 == 0x430);
      }
      CloseServiceHandle(hService);
    }
    CloseServiceHandle(hSCManager);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack_78);
  return uVar3;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_140004ae0(SC_HANDLE param_1,PACL *param_2)

{
  int iVar1;
  BOOL BVar2;
  uint uVar3;
  DWORD DVar4;
  HLOCAL pSid;
  HLOCAL pSid_00;
  char *pcVar5;
  ulonglong uVar6;
  code *pcVar7;
  undefined *lpSecurityDescriptor;
  LPBOOL lpbDaclDefaulted;
  DWORD *cbSid;
  PACL *cbSid_00;
  undefined auStackY_118 [32];
  undefined local_e8 [44];
  undefined8 local_bc;
  BOOL local_b4;
  PACL local_b0;
  uint local_a4;
  HLOCAL local_a0;
  undefined local_98 [16];
  undefined local_88 [16];
  undefined local_78 [16];
  undefined local_68 [16];
  undefined local_58 [16];
  undefined local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStackY_118;
  local_a0 = (HLOCAL)0x0;
  local_a4 = 0;
  lpbDaclDefaulted = (LPBOOL)0x0;
  BVar2 = QueryServiceObjectSecurity(param_1,4,&local_a0,0,&local_a4);
  if (BVar2 == 0) {
    DVar4 = GetLastError();
    uVar3 = local_a4;
    if (DVar4 == 0x7a) {
      local_a0 = LocalAlloc(0x40,(ulonglong)local_a4);
      if (local_a0 == (HLOCAL)0x0) {
        if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4) < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = 0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        DVar4 = GetLastError();
        FUN_140008ff0((FILE **)&DAT_14003a118,
                      (longlong)"Could not allocate security descriptor.  (%lu)",(ulonglong)DVar4,
                      lpbDaclDefaulted);
        uVar6 = 0x7a;
        goto LAB_140004f10;
      }
      lpbDaclDefaulted = (LPBOOL)(ulonglong)uVar3;
      BVar2 = QueryServiceObjectSecurity(param_1,4,local_a0,uVar3,&local_a4);
      if (BVar2 != 0) goto LAB_140004b3b;
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = GetLastError_exref;
      uVar3 = GetLastError();
      pcVar5 = "Could not allocate security descriptor.  (%lu)";
    }
    else {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = GetLastError_exref;
      uVar3 = GetLastError();
      pcVar5 = "Could not query service object security size.  (%lu)";
    }
  }
  else {
LAB_140004b3b:
    local_b0 = (PACL)0x0;
    local_b4 = 0;
    lpbDaclDefaulted = (LPBOOL)((longlong)&local_bc + 4);
    local_bc._4_4_ = 0;
    BVar2 = GetSecurityDescriptorDacl(local_a0,&local_b4,&local_b0,lpbDaclDefaulted);
    if (BVar2 == 0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = GetLastError_exref;
      uVar3 = GetLastError();
      pcVar5 = "Could not obtain DACL.  (%lu)";
    }
    else {
      local_bc._0_4_ = 0x44;
      pSid = LocalAlloc(0,0x44);
      if (pSid != (HLOCAL)0x0) {
        cbSid = (DWORD *)&local_bc;
        BVar2 = CreateWellKnownSid(WinBuiltinUsersSid,(PSID)0x0,pSid,cbSid);
        if (BVar2 == 0) {
          DVar4 = GetLastError();
          uVar6 = (ulonglong)DVar4;
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not create BI\\Users SID.  (%lu)",
                        (ulonglong)DVar4,cbSid);
        }
        else {
          local_bc._0_4_ = 0x44;
          pSid_00 = LocalAlloc(0,0x44);
          if (pSid_00 == (HLOCAL)0x0) {
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            DVar4 = GetLastError();
            FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not allocate SID memory.  (%lu)",
                          (ulonglong)DVar4,cbSid);
            DVar4 = GetLastError();
            uVar6 = (ulonglong)DVar4;
          }
          else {
            cbSid_00 = (PACL *)&local_bc;
            BVar2 = CreateWellKnownSid(WinInteractiveSid,(PSID)0x0,pSid_00,(DWORD *)cbSid_00);
            if (BVar2 == 0) {
              uVar3 = GetLastError();
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                if (DAT_14003a328 == -1) {
                  DAT_14003a118 = 0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
              }
              pcVar5 = "Could not create Interactive SID.  (%lu)";
LAB_140004ef6:
              uVar6 = (ulonglong)uVar3;
              FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar5,uVar6,cbSid_00);
            }
            else {
              local_58 = ZEXT816(0);
              local_88 = ZEXT816(0);
              local_98 = ZEXT816(0x400000000);
              local_78 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),2);
              local_78 = CONCAT88(pSid,local_78._0_8_);
              local_68 = ZEXT816(0x280000030);
              local_48 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),2);
              local_48 = CONCAT88(pSid_00,local_48._0_8_);
              cbSid_00 = param_2;
              uVar3 = SetEntriesInAclW(2,(PEXPLICIT_ACCESS_W)local_98,local_b0,param_2);
              if (uVar3 != 0) {
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                pcVar5 = "Could not set entries in ACL.  (%lu)";
                goto LAB_140004ef6;
              }
              BVar2 = InitializeSecurityDescriptor(local_e8,1);
              if (BVar2 == 0) {
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                pcVar7 = GetLastError_exref;
                uVar3 = GetLastError();
                pcVar5 = "Could not initialize security descriptor.  (%lu)";
LAB_14000505c:
                FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar5,(ulonglong)uVar3,cbSid_00);
                uVar3 = (*pcVar7)();
                uVar6 = (ulonglong)uVar3;
              }
              else {
                cbSid_00 = (PACL *)0x0;
                BVar2 = SetSecurityDescriptorDacl(local_e8,1,*param_2,0);
                if (BVar2 == 0) {
                  if (*(int *)(*(longlong *)
                                ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                              4) < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  pcVar7 = GetLastError_exref;
                  uVar3 = GetLastError();
                  pcVar5 = "Could not set security descriptor DACL.  (%lu)";
                  goto LAB_14000505c;
                }
                lpSecurityDescriptor = local_e8;
                BVar2 = SetServiceObjectSecurity(param_1,4,lpSecurityDescriptor);
                iVar1 = *(int *)(*(longlong *)
                                  ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                + 4);
                if (BVar2 == 0) {
                  if (iVar1 < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  pcVar7 = GetLastError_exref;
                  uVar3 = GetLastError();
                  pcVar5 = "Could not set object security.  (%lu)";
                  goto LAB_14000505c;
                }
                if (iVar1 < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                FUN_140008ee0((FILE **)&DAT_14003a118,
                              (longlong)"User access was set successfully on the service.",
                              lpSecurityDescriptor,cbSid_00);
                uVar6 = 0;
              }
            }
            FreeSid(pSid_00);
          }
        }
        FreeSid(pSid);
        goto LAB_140004f10;
      }
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar7 = GetLastError_exref;
      uVar3 = GetLastError();
      pcVar5 = "Could not allocate SID memory.  (%lu)";
    }
  }
  FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar5,(ulonglong)uVar3,lpbDaclDefaulted);
  uVar3 = (*pcVar7)();
  uVar6 = (ulonglong)uVar3;
LAB_140004f10:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY_118);
  return uVar6;
}



BOOL FUN_1400053c0(int param_1,longlong param_2,wchar_t *param_3)

{
  WCHAR WVar1;
  int iVar2;
  BOOL BVar3;
  wchar_t *pwVar4;
  longlong lVar5;
  WCHAR *pWVar6;
  bool bVar7;
  
  if (param_1 == 4) {
    iVar2 = wcscmp(*(wchar_t **)(param_2 + 0x18),L"-1");
    if (iVar2 == 0) {
      bVar7 = true;
    }
    else {
LAB_1400053f2:
      pwVar4 = wcsstr(*(wchar_t **)(param_2 + 0x18),L"/replace");
      bVar7 = true;
      if (pwVar4 == (wchar_t *)0x0) {
        pWVar6 = *(WCHAR **)(param_2 + 0x18);
        do {
          WVar1 = *pWVar6;
          bVar7 = WVar1 == L'\0';
          if (bVar7) break;
          pWVar6 = pWVar6 + 1;
          iVar2 = FUN_1400148ec(WVar1);
        } while (iVar2 != 0);
      }
    }
  }
  else {
    if (3 < param_1) goto LAB_1400053f2;
    bVar7 = false;
  }
  FUN_14000b198(param_3,*(longlong *)(param_2 + 0x10),0x104);
  pwVar4 = wcsrchr(param_3,L'\\');
  if ((pwVar4 != (wchar_t *)0x0) && (pwVar4[1] == L'\0')) {
    *pwVar4 = L'\0';
  }
  if (!bVar7) {
    return 1;
  }
  if (param_1 == 4) {
    lVar5 = 3;
  }
  else {
    if (param_1 != 5) {
      if (param_1 < 4) {
        return 1;
      }
      bVar7 = false;
      goto LAB_140005494;
    }
    lVar5 = 4;
  }
  iVar2 = wcscmp(*(wchar_t **)(param_2 + lVar5 * 8),L"-1");
  bVar7 = iVar2 == 0;
LAB_140005494:
  pwVar4 = wcsstr(*(wchar_t **)(param_2 + 0x18),L"/replace");
  if ((!bVar7) && (pwVar4 == (wchar_t *)0x0)) {
    return 1;
  }
                    // WARNING: Could not recover jumptable at 0x0001400054cb. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar3 = PathRemoveFileSpecW(param_3);
  return BVar3;
}



ulonglong FUN_1400054e0(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  int iVar5;
  undefined7 extraout_var;
  HANDLE hObject;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined8 uVar6;
  HMODULE hInstance;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  char *pcVar7;
  ulonglong uVar8;
  wchar_t *pwVar9;
  int *piVar10;
  LPSTR lpBuffer;
  WCHAR *pWVar11;
  undefined auStackY_2c8 [32];
  int local_290;
  uint local_28c;
  CHAR local_288 [64];
  WCHAR local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStackY_2c8;
  local_28c = 0;
  bVar1 = FUN_14000a450(param_1,&local_28c);
  if (((int)CONCAT71(extraout_var,bVar1) == 0) || (local_28c == 0)) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    DVar2 = GetLastError();
    uVar8 = (ulonglong)DVar2;
    FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Filesystem in path %ls is not supported (%lu)",
                  param_1,uVar8);
    bVar1 = FUN_14000a180(param_3,0x1f);
    if ((int)CONCAT71(extraout_var_01,bVar1) == 0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      DVar2 = GetLastError();
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)"Could not write update.status service update failure.  (%lu)",
                    (ulonglong)DVar2,uVar8);
    }
    uVar8 = 0;
    goto LAB_1400056b3;
  }
  pWVar11 = (WCHAR *)0x0;
  hObject = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  if (hObject == (HANDLE)0xffffffffffffffff) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    DVar2 = GetLastError();
    FUN_140008ff0((FILE **)&DAT_14003a118,
                  (longlong)"Could not set no write sharing access on file.  (%lu)",(ulonglong)DVar2
                  ,pWVar11);
    bVar1 = FUN_14000a180(param_3,0x20);
    if ((int)CONCAT71(extraout_var_00,bVar1) == 0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      DVar2 = GetLastError();
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)"Could not write update.status service update failure.  (%lu)",
                    (ulonglong)DVar2,pWVar11);
    }
    goto LAB_1400055fd;
  }
  FUN_14000ce30((undefined (*) [16])local_248,0,0x20a);
  pwVar9 = (wchar_t *)0x104;
  FUN_14000b198((short *)(undefined (*) [16])local_248,(longlong)param_2,0x104);
  BVar3 = FUN_140028000((wchar_t *)(undefined (*) [16])local_248,L"updater.exe");
  if (BVar3 == 0) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    pcVar7 = "Install directory updater could not be determined.";
LAB_140005883:
    FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar7,pwVar9,pWVar11);
LAB_1400055fd:
    uVar8 = 0;
  }
  else {
    piVar10 = &local_290;
    uVar6 = FUN_1400027b0(param_1,local_248,piVar10);
    if ((int)uVar6 == 0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)
                    "Error checking if the updaters are the same.\nPath 1: %ls\nPath 2: %ls",param_1
                    ,local_248);
      goto LAB_1400055fd;
    }
    iVar4 = *(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4);
    if (local_290 == 0) {
      if (iVar4 < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pWVar11 = local_248;
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)
                    "The updaters do not match, updater will not run.\nPath 1: %ls\nPath 2: %ls",
                    param_1,pWVar11);
      bVar1 = FUN_14000a180(param_3,0x1b);
      if ((int)CONCAT71(extraout_var_02,bVar1) == 0) {
        pwVar9 = param_1;
        if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4) < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          pwVar9 = param_1;
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = 0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
            pwVar9 = param_1;
          }
        }
        pcVar7 = "Could not write update.status updater compare failure.";
        goto LAB_140005883;
      }
      goto LAB_1400055fd;
    }
    if (iVar4 < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    FUN_140008ee0((FILE **)&DAT_14003a118,
                  (longlong)
                  "updater.exe was compared successfully to the installation directory updater.exe."
                  ,piVar10,pWVar11);
    hInstance = LoadLibraryExW(param_1,(HANDLE)0x0,2);
    if (hInstance == (HMODULE)0x0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      DVar2 = GetLastError();
      pwVar9 = (wchar_t *)(ulonglong)DVar2;
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)"updater.exe module could not be loaded. (%lu)",pwVar9,pWVar11);
LAB_140005989:
      bVar1 = FUN_14000a180(param_3,0x1c);
      if ((int)CONCAT71(extraout_var_03,bVar1) == 0) {
        if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                    + 4) < DAT_14003a328) {
          _Init_thread_header(&DAT_14003a328);
          if (DAT_14003a328 == -1) {
            DAT_14003a118 = 0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
        }
        pcVar7 = "Could not write update.status no updater identity.";
        goto LAB_140005883;
      }
      goto LAB_1400055fd;
    }
    lpBuffer = local_288;
    pWVar11 = (WCHAR *)0x40;
    iVar4 = LoadStringA(hInstance,0x3ee,lpBuffer,0x40);
    if (iVar4 == 0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)
                    "The updater.exe application does not contain the Mozilla updater identity.",
                    lpBuffer,pWVar11);
    }
    pwVar9 = (wchar_t *)0x35;
    iVar5 = memcmp(local_288,"moz-updater.exe-4cdccec4-5ee0-4a06-9817-4cd899a9db49",0x35);
    if (iVar5 != 0) {
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)"The updater.exe identity string is not valid.",pwVar9,pWVar11);
      FreeLibrary(hInstance);
      goto LAB_140005989;
    }
    FreeLibrary(hInstance);
    if (iVar4 == 0) goto LAB_140005989;
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    FUN_140008ee0((FILE **)&DAT_14003a118,
                  (longlong)"The updater.exe application contains the Mozilla updater identity.",
                  pwVar9,pWVar11);
    uVar6 = FUN_140008420(param_2,param_1,1);
    uVar8 = (ulonglong)param_2 & 0xffffffffffffff00 | (ulonglong)((int)uVar6 != 0);
  }
  if (1 < (longlong)hObject + 1U) {
    CloseHandle(hObject);
  }
LAB_1400056b3:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY_2c8);
  return uVar8 & 0xffffffff;
}



void FUN_140005dd0(wchar_t *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined auStack_248 [32];
  WCHAR local_228 [264];
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStack_248;
  if (*param_1 != L'\0') {
    BVar1 = DeleteFileW(param_1);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 != 3) {
        DVar2 = GetLastError();
        if (DVar2 != 2) {
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          FUN_140008ff0((FILE **)&DAT_14003a118,
                        (longlong)"Could not delete service updater path: \'%ls\'.",param_1,param_4)
          ;
        }
      }
    }
    FUN_14000ce30((undefined (*) [16])local_228,0,0x20a);
    BVar1 = FUN_140009720((wchar_t *)(undefined (*) [16])local_228,param_1,L"updater.ini");
    if (BVar1 != 0) {
      BVar1 = DeleteFileW(local_228);
      if (BVar1 == 0) {
        DVar2 = GetLastError();
        if (DVar2 != 3) {
          DVar2 = GetLastError();
          if (DVar2 != 2) {
            if (*(int *)(*(longlong *)
                          ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                DAT_14003a328) {
              _Init_thread_header(&DAT_14003a328);
              if (DAT_14003a328 == -1) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
            }
            FUN_140008ff0((FILE **)&DAT_14003a118,
                          (longlong)"Could not delete service updater INI path: \'%ls\'.",local_228,
                          param_4);
          }
        }
      }
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack_248);
  return;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe
// WARNING: Could not reconcile some variable overlaps

int FUN_140005f80(uint param_1,longlong param_2,undefined (*param_3) [16],undefined (*param_4) [16])

{
  wchar_t **ppwVar1;
  undefined (**ppauVar2) [16];
  WCHAR WVar3;
  bool bVar4;
  undefined (*pauVar5) [16];
  bool bVar6;
  bool bVar7;
  int iVar8;
  uint uVar9;
  BOOL BVar10;
  LSTATUS LVar11;
  uint uVar12;
  DWORD DVar13;
  BOOL BVar14;
  undefined8 uVar15;
  size_t sVar16;
  undefined7 extraout_var;
  ulonglong uVar17;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  HANDLE pvVar18;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  longlong lVar19;
  undefined7 extraout_var_08;
  char *pcVar20;
  wchar_t *pwVar21;
  WCHAR *pWVar22;
  undefined (*pauVar23) [16];
  wchar_t *pwVar24;
  bool bVar25;
  undefined auStackY_11f0 [32];
  undefined (*local_1188) [16];
  undefined local_1180 [16];
  undefined8 local_1170;
  undefined local_1160 [16];
  undefined local_1150 [16];
  undefined local_1140 [16];
  undefined local_1130 [16];
  undefined local_1120 [16];
  undefined local_1110 [16];
  HANDLE local_1100;
  undefined local_10f4 [4];
  WCHAR local_10f0 [264];
  wchar_t local_ee0 [264];
  WCHAR local_cd0 [264];
  wchar_t local_ac0 [264];
  wchar_t local_8b0 [264];
  undefined local_6a0 [528];
  HKEY local_490 [66];
  undefined local_280 [16];
  undefined local_270 [16];
  uint local_260 [132];
  ulonglong local_50;
  undefined8 uStack_48;
  
  uStack_48 = 0x140005f96;
  local_50 = DAT_140038010 ^ (ulonglong)auStackY_11f0;
  if ((int)param_1 < 3) {
    if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                 ) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    pcVar20 = "Not enough command line arguments to execute a service command";
    goto LAB_1400061b9;
  }
  FUN_14000ce30((undefined (*) [16])local_6a0,0,0x20a);
  uVar15 = FUN_140028050((short *)(undefined (*) [16])local_6a0);
  iVar8 = *(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4);
  if ((int)uVar15 == 0) {
    if ((iVar8 < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    param_3 = *(undefined (**) [16])(param_2 + 0x10);
    FUN_140008ee0(&DAT_14003a118,(longlong)"Executing service command %ls",param_3,param_4);
  }
  else {
    if ((iVar8 < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    param_3 = *(undefined (**) [16])(param_2 + 0x10);
    param_4 = (undefined (*) [16])local_6a0;
    FUN_140008ee0(&DAT_14003a118,(longlong)"Executing service command %ls, ID: %ls",param_3,param_4)
    ;
  }
  iVar8 = lstrcmpiW(*(LPCWSTR *)(param_2 + 0x10),L"software-update");
  if (iVar8 != 0) {
    if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                 ) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    FUN_140008ff0(&DAT_14003a118,(longlong)"Service command not recognized: %ls.",
                  *(undefined8 *)(param_2 + 0x10),param_4);
    iVar8 = 0;
LAB_1400060d0:
    if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                 ) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    pwVar24 = L"Success";
    if (iVar8 == 0) {
      pwVar24 = L"Failure";
    }
    FUN_140008ee0(&DAT_14003a118,(longlong)"service command %ls complete with result: %ls.",
                  *(undefined8 *)(param_2 + 8),pwVar24);
    goto LAB_1400061c0;
  }
  if ((param_1 < 5) || (uVar9 = FUN_140009410(*(wchar_t **)(param_2 + 0x20)), (char)uVar9 == '\0'))
  {
    if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                 ) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
      DAT_14003a118 = (FILE *)0x0;
      atexit(FUN_140002780);
      _Init_thread_footer(&DAT_14003a328);
    }
    pcVar20 = "The patch directory path is not valid for this application.";
LAB_1400061b9:
    FUN_140008ff0(&DAT_14003a118,(longlong)pcVar20,param_3,param_4);
  }
  else {
    ppwVar1 = (wchar_t **)(param_2 + 0x20);
    pwVar24 = *ppwVar1;
    sVar16 = wcslen(pwVar24);
    if (sVar16 < 10) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      pcVar20 = "The patch directory path length is not valid for this application.";
      goto LAB_1400061b9;
    }
    pwVar21 = L"\\updates\\0";
    param_3 = (undefined (*) [16])0xa;
    iVar8 = FUN_140013348((wint_t *)(pwVar24 + (sVar16 - 10)),(wint_t *)L"\\updates\\0",10);
    if (iVar8 != 0) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      pcVar20 = "The patch directory path subdirectory is not valid for this application.";
      goto LAB_1400061b9;
    }
    FUN_140009ae0(*ppwVar1);
    bVar6 = FUN_1400099d0(*ppwVar1,pwVar21,param_3,param_4);
    if ((int)CONCAT71(extraout_var,bVar6) == 0) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      pcVar20 = "Unable to write to secure ID file.";
      goto LAB_1400061b9;
    }
    if (((param_1 < 6) ||
        (uVar9 = FUN_140009410(*(wchar_t **)(param_2 + 0x28)), (char)uVar9 == '\0')) ||
       (uVar17 = FUN_1400090a0(*(LPCWSTR *)(param_2 + 0x28)), (char)uVar17 == '\0')) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      FUN_140008ff0(&DAT_14003a118,
                    (longlong)"The install directory path is not valid for this application.",
                    param_3,param_4);
      pwVar24 = *ppwVar1;
      uVar9 = 0x37;
LAB_1400062de:
      bVar6 = FUN_14000a180(pwVar24,uVar9);
      iVar8 = 0;
      if ((int)CONCAT71(extraout_var_00,bVar6) == 0) {
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ff0(&DAT_14003a118,(longlong)"Could not write update.status for previous failure."
                      ,param_3,param_4);
      }
      goto LAB_1400061c0;
    }
    uVar9 = param_1 - 3;
    if (uVar9 != 4) {
      if (3 < uVar9) goto LAB_140006368;
LAB_14000657a:
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      FUN_140008ff0(&DAT_14003a118,
                    (longlong)"The working directory path is not valid for this application.",
                    param_3,param_4);
      pwVar24 = *ppwVar1;
      uVar9 = 0x38;
      goto LAB_1400062de;
    }
    iVar8 = wcscmp(*(wchar_t **)(param_2 + 0x30),L"-1");
    if (iVar8 == 0) {
LAB_140006381:
      ppauVar2 = (undefined (**) [16])(param_2 + 0x18);
      param_3 = (undefined (*) [16])local_8b0;
      FUN_14000ce30(param_3,0,0x20a);
      BVar10 = FUN_1400053c0(uVar9,(longlong)ppauVar2,(wchar_t *)param_3);
      if (BVar10 == 0) {
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ff0(&DAT_14003a118,(longlong)"Could not get the installation directory",param_3,
                      param_4);
        pwVar24 = *ppwVar1;
        uVar9 = 0x21;
      }
      else {
        bVar6 = FUN_14000a3e0();
        if ((int)CONCAT71(extraout_var_01,bVar6) != 0) {
LAB_14000661c:
          FUN_14000ce30((undefined (*) [16])local_ac0,0,0x20a);
          uVar15 = 0x104;
          FUN_14000b198((short *)(undefined (*) [16])local_ac0,(longlong)local_8b0,0x104);
          BVar10 = FUN_140028000((wchar_t *)(undefined (*) [16])local_ac0,L"updater.exe");
          if (BVar10 == 0) {
            if ((*(int *)(*(longlong *)
                           ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                 DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
              DAT_14003a118 = (FILE *)0x0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
            FUN_140008ff0(&DAT_14003a118,
                          (longlong)"Install directory updater could not be determined.",uVar15,
                          param_4);
          }
          uVar17 = FUN_1400054e0(local_ac0,local_8b0,*ppwVar1);
          FUN_14000ce30((undefined (*) [16])local_cd0,0,0x20a);
          if ((char)uVar17 == '\0') {
LAB_14000682d:
            if ((*(int *)(*(longlong *)
                           ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                 DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
              DAT_14003a118 = (FILE *)0x0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
            DVar13 = GetLastError();
            uVar17 = (ulonglong)DVar13;
            FUN_140008ff0(&DAT_14003a118,(longlong)"Could not copy path to secure location.  (%lu)",
                          uVar17,param_4);
            bVar6 = FUN_14000a180(*ppwVar1,0x31);
            iVar8 = 0;
            if ((int)CONCAT71(extraout_var_03,bVar6) == 0) {
              if ((*(int *)(*(longlong *)
                             ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                   < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                DAT_14003a118 = (FILE *)0x0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
              FUN_140008ff0(&DAT_14003a118,
                            (longlong)"Could not write update.status could not copy updater error",
                            uVar17,param_4);
            }
          }
          else {
            DVar13 = GetModuleFileNameW((HMODULE)0x0,local_cd0,0x104);
            if (DVar13 == 0) {
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                pcVar20 = 
                "Could not obtain module filename when attempting to use a secure updater path.  (%lu)"
                ;
LAB_1400079a1:
                if (DAT_14003a328 == -1) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
              }
              else {
                pcVar20 = 
                "Could not obtain module filename when attempting to use a secure updater path.  (%lu)"
                ;
              }
LAB_140006815:
              DVar13 = GetLastError();
              FUN_140008ff0(&DAT_14003a118,(longlong)pcVar20,(ulonglong)DVar13,param_4);
              goto LAB_14000682d;
            }
            BVar10 = PathRemoveFileSpecW(local_cd0);
            if (BVar10 == 0) {
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                pcVar20 = 
                "Couldn\'t remove file spec when attempting to use a secure updater path.  (%lu)";
                goto LAB_1400079a1;
              }
              pcVar20 = 
              "Couldn\'t remove file spec when attempting to use a secure updater path.  (%lu)";
              goto LAB_140006815;
            }
            BVar10 = FUN_140028000(local_cd0,L"update");
            if (BVar10 == 0) {
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
LAB_140006e40:
                _Init_thread_header(&DAT_14003a328);
                pcVar20 = 
                "Couldn\'t append file spec when attempting to use a secure updater path.  (%lu)";
                goto LAB_1400079a1;
              }
LAB_14000698b:
              pcVar20 = 
              "Couldn\'t append file spec when attempting to use a secure updater path.  (%lu)";
              goto LAB_140006815;
            }
            CreateDirectoryW((LPCWSTR)(undefined (*) [16])local_cd0,(LPSECURITY_ATTRIBUTES)0x0);
            BVar10 = FUN_140028000((wchar_t *)(undefined (*) [16])local_cd0,L"updater.exe");
            iVar8 = *(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
            ;
            if (BVar10 == 0) {
              if (iVar8 < DAT_14003a328) goto LAB_140006e40;
              goto LAB_14000698b;
            }
            if ((iVar8 < DAT_14003a328) &&
               (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
              DAT_14003a118 = (FILE *)0x0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
            pauVar23 = *ppauVar2;
            pcVar20 = 
            "Passed in path: \'%ls\' (ignored); Install dir has: \'%ls\'; Using this path for updating: \'%ls\'."
            ;
            param_4 = (undefined (*) [16])local_ac0;
            FUN_140008ee0(&DAT_14003a118,
                          (longlong)
                          "Passed in path: \'%ls\' (ignored); Install dir has: \'%ls\'; Using this path for updating: \'%ls\'."
                          ,pauVar23,(undefined (*) [16])local_ac0);
            FUN_140005dd0((wchar_t *)(undefined (*) [16])local_cd0,pcVar20,pauVar23,param_4);
            BVar10 = CopyFileW((LPCWSTR)(undefined (*) [16])local_ac0,
                               (LPCWSTR)(undefined (*) [16])local_cd0,0);
            if (BVar10 == 0) goto LAB_14000682d;
            *ppauVar2 = (undefined (*) [16])local_cd0;
            FUN_14000ce30((undefined (*) [16])local_ee0,0,0x20a);
            FUN_14000ce30((undefined (*) [16])local_10f0,0,0x20a);
            BVar10 = FUN_140009720((wchar_t *)(undefined (*) [16])local_10f0,
                                   (wchar_t *)(undefined (*) [16])local_cd0,L"updater.ini");
            if (((BVar10 != 0) &&
                (BVar10 = FUN_140009720(local_ee0,local_ac0,L"updater.ini"), BVar10 != 0)) &&
               (BVar10 = CopyFileW(local_ee0,local_10f0,0), BVar10 == 0)) {
              if ((*(int *)(*(longlong *)
                             ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                   < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                DAT_14003a118 = (FILE *)0x0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
              GetLastError();
              param_4 = (undefined (*) [16])local_10f0;
              FUN_140008ff0(&DAT_14003a118,
                            (longlong)"Could not copy updater.ini from: \'%ls\' to \'%ls\'.  (%lu)",
                            local_ee0,param_4);
            }
            pauVar23 = (undefined (*) [16])local_490;
            FUN_14000ce30(pauVar23,0,0x20a);
            BVar10 = FUN_1400053c0(uVar9,(longlong)ppauVar2,(wchar_t *)pauVar23);
            if (BVar10 == 0) {
              if ((*(int *)(*(longlong *)
                             ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                   < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                DAT_14003a118 = (FILE *)0x0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
              FUN_140008ff0(&DAT_14003a118,(longlong)"Could not get the installation directory",
                            pauVar23,param_4);
              pcVar20 = (char *)0x21;
              bVar6 = FUN_14000a180(*ppwVar1,0x21);
              iVar8 = 0;
              if ((int)CONCAT71(extraout_var_04,bVar6) == 0) {
                if ((*(int *)(*(longlong *)
                               ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                             ) < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                pcVar20 = "Could not write update.status for GetInstallationDir failure.";
                FUN_140008ff0(&DAT_14003a118,
                              (longlong)
                              "Could not write update.status for GetInstallationDir failure.",
                              pauVar23,param_4);
              }
            }
            else {
              pwVar24 = *ppwVar1;
              uVar17 = FUN_1400054e0((wchar_t *)*ppauVar2,(wchar_t *)local_490,pwVar24);
              iVar8 = *(int *)(*(longlong *)
                                ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                              4);
              if ((char)uVar17 == '\0') {
                if ((iVar8 < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                DVar13 = GetLastError();
                pauVar23 = (undefined (*) [16])(ulonglong)DVar13;
                FUN_140008ff0(&DAT_14003a118,
                              (longlong)
                              "Could not start process due to certificate check error on updater.exe. Updating update.status.  (%lu)"
                              ,pauVar23,param_4);
                pcVar20 = (char *)0x1a;
                bVar6 = FUN_14000a180(*ppwVar1,0x1a);
                iVar8 = 0;
                if ((int)CONCAT71(extraout_var_05,bVar6) != 0) goto LAB_1400076a5;
                if ((*(int *)(*(longlong *)
                               ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                             ) < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                uVar9 = GetLastError();
                pcVar20 = "Could not write pending state to update.status.  (%lu)";
LAB_140006f9b:
                iVar8 = 0;
                pauVar23 = (undefined (*) [16])(ulonglong)uVar9;
                FUN_140008ff0(&DAT_14003a118,(longlong)pcVar20,pauVar23,param_4);
              }
              else {
                if ((iVar8 < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                FUN_140008ee0(&DAT_14003a118,
                              (longlong)"Starting update process as the service in session 0.",
                              pwVar24,param_4);
                local_1140 = ZEXT816(0);
                local_1130 = ZEXT816(0);
                local_1120 = ZEXT816(0);
                local_1110 = ZEXT816(0);
                local_1100 = (HANDLE)0x0;
                local_1180 = ZEXT816(0);
                local_1170 = 0;
                local_1160 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x68);
                local_1150 = ZEXT816(0x140030e6e);
                uVar15 = 0;
                FUN_140001090(&local_1188,uVar9,(longlong)ppauVar2,0,0);
                if (uVar9 == 4) {
                  iVar8 = wcscmp(*(wchar_t **)(param_2 + 0x30),L"-1");
                  if (iVar8 != 0) {
LAB_14000702f:
                    pwVar24 = wcsstr(*(wchar_t **)(param_2 + 0x30),L"/replace");
                    if (pwVar24 == (wchar_t *)0x0) {
                      pWVar22 = *(WCHAR **)(param_2 + 0x30);
                      do {
                        WVar3 = *pWVar22;
                        if (WVar3 == L'\0') break;
                        pWVar22 = pWVar22 + 1;
                        iVar8 = FUN_1400148ec(WVar3);
                      } while (iVar8 != 0);
                    }
                  }
                }
                else if (6 < (int)param_1) goto LAB_14000702f;
                local_1150 = CONCAT88(local_1150._8_8_,0x1400313d0);
                local_1130 = local_1130 | (undefined  [16])0x100000000;
                local_1120 = local_1120 & (undefined  [16])0xffffffffffff0000;
                FUN_140012834("MOZ_USING_SERVICE=1");
                if ((*(int *)(*(longlong *)
                               ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                             ) < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = (FILE *)0x0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                FUN_140008ee0(&DAT_14003a118,(longlong)"Starting service with cmdline: %ls",
                              local_1188,uVar15);
                pvVar18 = (HANDLE)0x0;
                uVar15 = 0;
                param_4 = (undefined (*) [16])0x0;
                BVar10 = CreateProcessW((LPCWSTR)*ppauVar2,(LPWSTR)local_1188,
                                        (LPSECURITY_ATTRIBUTES)0x0,(LPSECURITY_ATTRIBUTES)0x0,0,
                                        0x4000000,(LPVOID)0x0,(LPCWSTR)0x0,
                                        (LPSTARTUPINFOW)local_1160,(LPPROCESS_INFORMATION)local_1180
                                       );
                if (BVar10 == 0) {
                  GetLastError();
                  if ((*(int *)(*(longlong *)
                                 ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                               4) < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = (FILE *)0x0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  pauVar23 = *ppauVar2;
                  param_4 = local_1188;
                  FUN_140008ff0(&DAT_14003a118,
                                (longlong)
                                "Could not create process as current user, updaterPath: %ls; cmdLine: %ls.  (%lu)"
                                ,pauVar23,local_1188);
                  bVar6 = false;
                }
                else {
                  if ((*(int *)(*(longlong *)
                                 ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                               4) < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = (FILE *)0x0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  FUN_140008ee0(&DAT_14003a118,(longlong)"Process was started... waiting on result."
                                ,uVar15,param_4);
                  DVar13 = WaitForSingleObject(local_1180._0_8_,900000);
                  if (DVar13 == 0x102) {
                    TerminateProcess(local_1180._0_8_,1);
                    bVar7 = false;
                    bVar6 = false;
                  }
                  else {
                    BVar14 = GetExitCodeProcess(local_1180._0_8_,local_260);
                    iVar8 = *(int *)(*(longlong *)
                                      ((longlong)ThreadLocalStoragePointer +
                                      (ulonglong)_tls_index * 8) + 4);
                    if (BVar14 == 0) {
                      if ((iVar8 < DAT_14003a328) &&
                         (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                        DAT_14003a118 = (FILE *)0x0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                      FUN_140008ff0(&DAT_14003a118,
                                    (longlong)"Process finished but could not obtain return code.",
                                    uVar15,param_4);
                      bVar6 = false;
                      bVar7 = true;
                    }
                    else {
                      if ((iVar8 < DAT_14003a328) &&
                         (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                        DAT_14003a118 = (FILE *)0x0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                      FUN_140008ee0(&DAT_14003a118,
                                    (longlong)"Process finished with return code %lu.",
                                    (ulonglong)local_260[0],param_4);
                      bVar6 = local_260[0] == 0;
                      bVar7 = false;
                    }
                  }
                  CloseHandle(local_1180._0_8_);
                  CloseHandle(local_1180._8_8_);
                  pwVar24 = *ppwVar1;
                  pauVar23 = (undefined (*) [16])local_260;
                  FUN_14000ce30(pauVar23,0,0x20a);
                  BVar14 = FUN_140009940(pwVar24,L".status",(wchar_t *)pauVar23);
                  if (BVar14 == 0) {
                    if ((*(int *)(*(longlong *)
                                   ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                 + 4) < DAT_14003a328) &&
                       (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                      DAT_14003a118 = (FILE *)0x0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                    pcVar20 = "Could not get path for the secure update status file";
                    goto LAB_14000738f;
                  }
                  pauVar23 = (undefined (*) [16])0x7;
                  param_4 = (undefined (*) [16])0x0;
                  pvVar18 = CreateFileW((LPCWSTR)local_260,0x80000000,7,(LPSECURITY_ATTRIBUTES)0x0,3
                                        ,0,pvVar18);
                  if (pvVar18 == (HANDLE)0xffffffffffffffff) {
                    if ((*(int *)(*(longlong *)
                                   ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                 + 4) < DAT_14003a328) &&
                       (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                      DAT_14003a118 = (FILE *)0x0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                    pcVar20 = "Could not open update.status file";
LAB_140007401:
                    FUN_140008ff0(&DAT_14003a118,(longlong)pcVar20,pauVar23,param_4);
                    bVar25 = false;
                    bVar4 = false;
                  }
                  else {
                    local_270 = ZEXT816(0);
                    local_280 = ZEXT816(0);
                    param_4 = (undefined (*) [16])local_10f4;
                    pauVar23 = (undefined (*) [16])0x20;
                    BVar14 = ReadFile(pvVar18,local_280,0x20,(LPDWORD)param_4,(LPOVERLAPPED)0x0);
                    if (BVar14 == 0) {
                      if ((*(int *)(*(longlong *)
                                     ((longlong)ThreadLocalStoragePointer +
                                     (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) &&
                         (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                        DAT_14003a118 = (FILE *)0x0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                      pcVar20 = "Could not read from update.status file";
                      goto LAB_140007401;
                    }
                    bVar25 = local_280._0_8_ == 0x676e69796c707061;
                    bVar4 = true;
                  }
                  if (1 < (longlong)pvVar18 + 1U) {
                    CloseHandle(pvVar18);
                  }
                  if ((bVar4) && (bVar25)) {
                    iVar8 = *(int *)(*(longlong *)
                                      ((longlong)ThreadLocalStoragePointer +
                                      (ulonglong)_tls_index * 8) + 4);
                    if (bVar6) {
                      if ((iVar8 < DAT_14003a328) &&
                         (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                        DAT_14003a118 = (FILE *)0x0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                      FUN_140008ee0(&DAT_14003a118,
                                    (longlong)
                                    "update.status is still applying even though update was successful."
                                    ,pauVar23,param_4);
                      bVar7 = FUN_14000a180(*ppwVar1,0x1d);
                      bVar6 = false;
                      if ((int)CONCAT71(extraout_var_06,bVar7) == 0) {
                        if ((*(int *)(*(longlong *)
                                       ((longlong)ThreadLocalStoragePointer +
                                       (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) &&
                           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                          DAT_14003a118 = (FILE *)0x0;
                          atexit(FUN_140002780);
                          _Init_thread_footer(&DAT_14003a328);
                        }
                        pcVar20 = "Could not write update.status still applying on success error.";
LAB_14000738f:
                        FUN_140008ff0(&DAT_14003a118,(longlong)pcVar20,pauVar23,param_4);
                      }
                    }
                    else {
                      if ((iVar8 < DAT_14003a328) &&
                         (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                        DAT_14003a118 = (FILE *)0x0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                      FUN_140008ff0(&DAT_14003a118,
                                    (longlong)
                                    "update.status is still applying and update was not successful."
                                    ,pauVar23,param_4);
                      uVar9 = 0x1e;
                      if (DVar13 == 0x102) {
                        uVar9 = 0x32;
                      }
                      uVar12 = 0x33;
                      if (!bVar7) {
                        uVar12 = uVar9;
                      }
                      bVar7 = FUN_14000a180(*ppwVar1,uVar12);
                      bVar6 = false;
                      if ((int)CONCAT71(extraout_var_07,bVar7) == 0) {
                        if ((*(int *)(*(longlong *)
                                       ((longlong)ThreadLocalStoragePointer +
                                       (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) &&
                           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                          DAT_14003a118 = (FILE *)0x0;
                          atexit(FUN_140002780);
                          _Init_thread_footer(&DAT_14003a328);
                        }
                        pcVar20 = "Could not write update.status still applying on failure error.";
                        goto LAB_14000738f;
                      }
                    }
                  }
                }
                FUN_140012834("MOZ_USING_SERVICE=");
                pauVar5 = local_1188;
                local_1188 = (undefined (*) [16])0x0;
                if (pauVar5 != (undefined (*) [16])0x0) {
                  thunk_FUN_140013ed8(pauVar5);
                }
                iVar8 = *(int *)(*(longlong *)
                                  ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                                + 4);
                if (bVar6) {
                  if ((iVar8 < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = (FILE *)0x0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  FUN_140008ee0(&DAT_14003a118,
                                (longlong)"updater.exe was launched and run successfully!",pauVar23,
                                param_4);
                  pcVar20 = (char *)ThreadLocalStoragePointer;
                  if ((*(int *)(*(longlong *)
                                 ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                               4) < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = (FILE *)0x0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  if (DAT_14003a118 != (FILE *)0x0) {
                    fflush(DAT_14003a118);
                  }
                  if (param_1 == 7) {
                    lVar19 = 3;
LAB_14000767f:
                    pcVar20 = "-1";
                    iVar8 = wcscmp((wchar_t *)ppauVar2[lVar19],L"-1");
                    if (iVar8 != 0) goto LAB_140007693;
                  }
                  else {
                    if (param_1 == 8) {
                      lVar19 = 4;
                      goto LAB_14000767f;
                    }
LAB_140007693:
                    FUN_140009c70((wchar_t *)local_490);
                  }
                  iVar8 = 1;
                }
                else {
                  if ((iVar8 < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = (FILE *)0x0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  DVar13 = GetLastError();
                  pauVar23 = (undefined (*) [16])(ulonglong)DVar13;
                  FUN_140008ff0(&DAT_14003a118,
                                (longlong)
                                "Error running update process. Updating update.status  (%lu)",
                                pauVar23,param_4);
                  pcVar20 = (char *)ThreadLocalStoragePointer;
                  if ((*(int *)(*(longlong *)
                                 ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                               4) < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = (FILE *)0x0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  if (DAT_14003a118 != (FILE *)0x0) {
                    fflush(DAT_14003a118);
                  }
                  iVar8 = 0;
                  if (BVar10 == 0) {
                    pcVar20 = (char *)0x18;
                    bVar6 = FUN_14000a180(*ppwVar1,0x18);
                    if ((int)CONCAT71(extraout_var_08,bVar6) == 0) {
                      if ((*(int *)(*(longlong *)
                                     ((longlong)ThreadLocalStoragePointer +
                                     (ulonglong)_tls_index * 8) + 4) < DAT_14003a328) &&
                         (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                        DAT_14003a118 = (FILE *)0x0;
                        atexit(FUN_140002780);
                        _Init_thread_footer(&DAT_14003a328);
                      }
                      uVar9 = GetLastError();
                      pcVar20 = "Could not write update.status service update failure.  (%lu)";
                      goto LAB_140006f9b;
                    }
                  }
                }
              }
            }
LAB_1400076a5:
            FUN_140005dd0(local_cd0,pcVar20,pauVar23,param_4);
          }
          if ((*(int *)(*(longlong *)
                         ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
               DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
            DAT_14003a118 = (FILE *)0x0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
          FUN_140008ee0(&DAT_14003a118,(longlong)"Service command %ls complete.",
                        *(undefined8 *)(param_2 + 0x10),param_4);
          goto LAB_1400060d0;
        }
        uVar15 = FUN_140001460(local_8b0,(short *)local_260);
        if ((int)uVar15 == 0) {
          pwVar24 = *ppwVar1;
          uVar9 = 0x35;
        }
        else {
          if ((*(int *)(*(longlong *)
                         ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
               DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
            DAT_14003a118 = (FILE *)0x0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
          FUN_140008ee0(&DAT_14003a118,
                        (longlong)"Checking for Maintenance Service registry. key: \'%ls\'",
                        local_260,param_4);
          local_490[0] = (HKEY)0x0;
          param_3 = (undefined (*) [16])0x0;
          param_4 = (undefined (*) [16])0x20119;
          LVar11 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)local_260,0,0x20119,local_490);
          if (LVar11 == 0) {
            RegCloseKey(local_490[0]);
            goto LAB_14000661c;
          }
          if ((*(int *)(*(longlong *)
                         ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
               DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
            DAT_14003a118 = (FILE *)0x0;
            atexit(FUN_140002780);
            _Init_thread_footer(&DAT_14003a328);
          }
          FUN_140008ff0(&DAT_14003a118,
                        (longlong)"The maintenance service registry key does not exist.",param_3,
                        param_4);
          pwVar24 = *ppwVar1;
          uVar9 = 0x39;
        }
      }
    }
    else {
LAB_140006368:
      pwVar24 = wcsstr(*(wchar_t **)(param_2 + 0x30),L"/replace");
      if (pwVar24 != (wchar_t *)0x0) goto LAB_140006381;
      pWVar22 = *(WCHAR **)(param_2 + 0x30);
      do {
        WVar3 = *pWVar22;
        if (WVar3 == L'\0') goto LAB_140006381;
        pWVar22 = pWVar22 + 1;
        iVar8 = FUN_1400148ec(WVar3);
      } while (iVar8 != 0);
      if (((int)param_1 < 7) ||
         (uVar12 = FUN_140009410(*(wchar_t **)(param_2 + 0x30)), (char)uVar12 == '\0'))
      goto LAB_14000657a;
      param_3 = (undefined (*) [16])0x104;
      iVar8 = FUN_140013348(*(wint_t **)(param_2 + 0x30),*(wint_t **)(param_2 + 0x28),0x104);
      if (iVar8 == 0) goto LAB_140006381;
      if (param_1 < 8) {
LAB_140006534:
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ff0(&DAT_14003a118,
                      (longlong)
                      "Installation directory and working directory must be the same for non-staged updates. Exiting."
                      ,param_3,param_4);
        pwVar24 = *ppwVar1;
        uVar9 = 0x36;
        goto LAB_1400062de;
      }
      pwVar24 = L"-1";
      iVar8 = wcscmp(*(wchar_t **)(param_2 + 0x38),L"-1");
      if (iVar8 != 0) {
        pwVar24 = L"/replace";
        pwVar21 = wcsstr(*(wchar_t **)(param_2 + 0x38),L"/replace");
        if (pwVar21 == (wchar_t *)0x0) goto LAB_140006534;
      }
      param_4 = *(undefined (**) [16])(param_2 + 0x30);
      FUN_140008070((undefined2 *)local_260,pwVar24,param_3,param_4);
      BVar10 = PathRemoveFileSpecW((LPWSTR)local_260);
      if (BVar10 == 0) {
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        DVar13 = GetLastError();
        param_3 = (undefined (*) [16])(ulonglong)DVar13;
        FUN_140008ff0(&DAT_14003a118,
                      (longlong)
                      "Couldn\'t remove file spec when attempting to verify the working directory path.  (%lu)"
                      ,param_3,param_4);
        pwVar24 = *ppwVar1;
        uVar9 = 0x47;
      }
      else {
        param_3 = (undefined (*) [16])0x104;
        iVar8 = FUN_140013348((wint_t *)local_260,*(wint_t **)(param_2 + 0x28),0x104);
        if (iVar8 == 0) goto LAB_140006381;
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = (FILE *)0x0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ff0(&DAT_14003a118,
                      (longlong)
                      "The apply-to directory must be the same as or a child of the installation directory! Exiting."
                      ,param_3,param_4);
        pwVar24 = *ppwVar1;
        uVar9 = 0x34;
      }
    }
    bVar6 = FUN_14000a180(pwVar24,uVar9);
    if ((int)CONCAT71(extraout_var_02,bVar6) == 0) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = (FILE *)0x0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      pcVar20 = "Could not write update.status for previous failure.";
      goto LAB_1400061b9;
    }
  }
  iVar8 = 0;
LAB_1400061c0:
  __security_check_cookie(local_50 ^ (ulonglong)auStackY_11f0);
  return iVar8;
}



void FUN_140008070(undefined2 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  ulonglong *puVar2;
  undefined8 local_res20;
  undefined auStackY_58 [32];
  
  uVar1 = DAT_140038010 ^ (ulonglong)auStackY_58;
  local_res20 = param_4;
  puVar2 = (ulonglong *)FUN_140001080();
  common_vsprintf__(*puVar2 | 1,param_1,0x103,(longlong)&DAT_140030ece,(__crt_locale_pointers *)0x0,
                    &local_res20);
  param_1[0x103] = 0;
  __security_check_cookie(uVar1 ^ (ulonglong)auStackY_58);
  return;
}



char FUN_1400080f0(wchar_t *param_1,char *param_2,uint param_3,longlong param_4,char *param_5)

{
  byte *pbVar1;
  LPVOID pvVar2;
  int iVar3;
  FILE *_File;
  ulonglong uVar4;
  ulonglong *_DstBuf;
  size_t sVar5;
  byte *pbVar6;
  undefined (*pauVar7) [16];
  byte bVar8;
  ulonglong *puVar9;
  byte bVar10;
  byte *pbVar11;
  char cVar12;
  ulonglong *puVar13;
  char *pcVar14;
  longlong lVar15;
  ulonglong *_Str1;
  bool bVar16;
  uint local_54;
  
  _File = FUN_14001351c(param_1,L"rb");
  if (_File == (FILE *)0x0) {
    return '\x06';
  }
  iVar3 = FUN_140013eec(_File,0,2);
  cVar12 = '\x06';
  if ((iVar3 != 0) || (uVar4 = thunk_FUN_1400145ac(_File), (int)uVar4 < 1)) goto LAB_1400083f8;
  uVar4 = uVar4 & 0xffffffff;
  _DstBuf = (ulonglong *)operator_new(uVar4 + 1);
  iVar3 = FUN_140013eec(_File,0,0);
  cVar12 = '\x06';
  if ((iVar3 == 0) && (sVar5 = fread(_DstBuf,1,uVar4,_File), sVar5 == uVar4)) {
    *(byte *)((longlong)_DstBuf + uVar4) = 0;
    bVar16 = false;
    local_54 = 0;
    puVar9 = _DstBuf;
LAB_1400081b3:
    for (; (bVar8 = *(byte *)puVar9, bVar8 == 10 || (bVar8 == 0xd));
        puVar9 = (ulonglong *)((longlong)puVar9 + 1)) {
    }
    if (bVar8 != 0) {
      _Str1 = (ulonglong *)((longlong)puVar9 + 1);
      puVar13 = _Str1;
      bVar10 = bVar8;
      do {
        if ((bVar10 == 10) || (bVar10 == 0xd)) {
          *(byte *)((longlong)puVar13 + -1) = 0;
          bVar8 = *(byte *)puVar9;
          goto LAB_1400081fe;
        }
        bVar10 = *(byte *)puVar13;
        puVar13 = (ulonglong *)((longlong)puVar13 + 1);
      } while (bVar10 != 0);
      puVar13 = (ulonglong *)0x0;
LAB_1400081fe:
      if ((bVar8 != 0x23) && (bVar8 != 0x3b)) {
        pbVar11 = (byte *)((longlong)puVar9 + 2);
        pbVar6 = (byte *)((longlong)puVar9 + 3);
LAB_14000821b:
        if (bVar8 < 0x20) {
          if (bVar8 != 9) goto LAB_14000823d;
LAB_14000822f:
          bVar8 = *(byte *)_Str1;
          _Str1 = (ulonglong *)((longlong)_Str1 + 1);
          pbVar11 = pbVar11 + 1;
          pbVar6 = pbVar6 + 1;
          goto LAB_14000821b;
        }
        if (bVar8 == 0x20) goto LAB_14000822f;
        puVar9 = _Str1;
        if (bVar8 != 0x5b) goto LAB_140008262;
        for (; bVar8 = *(byte *)puVar9, bVar8 == 0x5d; puVar9 = (ulonglong *)((longlong)puVar9 + 1))
        {
          pbVar11 = pbVar11 + 1;
          pbVar6 = pbVar6 + 1;
        }
        if (bVar8 != 0) {
LAB_140008295:
          if (bVar8 != 0x5d) goto code_r0x00014000829b;
          *(byte *)puVar9 = 0;
          for (; (bVar8 = *pbVar11, bVar8 == 9 || (bVar8 == 0x20)); pbVar11 = pbVar11 + 1) {
            pbVar6 = pbVar6 + 1;
          }
          if (bVar8 == 0) {
LAB_1400082ea:
            pcVar14 = param_5;
            if (param_5 == (char *)0x0) {
              pcVar14 = "Strings";
            }
            iVar3 = strcmp((char *)_Str1,pcVar14);
            bVar16 = iVar3 == 0;
            goto LAB_140008377;
          }
          while ((bVar8 != 9 && (bVar8 != 0x20))) {
            bVar8 = *pbVar6;
            pbVar6 = pbVar6 + 1;
            if (bVar8 == 0) goto LAB_140008288;
          }
          pbVar6[-1] = 0;
        }
LAB_140008288:
        bVar16 = false;
      }
      goto LAB_140008377;
    }
    goto LAB_1400083de;
  }
LAB_1400083f0:
  thunk_FUN_140013ed8(_DstBuf);
LAB_1400083f8:
  FUN_140013618(_File);
  return cVar12;
code_r0x00014000829b:
  bVar8 = *(byte *)((longlong)puVar9 + 1);
  puVar9 = (ulonglong *)((longlong)puVar9 + 1);
  pbVar11 = pbVar11 + 1;
  pbVar6 = pbVar6 + 1;
  if (bVar8 == 0) goto LAB_1400082ea;
  goto LAB_140008295;
LAB_14000823d:
  if (bVar8 != 0) {
LAB_140008262:
    if (bVar16) {
      pbVar11 = (byte *)((longlong)_Str1 + -1);
      pbVar6 = pbVar11;
      while (bVar8 == 0x3d) {
        pbVar1 = pbVar6 + 1;
        pbVar6 = pbVar6 + 1;
        _Str1 = (ulonglong *)((longlong)_Str1 + 1);
        bVar8 = *pbVar1;
      }
      if (bVar8 != 0) {
        do {
          if (bVar8 == 0x3d) {
            *(byte *)((longlong)_Str1 + -1) = 0;
            goto LAB_140008331;
          }
          bVar8 = *(byte *)_Str1;
          _Str1 = (ulonglong *)((longlong)_Str1 + 1);
        } while (bVar8 != 0);
        _Str1 = (ulonglong *)0x0;
LAB_140008331:
        if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
          lVar15 = 0;
          pcVar14 = param_2;
          do {
            iVar3 = strcmp((char *)pbVar11,pcVar14);
            if (iVar3 == 0) {
              if ((uint)lVar15 < param_3) {
                sVar5 = strlen((char *)_Str1);
                pauVar7 = (undefined (*) [16])operator_new(sVar5 + 1);
                FUN_14000ce30(pauVar7,0,sVar5 + 1);
                pvVar2 = *(LPVOID *)(param_4 + lVar15 * 8);
                *(undefined (**) [16])(param_4 + lVar15 * 8) = pauVar7;
                if (pvVar2 != (LPVOID)0x0) {
                  thunk_FUN_140013ed8(pvVar2);
                  pauVar7 = *(undefined (**) [16])(param_4 + lVar15 * 8);
                }
                FUN_140014a70((longlong)pauVar7,_Str1);
                local_54 = local_54 + 1;
              }
              break;
            }
            sVar5 = strlen(pcVar14);
            pcVar14 = pcVar14 + sVar5 + 1;
            lVar15 = lVar15 + 1;
          } while (*pcVar14 != '\0');
        }
      }
    }
  }
LAB_140008377:
  puVar9 = puVar13;
  if (puVar13 == (ulonglong *)0x0) goto LAB_1400083de;
  goto LAB_1400081b3;
LAB_1400083de:
  cVar12 = (local_54 != param_3) * '\x05';
  goto LAB_1400083f0;
}



undefined8 FUN_140008420(wchar_t *param_1,void *param_2,int param_3)

{
  uint uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  char *pcVar4;
  wchar_t **ppwVar5;
  undefined8 uVar6;
  LPDWORD lpcchName;
  DWORD dwIndex;
  undefined auStackY_908 [32];
  wchar_t *local_8a8;
  undefined (*local_8a0) [16];
  DWORD local_894;
  HKEY local_890;
  DWORD local_888;
  uint local_884;
  HKEY local_880;
  undefined local_878 [512];
  wchar_t local_678 [256];
  WCHAR local_478 [256];
  WCHAR local_278 [268];
  ulonglong local_60;
  
  local_60 = DAT_140038010 ^ (ulonglong)auStackY_908;
  uVar2 = FUN_140001460(param_1,local_278);
  if ((int)uVar2 != 0) {
    uVar2 = 0x20119;
    uVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,local_278,0,0x20119,&local_880);
    if (uVar1 != 0) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open key.  (%ld)",(ulonglong)uVar1,
                    uVar2);
      uVar2 = 0;
      uVar6 = 0x20119;
      uVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                            L"SOFTWARE\\Mozilla\\MaintenanceService\\3932ecacee736d366d6436db0f55bce4"
                            ,0,0x20119,&local_880);
      if (uVar1 != 0) {
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open fallback key.  (%ld)",
                      (ulonglong)uVar1,uVar6);
        goto LAB_140008627;
      }
      if (param_3 != 0) {
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ff0((FILE **)&DAT_14003a118,
                      (longlong)
                      "Fallback key present, skipping VerifyCertificateTrustForFile check and the certificate attribute registry matching check."
                      ,uVar2,uVar6);
LAB_14000857c:
        RegCloseKey(local_880);
        uVar2 = 1;
        goto LAB_140008629;
      }
    }
    local_884 = 0;
    lpcchName = (LPDWORD)0x0;
    uVar1 = RegQueryInfoKeyW(local_880,(LPWSTR)0x0,(LPDWORD)0x0,(LPDWORD)0x0,&local_884,(LPDWORD)0x0
                             ,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                             (PFILETIME)0x0);
    if (uVar1 == 0) {
      if (local_884 != 0) {
        dwIndex = 0;
        do {
          local_888 = 0xff;
          lpcchName = &local_888;
          uVar1 = RegEnumKeyExW(local_880,dwIndex,local_478,lpcchName,(LPDWORD)0x0,(LPWSTR)0x0,
                                (LPDWORD)0x0,(PFILETIME)0x0);
          if (uVar1 != 0) {
            if ((*(int *)(*(longlong *)
                           ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                 DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
            pcVar4 = "Could not enum certs.  (%ld)";
            goto LAB_140008614;
          }
          uVar2 = 0x20119;
          uVar1 = RegOpenKeyExW(local_880,local_478,0,0x20119,&local_890);
          if (uVar1 == 0) {
            local_894 = 0x200;
            FUN_14000ce30((undefined (*) [16])local_678,0,0x200);
            FUN_14000ce30((undefined (*) [16])local_878,0,0x200);
            uVar2 = 0;
            uVar1 = RegQueryValueExW(local_890,L"name",(LPDWORD)0x0,(LPDWORD)0x0,
                                     (LPBYTE)(undefined (*) [16])local_678,&local_894);
            if (uVar1 == 0) {
              local_894 = 0x200;
              uVar6 = 0;
              uVar2 = 0;
              uVar1 = RegQueryValueExW(local_890,L"issuer",(LPDWORD)0x0,(LPDWORD)0x0,
                                       (LPBYTE)(undefined (*) [16])local_878,&local_894);
              if (uVar1 == 0) {
                local_8a8 = local_678;
                ppwVar5 = &local_8a8;
                local_8a0 = (undefined (*) [16])local_878;
                uVar3 = FUN_14000a4f0(param_2,ppwVar5);
                uVar1 = (uint)uVar3;
                if (uVar1 == 0) {
                  uVar1 = FUN_14000ad20(param_2,ppwVar5,uVar6,uVar2);
                  if (uVar1 == 0) goto LAB_14000857c;
                  if ((*(int *)(*(longlong *)
                                 ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                               4) < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  pcVar4 = "Error on certificate trust check.  (%ld)";
                }
                else {
                  if ((*(int *)(*(longlong *)
                                 ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                               4) < DAT_14003a328) &&
                     (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                  pcVar4 = "Error on certificate check.  (%ld)";
                }
              }
              else {
                if ((*(int *)(*(longlong *)
                               ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4
                             ) < DAT_14003a328) &&
                   (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                  DAT_14003a118 = 0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
                pcVar4 = "Could not obtain issuer from registry.  (%ld)";
              }
            }
            else {
              if ((*(int *)(*(longlong *)
                             ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                   < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
                DAT_14003a118 = 0;
                atexit(FUN_140002780);
                _Init_thread_footer(&DAT_14003a328);
              }
              pcVar4 = "Could not obtain name from registry.  (%ld)";
            }
            FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar4,(ulonglong)uVar1,uVar2);
            RegCloseKey(local_890);
          }
          else {
            if ((*(int *)(*(longlong *)
                           ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                 DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
            FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"Could not open subkey.  (%ld)",
                          (ulonglong)uVar1,uVar2);
          }
          dwIndex = dwIndex + 1;
        } while (dwIndex < local_884);
      }
    }
    else {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      pcVar4 = "Could not query info key.  (%ld)";
LAB_140008614:
      FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar4,(ulonglong)uVar1,lpcchName);
    }
    RegCloseKey(local_880);
  }
LAB_140008627:
  uVar2 = 0;
LAB_140008629:
  __security_check_cookie(local_60 ^ (ulonglong)auStackY_908);
  return uVar2;
}



undefined8 FUN_140008bb0(HANDLE param_1,longlong param_2,longlong param_3,undefined8 param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  HANDLE ProcessHandle;
  undefined8 uVar3;
  longlong lVar4;
  undefined8 uVar5;
  undefined auStackY_b8 [32];
  HANDLE local_80;
  _LUID local_78;
  _TOKEN_PRIVILEGES local_70;
  ulonglong local_60;
  
  local_60 = DAT_140038010 ^ (ulonglong)auStackY_b8;
  local_80 = (HANDLE)0x0;
  if (param_1 == (HANDLE)0x0) {
    ProcessHandle = GetCurrentProcess();
    BVar1 = OpenProcessToken(ProcessHandle,0xf00ff,&local_80);
    param_1 = local_80;
    if (BVar1 == 0) {
      if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                   4) < DAT_14003a328) && (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)
         ) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
      DVar2 = GetLastError();
      FUN_140008ff0((FILE **)&DAT_14003a118,
                    (longlong)
                    "Could not obtain token for current process, no privileges changed. (%lu)",
                    (ulonglong)DVar2,param_4);
      uVar5 = 0;
      goto LAB_140008de9;
    }
  }
  uVar5 = 1;
  if (param_3 != 0) {
    lVar4 = 0;
    do {
      BVar1 = LookupPrivilegeValueA((LPCSTR)0x0,*(LPCSTR *)(param_2 + lVar4 * 8),&local_78);
      if (BVar1 == 0) {
LAB_140008c9a:
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        DVar2 = GetLastError();
        FUN_140008ee0((FILE **)&DAT_14003a118,
                      (longlong)"Could not disable token privilege value: %s. (%lu)",
                      *(undefined8 *)(param_2 + lVar4 * 8),(ulonglong)DVar2);
        uVar5 = 0;
      }
      else {
        local_70.PrivilegeCount = 1;
        local_70.Privileges[0].Luid = local_78;
        local_70.Privileges[0].Attributes = 0;
        SetLastError(0);
        uVar3 = 0x10;
        BVar1 = AdjustTokenPrivileges(param_1,0,&local_70,0x10,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0);
        if ((BVar1 == 0) || (DVar2 = GetLastError(), DVar2 != 0)) goto LAB_140008c9a;
        if ((*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8)
                     + 4) < DAT_14003a328) &&
           (_Init_thread_header(&DAT_14003a328), DAT_14003a328 == -1)) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
        FUN_140008ee0((FILE **)&DAT_14003a118,(longlong)"Disabled unneeded token privilege: %s.",
                      *(undefined8 *)(param_2 + lVar4 * 8),uVar3);
      }
      lVar4 = lVar4 + 1;
    } while (param_3 != lVar4);
  }
  if (local_80 != (HANDLE)0x0) {
    CloseHandle(local_80);
  }
LAB_140008de9:
  __security_check_cookie(local_60 ^ (ulonglong)auStackY_b8);
  return uVar5;
}



void FUN_140008e50(FILE **param_1,wchar_t *param_2)

{
  size_t sVar1;
  FILE *pFVar2;
  
  if (*param_1 == (FILE *)0x0) {
    sVar1 = wcslen(param_2);
    if ((int)sVar1 - 1U < 0x102) {
      FUN_14000b198((short *)(param_1 + 1),(longlong)param_2,0x104);
      pFVar2 = FUN_14001351c((wchar_t *)(param_1 + 1),L"w");
      *param_1 = pFVar2;
    }
  }
  return;
}



void FUN_140008eb0(FILE **param_1)

{
  if (*param_1 != (FILE *)0x0) {
    FUN_140013618(*param_1);
    *param_1 = (FILE *)0x0;
  }
  return;
}



void FUN_140008ee0(FILE **param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  FILE *pFVar1;
  uint uVar2;
  int iVar3;
  tm *ptVar4;
  longlong lVar5;
  undefined8 *puVar6;
  undefined8 uVar7;
  char *pcVar8;
  tm *ptVar9;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStackY_88 [32];
  __time64_t local_60;
  undefined local_58;
  undefined7 uStack_57;
  undefined uStack_50;
  undefined7 uStack_4f;
  unkbyte9 Stack_48;
  ulonglong local_30;
  
  local_30 = DAT_140038010 ^ (ulonglong)auStackY_88;
  local_res18 = param_3;
  local_res20 = param_4;
  if (*param_1 != (FILE *)0x0) {
    local_60 = _time64((__time64_t *)0x0);
    ptVar4 = FID_conflict__localtime64((__time32_t *)&local_60);
    if (ptVar4 != (tm *)0x0) {
      Stack_48 = SUB169(ZEXT816(0) >> 0x38,0);
      local_58 = 0;
      uStack_57 = 0;
      uStack_50 = 0;
      uStack_4f = 0;
      pcVar8 = "%Y-%m-%d %H:%M:%S%z";
      uVar7 = 0x19;
      ptVar9 = ptVar4;
      lVar5 = FUN_140014b28(&local_58,0x19,"%Y-%m-%d %H:%M:%S%z",(uint *)ptVar4);
      if (lVar5 == 0) {
        local_58 = 0;
        uVar2 = FUN_140012448(&ptVar4->tm_sec);
        ptVar9 = (tm *)(ulonglong)uVar2;
        iVar3 = FUN_140001000(&local_58,uVar7,pcVar8,ptVar9);
        if (iVar3 < 0) {
          local_58 = 0;
        }
      }
      FUN_1400013f0((longlong)*param_1,(longlong)&DAT_140030e0e,&local_58,ptVar9);
    }
    local_58 = SUB81(&local_res18,0);
    uStack_57 = (undefined7)((ulonglong)&local_res18 >> 8);
    pFVar1 = *param_1;
    puVar6 = (undefined8 *)FUN_140001080();
    FID_conflict___stdio_common_vfwprintf(*puVar6,(longlong)pFVar1,param_2,0,&local_res18);
    FUN_140013a54(10,*param_1);
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStackY_88);
  return;
}



void FUN_140008ff0(FILE **param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  FILE *pFVar1;
  ulonglong uVar2;
  undefined8 *puVar3;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStackY_58 [32];
  
  uVar2 = DAT_140038010 ^ (ulonglong)auStackY_58;
  local_res18 = param_3;
  local_res20 = param_4;
  if (*param_1 != (FILE *)0x0) {
    fwrite("*** Warning: ",0xd,1,*param_1);
    pFVar1 = *param_1;
    puVar3 = (undefined8 *)FUN_140001080();
    FID_conflict___stdio_common_vfwprintf(*puVar3,(longlong)pFVar1,param_2,0,&local_res18);
    fwrite(&DAT_140030e26,4,1,*param_1);
  }
  __security_check_cookie(uVar2 ^ (ulonglong)auStackY_58);
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_1400090a0(LPCWSTR param_1)

{
  byte bVar1;
  wchar_t *pv;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  LSTATUS LVar5;
  undefined (*lpszLongPath) [16];
  size_t sVar6;
  undefined (*pauVar7) [16];
  size_t sVar8;
  undefined (*pauVar9) [16];
  __uint64 _Var10;
  byte bVar11;
  ulonglong uVar12;
  undefined auStackY_88 [32];
  wchar_t *local_48;
  ulonglong local_40;
  
  local_40 = DAT_140038010 ^ (ulonglong)auStackY_88;
  uVar12 = 0;
  DVar2 = GetLongPathNameW(param_1,(LPWSTR)0x0,0);
  if (DVar2 == 0) goto LAB_1400091eb;
  lpszLongPath = (undefined (*) [16])operator_new((ulonglong)DVar2 * 2);
  uVar12 = 0;
  FUN_14000ce30(lpszLongPath,0,(ulonglong)DVar2 * 2);
  DVar2 = GetLongPathNameW(param_1,(LPWSTR)lpszLongPath,DVar2);
  if (DVar2 != 0) {
    local_48 = (wchar_t *)0x0;
    iVar3 = SHGetKnownFolderPath(&DAT_140029028,0,0,&local_48);
    pv = local_48;
    if (-1 < iVar3) {
      sVar6 = wcslen(local_48);
      if (sVar6 != 0) {
        if (pv[sVar6 - 1] == L'\\') {
          uVar4 = FUN_140013348((wint_t *)lpszLongPath,(wint_t *)pv,sVar6);
        }
        else {
          uVar12 = sVar6 + 2;
          _Var10 = 0xffffffffffffffff;
          if (!CARRY8(uVar12,uVar12)) {
            _Var10 = uVar12 * 2;
          }
          pauVar7 = (undefined (*) [16])operator_new(_Var10);
          FUN_14000ce30(pauVar7,0,_Var10);
          FUN_140009390((undefined2 *)pauVar7,uVar12,_Var10,pv);
          uVar4 = FUN_140013348((wint_t *)lpszLongPath,(wint_t *)pauVar7,sVar6 + 1);
          sVar6 = (size_t)uVar4;
          thunk_FUN_140013ed8(pauVar7);
        }
        if (uVar4 == 0) {
          CoTaskMemFree(pv);
          uVar12 = CONCAT71((int7)(sVar6 >> 8),1);
        }
        else {
          CoTaskMemFree(pv);
          local_48 = (wchar_t *)((ulonglong)local_48 & 0xffffffff00000000);
          LVar5 = RegGetValueW((HKEY)0xffffffff80000002,
                               L"Software\\Microsoft\\Windows\\CurrentVersion",L"ProgramFilesDir",
                               0x10002,(LPDWORD)0x0,(PVOID)0x0,(LPDWORD)&local_48);
          bVar1 = 1;
          if ((LVar5 == 0) && (3 < (uint)local_48)) {
            pauVar7 = (undefined (*) [16])operator_new((ulonglong)((uint)local_48 & 0xfffffffe));
            bVar11 = 0;
            FUN_14000ce30(pauVar7,0,(ulonglong)((uint)local_48 & 0xfffffffe));
            LVar5 = RegGetValueW((HKEY)0xffffffff80000002,
                                 L"Software\\Microsoft\\Windows\\CurrentVersion",L"ProgramFilesDir",
                                 0x10002,(LPDWORD)0x0,pauVar7,(LPDWORD)&local_48);
            bVar1 = 1;
            if (LVar5 == 0) {
              sVar8 = wcsnlen((wchar_t *)pauVar7,(ulonglong)((uint)local_48 >> 1));
              if (sVar8 == 0) {
                bVar11 = 0;
              }
              else {
                if (*(short *)(pauVar7[-1] + sVar8 * 2 + 0xe) == 0x5c) {
                  uVar4 = FUN_140013348((wint_t *)lpszLongPath,(wint_t *)pauVar7,sVar8);
                  sVar6 = sVar8;
                }
                else {
                  uVar12 = sVar8 + 2;
                  _Var10 = 0xffffffffffffffff;
                  if (!CARRY8(uVar12,uVar12)) {
                    _Var10 = uVar12 * 2;
                  }
                  pauVar9 = (undefined (*) [16])operator_new(_Var10);
                  FUN_14000ce30(pauVar9,0,_Var10);
                  FUN_140009390((undefined2 *)pauVar9,uVar12,_Var10,pauVar7);
                  uVar4 = FUN_140013348((wint_t *)lpszLongPath,(wint_t *)pauVar9,sVar8 + 1);
                  thunk_FUN_140013ed8(pauVar9);
                  sVar6 = (ulonglong)uVar4;
                }
                if (uVar4 == 0) {
                  bVar11 = 1;
                }
                else {
                  bVar11 = 1;
                  bVar1 = 0;
                }
              }
            }
            thunk_FUN_140013ed8(pauVar7);
          }
          else {
            bVar11 = 0;
          }
          uVar12 = sVar6 & 0xffffffffffffff00 | (ulonglong)(bVar1 & bVar11);
        }
        goto LAB_1400091e3;
      }
      if (pv != (wchar_t *)0x0) {
        CoTaskMemFree(pv);
      }
    }
    uVar12 = 0;
  }
LAB_1400091e3:
  thunk_FUN_140013ed8(lpszLongPath);
LAB_1400091eb:
  __security_check_cookie(local_40 ^ (ulonglong)auStackY_88);
  return uVar12 & 0xffffffff;
}



void FUN_140009390(undefined2 *param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  ulonglong *puVar2;
  undefined8 local_res20;
  undefined auStackY_68 [32];
  
  uVar1 = DAT_140038010 ^ (ulonglong)auStackY_68;
  local_res20 = param_4;
  puVar2 = (ulonglong *)FUN_140001080();
  common_vsprintf__(*puVar2 | 1,param_1,param_2 + -1,(longlong)&DAT_1400312ba,
                    (__crt_locale_pointers *)0x0,&local_res20);
  param_1[param_2 + -1] = 0;
  __security_check_cookie(uVar1 ^ (ulonglong)auStackY_68);
  return;
}



uint FUN_140009410(wchar_t *param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  int iVar3;
  size_t sVar4;
  LPCWSTR lpFileName;
  HANDLE hDevice;
  undefined (*lpOutBuffer) [16];
  short *psVar5;
  wchar_t *_Str1;
  code *pcVar6;
  uint uVar7;
  uint uVar8;
  bool bVar9;
  undefined auStackY_6d8 [32];
  DWORD local_684;
  short *local_680;
  wint_t local_678 [264];
  WCHAR local_468 [264];
  undefined local_258 [528];
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStackY_6d8;
  sVar4 = wcslen(param_1);
  uVar8 = 0;
  if (0x103 < sVar4) goto LAB_1400094b6;
  FUN_14000ce30((undefined (*) [16])local_468,0,0x208);
  DVar1 = GetFullPathNameW(param_1,0x104,(LPWSTR)(undefined (*) [16])local_468,(LPWSTR *)0x0);
  if (DVar1 == 0) goto LAB_1400094b6;
  uVar8 = 0;
  FUN_14000ce30((undefined (*) [16])local_678,0,0x208);
  BVar2 = PathCanonicalizeW((LPWSTR)(undefined (*) [16])local_678,local_468);
  if (BVar2 == 0) goto LAB_1400094b6;
  iVar3 = FUN_140012f6c((wint_t *)param_1,local_678);
  if (iVar3 == 0) {
    FUN_14000b198(local_468,(longlong)param_1,0x104);
    BVar2 = PathStripToRootW(local_468);
    if (BVar2 != 0) {
      if (*param_1 == L'\\') {
        BVar2 = PathIsUNCServerShareW(local_468);
        if (BVar2 == 0) goto LAB_1400094b4;
      }
      uVar8 = 0;
      FUN_14000ce30((undefined (*) [16])local_258,0,0x20a);
      FUN_14000b198((short *)(undefined (*) [16])local_258,(longlong)local_678,0x104);
      local_680 = (short *)0x0;
      lpFileName = FUN_14001530c((short *)(undefined (*) [16])local_258,L"\\",&local_680);
      if (lpFileName != (LPCWSTR)0x0) {
        pcVar6 = PathAppendW_exref;
        uVar7 = 0;
        do {
          DVar1 = GetFileAttributesW(lpFileName);
          uVar8 = uVar7;
          if ((DVar1 >> 10 & 1) != 0) {
            hDevice = CreateFileW(lpFileName,0,7,(LPSECURITY_ATTRIBUTES)0x0,3,0x2200000,(HANDLE)0x0)
            ;
            if (hDevice == (HANDLE)0xffffffffffffffff) {
              DVar1 = GetLastError();
              uVar8 = uVar7 & 0xffffff00 | (uint)(DVar1 != 2);
              bVar9 = true;
            }
            else {
              lpOutBuffer = (undefined (*) [16])operator_new(0x4000);
              FUN_14000ce30(lpOutBuffer,0,0x4000);
              local_684 = 0;
              BVar2 = DeviceIoControl(hDevice,0x900a8,(LPVOID)0x0,0,lpOutBuffer,0x4000,&local_684,
                                      (LPOVERLAPPED)0x0);
              uVar8 = 0x40031301;
              bVar9 = true;
              if (BVar2 != 0) {
                if (*(int *)*lpOutBuffer == -0x5ffffff4) {
                  if (4 < *(ushort *)(*lpOutBuffer + 10)) {
                    _Str1 = (wchar_t *)
                            (lpOutBuffer[1] +
                            (ulonglong)(*(ushort *)(*lpOutBuffer + 8) & 0xfffffffe) + 4);
                    goto LAB_14000969c;
                  }
LAB_140009688:
                  uVar8 = 0;
                }
                else if (*(int *)*lpOutBuffer == -0x5ffffffd) {
                  if (*(ushort *)(*lpOutBuffer + 10) < 5) goto LAB_140009688;
                  _Str1 = (wchar_t *)(lpOutBuffer[1] + (*(ushort *)(*lpOutBuffer + 8) & 0xfffffffe))
                  ;
LAB_14000969c:
                  iVar3 = wcsncmp(_Str1,L"\\??\\",4);
                  bVar9 = iVar3 != 0;
                  uVar8 = uVar7 & 0xffffff00 | (uint)(byte)((byte)uVar7 | bVar9);
                }
              }
              thunk_FUN_140013ed8(lpOutBuffer);
            }
            if (1 < (longlong)hDevice + 1U) {
              CloseHandle(hDevice);
            }
            pcVar6 = PathAppendW_exref;
            if (bVar9) goto LAB_140009714;
          }
          psVar5 = FUN_14001530c((short *)0x0,L"\\",&local_680);
          (*pcVar6)(lpFileName);
          uVar7 = uVar8;
        } while (psVar5 != (short *)0x0);
        uVar8 = 0;
      }
LAB_140009714:
      uVar8 = uVar8 ^ 1;
      goto LAB_1400094b6;
    }
  }
LAB_1400094b4:
  uVar8 = 0;
LAB_1400094b6:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY_6d8);
  return uVar8;
}



BOOL FUN_140009720(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3)

{
  BOOL BVar1;
  size_t sVar2;
  
  sVar2 = wcslen(param_2);
  if (sVar2 < 0x105) {
    FUN_14000b198(param_1,(longlong)param_2,0x105);
    BVar1 = PathRemoveFileSpecW(param_1);
    if (BVar1 != 0) {
      BVar1 = FUN_140028000(param_1,param_3);
      return BVar1;
    }
  }
  return 0;
}



undefined8 FUN_140009780(wchar_t *param_1)

{
  wchar_t *pv;
  int iVar1;
  BOOL BVar2;
  DWORD DVar3;
  size_t sVar4;
  undefined8 uVar5;
  undefined auStack_48 [32];
  wchar_t *local_28;
  ulonglong local_20;
  
  local_20 = DAT_140038010 ^ (ulonglong)auStack_48;
  uVar5 = 0;
  iVar1 = SHGetKnownFolderPath(&DAT_140029028,0x8000,0,&local_28);
  pv = local_28;
  if (-1 < iVar1) {
    sVar4 = wcslen(local_28);
    if (sVar4 < 0x105) {
      FUN_14000b198(param_1,(longlong)pv,0x105);
      CoTaskMemFree(local_28);
      BVar2 = FUN_140028000(param_1,L"Mozilla Maintenance Service");
      if (BVar2 != 0) {
        BVar2 = CreateDirectoryW(param_1,(LPSECURITY_ATTRIBUTES)0x0);
        if (BVar2 == 0) {
          DVar3 = GetLastError();
          uVar5 = 0;
          if (DVar3 != 0xb7) goto LAB_1400097d6;
        }
        BVar2 = FUN_140028000(param_1,L"UpdateLogs");
        uVar5 = 0;
        if (BVar2 != 0) {
          uVar5 = 0;
          BVar2 = CreateDirectoryW(param_1,(LPSECURITY_ATTRIBUTES)0x0);
          if (BVar2 == 0) {
            DVar3 = GetLastError();
            if (DVar3 != 0xb7) goto LAB_1400097d6;
          }
          uVar5 = 1;
        }
      }
    }
    else {
      CoTaskMemFree(pv);
    }
  }
LAB_1400097d6:
  __security_check_cookie(local_20 ^ (ulonglong)auStack_48);
  return uVar5;
}



undefined8 FUN_140009880(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3)

{
  int iVar1;
  BOOL BVar2;
  size_t sVar3;
  size_t _Count;
  undefined8 uVar4;
  
  sVar3 = wcslen(param_1);
  uVar4 = 0;
  if (0xffffffffffffff04 < sVar3 - 0x105) {
    iVar1 = FUN_140013348((wint_t *)(param_1 + (sVar3 - 10)),(wint_t *)L"\\updates\\0",10);
    if (iVar1 == 0) {
      FUN_14000b198(param_3,(longlong)param_1,0x105);
      BVar2 = PathRemoveFileSpecW(param_3);
      if (BVar2 != 0) {
        BVar2 = PathRemoveFileSpecW(param_3);
        uVar4 = 0;
        if (BVar2 != 0) {
          PathStripPathW(param_3);
          sVar3 = wcslen(param_3);
          _Count = wcslen(param_2);
          if (sVar3 + _Count < 0x105) {
            wcsncat(param_3,param_2,_Count);
            uVar4 = 1;
          }
        }
      }
    }
  }
  return uVar4;
}



BOOL FUN_140009940(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined auStack_268 [32];
  wchar_t local_248 [268];
  ulonglong local_30;
  
  local_30 = DAT_140038010 ^ (ulonglong)auStack_268;
  uVar2 = FUN_140009780(param_3);
  BVar1 = 0;
  if ((int)uVar2 != 0) {
    FUN_14000ce30((undefined (*) [16])local_248,0,0x20a);
    uVar2 = FUN_140009880(param_1,param_2,(wchar_t *)(undefined (*) [16])local_248);
    BVar1 = 0;
    if ((int)uVar2 != 0) {
      BVar1 = FUN_140028000(param_3,local_248);
    }
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack_268);
  return BVar1;
}



bool FUN_1400099d0(wchar_t *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  BOOL BVar1;
  int iVar2;
  undefined8 uVar3;
  FILE *pFVar4;
  bool bVar5;
  undefined auStack_678 [32];
  wchar_t local_658 [264];
  undefined local_448 [528];
  wchar_t local_238 [268];
  ulonglong local_20;
  
  local_20 = DAT_140038010 ^ (ulonglong)auStack_678;
  bVar5 = false;
  FUN_14000ce30((undefined (*) [16])local_448,0,0x20a);
  uVar3 = FUN_140028050((short *)(undefined (*) [16])local_448);
  if ((int)uVar3 != 0) {
    bVar5 = false;
    FUN_14000ce30((undefined (*) [16])local_658,0,0x20a);
    uVar3 = FUN_140009780((wchar_t *)(undefined (*) [16])local_658);
    if ((int)uVar3 != 0) {
      bVar5 = false;
      FUN_14000ce30((undefined (*) [16])local_238,0,0x20a);
      uVar3 = FUN_140009880(param_1,L".id",(wchar_t *)(undefined (*) [16])local_238);
      if ((int)uVar3 != 0) {
        BVar1 = FUN_140028000(local_658,local_238);
        if (BVar1 != 0) {
          pFVar4 = FUN_14001351c(local_658,L"wb+");
          if (pFVar4 != (FILE *)0x0) {
            iVar2 = FUN_1400013f0((longlong)pFVar4,(longlong)&DAT_140030e21,local_448,param_4);
            bVar5 = iVar2 != -1;
            FUN_140013618(pFVar4);
          }
        }
      }
    }
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack_678);
  return bVar5;
}



void FUN_140009ae0(wchar_t *param_1)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined auStack_458 [32];
  wchar_t local_438 [264];
  wchar_t local_228 [264];
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStack_458;
  FUN_14000ce30((undefined (*) [16])local_438,0,0x20a);
  uVar2 = FUN_140009780((wchar_t *)(undefined (*) [16])local_438);
  if ((int)uVar2 != 0) {
    FUN_14000ce30((undefined (*) [16])local_228,0,0x20a);
    uVar2 = FUN_140009880(param_1,L".id",(wchar_t *)(undefined (*) [16])local_228);
    if ((int)uVar2 != 0) {
      BVar1 = FUN_140028000(local_438,local_228);
      if (BVar1 != 0) {
        FID_conflict__wrmdir(local_438);
      }
    }
  }
  uVar2 = FUN_140009780(local_438);
  if ((int)uVar2 != 0) {
    FUN_14000ce30((undefined (*) [16])local_228,0,0x20a);
    uVar2 = FUN_140009880(param_1,L".status",(wchar_t *)(undefined (*) [16])local_228);
    if ((int)uVar2 != 0) {
      BVar1 = FUN_140028000(local_438,local_228);
      if (BVar1 != 0) {
        FID_conflict__wrmdir(local_438);
      }
    }
  }
  uVar2 = FUN_140009780(local_438);
  if ((int)uVar2 != 0) {
    FUN_14000ce30((undefined (*) [16])local_228,0,0x20a);
    uVar2 = FUN_140009880(param_1,L".log",(wchar_t *)(undefined (*) [16])local_228);
    if ((int)uVar2 != 0) {
      BVar1 = FUN_140028000(local_438,local_228);
      if (BVar1 != 0) {
        FID_conflict__wrmdir(local_438);
      }
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack_458);
  return;
}



// WARNING: Could not reconcile some variable overlaps

BOOL FUN_140009c70(wchar_t *param_1)

{
  wchar_t *_Str;
  BOOL BVar1;
  DWORD DVar2;
  BOOL BVar3;
  SC_HANDLE hSCManager;
  SC_HANDLE hService;
  LPQUERY_SERVICE_CONFIGW lpServiceConfig;
  size_t sVar4;
  undefined8 uVar5;
  undefined auStackY_5b8 [32];
  undefined local_568 [16];
  undefined8 local_558;
  undefined local_548 [16];
  undefined local_538 [16];
  undefined local_528 [16];
  undefined local_518 [16];
  undefined local_508 [16];
  undefined local_4f8 [16];
  HANDLE local_4e8;
  uint local_4dc;
  undefined local_4d8 [16];
  undefined local_4c8 [16];
  undefined local_4b8 [16];
  undefined local_4a8 [16];
  undefined local_498 [16];
  undefined local_488 [16];
  undefined local_478 [16];
  undefined local_468 [16];
  undefined local_458 [528];
  WCHAR local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStackY_5b8;
  hSCManager = OpenSCManagerA((LPCSTR)0x0,(LPCSTR)0x0,0xf003f);
  BVar1 = 0;
  if (hSCManager != (SC_HANDLE)0x0) {
    hService = OpenServiceW(hSCManager,L"MozillaMaintenance",0xf01ff);
    CloseServiceHandle(hSCManager);
    BVar1 = 0;
    if (hService != (SC_HANDLE)0x0) {
      BVar1 = QueryServiceConfigW(hService,(LPQUERY_SERVICE_CONFIGW)0x0,0,&local_4dc);
      if (BVar1 == 0) {
        DVar2 = GetLastError();
        if (DVar2 != 0x7a) {
          CloseServiceHandle(hService);
          BVar1 = 0;
          goto LAB_140009db2;
        }
      }
      lpServiceConfig = (LPQUERY_SERVICE_CONFIGW)operator_new((ulonglong)local_4dc);
      FUN_14000ce30((undefined (*) [16])lpServiceConfig,0,(ulonglong)local_4dc);
      BVar3 = QueryServiceConfigW(hService,lpServiceConfig,local_4dc,&local_4dc);
      CloseServiceHandle(hService);
      BVar1 = 0;
      if (BVar3 != 0) {
        PathUnquoteSpacesW(lpServiceConfig->lpBinaryPathName);
        BVar1 = 0;
        FUN_14000ce30((undefined (*) [16])local_248,0,0x20a);
        _Str = lpServiceConfig->lpBinaryPathName;
        sVar4 = wcslen(_Str);
        if (sVar4 < 0x105) {
          FUN_14000b198(local_248,(longlong)_Str,0x105);
          BVar3 = PathRemoveFileSpecW(local_248);
          if (BVar3 != 0) {
            BVar3 = FUN_140028000(local_248,L"maintenanceservice_tmp.exe");
            if (BVar3 != 0) {
              sVar4 = wcslen(param_1);
              if (sVar4 < 0x105) {
                FUN_14000ce30((undefined (*) [16])local_458,0,0x20a);
                FUN_14000b198((short *)(undefined (*) [16])local_458,(longlong)param_1,0x104);
                FUN_140028000((wchar_t *)(undefined (*) [16])local_458,L"maintenanceservice.exe");
                BVar3 = CopyFileW((LPCWSTR)(undefined (*) [16])local_458,local_248,0);
                BVar1 = 0;
                if (BVar3 != 0) {
                  uVar5 = FUN_140008420(param_1,local_248,1);
                  if ((int)uVar5 == 0) {
                    DeleteFileW(local_248);
                    BVar1 = 0;
                  }
                  else {
                    local_4f8 = ZEXT816(0);
                    local_508 = ZEXT816(0);
                    local_518 = ZEXT816(0);
                    local_528 = ZEXT816(0);
                    local_4e8 = (HANDLE)0x0;
                    local_548 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x68);
                    local_538 = ZEXT816(0x1400313d0);
                    local_558 = 0;
                    local_568 = ZEXT816(0);
                    local_468 = ZEXT816(0);
                    local_478 = ZEXT816(0);
                    local_488 = ZEXT816(0);
                    local_498 = ZEXT816(0);
                    local_4a8 = ZEXT816(0);
                    local_4b8 = ZEXT816(0);
                    local_4c8 = ZEXT816(0);
                    local_4d8 = ZEXT816(0);
                    FUN_14000b198((short *)local_4d8,(longlong)L"dummyparam.exe upgrade",0x3f);
                    BVar1 = CreateProcessW(local_248,(LPWSTR)local_4d8,(LPSECURITY_ATTRIBUTES)0x0,
                                           (LPSECURITY_ATTRIBUTES)0x0,0,0,(LPVOID)0x0,param_1,
                                           (LPSTARTUPINFOW)local_548,
                                           (LPPROCESS_INFORMATION)local_568);
                    if (BVar1 != 0) {
                      CloseHandle(local_568._0_8_);
                      CloseHandle(local_568._8_8_);
                    }
                  }
                }
              }
            }
          }
        }
      }
      thunk_FUN_140013ed8(lpServiceConfig);
    }
  }
LAB_140009db2:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY_5b8);
  return BVar1;
}



uint FUN_140009f70(LPCWSTR param_1,int param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  SC_HANDLE hSCManager;
  SC_HANDLE hService;
  uint uVar3;
  uint uVar4;
  undefined auStackY_a8 [32];
  DWORD local_74;
  BYTE local_70 [4];
  uint local_6c;
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStackY_a8;
  hSCManager = OpenSCManagerA((LPCSTR)0x0,(LPCSTR)0x0,5);
  if (hSCManager == (SC_HANDLE)0x0) {
    DVar2 = GetLastError();
    uVar3 = 0xfd;
    if (DVar2 != 5) {
      uVar3 = DVar2 == 0x429 ^ 0xff;
    }
  }
  else {
    hService = OpenServiceW(hSCManager,param_1,4);
    if (hService == (SC_HANDLE)0x0) {
      DVar2 = GetLastError();
      CloseServiceHandle(hSCManager);
      if ((int)DVar2 < 0x7b) {
        if (DVar2 == 5) {
          uVar3 = 0xeb;
          goto LAB_14000a15d;
        }
        if (DVar2 == 6) {
          uVar3 = 0xec;
          goto LAB_14000a15d;
        }
      }
      else {
        if (DVar2 == 0x7b) {
          uVar3 = 0xed;
          goto LAB_14000a15d;
        }
        if (DVar2 == 0x424) {
          uVar3 = 0xee;
          goto LAB_14000a15d;
        }
      }
      uVar3 = 0xef;
    }
    else {
      local_6c = 0xcf;
      if (param_2 * 1000 == 0) {
        uVar3 = 0xcf;
      }
      else {
        uVar4 = 0;
        do {
          BVar1 = QueryServiceStatusEx(hService,SC_STATUS_PROCESS_INFO,local_70,0x24,&local_74);
          if (BVar1 == 0) {
            DVar2 = GetLastError();
            if ((int)DVar2 < 0x425) {
              if ((int)DVar2 < 0x7a) {
                if (DVar2 == 5) {
                  local_6c = 0xda;
                  uVar3 = local_6c;
                  break;
                }
                if (DVar2 == 6) {
                  local_6c = 0xd9;
                  uVar3 = local_6c;
                  break;
                }
                if (DVar2 == 0x57) {
                  local_6c = 0xdc;
                  uVar3 = local_6c;
                  break;
                }
              }
              else {
                if (DVar2 == 0x41c) goto LAB_14000a054;
                if (DVar2 == 0x7a) {
                  local_6c = 0xdb;
                  uVar3 = local_6c;
                  break;
                }
                if (DVar2 == 0x7c) {
                  local_6c = 0xdd;
                  uVar3 = local_6c;
                  break;
                }
              }
            }
            else {
              if (DVar2 - 0x425 < 2) goto LAB_14000a054;
              if (DVar2 == 0x45b) {
                local_6c = 0xde;
                uVar3 = local_6c;
                break;
              }
            }
            local_6c = 0xdf;
            uVar3 = local_6c;
            break;
          }
          if (local_6c == 1) {
            uVar3 = 1;
            break;
          }
LAB_14000a054:
          Sleep(0x32);
          uVar4 = uVar4 + 0x32;
          uVar3 = local_6c;
        } while (uVar4 < (uint)(param_2 * 1000));
      }
      CloseServiceHandle(hService);
      CloseServiceHandle(hSCManager);
    }
  }
LAB_14000a15d:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY_a8);
  return uVar3;
}



bool FUN_14000a180(wchar_t *param_1,uint param_2)

{
  BOOL BVar1;
  undefined8 uVar2;
  HANDLE hFile;
  size_t sVar3;
  bool bVar4;
  undefined8 uVar5;
  undefined auStackY_488 [32];
  DWORD local_44c;
  wchar_t local_448 [264];
  wchar_t local_238 [264];
  ulonglong local_28;
  
  local_28 = DAT_140038010 ^ (ulonglong)auStackY_488;
  bVar4 = false;
  FUN_14000ce30((undefined (*) [16])local_448,0,0x20a);
  uVar2 = FUN_140009780((wchar_t *)(undefined (*) [16])local_448);
  if ((int)uVar2 != 0) {
    bVar4 = false;
    FUN_14000ce30((undefined (*) [16])local_238,0,0x20a);
    uVar2 = FUN_140009880(param_1,L".status",(wchar_t *)(undefined (*) [16])local_238);
    if ((int)uVar2 != 0) {
      BVar1 = FUN_140028000(local_448,local_238);
      if (BVar1 != 0) {
        bVar4 = false;
        uVar2 = 0x40000000;
        uVar5 = 0;
        hFile = CreateFileW(local_448,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0,(HANDLE)0x0);
        if (hFile != (HANDLE)0xffffffffffffffff) {
          FUN_140027f90((undefined *)local_238,uVar2,(ulonglong)param_2,uVar5);
          sVar3 = strlen((char *)local_238);
          BVar1 = WriteFile(hFile,local_238,(DWORD)sVar3,&local_44c,(LPOVERLAPPED)0x0);
          CloseHandle(hFile);
          bVar4 = local_44c == (DWORD)sVar3 && BVar1 != 0;
        }
      }
    }
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStackY_488);
  return bVar4;
}



undefined8 FUN_14000a2d0(wint_t *param_1,int param_2)

{
  int iVar1;
  DWORD DVar2;
  HANDLE hObject;
  int iVar3;
  undefined8 uVar4;
  undefined auStack_2a8 [40];
  undefined4 local_280;
  wint_t local_254 [262];
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStack_2a8;
  uVar4 = 0x102;
  if (param_2 != 0) {
    iVar3 = 0;
    do {
      hObject = (HANDLE)CreateToolhelp32Snapshot(2,0);
      if (hObject == (HANDLE)0xffffffffffffffff) {
        DVar2 = GetLastError();
      }
      else {
        local_280 = 0x238;
        iVar1 = Process32FirstW(hObject);
        if (iVar1 == 0) {
          DVar2 = GetLastError();
        }
        else {
          do {
            iVar1 = FUN_140012f6c(param_1,local_254);
            if (iVar1 == 0) {
              DVar2 = 0;
              goto LAB_14000a382;
            }
            iVar1 = Process32NextW(hObject);
          } while (iVar1 != 0);
          DVar2 = 0x490;
        }
LAB_14000a382:
        CloseHandle(hObject);
      }
      if (DVar2 == 0x490) {
        uVar4 = 0;
        goto LAB_14000a3af;
      }
      Sleep(1000);
      iVar3 = iVar3 + 1;
    } while (iVar3 != param_2);
    uVar4 = 0x102;
  }
LAB_14000a3af:
  __security_check_cookie(local_48 ^ (ulonglong)auStack_2a8);
  return uVar4;
}



bool FUN_14000a3e0(void)

{
  LSTATUS LVar1;
  undefined auStackY_48 [32];
  HKEY local_18;
  ulonglong local_10;
  
  local_10 = DAT_140038010 ^ (ulonglong)auStackY_48;
  LVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                        L"SOFTWARE\\Mozilla\\MaintenanceService\\3932ecacee736d366d6436db0f55bce4",0
                        ,0x20119,&local_18);
  if (LVar1 == 0) {
    RegCloseKey(local_18);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStackY_48);
  return LVar1 == 0;
}



bool FUN_14000a450(wchar_t *param_1,uint *param_2)

{
  UINT UVar1;
  size_t sVar2;
  undefined auStack_258 [32];
  WCHAR local_238 [268];
  ulonglong local_20;
  
  local_20 = DAT_140038010 ^ (ulonglong)auStack_258;
  FUN_14000ce30((undefined (*) [16])local_238,0,0x20a);
  sVar2 = wcslen(param_1);
  if (sVar2 < 0x105) {
    FUN_14000b198(local_238,(longlong)param_1,0x104);
    PathStripToRootW(local_238);
    UVar1 = GetDriveTypeW(local_238);
    *param_2 = (uint)(UVar1 == 3);
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack_258);
  return sVar2 < 0x105;
}



ulonglong FUN_14000a4f0(void *param_1,wchar_t **param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  HLOCAL pvData;
  PCCERT_CONTEXT pCertContext;
  wchar_t *pszNameString;
  char *pcVar5;
  ulonglong uVar6;
  undefined8 uVar7;
  HLOCAL pvVar8;
  undefined auStackY_178 [32];
  undefined local_120 [8];
  undefined4 local_118;
  undefined4 uStack_114;
  undefined4 uStack_110;
  undefined4 uStack_10c;
  undefined4 local_f0;
  undefined4 uStack_ec;
  undefined4 uStack_e8;
  undefined4 uStack_e4;
  uint local_50;
  DWORD local_4c;
  DWORD local_48;
  DWORD local_44;
  HCRYPTMSG local_40;
  HCERTSTORE local_38;
  ulonglong local_30;
  
  local_30 = DAT_140038010 ^ (ulonglong)auStackY_178;
  local_38 = (HCERTSTORE)0x0;
  local_40 = (HCRYPTMSG)0x0;
  uVar7 = 0x3ffe;
  BVar1 = CryptQueryObject(1,param_1,0x400,0x3ffe,0,&local_44,&local_48,&local_4c,&local_38,
                           &local_40,(void **)0x0);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    uVar6 = (ulonglong)DVar2;
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    pcVar5 = "CryptQueryObject failed.  (%lu)";
  }
  else {
    uVar7 = 0;
    BVar1 = CryptMsgGetParam(local_40,6,0,(void *)0x0,&local_50);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      uVar6 = (ulonglong)DVar2;
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar5 = "CryptMsgGetParam failed.  (%lu)";
    }
    else {
      pvData = LocalAlloc(0x40,(ulonglong)local_50);
      if (pvData != (HLOCAL)0x0) {
        pvVar8 = pvData;
        BVar1 = CryptMsgGetParam(local_40,6,0,pvData,&local_50);
        if (BVar1 == 0) {
          uVar4 = GetLastError();
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          pcVar5 = "CryptMsgGetParam failed.  (%lu)";
        }
        else {
          local_f0 = *(undefined4 *)((longlong)pvData + 8);
          uStack_ec = *(undefined4 *)((longlong)pvData + 0xc);
          uStack_e8 = *(undefined4 *)((longlong)pvData + 0x10);
          uStack_e4 = *(undefined4 *)((longlong)pvData + 0x14);
          local_118 = *(undefined4 *)((longlong)pvData + 0x18);
          uStack_114 = *(undefined4 *)((longlong)pvData + 0x1c);
          uStack_110 = *(undefined4 *)((longlong)pvData + 0x20);
          uStack_10c = *(undefined4 *)((longlong)pvData + 0x24);
          pvVar8 = (HLOCAL)0xb0000;
          pCertContext = CertFindCertificateInStore
                                   (local_38,0x10001,0,0xb0000,local_120,(PCCERT_CONTEXT)0x0);
          if (pCertContext != (PCCERT_CONTEXT)0x0) {
            if (param_2[1] == (wchar_t *)0x0) {
LAB_14000a6ef:
              if (*param_2 != (wchar_t *)0x0) {
                uVar7 = 0;
                DVar2 = CertGetNameStringA(pCertContext,4,0,(void *)0x0,(LPSTR)0x0,0);
                if (DVar2 == 0) goto LAB_14000a928;
                pszNameString = (wchar_t *)LocalAlloc(0x40,(ulonglong)DVar2 * 2);
                if (pszNameString == (wchar_t *)0x0) {
                  if (*(int *)(*(longlong *)
                                ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                              4) < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  uVar4 = GetLastError();
                  pcVar5 = "Unable to allocate memory for subject name.  (%lu)";
                  goto LAB_14000aa29;
                }
                uVar7 = 0;
                DVar2 = CertGetNameStringW(pCertContext,4,0,(void *)0x0,pszNameString,DVar2);
                if (DVar2 == 0) goto LAB_14000a9a4;
                if (*param_2 != (wchar_t *)0x0) {
                  iVar3 = wcscmp(pszNameString,*param_2);
                  if (iVar3 == 0) {
                    LocalFree(pszNameString);
                    goto LAB_14000a78e;
                  }
                }
LAB_14000a9e5:
                LocalFree(pszNameString);
                goto LAB_14000aa31;
              }
LAB_14000a78e:
              uVar6 = 0;
            }
            else {
              uVar7 = 0;
              DVar2 = CertGetNameStringA(pCertContext,4,1,(void *)0x0,(LPSTR)0x0,0);
              if (DVar2 == 0) {
LAB_14000a928:
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                uVar4 = GetLastError();
                pcVar5 = "CertGetNameString failed.  (%lu)";
              }
              else {
                pszNameString = (wchar_t *)LocalAlloc(0x40,(ulonglong)DVar2 * 2);
                if (pszNameString != (wchar_t *)0x0) {
                  uVar7 = 0;
                  DVar2 = CertGetNameStringW(pCertContext,4,1,(void *)0x0,pszNameString,DVar2);
                  if (DVar2 != 0) {
                    if (param_2[1] != (wchar_t *)0x0) {
                      iVar3 = wcscmp(pszNameString,param_2[1]);
                      if (iVar3 == 0) {
                        LocalFree(pszNameString);
                        goto LAB_14000a6ef;
                      }
                    }
                    goto LAB_14000a9e5;
                  }
LAB_14000a9a4:
                  if (*(int *)(*(longlong *)
                                ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                              4) < DAT_14003a328) {
                    _Init_thread_header(&DAT_14003a328);
                    if (DAT_14003a328 == -1) {
                      DAT_14003a118 = 0;
                      atexit(FUN_140002780);
                      _Init_thread_footer(&DAT_14003a328);
                    }
                  }
                  DVar2 = GetLastError();
                  FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)"CertGetNameString failed.  (%lu)"
                                ,(ulonglong)DVar2,uVar7);
                  goto LAB_14000a9e5;
                }
                if (*(int *)(*(longlong *)
                              ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
                    < DAT_14003a328) {
                  _Init_thread_header(&DAT_14003a328);
                  if (DAT_14003a328 == -1) {
                    DAT_14003a118 = 0;
                    atexit(FUN_140002780);
                    _Init_thread_footer(&DAT_14003a328);
                  }
                }
                uVar4 = GetLastError();
                pcVar5 = "Unable to allocate memory for issuer name.  (%lu)";
              }
LAB_14000aa29:
              FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar5,(ulonglong)uVar4,uVar7);
LAB_14000aa31:
              if (*(int *)(*(longlong *)
                            ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
                  DAT_14003a328) {
                _Init_thread_header(&DAT_14003a328);
                if (DAT_14003a328 == -1) {
                  DAT_14003a118 = 0;
                  atexit(FUN_140002780);
                  _Init_thread_footer(&DAT_14003a328);
                }
              }
              uVar6 = 0x490;
              FUN_140008ff0((FILE **)&DAT_14003a118,
                            (longlong)"Certificate did not match issuer or name.  (%lu)",0x490,uVar7
                           );
            }
            LocalFree(pvData);
            CertFreeCertificateContext(pCertContext);
            goto LAB_14000a852;
          }
          uVar4 = GetLastError();
          if (*(int *)(*(longlong *)
                        ((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
              DAT_14003a328) {
            _Init_thread_header(&DAT_14003a328);
            if (DAT_14003a328 == -1) {
              DAT_14003a118 = 0;
              atexit(FUN_140002780);
              _Init_thread_footer(&DAT_14003a328);
            }
          }
          pcVar5 = "CertFindCertificateInStore failed.  (%lu)";
        }
        uVar6 = (ulonglong)uVar4;
        FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar5,uVar6,pvVar8);
        LocalFree(pvData);
        goto LAB_14000a852;
      }
      DVar2 = GetLastError();
      uVar6 = (ulonglong)DVar2;
      if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) +
                  4) < DAT_14003a328) {
        _Init_thread_header(&DAT_14003a328);
        if (DAT_14003a328 == -1) {
          DAT_14003a118 = 0;
          atexit(FUN_140002780);
          _Init_thread_footer(&DAT_14003a328);
        }
      }
      pcVar5 = "Unable to allocate memory for Signer Info.  (%lu)";
    }
  }
  FUN_140008ff0((FILE **)&DAT_14003a118,(longlong)pcVar5,uVar6,uVar7);
LAB_14000a852:
  if (local_38 != (HCERTSTORE)0x0) {
    CertCloseStore(local_38,0);
  }
  if (local_40 != (HCRYPTMSG)0x0) {
    CryptMsgClose(local_40);
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStackY_178);
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

uint FUN_14000ad20(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  undefined auStack_d8 [32];
  DWORD local_b8;
  undefined4 local_a8;
  undefined4 uStack_a4;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined4 uStack_90;
  undefined4 uStack_8c;
  undefined local_88 [16];
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68;
  undefined8 uStack_60;
  undefined local_58 [16];
  undefined local_48 [16];
  GUID local_38;
  ulonglong local_20;
  
  local_20 = DAT_140038010 ^ (ulonglong)auStack_d8;
  local_48 = ZEXT816(0);
  local_58 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x20);
  local_58 = CONCAT88(param_1,local_58._0_8_);
  uStack_a4 = 0;
  uStack_8c = 0;
  uStack_60 = 0;
  local_78 = 0;
  local_a8 = 0x50;
  uStack_a0 = 0;
  local_98 = 0;
  uStack_90 = 2;
  local_88 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),1);
  uStack_70 = 0;
  local_68 = 0;
  local_88 = CONCAT88(local_58,local_88._0_8_);
  local_38.Data1 = 0xaac56b;
  local_38._4_4_ = 0x11d0cd44;
  local_38.Data4._0_4_ = 0xc000c28c;
  local_38.Data4._4_4_ = 0xee95c24f;
  uVar1 = WinVerifyTrust((HWND)0x0,&local_38,&local_a8);
  if (uVar1 == 0) {
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    FUN_140008ee0((FILE **)&DAT_14003a118,
                  (longlong)"The file \"%ls\" is signed and the signature was verified.",param_1,
                  param_4);
  }
  else {
    local_b8 = GetLastError();
    if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4)
        < DAT_14003a328) {
      _Init_thread_header(&DAT_14003a328);
      if (DAT_14003a328 == -1) {
        DAT_14003a118 = 0;
        atexit(FUN_140002780);
        _Init_thread_footer(&DAT_14003a328);
      }
    }
    FUN_140008ff0((FILE **)&DAT_14003a118,
                  (longlong)
                  "There was an error validating trust of the certificate for file \"%ls\". Returned: %ld.  (%lu)"
                  ,param_1,(ulonglong)uVar1);
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack_d8);
  return uVar1;
}



void common_vsprintf__(ulonglong param_1,undefined *param_2,longlong param_3,longlong param_4,
                      __crt_locale_pointers *param_5,undefined8 param_6)

{
  int iVar1;
  ulong *puVar2;
  undefined auStack_528 [32];
  undefined *puStack_508;
  longlong lStack_500;
  longlong lStack_4f8;
  undefined uStack_4f0;
  longlong lStack_4e8;
  undefined auStack_4e0 [16];
  char cStack_4d0;
  ulonglong uStack_4c8;
  undefined *puStack_4c0;
  undefined8 uStack_4b8;
  longlong lStack_4b0;
  undefined8 uStack_4a8;
  undefined8 uStack_4a0;
  undefined8 uStack_498;
  undefined4 uStack_490;
  undefined2 uStack_488;
  undefined4 uStack_478;
  undefined uStack_474;
  undefined8 uStack_70;
  LPVOID pvStack_68;
  undefined **ppuStack_60;
  undefined4 uStack_58;
  ulonglong uStack_48;
  
  uStack_48 = DAT_140038010 ^ (ulonglong)auStack_528;
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (undefined *)0x0)))) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    goto LAB_14000da56;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&lStack_4e8,param_5);
  FUN_14000ce30((undefined (*) [16])&puStack_508,0,0x20);
  lStack_4f8 = 0;
  if (((param_1 & 2) != 0) || (uStack_4f0 = 0, param_2 == (undefined *)0x0)) {
    uStack_4f0 = 1;
  }
  ppuStack_60 = &puStack_508;
  uStack_4b8 = 0;
  puStack_4c0 = auStack_4e0;
  uStack_4a0 = 0;
  uStack_4a8 = param_6;
  uStack_498 = 0;
  uStack_490 = 0;
  uStack_488 = 0;
  uStack_478 = 0;
  uStack_474 = 0;
  uStack_70 = 0;
  pvStack_68 = (LPVOID)0x0;
  uStack_58 = 0;
  puStack_508 = param_2;
  lStack_500 = param_3;
  uStack_4c8 = param_1;
  lStack_4b0 = param_4;
  iVar1 = FUN_14000ee58(&uStack_4c8);
  if (param_2 != (undefined *)0x0) {
    if ((param_1 & 1) == 0) {
      if ((param_1 & 2) == 0) {
        if (param_3 != 0) {
          if (lStack_4f8 != param_3) goto LAB_14000da2a;
LAB_14000da90:
          param_2[param_3 + -1] = 0;
        }
      }
      else if (param_3 != 0) {
        if (-1 < iVar1) {
          if (lStack_4f8 == param_3) goto LAB_14000da90;
          goto LAB_14000da2a;
        }
        *param_2 = 0;
      }
    }
    else if (((param_3 != 0) || (iVar1 == 0)) && (lStack_4f8 != param_3)) {
LAB_14000da2a:
      param_2[lStack_4f8] = 0;
    }
  }
  _free_base(pvStack_68);
  pvStack_68 = (LPVOID)0x0;
  if (cStack_4d0 != '\0') {
    *(uint *)(lStack_4e8 + 0x3a8) = *(uint *)(lStack_4e8 + 0x3a8) & 0xfffffffd;
  }
LAB_14000da56:
  __security_check_cookie(uStack_48 ^ (ulonglong)auStack_528);
  return;
}



void * __cdecl operator_new(__uint64 param_1)

{
  code *pcVar1;
  int iVar2;
  LPVOID pvVar3;
  void *pvVar4;
  
  do {
    pvVar3 = _malloc_base(param_1);
    if (pvVar3 != (LPVOID)0x0) {
      return pvVar3;
    }
    iVar2 = _callnewh(param_1);
  } while (iVar2 != 0);
  if (param_1 == 0xffffffffffffffff) {
    FUN_14000bda8();
    pcVar1 = (code *)swi(3);
    pvVar4 = (void *)(*pcVar1)();
    return pvVar4;
  }
  FUN_14000bd88();
  pcVar1 = (code *)swi(3);
  pvVar4 = (void *)(*pcVar1)();
  return pvVar4;
}



// Library Function - Single Match
//  wcspbrk
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

wchar_t * __cdecl wcspbrk(wchar_t *_Str,wchar_t *_Control)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  
  do {
    if (*_Str == L'\0') {
      return (wchar_t *)0x0;
    }
    if (*_Control != L'\0') {
      wVar1 = *_Control;
      pwVar2 = _Control;
      do {
        if (wVar1 == *_Str) {
          return _Str;
        }
        pwVar2 = pwVar2 + 1;
        wVar1 = *pwVar2;
      } while (wVar1 != L'\0');
    }
    _Str = _Str + 1;
  } while( true );
}



longlong FUN_14000af20(longlong param_1,short *param_2)

{
  short sVar1;
  longlong lVar2;
  
  lVar2 = param_1 - (longlong)param_2;
  do {
    sVar1 = *param_2;
    *(short *)(lVar2 + (longlong)param_2) = sVar1;
    param_2 = param_2 + 1;
  } while (sVar1 != 0);
  return param_1;
}



// Library Function - Single Match
//  wcschr
// 
// Library: Visual Studio 2017 Release

wchar_t * __cdecl wcschr(wchar_t *_Str,wchar_t _Ch)

{
  uint uVar1;
  ushort uVar2;
  longlong lVar3;
  wchar_t *pwVar4;
  undefined in_XMM1 [16];
  undefined auVar5 [16];
  undefined auVar6 [16];
  wchar_t wVar7;
  wchar_t wVar8;
  
  auVar5 = pshuflw(in_XMM1,ZEXT216((ushort)_Ch),0);
  do {
    if (((uint)_Str & 0xfff) < 0xff1) {
      wVar7 = SUB162(auVar5,0);
      wVar8 = SUB162(auVar5 >> 0x10,0);
      auVar6 = CONCAT214(-(ushort)(_Str[7] == L'\0'),
                         CONCAT212(-(ushort)(_Str[6] == L'\0'),
                                   CONCAT210(-(ushort)(_Str[5] == L'\0'),
                                             CONCAT28(-(ushort)(_Str[4] == L'\0'),
                                                      CONCAT26(-(ushort)(_Str[3] == L'\0'),
                                                               CONCAT24(-(ushort)(_Str[2] == L'\0'),
                                                                        CONCAT22(-(ushort)(_Str[1] 
                                                  == L'\0'),-(ushort)(*_Str == L'\0')))))))) |
               CONCAT214(-(ushort)(_Str[7] == wVar8),
                         CONCAT212(-(ushort)(_Str[6] == wVar7),
                                   CONCAT210(-(ushort)(_Str[5] == wVar8),
                                             CONCAT28(-(ushort)(_Str[4] == wVar7),
                                                      CONCAT26(-(ushort)(_Str[3] == wVar8),
                                                               CONCAT24(-(ushort)(_Str[2] == wVar7),
                                                                        CONCAT22(-(ushort)(_Str[1] 
                                                  == wVar8),-(ushort)(*_Str == wVar7))))))));
      uVar2 = (ushort)(SUB161(auVar6 >> 7,0) & 1) | (ushort)(SUB161(auVar6 >> 0xf,0) & 1) << 1 |
              (ushort)(SUB161(auVar6 >> 0x17,0) & 1) << 2 |
              (ushort)(SUB161(auVar6 >> 0x1f,0) & 1) << 3 |
              (ushort)(SUB161(auVar6 >> 0x27,0) & 1) << 4 |
              (ushort)(SUB161(auVar6 >> 0x2f,0) & 1) << 5 |
              (ushort)(SUB161(auVar6 >> 0x37,0) & 1) << 6 |
              (ushort)(SUB161(auVar6 >> 0x3f,0) & 1) << 7 |
              (ushort)(SUB161(auVar6 >> 0x47,0) & 1) << 8 |
              (ushort)(SUB161(auVar6 >> 0x4f,0) & 1) << 9 |
              (ushort)(SUB161(auVar6 >> 0x57,0) & 1) << 10 |
              (ushort)(SUB161(auVar6 >> 0x5f,0) & 1) << 0xb |
              (ushort)(SUB161(auVar6 >> 0x67,0) & 1) << 0xc |
              (ushort)(SUB161(auVar6 >> 0x6f,0) & 1) << 0xd |
              (ushort)(SUB161(auVar6 >> 0x77,0) & 1) << 0xe |
              (ushort)SUB161(auVar6 >> 0x7f,0) << 0xf;
      if (uVar2 != 0) {
        uVar1 = 0;
        if (uVar2 != 0) {
          for (; (uVar2 >> uVar1 & 1) == 0; uVar1 = uVar1 + 1) {
          }
        }
        pwVar4 = (wchar_t *)0x0;
        if (*(wchar_t *)((longlong)_Str + (ulonglong)uVar1) == _Ch) {
          pwVar4 = (wchar_t *)((longlong)_Str + (ulonglong)uVar1);
        }
        return pwVar4;
      }
      lVar3 = 0x10;
    }
    else {
      if (*_Str == _Ch) {
        return _Str;
      }
      if (*_Str == L'\0') {
        return (wchar_t *)0x0;
      }
      lVar3 = 2;
    }
    _Str = (wchar_t *)((longlong)_Str + lVar3);
  } while( true );
}



// Library Function - Single Match
//  wcslen
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

size_t __cdecl wcslen(wchar_t *_Str)

{
  wchar_t *pwVar1;
  size_t sVar2;
  wchar_t *pwVar3;
  undefined (*pauVar4) [32];
  ulonglong uVar5;
  undefined auVar6 [16];
  undefined in_YMM1 [32];
  ushort uVar7;
  
  pauVar4 = (undefined (*) [32])_Str;
  if (DAT_140038018 < 5) {
    if (DAT_140038018 < 1) {
      for (; *(short *)*pauVar4 != 0; pauVar4 = (undefined (*) [32])(*pauVar4 + 2)) {
      }
    }
    else if (((ulonglong)_Str & 1) == 0) {
      uVar5 = (ulonglong)((uint)_Str & 0xf);
      uVar5 = -(ulonglong)(uVar5 != 0) & 0x10 - uVar5;
      pwVar1 = (wchar_t *)((longlong)_Str + (uVar5 & 0xfffffffffffffffe));
      pwVar3 = _Str;
      if (_Str != pwVar1) {
        do {
          if (*pwVar3 == L'\0') break;
          pwVar3 = pwVar3 + 1;
        } while (pwVar3 != pwVar1);
      }
      sVar2 = (longlong)pwVar3 - (longlong)_Str >> 1;
      if (sVar2 != uVar5 >> 1) {
        return sVar2;
      }
      pauVar4 = (undefined (*) [32])(_Str + sVar2);
      while( true ) {
        uVar7 = -(ushort)(*(short *)(*pauVar4 + 0xe) == 0);
        auVar6 = CONCAT214(uVar7,CONCAT212(-(ushort)(*(short *)(*pauVar4 + 0xc) == 0),
                                           CONCAT210(-(ushort)(*(short *)(*pauVar4 + 10) == 0),
                                                     CONCAT28(-(ushort)(*(short *)(*pauVar4 + 8) ==
                                                                       0),
                                                              CONCAT26(-(ushort)(*(short *)(*pauVar4
                                                                                           + 6) == 0
                                                                                ),
                                                                       CONCAT24(-(ushort)(*(short *)
                                                  (*pauVar4 + 4) == 0),
                                                  CONCAT22(-(ushort)(*(short *)(*pauVar4 + 2) == 0),
                                                           -(ushort)(*(short *)*pauVar4 == 0))))))))
        ;
        if ((ushort)((ushort)(SUB161(auVar6 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar6 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar6 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar6 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar6 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar6 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar6 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar6 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar6 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar6 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar6 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar6 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar6 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar6 >> 0x6f,0) & 1) << 0xd |
                     (ushort)((byte)(uVar7 >> 7) & 1) << 0xe | uVar7 & 0x8000) != 0) break;
        pauVar4 = (undefined (*) [32])(*pauVar4 + 0x10);
      }
      for (; *(short *)*pauVar4 != 0; pauVar4 = (undefined (*) [32])(*pauVar4 + 2)) {
      }
    }
    else {
      for (; *(short *)*pauVar4 != 0; pauVar4 = (undefined (*) [32])(*pauVar4 + 2)) {
      }
    }
  }
  else if (((ulonglong)_Str & 1) == 0) {
    uVar5 = (ulonglong)((uint)_Str & 0x1f);
    uVar5 = -(ulonglong)(uVar5 != 0) & 0x20 - uVar5;
    pwVar1 = (wchar_t *)((longlong)_Str + (uVar5 & 0xfffffffffffffffe));
    pwVar3 = _Str;
    if (_Str != pwVar1) {
      do {
        if (*pwVar3 == L'\0') break;
        pwVar3 = pwVar3 + 1;
      } while (pwVar3 != pwVar1);
    }
    sVar2 = (longlong)pwVar3 - (longlong)_Str >> 1;
    if (sVar2 != uVar5 >> 1) {
      return sVar2;
    }
    pauVar4 = (undefined (*) [32])(_Str + sVar2);
    while( true ) {
      auVar6 = vpxor_avx(SUB3216(in_YMM1,0),SUB3216(in_YMM1,0));
      in_YMM1 = vpcmpeqw_avx2(ZEXT1632(auVar6),*pauVar4);
      vzeroupper_avx();
      if (((uint)(SUB321(in_YMM1 >> 7,0) & 1) | (uint)(SUB321(in_YMM1 >> 0xf,0) & 1) << 1 |
           (uint)(SUB321(in_YMM1 >> 0x17,0) & 1) << 2 | (uint)(SUB321(in_YMM1 >> 0x1f,0) & 1) << 3 |
           (uint)(SUB321(in_YMM1 >> 0x27,0) & 1) << 4 | (uint)(SUB321(in_YMM1 >> 0x2f,0) & 1) << 5 |
           (uint)(SUB321(in_YMM1 >> 0x37,0) & 1) << 6 | (uint)(SUB321(in_YMM1 >> 0x3f,0) & 1) << 7 |
           (uint)(SUB321(in_YMM1 >> 0x47,0) & 1) << 8 | (uint)(SUB321(in_YMM1 >> 0x4f,0) & 1) << 9 |
           (uint)(SUB321(in_YMM1 >> 0x57,0) & 1) << 10 |
           (uint)(SUB321(in_YMM1 >> 0x5f,0) & 1) << 0xb |
           (uint)(SUB321(in_YMM1 >> 0x67,0) & 1) << 0xc |
           (uint)(SUB321(in_YMM1 >> 0x6f,0) & 1) << 0xd |
           (uint)(SUB321(in_YMM1 >> 0x77,0) & 1) << 0xe | (uint)SUB321(in_YMM1 >> 0x7f,0) << 0xf |
           (uint)(SUB321(in_YMM1 >> 0x87,0) & 1) << 0x10 |
           (uint)(SUB321(in_YMM1 >> 0x8f,0) & 1) << 0x11 |
           (uint)(SUB321(in_YMM1 >> 0x97,0) & 1) << 0x12 |
           (uint)(SUB321(in_YMM1 >> 0x9f,0) & 1) << 0x13 |
           (uint)(SUB321(in_YMM1 >> 0xa7,0) & 1) << 0x14 |
           (uint)(SUB321(in_YMM1 >> 0xaf,0) & 1) << 0x15 |
           (uint)(SUB321(in_YMM1 >> 0xb7,0) & 1) << 0x16 | (uint)SUB321(in_YMM1 >> 0xbf,0) << 0x17 |
           (uint)(SUB321(in_YMM1 >> 199,0) & 1) << 0x18 |
           (uint)(SUB321(in_YMM1 >> 0xcf,0) & 1) << 0x19 |
           (uint)(SUB321(in_YMM1 >> 0xd7,0) & 1) << 0x1a |
           (uint)(SUB321(in_YMM1 >> 0xdf,0) & 1) << 0x1b |
           (uint)(SUB321(in_YMM1 >> 0xe7,0) & 1) << 0x1c |
           (uint)(SUB321(in_YMM1 >> 0xef,0) & 1) << 0x1d |
           (uint)(SUB321(in_YMM1 >> 0xf7,0) & 1) << 0x1e | (uint)SUB321(in_YMM1 >> 0xff,0) << 0x1f)
          != 0) break;
      pauVar4 = pauVar4[1];
    }
    for (; *(short *)*pauVar4 != 0; pauVar4 = (undefined (*) [32])(*pauVar4 + 2)) {
    }
  }
  else {
    for (; *(short *)*pauVar4 != 0; pauVar4 = (undefined (*) [32])(*pauVar4 + 2)) {
    }
  }
  return (longlong)pauVar4 - (longlong)_Str >> 1;
}



// Library Function - Multiple Matches With Different Base Names
//  __stdio_common_vfprintf
//  __stdio_common_vfprintf_p
//  __stdio_common_vfprintf_s
//  __stdio_common_vfwprintf
//   6 names - too many to list
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4
FID_conflict___stdio_common_vfwprintf
          (undefined8 param_1,longlong param_2,longlong param_3,undefined8 param_4,
          undefined8 param_5)

{
  undefined4 uVar1;
  ulong *puVar2;
  longlong local_res8;
  undefined8 local_res10;
  undefined8 local_res18;
  longlong local_res20;
  undefined8 local_48;
  longlong local_40;
  longlong local_38;
  longlong *local_30;
  undefined8 *local_28;
  undefined8 *local_20;
  longlong *local_18;
  undefined8 *local_10;
  
  local_48 = param_5;
  local_res8 = param_2;
  local_res10 = param_4;
  local_res18 = param_1;
  local_res20 = param_3;
  if ((param_2 == 0) || (param_3 == 0)) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    uVar1 = 0xffffffff;
  }
  else {
    local_30 = &local_res8;
    local_28 = &local_res10;
    local_20 = &local_res18;
    local_18 = &local_res20;
    local_10 = &local_48;
    local_40 = param_2;
    local_38 = param_2;
    uVar1 = operator____(&param_5,&local_38,&local_30,&local_40);
  }
  return uVar1;
}



void common_vsprintf__(ulonglong param_1,undefined2 *param_2,longlong param_3,longlong param_4,
                      __crt_locale_pointers *param_5,undefined8 param_6)

{
  int iVar1;
  ulong *puVar2;
  undefined auStack_528 [32];
  undefined2 *puStack_508;
  longlong lStack_500;
  longlong lStack_4f8;
  undefined uStack_4f0;
  longlong lStack_4e8;
  undefined auStack_4e0 [16];
  char cStack_4d0;
  ulonglong uStack_4c8;
  undefined *puStack_4c0;
  undefined8 uStack_4b8;
  longlong lStack_4b0;
  undefined8 uStack_4a8;
  undefined8 uStack_4a0;
  undefined8 uStack_498;
  undefined4 uStack_490;
  undefined uStack_488;
  undefined2 uStack_486;
  undefined4 uStack_478;
  undefined uStack_474;
  undefined8 uStack_70;
  LPVOID pvStack_68;
  undefined2 **ppuStack_60;
  undefined4 uStack_58;
  ulonglong uStack_48;
  
  uStack_48 = DAT_140038010 ^ (ulonglong)auStack_528;
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (undefined2 *)0x0)))) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    goto LAB_14000dc28;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&lStack_4e8,param_5);
  FUN_14000ce30((undefined (*) [16])&puStack_508,0,0x20);
  lStack_4f8 = 0;
  if (((param_1 & 2) != 0) || (uStack_4f0 = 0, param_2 == (undefined2 *)0x0)) {
    uStack_4f0 = 1;
  }
  ppuStack_60 = &puStack_508;
  uStack_4b8 = 0;
  puStack_4c0 = auStack_4e0;
  uStack_4a0 = 0;
  uStack_4a8 = param_6;
  uStack_498 = 0;
  uStack_490 = 0;
  uStack_488 = 0;
  uStack_486 = 0;
  uStack_478 = 0;
  uStack_474 = 0;
  uStack_70 = 0;
  pvStack_68 = (LPVOID)0x0;
  uStack_58 = 0;
  puStack_508 = param_2;
  lStack_500 = param_3;
  uStack_4c8 = param_1;
  lStack_4b0 = param_4;
  iVar1 = FUN_14000f6c8(&uStack_4c8);
  if (param_2 != (undefined2 *)0x0) {
    if ((param_1 & 1) == 0) {
      if ((param_1 & 2) == 0) {
        if (param_3 != 0) {
          if (lStack_4f8 != param_3) goto LAB_14000dbfb;
LAB_14000dc62:
          param_2[param_3 + -1] = 0;
        }
      }
      else if (param_3 != 0) {
        if (-1 < iVar1) {
          if (lStack_4f8 == param_3) goto LAB_14000dc62;
          goto LAB_14000dbfb;
        }
        *param_2 = 0;
      }
    }
    else if (((param_3 != 0) || (iVar1 == 0)) && (lStack_4f8 != param_3)) {
LAB_14000dbfb:
      param_2[lStack_4f8] = 0;
    }
  }
  _free_base(pvStack_68);
  pvStack_68 = (LPVOID)0x0;
  if (cStack_4d0 != '\0') {
    *(uint *)(lStack_4e8 + 0x3a8) = *(uint *)(lStack_4e8 + 0x3a8) & 0xfffffffd;
  }
LAB_14000dc28:
  __security_check_cookie(uStack_48 ^ (ulonglong)auStack_528);
  return;
}



void thunk_FUN_140013ed8(LPVOID param_1)

{
  thunk_FUN_140013ed8(param_1);
  return;
}



short * FUN_14000b198(short *param_1,longlong param_2,longlong param_3)

{
  short sVar1;
  longlong lVar2;
  short *psVar3;
  longlong lVar4;
  
  if (param_3 != 0) {
    psVar3 = param_1;
    do {
      lVar4 = param_3;
      sVar1 = *(short *)((param_2 - (longlong)param_1) + (longlong)psVar3);
      *psVar3 = sVar1;
      psVar3 = psVar3 + 1;
      if (sVar1 == 0) break;
      param_3 = lVar4 + -1;
    } while (lVar4 + -1 != 0);
    lVar2 = lVar4 + -1;
    if (sVar1 == 0) {
      lVar2 = lVar4;
    }
    if ((lVar2 != 0) && (lVar2 = lVar2 + -1, lVar2 != 0)) {
      for (; lVar2 != 0; lVar2 = lVar2 + -1) {
        *psVar3 = 0;
        psVar3 = psVar3 + 1;
      }
    }
  }
  return param_1;
}



// Library Function - Single Match
//  _wcslwr
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

wchar_t * __cdecl _wcslwr(wchar_t *_String)

{
  ulong *puVar1;
  wchar_t wVar2;
  wchar_t *pwVar3;
  
  if (DAT_140038e20 == 0) {
    if (_String == (wchar_t *)0x0) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      FUN_140011e58();
      _String = (wchar_t *)0x0;
    }
    else {
      wVar2 = *_String;
      pwVar3 = _String;
      while (wVar2 != L'\0') {
        if ((ushort)(wVar2 + L'﾿') < 0x1a) {
          *pwVar3 = wVar2 + L' ';
        }
        pwVar3 = pwVar3 + 1;
        wVar2 = *pwVar3;
      }
    }
  }
  else {
    _wcslwr_s_l(_String,0xffffffffffffffff,(_locale_t)0x0);
  }
  return _String;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Exceeded maximum restarts with more pending

undefined8 FUN_14000b260(void)

{
  code *pcVar1;
  byte bVar2;
  HMODULE hModule;
  FARPROC pFVar3;
  FARPROC pFVar4;
  FARPROC pFVar5;
  undefined8 uVar6;
  byte bVar7;
  
  InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)&DAT_140038cd8,4000);
  hModule = GetModuleHandleW(L"api-ms-win-core-synch-l1-2-0.dll");
  if ((hModule == (HMODULE)0x0) &&
     (hModule = GetModuleHandleW(L"kernel32.dll"), hModule == (HMODULE)0x0)) goto LAB_14000b3b2;
  pFVar3 = GetProcAddress(hModule,"InitializeConditionVariable");
  pFVar4 = GetProcAddress(hModule,"SleepConditionVariableCS");
  pFVar5 = GetProcAddress(hModule,"WakeAllConditionVariable");
  if ((pFVar3 == (FARPROC)0x0) || ((pFVar4 == (FARPROC)0x0 || (pFVar5 == (FARPROC)0x0)))) {
    DAT_140038d08 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
    if (DAT_140038d08 != (HANDLE)0x0) goto LAB_14000b350;
  }
  else {
    DAT_140038d08 = (HANDLE)0x0;
    (*pFVar3)(&DAT_140038d00);
    bVar7 = 0x40 - ((byte)DAT_140038010 & 0x3f);
    bVar2 = bVar7 & 0x3f;
    _DAT_140038d10 = DAT_140038010 ^ ((ulonglong)pFVar4 >> bVar2 | (longlong)pFVar4 << 0x40 - bVar2)
    ;
    bVar7 = bVar7 & 0x3f;
    _DAT_140038d18 = DAT_140038010 ^ ((ulonglong)pFVar5 >> bVar7 | (longlong)pFVar5 << 0x40 - bVar7)
    ;
LAB_14000b350:
    uVar6 = __scrt_initialize_onexit_tables(0);
    if ((char)uVar6 != '\0') {
      atexit(FUN_14000b550);
      return 0;
    }
    __scrt_fastfail(7);
  }
  __scrt_fastfail(7);
LAB_14000b3b2:
  __scrt_fastfail(7);
  pcVar1 = (code *)swi(3);
  uVar6 = (*pcVar1)();
  return uVar6;
}



// Library Function - Single Match
//  _Init_thread_header
// 
// Library: Visual Studio 2017 Release

void _Init_thread_header(int *param_1)

{
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
  do {
    if (*param_1 == 0) {
      *param_1 = -1;
LAB_14000b414:
                    // WARNING: Could not recover jumptable at 0x00014000b420. Too many branches
                    // WARNING: Treating indirect jump as call
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
      return;
    }
    if (*param_1 != -1) {
      *(undefined4 *)
       (*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) =
           DAT_140038000;
      goto LAB_14000b414;
    }
    _Init_thread_wait(100);
  } while( true );
}



// Library Function - Single Match
//  _Init_thread_footer
// 
// Library: Visual Studio 2017 Release

void _Init_thread_footer(int *param_1)

{
  ulonglong uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
  uVar1 = (ulonglong)_tls_index;
  DAT_140038000 = DAT_140038000 + 1;
  *param_1 = DAT_140038000;
  *(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + uVar1 * 8) + 4) = DAT_140038000;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
  _Init_thread_notify();
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _Init_thread_wait
// 
// Library: Visual Studio 2017 Release

void _Init_thread_wait(DWORD param_1)

{
  byte bVar1;
  
  if (DAT_140038d08 == (HANDLE)0x0) {
    bVar1 = (byte)DAT_140038010 & 0x3f;
    (*(code *)((DAT_140038010 ^ _DAT_140038d10) >> bVar1 |
              (DAT_140038010 ^ _DAT_140038d10) << 0x40 - bVar1))
              (&DAT_140038d00,&DAT_140038cd8,param_1);
                    // WARNING: Treating indirect jump as call
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
  WaitForSingleObjectEx(DAT_140038d08,param_1,0);
                    // WARNING: Could not recover jumptable at 0x00014000b4f8. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _Init_thread_notify
// 
// Library: Visual Studio 2017 Release

void _Init_thread_notify(void)

{
  byte bVar1;
  
  if (DAT_140038d08 == (HANDLE)0x0) {
    bVar1 = (byte)DAT_140038010 & 0x3f;
    (*(code *)((DAT_140038010 ^ _DAT_140038d18) >> bVar1 |
              (DAT_140038010 ^ _DAT_140038d18) << 0x40 - bVar1))(&DAT_140038d00);
                    // WARNING: Treating indirect jump as call
    return;
  }
  SetEvent(DAT_140038d08);
                    // WARNING: Could not recover jumptable at 0x00014000b549. Too many branches
                    // WARNING: Treating indirect jump as call
  ResetEvent(DAT_140038d08);
  return;
}



void FUN_14000b550(void)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_140038cd8);
  if (DAT_140038d08 != (HANDLE)0x0) {
    CloseHandle(DAT_140038d08);
  }
  return;
}



// Library Function - Single Match
//  atexit
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

int __cdecl atexit(void *param_1)

{
  _onexit_t p_Var1;
  
  p_Var1 = _onexit((_onexit_t)param_1);
  return (p_Var1 != (_onexit_t)0x0) - 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _onexit
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

_onexit_t __cdecl _onexit(_onexit_t _Func)

{
  int iVar1;
  byte bVar2;
  _onexit_t p_Var3;
  
  bVar2 = (byte)DAT_140038010 & 0x3f;
  if (((DAT_140038010 ^ _DAT_140038d38) >> bVar2 | (DAT_140038010 ^ _DAT_140038d38) << 0x40 - bVar2)
      == 0xffffffffffffffff) {
    iVar1 = FUN_14001134c(_Func);
  }
  else {
    iVar1 = _register_onexit_function((longlong)&DAT_140038d38,_Func);
  }
  p_Var3 = (_onexit_t)0x0;
  if (iVar1 == 0) {
    p_Var3 = _Func;
  }
  return p_Var3;
}



// WARNING: Removing unreachable block (ram,0x00014000b66e)
// Library Function - Single Match
//  __scrt_is_nonwritable_in_current_image
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

ulonglong __scrt_is_nonwritable_in_current_image(longlong param_1)

{
  ulonglong uVar1;
  uint7 uVar2;
  IMAGE_SECTION_HEADER *pIVar3;
  
  uVar1 = 0;
  for (pIVar3 = &IMAGE_SECTION_HEADER_140000180; pIVar3 != (IMAGE_SECTION_HEADER *)&DAT_1400002c0;
      pIVar3 = pIVar3 + 1) {
    if (((ulonglong)(uint)pIVar3->VirtualAddress <= param_1 - 0x140000000U) &&
       (uVar1 = (ulonglong)((pIVar3->Misc).PhysicalAddress + pIVar3->VirtualAddress),
       param_1 - 0x140000000U < uVar1)) goto LAB_14000b657;
  }
  pIVar3 = (IMAGE_SECTION_HEADER *)0x0;
LAB_14000b657:
  if (pIVar3 == (IMAGE_SECTION_HEADER *)0x0) {
    uVar1 = uVar1 & 0xffffffffffffff00;
  }
  else {
    uVar2 = (uint7)(uVar1 >> 8);
    if ((int)pIVar3->Characteristics < 0) {
      uVar1 = (ulonglong)uVar2 << 8;
    }
    else {
      uVar1 = CONCAT71(uVar2,1);
    }
  }
  return uVar1;
}



// Library Function - Single Match
//  __scrt_acquire_startup_lock
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong __scrt_acquire_startup_lock(void)

{
  bool bVar1;
  undefined7 extraout_var;
  ulonglong uVar3;
  void *pvVar2;
  
  bVar1 = __scrt_is_ucrt_dll_in_use();
  pvVar2 = (void *)CONCAT71(extraout_var,bVar1);
  if ((int)pvVar2 == 0) {
LAB_14000b6aa:
    uVar3 = (ulonglong)pvVar2 & 0xffffffffffffff00;
  }
  else {
    do {
      LOCK();
      bVar1 = DAT_140038d28 == 0;
      DAT_140038d28 = DAT_140038d28 ^ (ulonglong)bVar1 * (DAT_140038d28 ^ (ulonglong)StackBase);
      pvVar2 = (void *)(!bVar1 * DAT_140038d28);
      if (bVar1) goto LAB_14000b6aa;
    } while (StackBase != pvVar2);
    uVar3 = CONCAT71((int7)((ulonglong)pvVar2 >> 8),1);
  }
  return uVar3;
}



// Library Function - Single Match
//  __scrt_release_startup_lock
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __scrt_release_startup_lock(char param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  
  bVar1 = __scrt_is_ucrt_dll_in_use();
  if ((CONCAT31(extraout_var,bVar1) != 0) && (param_1 == '\0')) {
    DAT_140038d28 = 0;
  }
  return;
}



// Library Function - Single Match
//  __scrt_initialize_crt
// 
// Library: Visual Studio 2017 Release

ulonglong __scrt_initialize_crt(int param_1)

{
  ulonglong uVar1;
  
  if (param_1 == 0) {
    DAT_140038d30 = 1;
  }
  __isa_available_init();
  uVar1 = __vcrt_initialize();
  if ((char)uVar1 != '\0') {
    uVar1 = FUN_14000d3fc();
    if ((char)uVar1 != '\0') {
      return uVar1 & 0xffffffffffffff00 | 1;
    }
    uVar1 = __vcrt_uninitialize('\0');
  }
  return uVar1 & 0xffffffffffffff00;
}



// Library Function - Single Match
//  __scrt_uninitialize_crt
// 
// Library: Visual Studio 2017 Release

undefined8 __scrt_uninitialize_crt(bool param_1,char param_2)

{
  undefined8 in_RAX;
  
  if ((DAT_140038d30 == '\0') || (param_2 == '\0')) {
    __acrt_uninitialize(param_1);
    in_RAX = __vcrt_uninitialize(param_1);
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __scrt_initialize_onexit_tables
// 
// Library: Visual Studio 2017 Release

undefined8 __scrt_initialize_onexit_tables(uint param_1)

{
  code *pcVar1;
  byte bVar2;
  bool bVar3;
  ulonglong in_RAX;
  undefined7 extraout_var;
  undefined8 uVar4;
  undefined4 local_28;
  undefined4 uStack_24;
  
  if (DAT_140038d31 == '\0') {
    if (1 < param_1) {
      __scrt_fastfail(5);
      pcVar1 = (code *)swi(3);
      uVar4 = (*pcVar1)();
      return uVar4;
    }
    bVar3 = __scrt_is_ucrt_dll_in_use();
    if (((int)CONCAT71(extraout_var,bVar3) == 0) || (param_1 != 0)) {
      bVar2 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
      in_RAX = (0xffffffffffffffffU >> bVar2 | -1L << 0x40 - bVar2) ^ DAT_140038010;
      local_28 = (undefined4)in_RAX;
      uStack_24 = (undefined4)(in_RAX >> 0x20);
      _DAT_140038d38 = local_28;
      uRam0000000140038d3c = uStack_24;
      uRam0000000140038d40 = local_28;
      uRam0000000140038d44 = uStack_24;
      _DAT_140038d50 = local_28;
      uRam0000000140038d54 = uStack_24;
      uRam0000000140038d58 = local_28;
      uRam0000000140038d5c = uStack_24;
      _DAT_140038d48 = in_RAX;
      _DAT_140038d60 = in_RAX;
    }
    else {
      in_RAX = _initialize_onexit_table((ulonglong *)&DAT_140038d38);
      if (((int)in_RAX != 0) ||
         (in_RAX = _initialize_onexit_table((ulonglong *)&DAT_140038d50), (int)in_RAX != 0)) {
        return in_RAX & 0xffffffffffffff00;
      }
    }
    DAT_140038d31 = '\x01';
  }
  return CONCAT71((int7)(in_RAX >> 8),1);
}



// Library Function - Single Match
//  void * __ptr64 __cdecl operator new(unsigned __int64)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void * __cdecl operator_new(__uint64 param_1)

{
  code *pcVar1;
  int iVar2;
  LPVOID pvVar3;
  void *pvVar4;
  
  do {
    pvVar3 = _malloc_base(param_1);
    if (pvVar3 != (LPVOID)0x0) {
      return pvVar3;
    }
    iVar2 = _callnewh(param_1);
  } while (iVar2 != 0);
  if (param_1 == 0xffffffffffffffff) {
    FUN_14000bda8();
    pcVar1 = (code *)swi(3);
    pvVar4 = (void *)(*pcVar1)();
    return pvVar4;
  }
  FUN_14000bd88();
  pcVar1 = (code *)swi(3);
  pvVar4 = (void *)(*pcVar1)();
  return pvVar4;
}



void thunk_FUN_140013ed8(LPVOID param_1)

{
  _free_base(param_1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14000b870(void)

{
  _DAT_140038d68 = 0;
  return;
}



// Library Function - Single Match
//  __scrt_is_managed_app
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong __scrt_is_managed_app(void)

{
  HMODULE pHVar1;
  ulonglong uVar2;
  int *piVar3;
  
  pHVar1 = GetModuleHandleW((LPCWSTR)0x0);
  if ((((pHVar1 == (HMODULE)0x0) || (*(short *)&pHVar1->unused != 0x5a4d)) ||
      (piVar3 = (int *)((longlong)&pHVar1->unused + (longlong)pHVar1[0xf].unused), *piVar3 != 0x4550
      )) || (((pHVar1 = (HMODULE)0x20b, *(short *)(piVar3 + 6) != 0x20b ||
              ((uint)piVar3[0x21] < 0xf)) || (piVar3[0x3e] == 0)))) {
    uVar2 = (ulonglong)pHVar1 & 0xffffffffffffff00;
  }
  else {
    uVar2 = 0x201;
  }
  return uVar2;
}



undefined8 FUN_14000b8d0(void)

{
  return 0;
}



undefined8 thunk_FUN_14000b8d0(void)

{
  return 0;
}



void FUN_14000b8dc(void)

{
                    // WARNING: Could not recover jumptable at 0x00014000b8e3. Too many branches
                    // WARNING: Treating indirect jump as call
  SetUnhandledExceptionFilter(FUN_14000ba40);
  return;
}



// Library Function - Single Match
//  __scrt_fastfail
// 
// Library: Visual Studio 2017 Release

void __scrt_fastfail(undefined4 param_1)

{
  code *pcVar1;
  BOOL BVar2;
  LONG LVar3;
  PRUNTIME_FUNCTION FunctionEntry;
  undefined *puVar4;
  undefined8 unaff_retaddr;
  DWORD64 local_res10;
  undefined local_res18 [8];
  undefined local_res20 [8];
  undefined auStack_5c8 [8];
  undefined auStack_5c0 [232];
  undefined local_4d8 [152];
  undefined *local_440;
  DWORD64 local_3e0;
  
  puVar4 = auStack_5c8;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(param_1);
    puVar4 = auStack_5c0;
  }
  *(undefined8 *)(puVar4 + -8) = 0x14000b91f;
  FUN_14000b870();
  *(undefined8 *)(puVar4 + -8) = 0x14000b930;
  FUN_14000ce30((undefined (*) [16])local_4d8,0,0x4d0);
  *(undefined8 *)(puVar4 + -8) = 0x14000b93a;
  RtlCaptureContext(local_4d8);
  *(undefined8 *)(puVar4 + -8) = 0x14000b954;
  FunctionEntry = RtlLookupFunctionEntry(local_3e0,&local_res10,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    *(undefined8 *)(puVar4 + 0x38) = 0;
    *(undefined **)(puVar4 + 0x30) = local_res18;
    *(undefined **)(puVar4 + 0x28) = local_res20;
    *(undefined **)(puVar4 + 0x20) = local_4d8;
    *(undefined8 *)(puVar4 + -8) = 0x14000b995;
    RtlVirtualUnwind(0,local_res10,local_3e0,FunctionEntry,*(PCONTEXT *)(puVar4 + 0x20),
                     *(PVOID **)(puVar4 + 0x28),*(PDWORD64 *)(puVar4 + 0x30),
                     *(PKNONVOLATILE_CONTEXT_POINTERS *)(puVar4 + 0x38));
  }
  local_440 = &stack0x00000008;
  *(undefined8 *)(puVar4 + -8) = 0x14000b9c7;
  FUN_14000ce30((undefined (*) [16])(puVar4 + 0x50),0,0x98);
  *(undefined8 *)(puVar4 + 0x60) = unaff_retaddr;
  *(undefined4 *)(puVar4 + 0x50) = 0x40000015;
  *(undefined4 *)(puVar4 + 0x54) = 1;
  *(undefined8 *)(puVar4 + -8) = 0x14000b9e9;
  BVar2 = IsDebuggerPresent();
  *(undefined **)(puVar4 + 0x40) = puVar4 + 0x50;
  *(undefined **)(puVar4 + 0x48) = local_4d8;
  *(undefined8 *)(puVar4 + -8) = 0x14000ba0a;
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  *(undefined8 *)(puVar4 + -8) = 0x14000ba15;
  LVar3 = UnhandledExceptionFilter((_EXCEPTION_POINTERS *)(puVar4 + 0x40));
  if ((LVar3 == 0) && (BVar2 != 1)) {
    *(undefined8 *)(puVar4 + -8) = 0x14000ba25;
    FUN_14000b870();
  }
  return;
}



undefined8 FUN_14000ba40(int **param_1,ushort *param_2)

{
  uint uVar1;
  int *piVar2;
  code *pcVar3;
  undefined8 uVar4;
  
  piVar2 = *param_1;
  if ((*piVar2 == -0x1f928c9d) && (piVar2[6] == 4)) {
    uVar1 = piVar2[8];
    if ((uVar1 + 0xe66cfae0 < 3) || (uVar1 == 0x1994000)) {
      terminate((ushort *)(ulonglong)uVar1,param_2);
      pcVar3 = (code *)swi(3);
      uVar4 = (*pcVar3)();
      return uVar4;
    }
  }
  return 0;
}



void _guard_check_icall(void)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x00014000bb52)
// WARNING: Removing unreachable block (ram,0x00014000bad0)
// WARNING: Removing unreachable block (ram,0x00014000baab)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __isa_available_init
// 
// Library: Visual Studio 2017 Release

undefined8 __isa_available_init(void)

{
  int *piVar1;
  uint *puVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  byte in_XCR0;
  
  DAT_14003801c = 2;
  DAT_140038018 = 1;
  piVar1 = (int *)cpuid_basic_info(0);
  uVar6 = 0;
  puVar2 = (uint *)cpuid_Version_info(1);
  uVar4 = puVar2[3];
  if ((piVar1[1] ^ 0x756e6547U | piVar1[3] ^ 0x6c65746eU | piVar1[2] ^ 0x49656e69U) == 0) {
    _DAT_140038020 = 0xffffffffffffffff;
    uVar5 = *puVar2 & 0xfff3ff0;
    if ((((uVar5 == 0x106c0) || (uVar5 == 0x20660)) || (uVar5 == 0x20670)) ||
       ((uVar5 - 0x30650 < 0x21 &&
        ((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))) {
      DAT_140038d70 = DAT_140038d70 | 1;
    }
  }
  if (6 < *piVar1) {
    lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
    uVar6 = *(uint *)(lVar3 + 4);
    if ((uVar6 >> 9 & 1) != 0) {
      DAT_140038d70 = DAT_140038d70 | 2;
    }
  }
  if ((uVar4 >> 0x14 & 1) != 0) {
    DAT_140038018 = 2;
    DAT_14003801c = 6;
    if ((((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) && ((in_XCR0 & 6) == 6)) {
      DAT_14003801c = 0xe;
      DAT_140038018 = 3;
      if ((uVar6 & 0x20) != 0) {
        DAT_140038018 = 5;
        DAT_14003801c = 0x2e;
      }
    }
  }
  return 0;
}



undefined8 FUN_14000bc00(void)

{
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __scrt_is_ucrt_dll_in_use
// 
// Library: Visual Studio 2017 Release

bool __scrt_is_ucrt_dll_in_use(void)

{
  return _DAT_140038d74 != 0;
}



char * FUN_14000bc50(longlong param_1)

{
  char *pcVar1;
  
  pcVar1 = "Unknown exception";
  if (*(longlong *)(param_1 + 8) != 0) {
    pcVar1 = *(char **)(param_1 + 8);
  }
  return pcVar1;
}



undefined8 * FUN_14000bc70(undefined8 *param_1,uint param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((LPVOID *)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    thunk_FUN_140013ed8(param_1);
  }
  return param_1;
}



undefined8 * FUN_14000bcb4(undefined8 *param_1)

{
  param_1[2] = 0;
  param_1[1] = "bad allocation";
  *param_1 = std::bad_alloc::vftable;
  return param_1;
}



undefined8 * FUN_14000bd28(undefined8 *param_1)

{
  param_1[2] = 0;
  param_1[1] = "bad array new length";
  *param_1 = std::bad_array_new_length::vftable;
  return param_1;
}



void FUN_14000bd88(void)

{
  code *pcVar1;
  undefined8 local_28 [5];
  
  FUN_14000bcb4(local_28);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_140037080);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_14000bda8(void)

{
  code *pcVar1;
  undefined8 local_28 [5];
  
  FUN_14000bd28(local_28);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_140037108);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined8 * FUN_14000bdd0(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = type_info::vftable;
  if ((param_2 & 1) != 0) {
    thunk_FUN_140013ed8(param_1);
  }
  return param_1;
}



void FUN_14000be00(void)

{
  code *pcVar1;
  bool bVar2;
  char cVar3;
  int iVar4;
  undefined8 uVar5;
  undefined4 *puVar6;
  undefined7 extraout_var;
  
  FUN_140012d08(1);
  uVar5 = FUN_14000c130();
  _set_fmode((int)uVar5);
  puVar6 = FUN_14000d638();
  uVar5 = FUN_14000b8d0();
  *puVar6 = (int)uVar5;
  uVar5 = __scrt_initialize_onexit_tables(1);
  if ((char)uVar5 != '\0') {
    FUN_14000c194();
    atexit(FUN_14000c1d0);
    uVar5 = FUN_14000bc00();
    iVar4 = _configure_wide_argv((int)uVar5);
    if (iVar4 == 0) {
      FUN_14000c138();
      bVar2 = FUN_14000c178();
      if ((int)CONCAT71(extraout_var,bVar2) != 0) {
        FUN_14000d640((ulonglong)FUN_14000b8d0);
      }
      _guard_check_icall();
      _guard_check_icall();
      uVar5 = FUN_14000b8d0();
      _configthreadlocale((int)uVar5);
      cVar3 = FUN_14000c150();
      if (cVar3 != '\0') {
        common_initialize_environment_nolock_wchar_t_();
      }
      FUN_14000b8d0();
      uVar5 = thunk_FUN_14000b8d0();
      if ((int)uVar5 == 0) {
        return;
      }
    }
  }
  __scrt_fastfail(7);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined8 FUN_14000bec0(void)

{
  FUN_14000c154();
  return 0;
}



void FUN_14000bed0(void)

{
  undefined8 uVar1;
  
  FUN_14000b8dc();
  uVar1 = FUN_14000b8d0();
  FUN_140012e68((uint)uVar1);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_14000beec(void)

{
  longlong lVar1;
  code *pcVar2;
  bool bVar3;
  bool bVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  code **ppcVar7;
  ushort **ppuVar8;
  longlong *plVar9;
  int *piVar10;
  undefined7 extraout_var;
  uint unaff_EBX;
  ulonglong uVar11;
  undefined8 in_R9;
  
  uVar5 = __scrt_initialize_crt(1);
  if ((char)uVar5 == '\0') {
    __scrt_fastfail(7);
  }
  else {
    bVar3 = false;
    uVar5 = __scrt_acquire_startup_lock();
    unaff_EBX = unaff_EBX & 0xffffff00 | (uint)(uVar5 & 0xff);
    if (DAT_140038d20 != 1) {
      if (DAT_140038d20 == 0) {
        DAT_140038d20 = 1;
        uVar6 = _initterm_e((undefined **)&DAT_140033e78,(undefined **)&DAT_140033eb8);
        if ((int)uVar6 != 0) {
          return 0xff;
        }
        _initterm((undefined **)&DAT_140033e60,(undefined **)&DAT_140033e70);
        DAT_140038d20 = 2;
      }
      else {
        bVar3 = true;
      }
      __scrt_release_startup_lock((char)(uVar5 & 0xff));
      ppcVar7 = (code **)FUN_14000c184();
      if ((*ppcVar7 != (code *)0x0) &&
         (uVar5 = __scrt_is_nonwritable_in_current_image((longlong)ppcVar7), (char)uVar5 != '\0')) {
        (**ppcVar7)(0,2);
      }
      ppuVar8 = (ushort **)FUN_14000c18c();
      if ((*ppuVar8 != (ushort *)0x0) &&
         (uVar5 = __scrt_is_nonwritable_in_current_image((longlong)ppuVar8), (char)uVar5 != '\0')) {
        _register_thread_local_exe_atexit_callback(*ppuVar8);
      }
      plVar9 = FUN_14000d604();
      lVar1 = *plVar9;
      piVar10 = (int *)FUN_14000d5fc();
      uVar6 = _get_initial_wide_environment();
      bVar4 = FUN_1400016d0(*piVar10,lVar1,uVar6,in_R9);
      uVar11 = CONCAT71(extraout_var,bVar4) & 0xffffffff;
      unaff_EBX = (uint)uVar11;
      uVar5 = __scrt_is_managed_app();
      if ((char)uVar5 != '\0') {
        if (!bVar3) {
          FUN_140010a88();
        }
        __scrt_uninitialize_crt(true,'\0');
        return uVar11;
      }
      goto LAB_14000c058;
    }
  }
  __scrt_fastfail(7);
LAB_14000c058:
  FUN_140010a70(unaff_EBX);
  FUN_140010a7c(unaff_EBX);
  pcVar2 = (code *)swi(3);
  uVar5 = (*pcVar2)();
  return uVar5;
}



void entry(void)

{
  __security_init_cookie();
  FUN_14000beec();
  return;
}



// Library Function - Single Match
//  __security_init_cookie
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl __security_init_cookie(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  uint local_res18;
  undefined4 uStackX_1c;
  
  if (DAT_140038010 == 0x2b992ddfa232) {
    local_res10 = (_FILETIME)0x0;
    GetSystemTimeAsFileTime(&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter((LARGE_INTEGER *)&local_res18);
    DAT_140038010 =
         ((ulonglong)local_res18 << 0x20 ^ CONCAT44(uStackX_1c,local_res18) ^ (ulonglong)local_res8
         ^ (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_140038010 == 0x2b992ddfa232) {
      DAT_140038010 = 0x2b992ddfa233;
    }
  }
  DAT_140038008 = ~DAT_140038010;
  return;
}



undefined8 FUN_14000c130(void)

{
  return 0x4000;
}



void FUN_14000c138(void)

{
                    // WARNING: Could not recover jumptable at 0x00014000c13f. Too many branches
                    // WARNING: Treating indirect jump as call
  InitializeSListHead(&DAT_140038d80);
  return;
}



undefined FUN_14000c150(void)

{
  return 1;
}



void FUN_14000c154(void)

{
  ulonglong *puVar1;
  
  puVar1 = (ulonglong *)FUN_140001080();
  *puVar1 = *puVar1 | 4;
  puVar1 = (ulonglong *)FUN_14000c170();
  *puVar1 = *puVar1 | 2;
  return;
}



undefined * FUN_14000c170(void)

{
  return &DAT_140038d90;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FUN_14000c178(void)

{
  return _DAT_140038030 == 0;
}



undefined * FUN_14000c184(void)

{
  return &DAT_140038da0;
}



undefined * FUN_14000c18c(void)

{
  return &DAT_140038da8;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_14000c194(void)

{
  code **ppcVar1;
  
  for (ppcVar1 = (code **)&DAT_1400357f8; ppcVar1 < &DAT_1400357f8; ppcVar1 = ppcVar1 + 1) {
    if (*ppcVar1 != (code *)0x0) {
      (**ppcVar1)();
    }
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_14000c1d0(void)

{
  code **ppcVar1;
  
  for (ppcVar1 = (code **)&DAT_140035808; ppcVar1 < &DAT_140035808; ppcVar1 = ppcVar1 + 1) {
    if (*ppcVar1 != (code *)0x0) {
      (**ppcVar1)();
    }
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  _CxxThrowException
// 
// Library: Visual Studio 2017 Release

void _CxxThrowException(void *pExceptionObject,ThrowInfo *pThrowInfo)

{
  PVOID local_res8;
  undefined4 local_28;
  undefined4 uStack_24;
  void *pvStack_20;
  ThrowInfo *local_18;
  PVOID pvStack_10;
  
  local_28 = 0x19930520;
  uStack_24 = 0;
  pvStack_20 = (void *)0x0;
  local_18 = (ThrowInfo *)0x0;
  pvStack_10 = (PVOID)0x0;
  if ((pThrowInfo != (ThrowInfo *)0x0) && ((*(byte *)&pThrowInfo->attributes & 0x10) != 0)) {
                    // WARNING: Load size is inaccurate
    pThrowInfo = *(ThrowInfo **)(*(longlong *)(*pExceptionObject + -8) + 0x30);
    (**(code **)(*(longlong *)(*pExceptionObject + -8) + 0x40))();
  }
  pvStack_20 = pExceptionObject;
  local_18 = pThrowInfo;
  local_res8 = RtlPcToFileHeader(pThrowInfo,&local_res8);
  if ((pThrowInfo != (ThrowInfo *)0x0) &&
     (((*(byte *)&pThrowInfo->attributes & 8) != 0 || (local_res8 == (PVOID)0x0)))) {
    local_28 = 0x1994000;
  }
  pvStack_10 = local_res8;
  RaiseException(0xe06d7363,1,4,(ULONG_PTR *)&local_28);
  return;
}



// Library Function - Single Match
//  public: static struct _s_TryBlockMapEntry const * __ptr64 __cdecl
// __FrameHandler3::CatchTryBlock(struct _s_FuncInfo const * __ptr64,int)
// 
// Library: Visual Studio 2017 Release

_s_TryBlockMapEntry * __cdecl __FrameHandler3::CatchTryBlock(_s_FuncInfo *param_1,int param_2)

{
  longlong lVar1;
  _s_TryBlockMapEntry *p_Var2;
  ulonglong uVar3;
  
  uVar3 = (ulonglong)param_1->nTryBlocks;
  do {
    if ((int)uVar3 == 0) {
      return (_s_TryBlockMapEntry *)0x0;
    }
    lVar1 = __vcrt_getptd();
    uVar3 = (ulonglong)((int)uVar3 - 1);
    p_Var2 = (_s_TryBlockMapEntry *)
             (*(longlong *)(lVar1 + 0x60) + uVar3 * 0x14 + (longlong)(int)param_1->dispTryBlockMap);
  } while ((param_2 <= *(int *)(p_Var2 + 4)) || (*(int *)(p_Var2 + 8) < param_2));
  return p_Var2;
}



// Library Function - Single Match
//  public: static bool __cdecl __FrameHandler3::ExecutionInCatch(struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2017 Release

bool __cdecl __FrameHandler3::ExecutionInCatch(_xDISPATCHER_CONTEXT *param_1,_s_FuncInfo *param_2)

{
  int iVar1;
  _s_TryBlockMapEntry *p_Var2;
  
  iVar1 = FUN_1400156d0(param_2,(__uint64 *)param_1);
  p_Var2 = CatchTryBlock(param_2,iVar1);
  return p_Var2 != (_s_TryBlockMapEntry *)0x0;
}



// Library Function - Single Match
//  public: static void __cdecl __FrameHandler3::FrameUnwindToEmptyState(unsigned __int64 *
// __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2017 Release

void __cdecl
__FrameHandler3::FrameUnwindToEmptyState
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  __uint64 *p_Var2;
  _s_TryBlockMapEntry *p_Var3;
  __uint64 local_res20;
  
  p_Var2 = GetEstablisherFrame(param_1,param_2,param_3,&local_res20);
  iVar1 = FUN_1400156d0(param_3,(__uint64 *)param_2);
  p_Var3 = CatchTryBlock(param_3,iVar1);
  if (p_Var3 == (_s_TryBlockMapEntry *)0x0) {
    iVar1 = -1;
  }
  else {
    iVar1 = *(int *)(p_Var3 + 4);
  }
  FUN_1400157dc(p_Var2,(__uint64 *)param_2,param_3,iVar1);
  return;
}



// Library Function - Single Match
//  public: static unsigned __int64 * __ptr64 __cdecl __FrameHandler3::GetEstablisherFrame(unsigned
// __int64 * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2017 Release

__uint64 * __cdecl
__FrameHandler3::GetEstablisherFrame
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,__uint64 *param_4)

{
  uint uVar1;
  int iVar2;
  PRUNTIME_FUNCTION p_Var3;
  uint uVar4;
  ulonglong uVar5;
  int *piVar6;
  longlong lVar7;
  ulonglong uVar8;
  longlong lVar9;
  ulonglong local_res8;
  
  uVar8 = (ulonglong)param_3->nTryBlocks;
  iVar2 = FUN_1400156d0(param_3,(__uint64 *)param_2);
  *param_4 = *param_1;
  do {
    do {
      if ((int)uVar8 == 0) {
        return param_4;
      }
      uVar8 = (ulonglong)((int)uVar8 - 1);
      lVar7 = (longlong)(int)param_3->dispTryBlockMap + uVar8 * 0x14 + *(longlong *)(param_2 + 8);
    } while ((iVar2 <= *(int *)(lVar7 + 4)) || (*(int *)(lVar7 + 8) < iVar2));
    p_Var3 = RtlLookupFunctionEntry(*(DWORD64 *)param_2,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    uVar5 = 0;
    lVar9 = (longlong)*(int *)(lVar7 + 0x10) + local_res8;
    uVar1 = *(uint *)(lVar7 + 0xc);
    if (uVar1 != 0) {
      piVar6 = (int *)(lVar9 + 0xc);
      do {
        if ((longlong)*piVar6 == (ulonglong)p_Var3->BeginAddress) break;
        uVar4 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar4;
        piVar6 = piVar6 + 5;
      } while (uVar4 < uVar1);
    }
    if ((uint)uVar5 < uVar1) {
      *param_4 = *(__uint64 *)((longlong)*(int *)(lVar9 + 0x10 + uVar5 * 0x14) + *param_1);
      return param_4;
    }
  } while( true );
}



// Library Function - Single Match
//  public: static void __cdecl __FrameHandler3::UnwindNestedFrames(unsigned __int64 *
// __ptr64,struct EHExceptionRecord * __ptr64,struct _CONTEXT * __ptr64,unsigned __int64 *
// __ptr64,void * __ptr64,struct _s_FuncInfo const * __ptr64,int,int,struct _s_HandlerType const *
// __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,unsigned char)
// 
// Library: Visual Studio 2017 Release

void __cdecl
__FrameHandler3::UnwindNestedFrames
          (__uint64 *param_1,EHExceptionRecord *param_2,_CONTEXT *param_3,__uint64 *param_4,
          void *param_5,_s_FuncInfo *param_6,int param_7,int param_8,_s_HandlerType *param_9,
          _xDISPATCHER_CONTEXT *param_10,uchar param_11)

{
  undefined auStackY_5b8 [32];
  undefined local_588 [12];
  undefined4 uStack_57c;
  undefined4 local_578;
  undefined4 uStack_574;
  DWORD DStack_570;
  undefined4 uStack_56c;
  code *local_568;
  __uint64 *p_Stack_560;
  void *local_558;
  ULONG_PTR UStack_550;
  _CONTEXT *local_548;
  _s_FuncInfo *p_Stack_540;
  EHExceptionRecord *local_538;
  ulonglong uStack_530;
  ULONG_PTR local_528;
  undefined4 uStack_520;
  undefined4 uStack_51c;
  undefined4 local_518;
  undefined4 uStack_514;
  undefined4 uStack_510;
  undefined4 uStack_50c;
  undefined4 local_508;
  undefined4 uStack_504;
  undefined4 uStack_500;
  undefined4 uStack_4fc;
  ULONG_PTR local_4f8;
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStackY_5b8;
  local_588._0_4_ = 0x80000029;
  local_588._4_4_ = 1;
  local_588._8_4_ = 0;
  uStack_57c = 0;
  local_578 = 0;
  uStack_574 = 0;
  DStack_570 = 0xf;
  uStack_56c = 0;
  uStack_520 = 0;
  uStack_51c = 0;
  local_518 = 0;
  uStack_514 = 0;
  uStack_510 = 0;
  uStack_50c = 0;
  local_508 = 0;
  uStack_504 = 0;
  uStack_500 = 0;
  uStack_4fc = 0;
  local_4f8 = 0;
  local_568 = CxxCallCatchBlock;
  local_558 = param_5;
  UStack_550 = (ULONG_PTR)param_7;
  p_Stack_540 = param_6;
  uStack_530 = (ulonglong)param_11;
  local_528 = 0x19930520;
  p_Stack_560 = param_4;
  local_548 = param_3;
  local_538 = param_2;
  RtlUnwindEx((PVOID)*param_1,*(PVOID *)param_10,(PEXCEPTION_RECORD)local_588,(PVOID)0x0,&local_4e8,
              *(PUNWIND_HISTORY_TABLE *)(param_10 + 0x40));
  __security_check_cookie(local_18 ^ (ulonglong)auStackY_5b8);
  return;
}



// Library Function - Single Match
//  public: static struct std::pair<class __FrameHandler3::TryBlockMap::iterator,class
// __FrameHandler3::TryBlockMap::iterator> __cdecl __FrameHandler3::GetRangeOfTrysToCheck(class
// __FrameHandler3::TryBlockMap & __ptr64,int,int)
// 
// Library: Visual Studio 2017 Release

pair_class___FrameHandler3__TryBlockMap__iterator_class___FrameHandler3__TryBlockMap__iterator_
__cdecl __FrameHandler3::GetRangeOfTrysToCheck(TryBlockMap *param_1,int param_2,int param_3)

{
  longlong lVar1;
  _s_FuncInfo *p_Var2;
  _s_FuncInfo *p_Var3;
  longlong lVar4;
  code *pcVar5;
  uint uVar6;
  pair_class___FrameHandler3__TryBlockMap__iterator_class___FrameHandler3__TryBlockMap__iterator_
  pVar7;
  int iVar8;
  uint uVar9;
  _s_FuncInfo *p_Var10;
  int *piVar11;
  uint uVar12;
  undefined4 in_register_00000014;
  _s_FuncInfo *p_Var13;
  longlong lVar14;
  uint uVar15;
  longlong lVar16;
  uint local_res10;
  undefined4 uStack_4c;
  undefined4 uStack_3c;
  
  p_Var2 = *(_s_FuncInfo **)CONCAT44(in_register_00000014,param_2);
  p_Var3 = ((_s_FuncInfo **)CONCAT44(in_register_00000014,param_2))[1];
  lVar14 = 0;
  uVar9 = p_Var2->nTryBlocks;
  p_Var10 = p_Var2;
  p_Var13 = p_Var3;
  iVar8 = FUN_1400156d0(p_Var2,(__uint64 *)p_Var3);
  if (uVar9 == 0) {
    terminate((ushort *)p_Var10,(ushort *)p_Var13);
    pcVar5 = (code *)swi(3);
    pVar7 = (pair_class___FrameHandler3__TryBlockMap__iterator_class___FrameHandler3__TryBlockMap__iterator_
             )(*pcVar5)();
    return pVar7;
  }
  lVar4 = *(longlong *)&p_Var3->dispUnwindMap;
  lVar16 = (longlong)(int)p_Var2->dispTryBlockMap;
  uVar15 = 0xffffffff;
  local_res10 = 0xffffffff;
  uVar12 = uVar9;
  do {
    uVar6 = uVar12 - 1;
    lVar1 = lVar4 + (ulonglong)uVar6 * 0x14;
    if ((*(int *)(lVar1 + 4 + lVar16) < iVar8) && (iVar8 <= *(int *)(lVar1 + 8 + lVar16))) break;
    uVar12 = uVar6;
  } while (uVar6 != 0);
  if (uVar12 != 0) {
    lVar14 = lVar16 + (ulonglong)(uVar12 - 1) * 0x14 + lVar4;
  }
  uVar12 = 0;
  if (uVar9 != 0) {
    piVar11 = (int *)(lVar4 + lVar16);
    do {
      uVar6 = uVar15;
      if ((((lVar14 == 0) ||
           ((*piVar11 != *(int *)(lVar14 + 4) && *(int *)(lVar14 + 4) <= *piVar11 &&
            (piVar11[1] == *(int *)(lVar14 + 8) || piVar11[1] < *(int *)(lVar14 + 8))))) &&
          (*piVar11 <= param_3)) &&
         ((param_3 <= piVar11[1] && (uVar6 = uVar12, local_res10 = uVar12, uVar15 != 0xffffffff))))
      {
        uVar6 = uVar15;
      }
      uVar15 = uVar6;
      uVar12 = uVar12 + 1;
      piVar11 = piVar11 + 5;
    } while (uVar12 < uVar9);
  }
  uVar9 = 0;
  if (uVar15 != 0xffffffff) {
    uVar9 = uVar15;
  }
  *(int *)param_1 = param_2;
  *(undefined4 *)(param_1 + 4) = in_register_00000014;
  *(uint *)(param_1 + 8) = uVar9;
  *(undefined4 *)(param_1 + 0xc) = uStack_4c;
  iVar8 = 0;
  if (uVar15 != 0xffffffff) {
    iVar8 = local_res10 + 1;
  }
  *(int *)(param_1 + 0x10) = param_2;
  *(undefined4 *)(param_1 + 0x14) = in_register_00000014;
  *(int *)(param_1 + 0x18) = iVar8;
  *(undefined4 *)(param_1 + 0x1c) = uStack_3c;
  return SUB81(param_1,0);
}



// Library Function - Single Match
//  _GetImageBase
// 
// Library: Visual Studio 2017 Release

undefined8 _GetImageBase(void)

{
  longlong lVar1;
  
  lVar1 = __vcrt_getptd();
  return *(undefined8 *)(lVar1 + 0x60);
}



void FUN_14000c920(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = __vcrt_getptd();
  *(undefined8 *)(lVar1 + 0x60) = param_1;
  return;
}



// Library Function - Single Match
//  _GetThrowImageBase
// 
// Library: Visual Studio 2017 Release

undefined8 _GetThrowImageBase(void)

{
  longlong lVar1;
  
  lVar1 = __vcrt_getptd();
  return *(undefined8 *)(lVar1 + 0x68);
}



void FUN_14000c94c(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = __vcrt_getptd();
  *(undefined8 *)(lVar1 + 0x68) = param_1;
  return;
}



// Library Function - Single Match
//  _CreateFrameInfo
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 * _CreateFrameInfo(undefined8 *param_1,undefined8 param_2)

{
  longlong lVar1;
  undefined8 uVar2;
  
  *param_1 = param_2;
  lVar1 = __vcrt_getptd();
  if (param_1 < *(undefined8 **)(lVar1 + 0x58)) {
    lVar1 = __vcrt_getptd();
    uVar2 = *(undefined8 *)(lVar1 + 0x58);
  }
  else {
    uVar2 = 0;
  }
  param_1[1] = uVar2;
  lVar1 = __vcrt_getptd();
  *(undefined8 **)(lVar1 + 0x58) = param_1;
  return param_1;
}



// Library Function - Single Match
//  _FindAndUnlinkFrame
// 
// Library: Visual Studio 2017 Release

void _FindAndUnlinkFrame(ushort *param_1,ushort *param_2)

{
  code *pcVar1;
  longlong lVar2;
  ushort *puVar3;
  
  puVar3 = param_1;
  lVar2 = __vcrt_getptd();
  if (param_1 == *(ushort **)(lVar2 + 0x58)) {
    lVar2 = __vcrt_getptd();
    for (param_2 = *(ushort **)(lVar2 + 0x58); param_2 != (ushort *)0x0;
        param_2 = *(ushort **)(param_2 + 4)) {
      if (param_1 == param_2) {
        lVar2 = __vcrt_getptd();
        *(ushort **)(lVar2 + 0x58) = *(ushort **)(param_2 + 4);
        return;
      }
    }
  }
  terminate(puVar3,param_2);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Multiple Matches With Same Base Name
//  int __cdecl _CallSETranslator<class __FrameHandler3>(struct EHExceptionRecord * __ptr64,unsigned
// __int64 * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// _s_FuncInfo const * __ptr64,unsigned long,unsigned __int64 * __ptr64)
//  int __cdecl _CallSETranslator<class __FrameHandler3>(struct EHExceptionRecord * __ptr64,unsigned
// __int64 * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// _s_FuncInfo const * __ptr64,unsigned long,unsigned __int64 * __ptr64,int)
//  int __cdecl _CallSETranslator<class __FrameHandler4>(struct EHExceptionRecord * __ptr64,unsigned
// __int64 * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// FuncInfo4 * __ptr64,unsigned long,unsigned __int64 * __ptr64)
//  int __cdecl _CallSETranslator<class __FrameHandler4>(struct EHExceptionRecord * __ptr64,unsigned
// __int64 * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// FH4::FuncInfo4 * __ptr64,unsigned long,unsigned __int64 * __ptr64,int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 _CallSETranslator__(undefined4 *param_1,undefined8 param_2,undefined8 param_3)

{
  longlong lVar1;
  undefined4 *local_20;
  undefined8 local_18;
  
  local_20 = param_1;
  local_18 = param_3;
  lVar1 = __vcrt_getptd();
  (**(code **)(lVar1 + 0x10))(*param_1,&local_20);
  return 0;
}



// Library Function - Single Match
//  __std_exception_copy
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __std_exception_copy(char **param_1,char **param_2)

{
  longlong lVar1;
  char *pcVar2;
  longlong lVar3;
  
  if ((*(char *)(param_1 + 1) == '\0') || (*param_1 == (char *)0x0)) {
    *param_2 = *param_1;
    *(undefined *)(param_2 + 1) = 0;
  }
  else {
    lVar1 = -1;
    do {
      lVar3 = lVar1;
      lVar1 = lVar3 + 1;
    } while ((*param_1)[lVar3 + 1] != '\0');
    pcVar2 = (char *)_malloc_base(lVar3 + 2);
    if (pcVar2 != (char *)0x0) {
      FUN_140016cd4(pcVar2,lVar3 + 2,(longlong)*param_1);
      *(undefined *)(param_2 + 1) = 1;
      *param_2 = pcVar2;
      pcVar2 = (char *)0x0;
    }
    FUN_140013ed8(pcVar2);
  }
  return;
}



// Library Function - Single Match
//  __std_exception_destroy
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __std_exception_destroy(LPVOID *param_1)

{
  if (*(char *)(param_1 + 1) != '\0') {
    FUN_140013ed8(*param_1);
  }
  *param_1 = (LPVOID)0x0;
  *(undefined *)(param_1 + 1) = 0;
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __DestructExceptionObject
// 
// Library: Visual Studio 2017 Release

void __DestructExceptionObject(int *param_1)

{
  byte *pbVar1;
  
  if ((((param_1 != (int *)0x0) && (*param_1 == -0x1f928c9d)) && (param_1[6] == 4)) &&
     ((param_1[8] + 0xe66cfae0U < 3 && (pbVar1 = *(byte **)(param_1 + 0xc), pbVar1 != (byte *)0x0)))
     ) {
    if (*(int *)(pbVar1 + 4) == 0) {
      if (((*pbVar1 & 0x10) != 0) && (**(longlong ***)(param_1 + 10) != (longlong *)0x0)) {
        (**(code **)(***(longlong ***)(param_1 + 10) + 0x10))();
      }
    }
    else {
      FUN_14000cc00(*(undefined8 *)(param_1 + 10),
                    (undefined *)((longlong)*(int *)(pbVar1 + 4) + *(longlong *)(param_1 + 0xe)));
    }
  }
  return;
}



void Unwind_14000cbf4(ushort *param_1,ushort *param_2)

{
  code *pcVar1;
  
  terminate(param_1,param_2);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_14000cc00(undefined8 param_1,undefined *UNRECOVERED_JUMPTABLE)

{
                    // WARNING: Could not recover jumptable at 0x00014000cc00. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)UNRECOVERED_JUMPTABLE)();
  return;
}



// Library Function - Single Match
//  _IsExceptionObjectToBeDestroyed
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 _IsExceptionObjectToBeDestroyed(longlong param_1)

{
  longlong lVar1;
  longlong *plVar2;
  
  lVar1 = __vcrt_getptd();
  plVar2 = *(longlong **)(lVar1 + 0x58);
  while( true ) {
    if (plVar2 == (longlong *)0x0) {
      return 1;
    }
    if (*plVar2 == param_1) break;
    plVar2 = (longlong *)plVar2[1];
  }
  return 0;
}



// Library Function - Single Match
//  __AdjustPointer
// 
// Library: Visual Studio 2017 Release

longlong __AdjustPointer(longlong param_1,int *param_2)

{
  longlong lVar1;
  
  lVar1 = *param_2 + param_1;
  if (-1 < param_2[1]) {
    lVar1 = lVar1 + (longlong)*(int *)((longlong)param_2[2] + *(longlong *)(param_2[1] + param_1)) +
                    (longlong)param_2[1];
  }
  return lVar1;
}



// Library Function - Single Match
//  __FrameUnwindFilter
// 
// Library: Visual Studio 2017 Release

undefined8 __FrameUnwindFilter(int **param_1,ushort *param_2)

{
  int *piVar1;
  code *pcVar2;
  longlong lVar3;
  undefined8 uVar4;
  
  piVar1 = *param_1;
  if ((*piVar1 == -0x1fbcbcae) || (*piVar1 == -0x1fbcb0b3)) {
    lVar3 = __vcrt_getptd();
    if (0 < *(int *)(lVar3 + 0x30)) {
      lVar3 = __vcrt_getptd();
      *(int *)(lVar3 + 0x30) = *(int *)(lVar3 + 0x30) + -1;
    }
  }
  else if (*piVar1 == -0x1f928c9d) {
    lVar3 = __vcrt_getptd();
    *(undefined4 *)(lVar3 + 0x30) = 0;
    terminate((ushort *)param_1,param_2);
    pcVar2 = (code *)swi(3);
    uVar4 = (*pcVar2)();
    return uVar4;
  }
  return 0;
}



// Library Function - Single Match
//  __std_type_info_compare
// 
// Library: Visual Studio 2017 Release

uint __std_type_info_compare(longlong param_1,longlong param_2)

{
  byte bVar1;
  byte *pbVar2;
  longlong lVar3;
  
  if (param_1 != param_2) {
    pbVar2 = (byte *)(param_1 + 9);
    lVar3 = (param_2 + 9) - (longlong)pbVar2;
    do {
      bVar1 = *pbVar2;
      if (bVar1 != pbVar2[lVar3]) {
        return -(uint)(bVar1 < pbVar2[lVar3]) | 1;
      }
      pbVar2 = pbVar2 + 1;
    } while (bVar1 != 0);
  }
  return 0;
}



// Library Function - Single Match
//  __vcrt_initialize
// 
// Library: Visual Studio 2017 Release

ulonglong __vcrt_initialize(void)

{
  ulonglong uVar1;
  
  FUN_14001719c();
  __vcrt_initialize_winapi_thunks();
  uVar1 = __vcrt_initialize_locks();
  if ((char)uVar1 != '\0') {
    uVar1 = __vcrt_initialize_ptd();
    if ((char)uVar1 != '\0') {
      return CONCAT71((int7)(uVar1 >> 8),1);
    }
    uVar1 = __vcrt_uninitialize_locks();
  }
  return uVar1 & 0xffffffffffffff00;
}



// Library Function - Single Match
//  __vcrt_uninitialize
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

undefined8 __vcrt_uninitialize(char param_1)

{
  undefined8 in_RAX;
  
  if (param_1 == '\0') {
    __vcrt_uninitialize_ptd();
    __vcrt_uninitialize_locks();
    in_RAX = __vcrt_uninitialize_winapi_thunks('\0');
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// Library Function - Single Match
//  memcmp
// 
// Library: Visual Studio

int __cdecl memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
  uint uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong uVar4;
  bool bVar5;
  
  lVar3 = (longlong)_Buf2 - (longlong)_Buf1;
  if (7 < _Size) {
    uVar4 = (ulonglong)_Buf1 & 7;
    while (uVar4 != 0) {
                    // WARNING: Load size is inaccurate
      bVar5 = *_Buf1 < *(byte *)((longlong)_Buf1 + lVar3);
      if (*_Buf1 != *(byte *)((longlong)_Buf1 + lVar3)) goto LAB_14000cd73;
      _Buf1 = (void *)((longlong)_Buf1 + 1);
      _Size = _Size - 1;
      uVar4 = (ulonglong)_Buf1 & 7;
    }
    if (_Size >> 3 != 0) {
      uVar4 = _Size >> 5;
      if (uVar4 != 0) {
        do {
                    // WARNING: Load size is inaccurate
          uVar2 = *_Buf1;
          if (uVar2 != *(ulonglong *)((longlong)_Buf1 + lVar3)) goto LAB_14000cde4;
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 8);
          if (uVar2 != *(ulonglong *)((longlong)_Buf1 + lVar3 + 8)) {
LAB_14000cde0:
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_14000cde4;
          }
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 0x10);
          if (uVar2 != *(ulonglong *)((longlong)_Buf1 + lVar3 + 0x10)) {
LAB_14000cddc:
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_14000cde0;
          }
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 0x18);
          if (uVar2 != *(ulonglong *)((longlong)_Buf1 + lVar3 + 0x18)) {
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_14000cddc;
          }
          _Buf1 = (void *)((longlong)_Buf1 + 0x20);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        _Size = _Size & 0x1f;
      }
      uVar4 = _Size >> 3;
      if (uVar4 != 0) {
        do {
                    // WARNING: Load size is inaccurate
          uVar2 = *_Buf1;
          if (uVar2 != *(ulonglong *)((longlong)_Buf1 + lVar3)) {
LAB_14000cde4:
            uVar4 = *(ulonglong *)(lVar3 + (longlong)_Buf1);
            uVar1 = (uint)((uVar2 >> 0x38 | (uVar2 & 0xff000000000000) >> 0x28 |
                            (uVar2 & 0xff0000000000) >> 0x18 | (uVar2 & 0xff00000000) >> 8 |
                            (uVar2 & 0xff000000) << 8 | (uVar2 & 0xff0000) << 0x18 |
                            (uVar2 & 0xff00) << 0x28 | uVar2 << 0x38) <
                          (uVar4 >> 0x38 | (uVar4 & 0xff000000000000) >> 0x28 |
                           (uVar4 & 0xff0000000000) >> 0x18 | (uVar4 & 0xff00000000) >> 8 |
                           (uVar4 & 0xff000000) << 8 | (uVar4 & 0xff0000) << 0x18 |
                           (uVar4 & 0xff00) << 0x28 | uVar4 << 0x38));
            return (1 - uVar1) - (uint)(uVar1 != 0);
          }
          _Buf1 = (void *)((longlong)_Buf1 + 8);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        _Size = _Size & 7;
      }
    }
  }
  while( true ) {
    if (_Size == 0) {
      return 0;
    }
                    // WARNING: Load size is inaccurate
    bVar5 = *_Buf1 < *(byte *)((longlong)_Buf1 + lVar3);
    if (*_Buf1 != *(byte *)((longlong)_Buf1 + lVar3)) break;
    _Buf1 = (void *)((longlong)_Buf1 + 1);
    _Size = _Size - 1;
  }
LAB_14000cd73:
  return (1 - (uint)bVar5) - (uint)(bVar5 != 0);
}



void FUN_14000ce10(undefined *param_1,undefined param_2,longlong param_3)

{
  for (; param_3 != 0; param_3 = param_3 + -1) {
    *param_1 = param_2;
    param_1 = param_1 + 1;
  }
  return;
}



undefined (*) [16] FUN_14000ce30(undefined (*param_1) [16],byte param_2,ulonglong param_3)

{
  undefined (*pauVar1) [16];
  undefined (*pauVar2) [16];
  ushort uVar3;
  ulonglong uVar5;
  undefined auVar6 [12];
  uint uVar4;
  undefined auVar7 [13];
  undefined auVar8 [16];
  undefined uVar9;
  
  uVar5 = (ulonglong)param_2 * 0x101010101010101;
  uVar3 = (ushort)uVar5;
  uVar4 = (uint)uVar5;
  if (param_3 < 0x11) {
    uVar9 = (undefined)uVar5;
    switch(param_3) {
    case 0:
      return param_1;
    case 8:
      *(ulonglong *)*param_1 = uVar5;
      return param_1;
    case 9:
      *(ulonglong *)(param_1[-1] + param_3 + 7) = uVar5;
      param_1[-1][param_3 + 0xf] = uVar9;
      return param_1;
    case 10:
      *(ulonglong *)*param_1 = uVar5;
      *(ushort *)(*param_1 + 8) = uVar3;
      return param_1;
    case 0xb:
      *(ulonglong *)*param_1 = uVar5;
      *(ushort *)(*param_1 + 8) = uVar3;
      (*param_1)[10] = uVar9;
      return param_1;
    case 0xc:
      *(ulonglong *)(param_1[-1] + param_3 + 4) = uVar5;
    case 4:
      *(uint *)(param_1[-1] + param_3 + 0xc) = uVar4;
      return param_1;
    case 0xd:
      *(ulonglong *)(param_1[-1] + param_3 + 3) = uVar5;
    case 5:
      *(uint *)(param_1[-1] + param_3 + 0xb) = uVar4;
      param_1[-1][param_3 + 0xf] = uVar9;
      return param_1;
    case 0xe:
      *(ulonglong *)(param_1[-1] + param_3 + 2) = uVar5;
    case 6:
      *(uint *)(param_1[-1] + param_3 + 10) = uVar4;
    case 2:
      *(ushort *)(param_1[-1] + param_3 + 0xe) = uVar3;
      return param_1;
    case 0xf:
      *(ulonglong *)(param_1[-1] + param_3 + 1) = uVar5;
    case 7:
      *(uint *)(param_1[-1] + param_3 + 9) = uVar4;
    case 3:
      *(ushort *)(param_1[-1] + param_3 + 0xd) = uVar3;
    case 1:
      param_1[-1][param_3 + 0xf] = uVar9;
      return param_1;
    case 0x10:
      *(ulonglong *)*param_1 = uVar5;
      *(ulonglong *)(*param_1 + 8) = uVar5;
      return param_1;
    }
  }
  uVar9 = SUB141(ZEXT814(uVar5) >> 0x30,0);
  auVar7 = ZEXT813(uVar5);
  auVar6 = ZEXT812(uVar5);
  auVar8 = CONCAT142(SUB1614(CONCAT133(SUB1613(CONCAT124(SUB1612(CONCAT115(SUB1611(CONCAT106(SUB1610
                                                  (CONCAT97(SUB169(CONCAT88(SUB168(CONCAT79(SUB167(
                                                  CONCAT610(SUB166(CONCAT511(SUB165(CONCAT412(SUB164
                                                  (CONCAT313(SUB163(CONCAT214(SUB162(CONCAT115(
                                                  SUB161(ZEXT816(uVar5) >> 0x38,0),
                                                  CONCAT114(SUB151(ZEXT815(uVar5) >> 0x38,0),
                                                            ZEXT814(uVar5))) >> 0x70,0),
                                                  CONCAT113(uVar9,auVar7)) >> 0x68,0),
                                                  CONCAT112(uVar9,auVar6)) >> 0x60,0),
                                                  CONCAT111(SUB131(auVar7 >> 0x28,0),ZEXT811(uVar5))
                                                  ) >> 0x58,0),
                                                  CONCAT110(SUB121(auVar6 >> 0x28,0),
                                                            (unkuint10)uVar5)) >> 0x50,0),
                                                  CONCAT19(SUB131(auVar7 >> 0x20,0),(unkuint9)uVar5)
                                                  ) >> 0x48,0),
                                                  CONCAT18(SUB121(auVar6 >> 0x20,0),uVar5)) >> 0x40,
                                                  0),(uVar5 >> 0x18) << 0x38) >> 0x38,0),
                                                  ((uint7)uVar5 >> 0x18) << 0x30) >> 0x30,0),
                                                  ((uint6)uVar5 >> 0x10) << 0x28) >> 0x28,0),
                                                  ((uint5)uVar5 >> 0x10) << 0x20) >> 0x20,0),
                                                  (uVar4 >> 8) << 0x18) >> 0x18,0),
                                       ((uint3)uVar5 >> 8) << 0x10) >> 0x10,0),
                     uVar3 & 0xff | uVar3 << 8);
  pauVar1 = param_1;
  if (0x80 < param_3) {
    if ((DAT_140038d70 >> 1 & 1) != 0) {
      for (; param_3 != 0; param_3 = param_3 - 1) {
        (*pauVar1)[0] = param_2;
        pauVar1 = (undefined (*) [16])(*pauVar1 + 1);
      }
      return param_1;
    }
    *param_1 = auVar8;
    pauVar1 = (undefined (*) [16])((ulonglong)param_1[1] & 0xfffffffffffffff0);
    param_3 = (longlong)param_1 + (param_3 - (longlong)pauVar1);
    uVar5 = param_3 >> 7;
    if (uVar5 != 0) {
      do {
        *pauVar1 = auVar8;
        pauVar1[1] = auVar8;
        pauVar2 = pauVar1[8];
        pauVar1[2] = auVar8;
        pauVar1[3] = auVar8;
        uVar5 = uVar5 - 1;
        pauVar1[4] = auVar8;
        pauVar1[5] = auVar8;
        pauVar1[6] = auVar8;
        pauVar1[7] = auVar8;
        pauVar1 = pauVar2;
      } while (uVar5 != 0);
      param_3 = param_3 & 0x7f;
    }
  }
  for (uVar5 = param_3 >> 4; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pauVar1 = auVar8;
    pauVar1 = pauVar1[1];
  }
  if ((param_3 & 0xf) != 0) {
    *(undefined (*) [16])(pauVar1[-1] + (param_3 & 0xf)) = auVar8;
  }
  return param_1;
}



// Library Function - Single Match
//  wcsrchr
// 
// Library: Visual Studio 2017 Release

wchar_t * __cdecl wcsrchr(wchar_t *_Str,wchar_t _Ch)

{
  undefined *puVar1;
  undefined (*pauVar2) [16];
  int iVar3;
  undefined (*pauVar4) [16];
  bool bVar5;
  bool bVar6;
  
  pauVar4 = (undefined (*) [16])0x0;
  pauVar2 = (undefined (*) [16])_Str;
  if (1 < DAT_140038018) {
    while( true ) {
      if (((int)_Str + 1U & 0xe) == 0) {
        bVar5 = _Ch != L'\0';
        bVar6 = _Ch == L'\0';
        if (!bVar6) {
          while( true ) {
            iVar3 = pcmpistri(ZEXT216((ushort)_Ch),*(undefined (*) [16])_Str,0x41);
            if (bVar5) {
              pauVar4 = (undefined (*) [16])((undefined *)_Str + (longlong)iVar3 * 2);
            }
            if (bVar6) break;
            bVar5 = (undefined (*) [16])0xffffffffffffffef < _Str;
            _Str = (wchar_t *)((longlong)_Str + 0x10);
            bVar6 = (undefined (*) [16])_Str == (undefined (*) [16])0x0;
          }
          return (wchar_t *)pauVar4;
        }
        while (iVar3 = pcmpistri(ZEXT416(0xffff0001),*(undefined (*) [16])_Str,0x15), !bVar6) {
          _Str = (wchar_t *)((longlong)_Str + 0x10);
          bVar6 = (undefined (*) [16])_Str == (undefined (*) [16])0x0;
        }
        return (wchar_t *)((undefined *)_Str + (longlong)iVar3 * 2);
      }
      pauVar2 = (undefined (*) [16])_Str;
      if (*(wchar_t *)(undefined *)_Str != _Ch) {
        pauVar2 = pauVar4;
      }
      if (*(short *)(undefined *)_Str == 0) break;
      _Str = (wchar_t *)((undefined *)_Str + 2);
      pauVar4 = pauVar2;
    }
    return (wchar_t *)pauVar2;
  }
  do {
    puVar1 = *pauVar2;
    pauVar2 = (undefined (*) [16])(*pauVar2 + 2);
  } while (*(short *)puVar1 != 0);
  do {
    pauVar2 = (undefined (*) [16])(pauVar2[-1] + 0xe);
    if (pauVar2 == (undefined (*) [16])_Str) break;
  } while (*(wchar_t *)*pauVar2 != _Ch);
  if (*(wchar_t *)*pauVar2 == _Ch) {
    pauVar4 = pauVar2;
  }
  return (wchar_t *)pauVar4;
}



// Library Function - Single Match
//  wcsstr
// 
// Library: Visual Studio 2017 Release

wchar_t * __cdecl wcsstr(wchar_t *_Str,wchar_t *_SubStr)

{
  wchar_t wVar1;
  ushort uVar2;
  wchar_t *pwVar3;
  ulonglong uVar4;
  int iVar5;
  wchar_t *pwVar6;
  short sVar7;
  uint uVar8;
  undefined (*pauVar9) [16];
  longlong lVar10;
  undefined (*pauVar11) [16];
  undefined in_XMM1 [16];
  undefined auVar12 [16];
  undefined auVar13 [16];
  wchar_t wVar14;
  wchar_t wVar15;
  
  wVar1 = *_SubStr;
  if (wVar1 != L'\0') {
    if (1 < DAT_140038018) {
      if (((ulonglong)_SubStr & 0xfff) < 0xff1) {
        auVar12 = *(undefined (*) [16])_SubStr;
      }
      else {
        auVar12 = ZEXT816(0);
        uVar8 = (uint)(ushort)wVar1;
        lVar10 = 8;
        pwVar6 = _SubStr;
        do {
          sVar7 = (short)uVar8;
          auVar12 = pinsrw(auVar12 >> 0x10,uVar8,7);
          if (sVar7 != 0) {
            uVar8 = (uint)(ushort)pwVar6[1];
          }
          pwVar3 = pwVar6 + 1;
          if (sVar7 == 0) {
            pwVar3 = pwVar6;
          }
          lVar10 = lVar10 + -1;
          pwVar6 = pwVar3;
        } while (lVar10 != 0);
      }
      do {
        while( true ) {
          uVar4 = (ulonglong)_Str & 0xfff;
          pauVar11 = (undefined (*) [16])_SubStr;
          if (uVar4 < 0xff1) break;
          if (*(short *)(undefined *)_Str == 0) goto LAB_14000d279;
          pauVar9 = (undefined (*) [16])_Str;
          if (*(wchar_t *)(undefined *)_Str == wVar1) {
LAB_14000d214:
            do {
              if (((ulonglong)_Str & 0xfff) < 0xff1) {
                uVar4 = (ulonglong)pauVar11 & 0xfff;
                if (uVar4 < 0xff1) {
                  pcmpistri(*pauVar11,*(undefined (*) [16])_Str,0xd);
                  if (SBORROW8(uVar4,0xff0)) {
                    if ((longlong)(uVar4 - 0xff0) < 0) {
                      return (wchar_t *)pauVar9;
                    }
                    _Str = (wchar_t *)((longlong)_Str + 0x10);
                    pauVar11 = pauVar11[1];
                    goto LAB_14000d214;
                  }
                  break;
                }
              }
              if (*(short *)*pauVar11 == 0) {
                return (wchar_t *)pauVar9;
              }
              if (*(short *)(undefined *)_Str != *(short *)*pauVar11) break;
              _Str = (wchar_t *)((undefined *)_Str + 2);
              pauVar11 = (undefined (*) [16])(*pauVar11 + 2);
            } while( true );
          }
          _Str = (wchar_t *)(*pauVar9 + 2);
        }
        pcmpistri(auVar12,*(undefined (*) [16])_Str,0xd);
        if (uVar4 < 0xff1) {
          if (uVar4 < 0xff0) {
            iVar5 = pcmpistri(auVar12,*(undefined (*) [16])_Str,0xd);
            _Str = (wchar_t *)((undefined *)_Str + (longlong)iVar5 * 2);
            pauVar9 = (undefined (*) [16])_Str;
            goto LAB_14000d214;
          }
          goto LAB_14000d279;
        }
        _Str = (wchar_t *)((longlong)_Str + 0x10);
      } while( true );
    }
    auVar12 = pshuflw(in_XMM1,ZEXT216((ushort)wVar1),0);
LAB_14000d0cb:
    for (; ((ulonglong)_Str & 0xfff) < 0xff1; _Str = _Str + 8) {
      wVar14 = SUB162(auVar12,0);
      wVar15 = SUB162(auVar12 >> 0x10,0);
      auVar13 = CONCAT214(-(ushort)(_Str[7] == L'\0'),
                          CONCAT212(-(ushort)(_Str[6] == L'\0'),
                                    CONCAT210(-(ushort)(_Str[5] == L'\0'),
                                              CONCAT28(-(ushort)(_Str[4] == L'\0'),
                                                       CONCAT26(-(ushort)(_Str[3] == L'\0'),
                                                                CONCAT24(-(ushort)(_Str[2] == L'\0')
                                                                         ,CONCAT22(-(ushort)(_Str[1]
                                                                                            == L'\0'
                                                  ),-(ushort)(*_Str == L'\0')))))))) |
                CONCAT214(-(ushort)(_Str[7] == wVar15),
                          CONCAT212(-(ushort)(_Str[6] == wVar14),
                                    CONCAT210(-(ushort)(_Str[5] == wVar15),
                                              CONCAT28(-(ushort)(_Str[4] == wVar14),
                                                       CONCAT26(-(ushort)(_Str[3] == wVar15),
                                                                CONCAT24(-(ushort)(_Str[2] == wVar14
                                                                                  ),
                                                                         CONCAT22(-(ushort)(_Str[1] 
                                                  == wVar15),-(ushort)(*_Str == wVar14))))))));
      uVar2 = (ushort)(SUB161(auVar13 >> 7,0) & 1) | (ushort)(SUB161(auVar13 >> 0xf,0) & 1) << 1 |
              (ushort)(SUB161(auVar13 >> 0x17,0) & 1) << 2 |
              (ushort)(SUB161(auVar13 >> 0x1f,0) & 1) << 3 |
              (ushort)(SUB161(auVar13 >> 0x27,0) & 1) << 4 |
              (ushort)(SUB161(auVar13 >> 0x2f,0) & 1) << 5 |
              (ushort)(SUB161(auVar13 >> 0x37,0) & 1) << 6 |
              (ushort)(SUB161(auVar13 >> 0x3f,0) & 1) << 7 |
              (ushort)(SUB161(auVar13 >> 0x47,0) & 1) << 8 |
              (ushort)(SUB161(auVar13 >> 0x4f,0) & 1) << 9 |
              (ushort)(SUB161(auVar13 >> 0x57,0) & 1) << 10 |
              (ushort)(SUB161(auVar13 >> 0x5f,0) & 1) << 0xb |
              (ushort)(SUB161(auVar13 >> 0x67,0) & 1) << 0xc |
              (ushort)(SUB161(auVar13 >> 0x6f,0) & 1) << 0xd |
              (ushort)(SUB161(auVar13 >> 0x77,0) & 1) << 0xe |
              (ushort)SUB161(auVar13 >> 0x7f,0) << 0xf;
      if (uVar2 != 0) {
        uVar8 = 0;
        if (uVar2 != 0) {
          for (; (uVar2 >> uVar8 & 1) == 0; uVar8 = uVar8 + 1) {
          }
        }
        _Str = _Str + (uVar8 >> 1);
        break;
      }
    }
    if (*_Str != L'\0') {
      pwVar6 = _Str;
      pwVar3 = _SubStr;
      if (wVar1 == *_Str) {
LAB_14000d119:
        for (; (((ulonglong)pwVar3 & 0xfff) < 0xff1 && (((ulonglong)pwVar6 & 0xfff) < 0xff1));
            pwVar6 = pwVar6 + 8) {
          auVar13 = CONCAT214(-(ushort)(pwVar6[7] != pwVar3[7]),
                              CONCAT212(-(ushort)(pwVar6[6] != pwVar3[6]),
                                        CONCAT210(-(ushort)(pwVar6[5] != pwVar3[5]),
                                                  CONCAT28(-(ushort)(pwVar6[4] != pwVar3[4]),
                                                           CONCAT26(-(ushort)(pwVar6[3] != pwVar3[3]
                                                                             ),
                                                                    CONCAT24(-(ushort)(pwVar6[2] !=
                                                                                      pwVar3[2]),
                                                                             CONCAT22(-(ushort)(
                                                  pwVar6[1] != pwVar3[1]),
                                                  -(ushort)(*pwVar6 != *pwVar3)))))))) |
                    CONCAT214(-(ushort)(pwVar3[7] == L'\0'),
                              CONCAT212(-(ushort)(pwVar3[6] == L'\0'),
                                        CONCAT210(-(ushort)(pwVar3[5] == L'\0'),
                                                  CONCAT28(-(ushort)(pwVar3[4] == L'\0'),
                                                           CONCAT26(-(ushort)(pwVar3[3] == L'\0'),
                                                                    CONCAT24(-(ushort)(pwVar3[2] ==
                                                                                      L'\0'),
                                                                             CONCAT22(-(ushort)(
                                                  pwVar3[1] == L'\0'),-(ushort)(*pwVar3 == L'\0'))))
                                                  ))));
          uVar2 = (ushort)(SUB161(auVar13 >> 7,0) & 1) | (ushort)(SUB161(auVar13 >> 0xf,0) & 1) << 1
                  | (ushort)(SUB161(auVar13 >> 0x17,0) & 1) << 2 |
                  (ushort)(SUB161(auVar13 >> 0x1f,0) & 1) << 3 |
                  (ushort)(SUB161(auVar13 >> 0x27,0) & 1) << 4 |
                  (ushort)(SUB161(auVar13 >> 0x2f,0) & 1) << 5 |
                  (ushort)(SUB161(auVar13 >> 0x37,0) & 1) << 6 |
                  (ushort)(SUB161(auVar13 >> 0x3f,0) & 1) << 7 |
                  (ushort)(SUB161(auVar13 >> 0x47,0) & 1) << 8 |
                  (ushort)(SUB161(auVar13 >> 0x4f,0) & 1) << 9 |
                  (ushort)(SUB161(auVar13 >> 0x57,0) & 1) << 10 |
                  (ushort)(SUB161(auVar13 >> 0x5f,0) & 1) << 0xb |
                  (ushort)(SUB161(auVar13 >> 0x67,0) & 1) << 0xc |
                  (ushort)(SUB161(auVar13 >> 0x6f,0) & 1) << 0xd |
                  (ushort)(SUB161(auVar13 >> 0x77,0) & 1) << 0xe |
                  (ushort)SUB161(auVar13 >> 0x7f,0) << 0xf;
          if (uVar2 != 0) {
            uVar8 = 0;
            if (uVar2 != 0) {
              for (; (uVar2 >> uVar8 & 1) == 0; uVar8 = uVar8 + 1) {
              }
            }
            pwVar6 = pwVar6 + (uVar8 >> 1);
            pwVar3 = pwVar3 + (uVar8 >> 1);
            break;
          }
          pwVar3 = pwVar3 + 8;
        }
        if (*pwVar3 == L'\0') {
          return _Str;
        }
        if (*pwVar6 == *pwVar3) {
          pwVar6 = pwVar6 + 1;
          pwVar3 = pwVar3 + 1;
          goto LAB_14000d119;
        }
      }
      _Str = _Str + 1;
      goto LAB_14000d0cb;
    }
LAB_14000d279:
    _Str = (wchar_t *)0x0;
  }
  return _Str;
}



undefined * FUN_14000d290(void)

{
  DAT_140039a48 = &PTR_DAT_1400386f0;
  return &DAT_140038601;
}



undefined8 FUN_14000d2b0(void)

{
  undefined8 uVar1;
  
  _initialize_onexit_table((ulonglong *)&DAT_140039040);
  uVar1 = _initialize_onexit_table((ulonglong *)&DAT_140039058);
  return CONCAT71((int7)((ulonglong)uVar1 >> 8),1);
}



undefined FUN_14000d2e0(void)

{
  __dcrt_uninitialize_environments_nolock();
  return 1;
}



undefined8 FUN_14000d2f0(void)

{
  byte bVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  bVar1 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
  uVar3 = (0UL >> bVar1 | 0L << 0x40 - bVar1) ^ DAT_140038010;
  FUN_14001201c(uVar3);
  FUN_140010da4(uVar3);
  FUN_140018e80(uVar3);
  FUN_14000d668(uVar3);
  uVar2 = FUN_140010aec(uVar3);
  return CONCAT71((int7)((ulonglong)uVar2 >> 8),1);
}



void FUN_14000d350(void)

{
  __vcrt_uninitialize('\0');
  return;
}



undefined8 FUN_14000d360(void)

{
  uint uVar1;
  ulonglong uVar2;
  
  LOCK();
  uVar1 = *DAT_140039a08;
  uVar2 = (ulonglong)uVar1;
  *DAT_140039a08 = *DAT_140039a08 - 1;
  if ((uVar1 == 1) && (DAT_140039a08 != (uint *)&DAT_1400382b0)) {
    uVar2 = _free_base(DAT_140039a08);
    DAT_140039a08 = (uint *)&DAT_1400382b0;
  }
  return CONCAT71((int7)(uVar2 >> 8),1);
}



undefined FUN_14000d3a0(void)

{
  _free_base(DAT_140039a50);
  DAT_140039a50 = (LPVOID)0x0;
  _free_base(DAT_140039a58);
  DAT_140039a58 = (LPVOID)0x0;
  _free_base(DAT_140038dd0);
  DAT_140038dd0 = (LPVOID)0x0;
  _free_base(DAT_140038dd8);
  DAT_140038dd8 = (LPVOID)0x0;
  return 1;
}



void FUN_14000d3fc(void)

{
  FUN_140018dc4(&PTR_FUN_140029270,(undefined **)&DAT_140029370);
  return;
}



// Library Function - Single Match
//  __acrt_uninitialize
// 
// Library: Visual Studio 2017 Release

undefined8 __acrt_uninitialize(bool param_1)

{
  int iVar1;
  undefined8 in_RAX;
  undefined4 extraout_var;
  undefined8 uVar2;
  
  if (param_1) {
    if (DAT_140038dc0 != 0) {
      iVar1 = common_flush_all(param_1);
      in_RAX = CONCAT44(extraout_var,iVar1);
    }
    return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
  }
  uVar2 = FUN_140018e44((longlong)&PTR_FUN_140029270,(longlong)&DAT_140029370);
  return uVar2;
}



// Library Function - Single Match
//  __acrt_iob_func
// 
// Library: Visual Studio 2015 Release

undefined * __acrt_iob_func(ulonglong param_1)

{
  return &DAT_140038040 + (param_1 & 0xffffffff) * 0x58;
}



void FUN_14000d45c(longlong param_1)

{
                    // WARNING: Could not recover jumptable at 0x00014000d460. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_14000d468(longlong param_1)

{
                    // WARNING: Could not recover jumptable at 0x00014000d46c. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



undefined8 FUN_14000d480(void)

{
  longlong lVar1;
  longlong lVar2;
  undefined4 *puVar3;
  longlong lVar4;
  undefined *puVar5;
  
  lVar1 = 0;
  lVar4 = 3;
  if (DAT_140038db8 == 0) {
    DAT_140038db8 = 0x200;
  }
  else if (DAT_140038db8 < 3) {
    DAT_140038db8 = 3;
  }
  DAT_140038dc0 = _calloc_base((longlong)DAT_140038db8,8);
  _free_base((LPVOID)0x0);
  if (DAT_140038dc0 == (LPVOID)0x0) {
    DAT_140038db8 = 3;
    DAT_140038dc0 = _calloc_base(3,8);
    _free_base((LPVOID)0x0);
    if (DAT_140038dc0 == (LPVOID)0x0) {
      return 0xffffffff;
    }
  }
  puVar3 = &DAT_140038058;
  puVar5 = &DAT_140038040;
  lVar2 = lVar1;
  do {
    __acrt_InitializeCriticalSectionEx((LPCRITICAL_SECTION)(puVar5 + 0x30),4000,0);
    *(undefined **)(lVar1 + (longlong)DAT_140038dc0) = puVar5;
    if (*(longlong *)((&DAT_140039600)[lVar2 >> 6] + 0x28 + (ulonglong)((uint)lVar2 & 0x3f) * 0x40)
        + 2U < 3) {
      *puVar3 = 0xfffffffe;
    }
    lVar2 = lVar2 + 1;
    puVar5 = puVar5 + 0x58;
    lVar1 = lVar1 + 8;
    puVar3 = puVar3 + 0x16;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return 0;
}



// Library Function - Single Match
//  __acrt_uninitialize_stdio
// 
// Library: Visual Studio 2017 Release

void __acrt_uninitialize_stdio(bool param_1)

{
  longlong lVar1;
  
  common_flush_all(param_1);
  _fcloseall();
  lVar1 = 0;
  do {
    __acrt_stdio_free_buffer_nolock(*(undefined8 **)(lVar1 + (longlong)DAT_140038dc0));
    DeleteCriticalSection
              ((LPCRITICAL_SECTION)(*(longlong *)(lVar1 + (longlong)DAT_140038dc0) + 0x30));
    lVar1 = lVar1 + 8;
  } while (lVar1 != 0x18);
  _free_base(DAT_140038dc0);
  DAT_140038dc0 = (LPVOID)0x0;
  return;
}



undefined * FUN_14000d5fc(void)

{
  return &DAT_140038dcc;
}



undefined8 * FUN_14000d604(void)

{
  return &DAT_140038dd8;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined FUN_14000d610(void)

{
  LPSTR pCVar1;
  LPWSTR pWVar2;
  uint7 extraout_var;
  uint7 extraout_var_00;
  
  pCVar1 = GetCommandLineA();
  _DAT_140038de0 = (ulonglong)pCVar1 & 0xff | (ulonglong)extraout_var << 8;
  pWVar2 = GetCommandLineW();
  DAT_140038de8 = (ulonglong)pWVar2 & 0xff | (ulonglong)extraout_var_00 << 8;
  return 1;
}



undefined4 * FUN_14000d638(void)

{
  return &DAT_140038df8;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14000d640(ulonglong param_1)

{
  byte bVar1;
  
  bVar1 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
  _DAT_140038e00 = (param_1 >> bVar1 | param_1 << 0x40 - bVar1) ^ DAT_140038010;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14000d668(undefined8 param_1)

{
  _DAT_140038e00 = param_1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __acrt_has_user_matherr
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

bool __acrt_has_user_matherr(void)

{
  byte bVar1;
  
  bVar1 = (byte)DAT_140038010 & 0x3f;
  return ((DAT_140038010 ^ _DAT_140038e00) >> bVar1 |
         (DAT_140038010 ^ _DAT_140038e00) << 0x40 - bVar1) != 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __acrt_invoke_user_matherr
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_invoke_user_matherr(undefined8 param_1)

{
  undefined8 uVar1;
  byte bVar2;
  code *pcVar3;
  
  bVar2 = (byte)DAT_140038010 & 0x3f;
  pcVar3 = (code *)((DAT_140038010 ^ _DAT_140038e00) >> bVar2 |
                   (DAT_140038010 ^ _DAT_140038e00) << 0x40 - bVar2);
  if (pcVar3 == (code *)0x0) {
    return 0;
  }
  uVar1 = (*pcVar3)(param_1);
                    // WARNING: Treating indirect jump as call
  return uVar1;
}



// Library Function - Single Match
//  public: __cdecl _LocaleUpdate::_LocaleUpdate(struct __crt_locale_pointers * __ptr64 const)
// __ptr64
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

_LocaleUpdate * __thiscall
_LocaleUpdate::_LocaleUpdate(_LocaleUpdate *this,__crt_locale_pointers *param_1)

{
  undefined (*pauVar1) [16];
  uint uVar2;
  __acrt_ptd *p_Var3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  
  this[0x18] = (_LocaleUpdate)0x0;
  pauVar1 = (undefined (*) [16])(this + 8);
  if (param_1 == (__crt_locale_pointers *)0x0) {
    uVar4 = PTR_PTR_DAT_140038848._0_4_;
    uVar5 = PTR_PTR_DAT_140038848._4_4_;
    uVar6 = PTR_DAT_140038850._0_4_;
    uVar7 = PTR_DAT_140038850._4_4_;
    if (DAT_140038e20 != 0) {
      p_Var3 = FUN_140017b04();
      *(__acrt_ptd **)this = p_Var3;
      *(longlong *)*pauVar1 = *(longlong *)(p_Var3 + 0x90);
      *(undefined8 *)(this + 0x10) = *(undefined8 *)(p_Var3 + 0x88);
      FUN_14001a408((longlong)p_Var3,(longlong *)pauVar1);
      __acrt_update_multibyte_info(*(longlong *)this,(longlong *)(this + 0x10));
      uVar2 = *(uint *)(*(longlong *)this + 0x3a8);
      if ((uVar2 & 2) != 0) {
        return this;
      }
      *(uint *)(*(longlong *)this + 0x3a8) = uVar2 | 2;
      this[0x18] = (_LocaleUpdate)0x1;
      return this;
    }
  }
  else {
    uVar4 = *(undefined4 *)param_1;
    uVar5 = *(undefined4 *)(param_1 + 4);
    uVar6 = *(undefined4 *)(param_1 + 8);
    uVar7 = *(undefined4 *)(param_1 + 0xc);
  }
  *pauVar1 = CONCAT412(uVar7,CONCAT48(uVar6,CONCAT44(uVar5,uVar4)));
  return this;
}



ulonglong FUN_14000d75c(FILE *param_1)

{
  uint uVar1;
  ulonglong uVar2;
  ulong *puVar3;
  ulonglong uVar4;
  undefined *puVar5;
  
  uVar1 = *(uint *)((longlong)&param_1->_base + 4) >> 0xc;
  uVar4 = (ulonglong)uVar1;
  if ((uVar1 & 1) == 0) {
    uVar1 = _fileno(param_1);
    uVar2 = (longlong)(int)uVar1 >> 6;
    if (uVar1 + 2 < 2) {
      puVar5 = &DAT_140038170;
    }
    else {
      puVar5 = (undefined *)((ulonglong)(uVar1 & 0x3f) * 0x40 + (&DAT_140039600)[uVar2]);
    }
    if (puVar5[0x39] == '\0') {
      uVar4 = (ulonglong)(uVar1 + 2);
      if (uVar1 + 2 < 2) {
        puVar5 = &DAT_140038170;
      }
      else {
        puVar5 = (undefined *)((ulonglong)(uVar1 & 0x3f) * 0x40 + (&DAT_140039600)[uVar2]);
        uVar4 = uVar2;
      }
      if ((puVar5[0x3d] & 1) == 0) goto LAB_14000d7e7;
    }
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    uVar4 = FUN_140011e58();
    uVar4 = uVar4 & 0xffffffffffffff00;
  }
  else {
LAB_14000d7e7:
    uVar4 = CONCAT71((int7)(uVar4 >> 8),1);
  }
  return uVar4;
}



// Library Function - Single Match
//  void __cdecl __crt_stdio_output::force_decimal_point(char * __ptr64,struct __crt_locale_pointers
// * __ptr64 const)
// 
// Library: Visual Studio 2017 Release

void __cdecl __crt_stdio_output::force_decimal_point(char *param_1,__crt_locale_pointers *param_2)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  byte bVar4;
  bool bVar5;
  
  iVar2 = tolower((int)*param_1);
  if (iVar2 != 0x65) {
    do {
      param_1 = (char *)((byte *)param_1 + 1);
      uVar3 = FUN_140019410((uint)(byte)*param_1);
    } while (uVar3 != 0);
  }
  iVar2 = tolower((int)*param_1);
  if (iVar2 == 0x78) {
    param_1 = (char *)((byte *)param_1 + 2);
  }
  bVar4 = *param_1;
  *param_1 = ***(byte ***)(*(longlong *)param_2 + 0xf8);
  do {
    param_1 = (char *)((byte *)param_1 + 1);
    bVar1 = *param_1;
    *param_1 = bVar4;
    bVar5 = bVar4 != 0;
    bVar4 = bVar1;
  } while (bVar5);
  return;
}



// Library Function - Single Match
//  void __cdecl __crt_stdio_output::crop_zeroes(char * __ptr64,struct __crt_locale_pointers *
// __ptr64 const)
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void __cdecl __crt_stdio_output::crop_zeroes(char *param_1,__crt_locale_pointers *param_2)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  
  cVar1 = *param_1;
  while ((cVar1 != '\0' && (cVar1 != ***(char ***)(*(longlong *)param_2 + 0xf8)))) {
    param_1 = param_1 + 1;
    cVar1 = *param_1;
  }
  if (cVar1 != '\0') {
    do {
      param_1 = param_1 + 1;
      pcVar2 = param_1;
      if (*param_1 == '\0') break;
    } while ((*param_1 + 0xbbU & 0xdf) != 0);
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + -1;
    } while (*pcVar2 == '0');
    pcVar3 = pcVar3 + -2;
    if (*pcVar2 != ***(char ***)(*(longlong *)param_2 + 0xf8)) {
      pcVar3 = pcVar2;
    }
    do {
      cVar1 = *param_1;
      pcVar3 = pcVar3 + 1;
      param_1 = param_1 + 1;
      *pcVar3 = cVar1;
    } while (cVar1 != '\0');
  }
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  int __cdecl common_vsprintf<class __crt_stdio_output::format_validation_base,char>(unsigned
// __int64,char * __ptr64 const,unsigned __int64,char const * __ptr64 const,struct
// __crt_locale_pointers * __ptr64 const,char * __ptr64 const)
//  int __cdecl common_vsprintf<class __crt_stdio_output::standard_base,char>(unsigned __int64,char
// * __ptr64 const,unsigned __int64,char const * __ptr64 const,struct __crt_locale_pointers *
// __ptr64 const,char * __ptr64 const)
// 
// Library: Visual Studio 2017 Release

void common_vsprintf__(ulonglong param_1,undefined *param_2,longlong param_3,longlong param_4,
                      __crt_locale_pointers *param_5,undefined8 param_6)

{
  int iVar1;
  ulong *puVar2;
  undefined auStack_528 [32];
  undefined *local_508;
  longlong local_500;
  longlong local_4f8;
  undefined local_4f0;
  longlong local_4e8;
  undefined local_4e0 [16];
  char local_4d0;
  ulonglong local_4c8;
  undefined *local_4c0;
  undefined8 local_4b8;
  longlong local_4b0;
  undefined8 local_4a8;
  undefined8 local_4a0;
  undefined8 local_498;
  undefined4 local_490;
  undefined2 local_488;
  undefined4 local_478;
  undefined local_474;
  undefined8 local_70;
  LPVOID local_68;
  undefined **local_60;
  undefined4 local_58;
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStack_528;
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (undefined *)0x0)))) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    goto LAB_14000da56;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_4e8,param_5);
  FUN_14000ce30((undefined (*) [16])&local_508,0,0x20);
  local_4f8 = 0;
  if (((param_1 & 2) != 0) || (local_4f0 = 0, param_2 == (undefined *)0x0)) {
    local_4f0 = 1;
  }
  local_60 = &local_508;
  local_4b8 = 0;
  local_4c0 = local_4e0;
  local_4a0 = 0;
  local_4a8 = param_6;
  local_498 = 0;
  local_490 = 0;
  local_488 = 0;
  local_478 = 0;
  local_474 = 0;
  local_70 = 0;
  local_68 = (LPVOID)0x0;
  local_58 = 0;
  local_508 = param_2;
  local_500 = param_3;
  local_4c8 = param_1;
  local_4b0 = param_4;
  iVar1 = FUN_14000ee58(&local_4c8);
  if (param_2 != (undefined *)0x0) {
    if ((param_1 & 1) == 0) {
      if ((param_1 & 2) == 0) {
        if (param_3 != 0) {
          if (local_4f8 != param_3) goto LAB_14000da2a;
LAB_14000da90:
          param_2[param_3 + -1] = 0;
        }
      }
      else if (param_3 != 0) {
        if (-1 < iVar1) {
          if (local_4f8 == param_3) goto LAB_14000da90;
          goto LAB_14000da2a;
        }
        *param_2 = 0;
      }
    }
    else if (((param_3 != 0) || (iVar1 == 0)) && (local_4f8 != param_3)) {
LAB_14000da2a:
      param_2[local_4f8] = 0;
    }
  }
  _free_base(local_68);
  local_68 = (LPVOID)0x0;
  if (local_4d0 != '\0') {
    *(uint *)(local_4e8 + 0x3a8) = *(uint *)(local_4e8 + 0x3a8) & 0xfffffffd;
  }
LAB_14000da56:
  __security_check_cookie(local_48 ^ (ulonglong)auStack_528);
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  int __cdecl common_vsprintf<class __crt_stdio_output::format_validation_base,wchar_t>(unsigned
// __int64,wchar_t * __ptr64 const,unsigned __int64,wchar_t const * __ptr64 const,struct
// __crt_locale_pointers * __ptr64 const,char * __ptr64 const)
//  int __cdecl common_vsprintf<class __crt_stdio_output::standard_base,wchar_t>(unsigned
// __int64,wchar_t * __ptr64 const,unsigned __int64,wchar_t const * __ptr64 const,struct
// __crt_locale_pointers * __ptr64 const,char * __ptr64 const)
// 
// Library: Visual Studio 2017 Release

void common_vsprintf__(ulonglong param_1,undefined2 *param_2,longlong param_3,longlong param_4,
                      __crt_locale_pointers *param_5,undefined8 param_6)

{
  int iVar1;
  ulong *puVar2;
  undefined auStack_528 [32];
  undefined2 *local_508;
  longlong local_500;
  longlong local_4f8;
  undefined local_4f0;
  longlong local_4e8;
  undefined local_4e0 [16];
  char local_4d0;
  ulonglong local_4c8;
  undefined *local_4c0;
  undefined8 local_4b8;
  longlong local_4b0;
  undefined8 local_4a8;
  undefined8 local_4a0;
  undefined8 local_498;
  undefined4 local_490;
  undefined local_488;
  undefined2 local_486;
  undefined4 local_478;
  undefined local_474;
  undefined8 local_70;
  LPVOID local_68;
  undefined2 **local_60;
  undefined4 local_58;
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStack_528;
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (undefined2 *)0x0)))) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    goto LAB_14000dc28;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_4e8,param_5);
  FUN_14000ce30((undefined (*) [16])&local_508,0,0x20);
  local_4f8 = 0;
  if (((param_1 & 2) != 0) || (local_4f0 = 0, param_2 == (undefined2 *)0x0)) {
    local_4f0 = 1;
  }
  local_60 = &local_508;
  local_4b8 = 0;
  local_4c0 = local_4e0;
  local_4a0 = 0;
  local_4a8 = param_6;
  local_498 = 0;
  local_490 = 0;
  local_488 = 0;
  local_486 = 0;
  local_478 = 0;
  local_474 = 0;
  local_70 = 0;
  local_68 = (LPVOID)0x0;
  local_58 = 0;
  local_508 = param_2;
  local_500 = param_3;
  local_4c8 = param_1;
  local_4b0 = param_4;
  iVar1 = FUN_14000f6c8(&local_4c8);
  if (param_2 != (undefined2 *)0x0) {
    if ((param_1 & 1) == 0) {
      if ((param_1 & 2) == 0) {
        if (param_3 != 0) {
          if (local_4f8 != param_3) goto LAB_14000dbfb;
LAB_14000dc62:
          param_2[param_3 + -1] = 0;
        }
      }
      else if (param_3 != 0) {
        if (-1 < iVar1) {
          if (local_4f8 == param_3) goto LAB_14000dc62;
          goto LAB_14000dbfb;
        }
        *param_2 = 0;
      }
    }
    else if (((param_3 != 0) || (iVar1 == 0)) && (local_4f8 != param_3)) {
LAB_14000dbfb:
      param_2[local_4f8] = 0;
    }
  }
  _free_base(local_68);
  local_68 = (LPVOID)0x0;
  if (local_4d0 != '\0') {
    *(uint *)(local_4e8 + 0x3a8) = *(uint *)(local_4e8 + 0x3a8) & 0xfffffffd;
  }
LAB_14000dc28:
  __security_check_cookie(local_48 ^ (ulonglong)auStack_528);
  return;
}



// Library Function - Single Match
//  protected: void __cdecl __crt_stdio_output::output_adapter_common<char,class
// __crt_stdio_output::stream_output_adapter<char> >::write_string_impl(char const * __ptr64
// const,int,int * __ptr64 const,class __crt_deferred_errno_cache & __ptr64)const __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_stdio_output::
output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_>::
write_string_impl(output_adapter_common_char_class___crt_stdio_output__stream_output_adapter_char___
                  *this,char *param_1,int param_2,int *param_3,__crt_deferred_errno_cache *param_4)

{
  ulong uVar1;
  ulong *puVar2;
  ulonglong uVar3;
  ulong *puVar4;
  byte *pbVar5;
  
  puVar2 = *(ulong **)param_4;
  if (puVar2 == (ulong *)0x0) {
    puVar2 = __doserrno();
    *(ulong **)param_4 = puVar2;
  }
  uVar1 = *puVar2;
  *puVar2 = 0;
  pbVar5 = (byte *)(param_1 + param_2);
  do {
    if ((byte *)param_1 == pbVar5) {
LAB_14000dd35:
      if ((*puVar2 == 0) && (uVar1 != 0)) {
        *puVar2 = uVar1;
      }
      return;
    }
    if ((((*(uint *)(*(longlong *)this + 0x14) >> 0xc & 1) == 0) ||
        (*(longlong *)(*(longlong *)this + 8) != 0)) &&
       (uVar3 = _fputc_nolock(*param_1,*(FILE **)this), (int)uVar3 == -1)) {
      puVar4 = *(ulong **)param_4;
      if (puVar4 == (ulong *)0x0) {
        puVar4 = __doserrno();
        *(ulong **)param_4 = puVar4;
      }
      if (*puVar4 != 0x2a) {
        *param_3 = -1;
        goto LAB_14000dd35;
      }
      if ((((*(uint *)(*(longlong *)this + 0x14) >> 0xc & 1) != 0) &&
          (*(longlong *)(*(longlong *)this + 8) == 0)) ||
         (uVar3 = _fputc_nolock(0x3f,*(FILE **)this), (int)uVar3 != -1)) goto LAB_14000dd21;
      *param_3 = -1;
    }
    else {
LAB_14000dd21:
      *param_3 = *param_3 + 1;
    }
    param_1 = (char *)((byte *)param_1 + 1);
  } while( true );
}



undefined4 FUN_14000dd64(ulonglong *param_1)

{
  byte bVar1;
  char cVar2;
  uint uVar3;
  ulong *puVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  int iVar7;
  ulonglong *puVar8;
  
  if ((FILE *)param_1[0x8d] != (FILE *)0x0) {
    uVar5 = FUN_14000d75c((FILE *)param_1[0x8d]);
    if ((char)uVar5 == '\0') {
      return 0xffffffff;
    }
    if (param_1[3] != 0) {
      *(int *)(param_1 + 0x8e) = *(int *)(param_1 + 0x8e) + 1;
      if (*(int *)(param_1 + 0x8e) == 2) {
LAB_14000df4e:
        return *(undefined4 *)(param_1 + 5);
      }
LAB_14000ddc9:
      *(undefined4 *)(param_1 + 10) = 0;
      *(undefined4 *)((longlong)param_1 + 0x2c) = 0;
LAB_14000df26:
      cVar2 = *(char *)param_1[3];
      *(char *)((longlong)param_1 + 0x41) = cVar2;
      if (cVar2 == '\0') goto code_r0x00014000df37;
      param_1[3] = param_1[3] + 1;
      if (*(int *)(param_1 + 5) < 0) goto LAB_14000df3b;
      if ((byte)(*(char *)((longlong)param_1 + 0x41) - 0x20U) < 0x5b) {
        uVar3 = (byte)(&DAT_140029370)[*(char *)((longlong)param_1 + 0x41) + -0x20] & 0xf;
      }
      else {
        uVar3 = 0;
      }
      bVar1 = (&DAT_140029370)[*(int *)((longlong)param_1 + 0x2c) + uVar3 * 8];
      uVar3 = (uint)(bVar1 >> 4);
      *(uint *)((longlong)param_1 + 0x2c) = uVar3;
      if (uVar3 == 8) {
        puVar4 = __doserrno();
        *puVar4 = 0x16;
        FUN_140011e58();
        return 0xffffffff;
      }
      if (bVar1 >> 4 == 0) {
        uVar6 = state_case_normal((longlong)param_1);
        cVar2 = (char)uVar6;
      }
      else {
        if (uVar3 == 1) {
          *(undefined4 *)((longlong)param_1 + 0x34) = 0;
          *(undefined4 *)(param_1 + 6) = 0;
          *(undefined4 *)((longlong)param_1 + 0x3c) = 0;
          *(undefined *)(param_1 + 8) = 0;
          *(undefined4 *)(param_1 + 7) = 0xffffffff;
          *(undefined *)((longlong)param_1 + 0x54) = 0;
          goto LAB_14000df26;
        }
        if (uVar3 == 2) {
          cVar2 = *(char *)((longlong)param_1 + 0x41);
          if (cVar2 == ' ') {
            *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 2;
          }
          else if (cVar2 == '#') {
            *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x20;
          }
          else if (cVar2 == '+') {
            *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 1;
          }
          else if (cVar2 == '-') {
            *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 4;
          }
          else if (cVar2 == '0') {
            *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 8;
          }
          goto LAB_14000df26;
        }
        if (uVar3 != 3) {
          if (uVar3 != 4) {
            if (uVar3 == 5) {
              puVar8 = param_1 + 7;
              if (*(char *)((longlong)param_1 + 0x41) == '*') {
                param_1[4] = param_1[4] + 8;
                iVar7 = *(int *)(param_1[4] - 8);
                if (*(int *)(param_1[4] - 8) < 0) {
                  iVar7 = -1;
                }
                goto LAB_14000dec6;
              }
              goto LAB_14000de7b;
            }
            if (uVar3 == 6) {
              uVar5 = FUN_14000e128(param_1);
              cVar2 = (char)uVar5;
            }
            else {
              if (uVar3 != 7) {
                return 0xffffffff;
              }
              uVar5 = FUN_14000e29c(param_1);
              cVar2 = (char)uVar5;
            }
            goto LAB_14000df22;
          }
          *(undefined4 *)(param_1 + 7) = 0;
          goto LAB_14000df26;
        }
        puVar8 = (ulonglong *)((longlong)param_1 + 0x34);
        if (*(char *)((longlong)param_1 + 0x41) == '*') {
          param_1[4] = param_1[4] + 8;
          iVar7 = *(int *)(param_1[4] - 8);
          *(int *)puVar8 = iVar7;
          if (iVar7 < 0) {
            *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 4;
            iVar7 = -iVar7;
LAB_14000dec6:
            *(int *)puVar8 = iVar7;
          }
          cVar2 = '\x01';
        }
        else {
LAB_14000de7b:
          uVar5 = parse_int_from_format_string((longlong)param_1,(long *)puVar8);
          cVar2 = (char)uVar5;
        }
      }
LAB_14000df22:
      if (cVar2 == '\0') {
        return 0xffffffff;
      }
      goto LAB_14000df26;
    }
  }
  puVar4 = __doserrno();
  *puVar4 = 0x16;
  FUN_140011e58();
  return 0xffffffff;
code_r0x00014000df37:
  param_1[3] = param_1[3] + 1;
LAB_14000df3b:
  *(int *)(param_1 + 0x8e) = *(int *)(param_1 + 0x8e) + 1;
  if (*(int *)(param_1 + 0x8e) == 2) goto LAB_14000df4e;
  goto LAB_14000ddc9;
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::state_case_normal(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::state_case_normal(void) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 state_case_normal(longlong param_1)

{
  ulonglong uVar1;
  ulong *puVar2;
  
  uVar1 = FUN_14000dfe8(param_1);
  if ((char)uVar1 != '\0') {
    if ((((*(uint *)(*(longlong *)(param_1 + 0x468) + 0x14) >> 0xc & 1) == 0) ||
        (uVar1 = *(ulonglong *)(param_1 + 0x468), *(longlong *)(uVar1 + 8) != 0)) &&
       (uVar1 = _fputc_nolock(*(byte *)(param_1 + 0x41),*(FILE **)(param_1 + 0x468)),
       (int)uVar1 == -1)) {
      *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
    }
    else {
      *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
    }
    return CONCAT71((int7)(uVar1 >> 8),1);
  }
  puVar2 = __doserrno();
  *puVar2 = 0x16;
  uVar1 = FUN_140011e58();
  return uVar1 & 0xffffffffffffff00;
}



ulonglong FUN_14000dfe8(longlong param_1)

{
  char cVar1;
  ulonglong uVar2;
  char *pcVar3;
  ulong *puVar4;
  
  *(undefined *)(param_1 + 0x54) = 0;
  pcVar3 = *(char **)**(undefined8 **)(param_1 + 8);
  if (*(short *)(pcVar3 + (ulonglong)*(byte *)(param_1 + 0x41) * 2) < 0) {
    if ((((*(uint *)(*(longlong *)(param_1 + 0x468) + 0x14) >> 0xc & 1) == 0) ||
        (*(longlong *)(*(longlong *)(param_1 + 0x468) + 8) != 0)) &&
       (uVar2 = _fputc_nolock(*(byte *)(param_1 + 0x41),*(FILE **)(param_1 + 0x468)),
       (int)uVar2 == -1)) {
      *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
    }
    else {
      *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
    }
    cVar1 = **(char **)(param_1 + 0x18);
    pcVar3 = *(char **)(param_1 + 0x18) + 1;
    *(char *)(param_1 + 0x41) = cVar1;
    *(char **)(param_1 + 0x18) = pcVar3;
    if (cVar1 == '\0') {
      puVar4 = __doserrno();
      *puVar4 = 0x16;
      uVar2 = FUN_140011e58();
      return uVar2 & 0xffffffffffffff00;
    }
  }
  return CONCAT71((int7)((ulonglong)pcVar3 >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> > >::parse_int_from_format_string(int * __ptr64
// const) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::positional_parameter_base<char,class
// __crt_stdio_output::console_output_adapter<char> > >::parse_int_from_format_string(int * __ptr64
// const) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::parse_int_from_format_string(int * __ptr64 const) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::parse_int_from_format_string(int * __ptr64
// const) __ptr64
//   9 names - too many to list
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong parse_int_from_format_string(longlong param_1,long *param_2)

{
  ulong uVar1;
  long lVar2;
  ulong *puVar3;
  ulong *puVar4;
  ulonglong uVar5;
  ulong *local_res8;
  
  puVar3 = *(ulong **)(param_1 + 0x10);
  if (puVar3 == (ulong *)0x0) {
    puVar3 = __doserrno();
    *(ulong **)(param_1 + 0x10) = puVar3;
  }
  uVar1 = *puVar3;
  *puVar3 = 0;
  uVar5 = 1;
  local_res8 = (ulong *)0x0;
  lVar2 = strtol((char *)(*(longlong *)(param_1 + 0x18) + -1),(char **)&local_res8,10);
  *param_2 = lVar2;
  puVar4 = *(ulong **)(param_1 + 0x10);
  if (puVar4 == (ulong *)0x0) {
    puVar4 = __doserrno();
    *(ulong **)(param_1 + 0x10) = puVar4;
  }
  if ((*puVar4 == 0x22) || (puVar4 = local_res8, local_res8 < *(ulong **)(param_1 + 0x18))) {
    uVar5 = 0;
  }
  else {
    *(ulong **)(param_1 + 0x18) = local_res8;
  }
  if ((*puVar3 == 0) && (uVar1 != 0)) {
    *puVar3 = uVar1;
  }
  return (ulonglong)puVar4 & 0xffffffffffffff00 | uVar5;
}



ulonglong FUN_14000e128(ulonglong *param_1)

{
  char cVar1;
  char *pcVar2;
  ulonglong in_RAX;
  ulonglong uVar3;
  ulong *puVar4;
  char *pcVar5;
  
  cVar1 = *(char *)((longlong)param_1 + 0x41);
  pcVar5 = (char *)(in_RAX & 0xffffffffffffff00);
  if (cVar1 == 'F') {
    if ((*(byte *)param_1 & 8) == 0) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 7;
      uVar3 = FUN_14000e29c(param_1);
      return uVar3;
    }
  }
  else if (cVar1 == 'N') {
    if ((*(byte *)param_1 & 8) == 0) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 8;
LAB_14000e160:
      puVar4 = __doserrno();
      *puVar4 = 0x16;
      uVar3 = FUN_140011e58();
      return uVar3 & 0xffffffffffffff00;
    }
  }
  else {
    if (*(int *)((longlong)param_1 + 0x3c) != 0) goto LAB_14000e160;
    if (cVar1 == 'I') {
      pcVar2 = (char *)param_1[3];
      cVar1 = *pcVar2;
      if ((cVar1 == '3') && (pcVar2[1] == '2')) {
        pcVar5 = pcVar2 + 2;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 10;
        param_1[3] = (ulonglong)pcVar5;
      }
      else if ((cVar1 == '6') && (pcVar2[1] == '4')) {
        pcVar5 = pcVar2 + 2;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 0xb;
        param_1[3] = (ulonglong)pcVar5;
      }
      else if (((byte)(cVar1 + 0xa8U) < 0x21) &&
              (pcVar5 = (char *)(longlong)(char)(cVar1 + 0xa8U),
              (0x120821001U >> ((ulonglong)pcVar5 & 0x3f) & 1) != 0)) {
        *(undefined4 *)((longlong)param_1 + 0x3c) = 9;
      }
    }
    else if (cVar1 == 'L') {
      *(undefined4 *)((longlong)param_1 + 0x3c) = 8;
    }
    else if (cVar1 == 'T') {
      *(undefined4 *)((longlong)param_1 + 0x3c) = 0xd;
    }
    else {
      if (cVar1 == 'h') {
        if (*(char *)param_1[3] == 'h') {
          param_1[3] = (ulonglong)((char *)param_1[3] + 1);
          pcVar5 = (char *)0x1;
        }
        else {
          pcVar5 = (char *)0x2;
        }
      }
      else {
        if (cVar1 == 'j') {
          *(undefined4 *)((longlong)param_1 + 0x3c) = 5;
          goto LAB_14000e294;
        }
        if (cVar1 != 'l') {
          if (cVar1 == 't') {
            *(undefined4 *)((longlong)param_1 + 0x3c) = 7;
          }
          else {
            if (cVar1 != 'w') {
              uVar3 = CONCAT71((int7)((ulonglong)pcVar5 >> 8),1);
              if (cVar1 != 'z') {
                return uVar3;
              }
              *(undefined4 *)((longlong)param_1 + 0x3c) = 6;
              return uVar3;
            }
            *(undefined4 *)((longlong)param_1 + 0x3c) = 0xc;
          }
          goto LAB_14000e294;
        }
        if (*(char *)param_1[3] == 'l') {
          param_1[3] = (ulonglong)((char *)param_1[3] + 1);
          pcVar5 = &DAT_00000004;
        }
        else {
          pcVar5 = (char *)0x3;
        }
      }
      *(int *)((longlong)param_1 + 0x3c) = (int)pcVar5;
    }
  }
LAB_14000e294:
  return CONCAT71((int7)((ulonglong)pcVar5 >> 8),1);
}



ulonglong FUN_14000e29c(ulonglong *param_1)

{
  ulonglong *puVar1;
  ulonglong *this;
  char cVar2;
  bool bVar3;
  uint uVar4;
  ulonglong uVar5;
  ulonglong extraout_RAX;
  undefined uVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  byte bVar10;
  longlong lVar11;
  undefined2 local_res8;
  undefined local_resa;
  
  uVar4 = (uint)*(char *)((longlong)param_1 + 0x41);
  uVar5 = (ulonglong)uVar4;
  uVar6 = 0x78;
  lVar11 = 1;
  if ((int)uVar4 < 0x65) {
    if (uVar4 == 100) {
LAB_14000e39c:
      *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x10;
LAB_14000e3a0:
      uVar4 = 10;
LAB_14000e3a5:
      bVar10 = 0;
LAB_14000e3a8:
      uVar5 = type_case_integer((longlong)param_1,uVar4,bVar10);
    }
    else {
      if (uVar4 == 0x41) goto LAB_14000e3af;
      if (uVar4 == 0x43) {
LAB_14000e310:
        uVar5 = FUN_14000e52c((longlong)param_1);
      }
      else {
        if ((int)uVar4 < 0x45) goto LAB_14000e3b8;
        if ((int)uVar4 < 0x48) goto LAB_14000e3af;
        if (uVar4 == 0x53) {
LAB_14000e358:
          uVar5 = type_case_s((longlong)param_1);
        }
        else {
          if (uVar4 == 0x58) goto LAB_14000e36d;
          if (uVar4 != 0x5a) {
            if (uVar4 != 0x61) {
              if (uVar4 != 99) goto LAB_14000e3b8;
              goto LAB_14000e310;
            }
            goto LAB_14000e3af;
          }
          uVar5 = type_case_Z((longlong)param_1);
        }
      }
    }
  }
  else {
    if (0x67 < (int)uVar4) {
      if (uVar4 == 0x69) goto LAB_14000e39c;
      if (uVar4 == 0x6e) {
        uVar5 = type_case_n((longlong)param_1);
        goto LAB_14000e3b4;
      }
      if (uVar4 == 0x6f) {
        if ((*(uint *)(param_1 + 6) >> 5 & 1) != 0) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x80;
        }
        uVar4 = 8;
        goto LAB_14000e3a5;
      }
      if (uVar4 != 0x70) {
        if (uVar4 == 0x73) goto LAB_14000e358;
        if (uVar4 != 0x75) {
          if (uVar4 != 0x78) goto LAB_14000e3b8;
          uVar4 = 0x10;
          goto LAB_14000e3a5;
        }
        goto LAB_14000e3a0;
      }
      *(undefined4 *)(param_1 + 7) = 0x10;
      *(undefined4 *)((longlong)param_1 + 0x3c) = 0xb;
LAB_14000e36d:
      bVar10 = 1;
      uVar4 = 0x10;
      goto LAB_14000e3a8;
    }
LAB_14000e3af:
    uVar5 = FUN_14000e700(param_1);
  }
LAB_14000e3b4:
  if ((char)uVar5 != '\0') {
    if (*(char *)(param_1 + 8) == '\0') {
      uVar4 = *(uint *)(param_1 + 6);
      local_res8 = 0;
      local_resa = 0;
      lVar9 = 0;
      if ((uVar4 >> 4 & 1) != 0) {
        if ((uVar4 >> 6 & 1) == 0) {
          if ((uVar4 & 1) == 0) {
            if ((uVar4 >> 1 & 1) != 0) {
              local_res8 = 0x20;
              lVar9 = lVar11;
            }
          }
          else {
            local_res8 = 0x2b;
            lVar9 = lVar11;
          }
        }
        else {
          local_res8 = 0x2d;
          lVar9 = lVar11;
        }
      }
      cVar2 = *(char *)((longlong)param_1 + 0x41);
      if (((cVar2 + 0xa8U & 0xdf) == 0) && ((uVar4 >> 5 & 1) != 0)) {
        bVar3 = true;
      }
      else {
        bVar3 = false;
      }
      if ((bVar3) || ((cVar2 + 0xbfU & 0xdf) == 0)) {
        *(undefined *)((longlong)&local_res8 + lVar9) = 0x30;
        if ((cVar2 == 'X') || (cVar2 == 'A')) {
          uVar6 = 0x58;
        }
        *(undefined *)((longlong)&local_res8 + lVar9 + 1) = uVar6;
        lVar9 = lVar9 + 2;
      }
      iVar8 = (int)lVar9;
      iVar7 = (*(int *)((longlong)param_1 + 0x34) - *(int *)(param_1 + 10)) - iVar8;
      if ((uVar4 & 0xc) == 0) {
        __crt_stdio_output::
        write_multiple_characters_class___crt_stdio_output__stream_output_adapter_char__char_
                  ((stream_output_adapter_char_ *)(param_1 + 0x8d),' ',iVar7,(int *)(param_1 + 5));
      }
      this = param_1 + 0x8d;
      puVar1 = param_1 + 5;
      if (((*(uint *)(*this + 0x14) >> 0xc & 1) == 0) || (*(longlong *)(*this + 8) != 0)) {
        __crt_stdio_output::
        output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_>::
        write_string_impl((output_adapter_common_char_class___crt_stdio_output__stream_output_adapter_char___
                           *)this,(char *)&local_res8,iVar8,(int *)puVar1,
                          (__crt_deferred_errno_cache *)(param_1 + 2));
      }
      else {
        *(int *)puVar1 = *(int *)puVar1 + iVar8;
      }
      if (((*(uint *)(param_1 + 6) >> 3 & 1) != 0) && ((*(uint *)(param_1 + 6) >> 2 & 1) == 0)) {
        __crt_stdio_output::
        write_multiple_characters_class___crt_stdio_output__stream_output_adapter_char__char_
                  ((stream_output_adapter_char_ *)this,'0',iVar7,(int *)puVar1);
      }
      uVar5 = write_stored_string_tchar((longlong)param_1);
      if ((-1 < *(int *)puVar1) &&
         (uVar5 = (ulonglong)(*(uint *)(param_1 + 6) >> 2), (*(uint *)(param_1 + 6) >> 2 & 1) != 0))
      {
        __crt_stdio_output::
        write_multiple_characters_class___crt_stdio_output__stream_output_adapter_char__char_
                  ((stream_output_adapter_char_ *)this,' ',iVar7,(int *)puVar1);
        uVar5 = extraout_RAX;
      }
    }
    return uVar5 & 0xffffffffffffff00 | 1;
  }
LAB_14000e3b8:
  return uVar5 & 0xffffffffffffff00;
}



undefined8 FUN_14000e52c(longlong param_1)

{
  int iVar1;
  errno_t eVar2;
  ulonglong in_RAX;
  undefined4 extraout_var;
  longlong lVar3;
  char *_MbCh;
  rsize_t _SizeInBytes;
  undefined *puVar4;
  
  iVar1 = *(int *)(param_1 + 0x3c);
  if (iVar1 == 2) {
    in_RAX = in_RAX & 0xffffffffffffff00;
LAB_14000e55f:
    if ((char)in_RAX == '\0') {
LAB_14000e5a9:
      puVar4 = *(undefined **)(param_1 + 0x460);
      if (*(undefined **)(param_1 + 0x460) == (undefined *)0x0) {
        puVar4 = (undefined *)(param_1 + 0x58);
      }
      *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
      *puVar4 = *(undefined *)(*(longlong *)(param_1 + 0x20) + -8);
      *(undefined4 *)(param_1 + 0x50) = 1;
      goto LAB_14000e5d1;
    }
  }
  else if ((iVar1 != 3) && (iVar1 != 0xc)) {
    if (*(int *)(param_1 + 0x3c) != 0xd) {
      in_RAX = in_RAX & 0xffffffffffffff00 |
               (ulonglong)((*(char *)(param_1 + 0x41) + 0x9dU & 0xef) != 0);
      goto LAB_14000e55f;
    }
    goto LAB_14000e5a9;
  }
  *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
  _MbCh = *(char **)(param_1 + 0x460);
  if (_MbCh == (char *)0x0) {
    _SizeInBytes = 0x200;
    _MbCh = (char *)(param_1 + 0x58);
  }
  else {
    _SizeInBytes = *(ulonglong *)(param_1 + 0x458) >> 1;
  }
  eVar2 = wctomb_s((int *)(param_1 + 0x50),_MbCh,_SizeInBytes,
                   *(wchar_t *)(*(longlong *)(param_1 + 0x20) + -8));
  in_RAX = CONCAT44(extraout_var,eVar2);
  if (eVar2 != 0) {
    *(undefined *)(param_1 + 0x40) = 1;
  }
LAB_14000e5d1:
  lVar3 = *(longlong *)(param_1 + 0x460);
  if (*(longlong *)(param_1 + 0x460) == 0) {
    lVar3 = param_1 + 0x58;
  }
  *(longlong *)(param_1 + 0x48) = lVar3;
  return CONCAT71((int7)(in_RAX >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> > >::type_case_Z(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::type_case_Z(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::type_case_Z(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::type_case_Z(void) __ptr64
//   6 names - too many to list
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release

undefined8 type_case_Z(longlong param_1)

{
  ushort uVar1;
  int iVar2;
  ushort *puVar3;
  ulonglong uVar4;
  bool bVar5;
  
  *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
  puVar3 = *(ushort **)(*(longlong *)(param_1 + 0x20) + -8);
  if ((puVar3 == (ushort *)0x0) || (*(longlong *)(puVar3 + 4) == 0)) {
    uVar4 = 6;
    *(undefined1 **)(param_1 + 0x48) = &DAT_140031550;
  }
  else {
    iVar2 = *(int *)(param_1 + 0x3c);
    if (iVar2 == 2) {
LAB_14000e633:
      bVar5 = false;
    }
    else if ((iVar2 == 3) || (iVar2 == 0xc)) {
      bVar5 = true;
    }
    else {
      if (*(int *)(param_1 + 0x3c) == 0xd) goto LAB_14000e633;
      bVar5 = (*(char *)(param_1 + 0x41) + 0x9dU & 0xef) != 0;
    }
    *(longlong *)(param_1 + 0x48) = *(longlong *)(puVar3 + 4);
    uVar1 = *puVar3;
    uVar4 = (ulonglong)uVar1;
    if (bVar5) {
      *(undefined *)(param_1 + 0x54) = 1;
      uVar4 = (ulonglong)(uVar1 >> 1);
      goto LAB_14000e660;
    }
  }
  *(undefined *)(param_1 + 0x54) = 0;
LAB_14000e660:
  *(int *)(param_1 + 0x50) = (int)uVar4;
  return CONCAT71((int7)(uVar4 >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> > >::type_case_s(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::type_case_s(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::type_case_s(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::type_case_s(void) __ptr64
//   6 names - too many to list
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

undefined8 type_case_s(longlong param_1)

{
  int iVar1;
  int iVar2;
  size_t sVar3;
  wchar_t *_Src;
  bool bVar4;
  
  *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
  iVar2 = *(int *)(param_1 + 0x38);
  _Src = *(wchar_t **)(*(longlong *)(param_1 + 0x20) + -8);
  iVar1 = *(int *)(param_1 + 0x3c);
  if (iVar2 == -1) {
    iVar2 = 0x7fffffff;
  }
  *(wchar_t **)(param_1 + 0x48) = _Src;
  if (iVar1 == 2) {
    bVar4 = false;
LAB_14000e6b9:
    if (!bVar4) {
LAB_14000e6db:
      if (_Src == (wchar_t *)0x0) {
        _Src = L"渨汵⥬";
        *(undefined1 **)(param_1 + 0x48) = &DAT_140031550;
      }
      sVar3 = strnlen((char *)_Src,(longlong)iVar2);
      goto LAB_14000e6f3;
    }
  }
  else if ((iVar1 != 3) && (iVar1 != 0xc)) {
    if (*(int *)(param_1 + 0x3c) != 0xd) {
      bVar4 = (*(char *)(param_1 + 0x41) + 0x9dU & 0xef) != 0;
      goto LAB_14000e6b9;
    }
    goto LAB_14000e6db;
  }
  if (_Src == (wchar_t *)0x0) {
    _Src = L"(null)";
    *(wchar_t **)(param_1 + 0x48) = L"(null)";
  }
  *(undefined *)(param_1 + 0x54) = 1;
  sVar3 = wcsnlen(_Src,(longlong)iVar2);
LAB_14000e6f3:
  *(int *)(param_1 + 0x50) = (int)sVar3;
  return CONCAT71((int7)(sVar3 >> 8),1);
}



undefined8 FUN_14000e700(ulonglong *param_1)

{
  ulonglong *puVar1;
  char cVar2;
  int iVar3;
  ulonglong uVar4;
  ulonglong *puVar5;
  ulonglong extraout_RAX;
  ulonglong extraout_RAX_00;
  char *pcVar6;
  __uint64 _Var7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong *puVar10;
  double local_res8;
  
  *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x10;
  iVar3 = *(int *)(param_1 + 7);
  if (iVar3 < 0) {
    iVar3 = (-(uint)((*(char *)((longlong)param_1 + 0x41) + 0xbfU & 0xdf) != 0) & 0xfffffff9) + 0xd;
    *(int *)(param_1 + 7) = iVar3;
  }
  else if ((iVar3 == 0) &&
          ((*(char *)((longlong)param_1 + 0x41) == 'g' ||
           (iVar3 = 0, *(char *)((longlong)param_1 + 0x41) == 'G')))) {
    *(undefined4 *)(param_1 + 7) = 1;
    iVar3 = 1;
  }
  puVar1 = param_1 + 0xb;
  uVar4 = FUN_140010634((longlong)puVar1,(longlong)(iVar3 + 0x15d));
  uVar9 = 0x200;
  if ((char)uVar4 == '\0') {
    if (param_1[0x8c] == 0) {
      iVar3 = 0x200;
    }
    else {
      iVar3 = (int)(param_1[0x8b] >> 1);
    }
    *(int *)(param_1 + 7) = iVar3 + -0x15d;
  }
  puVar5 = (ulonglong *)param_1[0x8c];
  if ((ulonglong *)param_1[0x8c] == (ulonglong *)0x0) {
    puVar5 = puVar1;
  }
  param_1[9] = (ulonglong)puVar5;
  param_1[4] = param_1[4] + 8;
  puVar5 = (ulonglong *)param_1[0x8c];
  local_res8 = *(double *)(param_1[4] - 8);
  if (puVar5 == (ulonglong *)0x0) {
    _Var7 = 0x200;
    puVar10 = param_1 + 0x4b;
    puVar5 = puVar1;
  }
  else {
    _Var7 = param_1[0x8b] >> 1;
    puVar10 = (ulonglong *)((param_1[0x8b] >> 1) + (longlong)puVar5);
    uVar9 = param_1[0x8b] >> 1;
  }
  __acrt_fp_format(&local_res8,puVar5,uVar9,(char *)puVar10,_Var7,
                   (int)*(char *)((longlong)param_1 + 0x41),*(uint *)(param_1 + 7),*param_1,
                   (__crt_locale_pointers *)param_1[1]);
  uVar4 = (ulonglong)(*(uint *)(param_1 + 6) >> 5);
  if (((*(uint *)(param_1 + 6) >> 5 & 1) != 0) && (*(int *)(param_1 + 7) == 0)) {
    __crt_stdio_output::force_decimal_point((char *)param_1[9],(__crt_locale_pointers *)param_1[1]);
    uVar4 = extraout_RAX;
  }
  uVar4 = uVar4 & 0xffffffffffffff00;
  if (((*(char *)((longlong)param_1 + 0x41) + 0xb9U & 0xdf) == 0) &&
     (uVar4 = (ulonglong)(*(uint *)(param_1 + 6) >> 5), (*(uint *)(param_1 + 6) >> 5 & 1) == 0)) {
    __crt_stdio_output::crop_zeroes((char *)param_1[9],(__crt_locale_pointers *)param_1[1]);
    uVar4 = extraout_RAX_00;
  }
  pcVar6 = (char *)param_1[9];
  cVar2 = *pcVar6;
  if (cVar2 == '-') {
    *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x40;
    pcVar6 = pcVar6 + 1;
    param_1[9] = (ulonglong)pcVar6;
    cVar2 = *pcVar6;
  }
  if (((byte)(cVar2 + 0xb7U) < 0x26) &&
     ((0x2100000021U >> ((ulonglong)(byte)(cVar2 + 0xb7U) & 0x3f) & 1) != 0)) {
    *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) & 0xfffffff7;
    *(undefined *)((longlong)param_1 + 0x41) = 0x73;
  }
  lVar8 = -1;
  do {
    lVar8 = lVar8 + 1;
  } while (pcVar6[lVar8] != '\0');
  *(int *)(param_1 + 10) = (int)lVar8;
  return CONCAT71((int7)(uVar4 >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> > >::type_case_integer(unsigned int,bool)
// __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::type_case_integer(unsigned int,bool) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::type_case_integer(unsigned int,bool) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::type_case_integer(unsigned int,bool) __ptr64
//   6 names - too many to list
// 
// Library: Visual Studio 2017 Release

ulonglong type_case_integer(longlong param_1,uint param_2,byte param_3)

{
  ulong *puVar1;
  ulonglong uVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  
  iVar3 = *(int *)(param_1 + 0x3c);
  lVar5 = 8;
  if (iVar3 < 6) {
    if (iVar3 == 5) goto LAB_14000e90b;
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        lVar5 = 1;
        goto LAB_14000e90b;
      }
      iVar3 = iVar3 + -2;
      if (iVar3 == 0) {
        lVar5 = 2;
        goto LAB_14000e90b;
      }
      goto LAB_14000e8fe;
    }
  }
  else {
    if (((iVar3 == 6) || (iVar3 == 7)) || (iVar3 = iVar3 + -9, iVar3 == 0)) goto LAB_14000e90b;
LAB_14000e8fe:
    if (iVar3 != 1) {
      if (iVar3 != 2) {
        lVar5 = 0;
      }
      goto LAB_14000e90b;
    }
  }
  lVar5 = 4;
LAB_14000e90b:
  if (lVar5 == 1) {
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    if ((*(uint *)(param_1 + 0x30) >> 4 & 1) == 0) {
      uVar2 = (ulonglong)*(byte *)(*(longlong *)(param_1 + 0x20) + -8);
    }
    else {
      uVar2 = (ulonglong)*(char *)(*(longlong *)(param_1 + 0x20) + -8);
    }
  }
  else if (lVar5 == 2) {
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    if ((*(uint *)(param_1 + 0x30) >> 4 & 1) == 0) {
      uVar2 = (ulonglong)*(ushort *)(*(longlong *)(param_1 + 0x20) + -8);
    }
    else {
      uVar2 = (ulonglong)*(short *)(*(longlong *)(param_1 + 0x20) + -8);
    }
  }
  else if (lVar5 == 4) {
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    if ((*(uint *)(param_1 + 0x30) >> 4 & 1) == 0) {
      uVar2 = (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x20) + -8);
    }
    else {
      uVar2 = (ulonglong)*(int *)(*(longlong *)(param_1 + 0x20) + -8);
    }
  }
  else {
    if (lVar5 != 8) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      uVar2 = FUN_140011e58();
      return uVar2 & 0xffffffffffffff00;
    }
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    uVar2 = *(ulonglong *)(*(longlong *)(param_1 + 0x20) + -8);
  }
  uVar4 = *(uint *)(param_1 + 0x30);
  if (((uVar4 >> 4 & 1) != 0) && ((longlong)uVar2 < 0)) {
    uVar2 = -uVar2;
    uVar4 = uVar4 | 0x40;
    *(uint *)(param_1 + 0x30) = uVar4;
  }
  if (*(int *)(param_1 + 0x38) < 0) {
    *(undefined4 *)(param_1 + 0x38) = 1;
  }
  else {
    *(uint *)(param_1 + 0x30) = uVar4 & 0xfffffff7;
    FUN_140010634(param_1 + 0x58,(longlong)*(int *)(param_1 + 0x38));
  }
  if (uVar2 == 0) {
    *(uint *)(param_1 + 0x30) = *(uint *)(param_1 + 0x30) & 0xffffffdf;
  }
  *(undefined *)(param_1 + 0x54) = 0;
  if (lVar5 == 8) {
    type_case_integer_parse_into_buffer__(param_1,uVar2,(ulonglong)param_2,param_3);
  }
  else {
    type_case_integer_parse_into_buffer__(param_1,(uint)uVar2,param_2,param_3);
  }
  uVar4 = *(uint *)(param_1 + 0x30);
  if (((uVar4 >> 7 & 1) != 0) &&
     ((*(int *)(param_1 + 0x50) == 0 || (**(char **)(param_1 + 0x48) != '0')))) {
    *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + -1;
    **(undefined **)(param_1 + 0x48) = 0x30;
    *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
  }
  return CONCAT71((uint7)(uint3)(uVar4 >> 0xf),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> > >::type_case_n(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::type_case_n(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::type_case_n(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::type_case_n(void) __ptr64
//   12 names - too many to list
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong type_case_n(longlong param_1)

{
  ulonglong *puVar1;
  int iVar2;
  undefined4 extraout_var;
  ulong *puVar3;
  ulonglong uVar4;
  longlong lVar5;
  
  lVar5 = 8;
  *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
  puVar1 = *(ulonglong **)(*(longlong *)(param_1 + 0x20) + -8);
  iVar2 = _get_printf_count_output();
  uVar4 = CONCAT44(extraout_var,iVar2);
  if (iVar2 == 0) {
LAB_14000eab0:
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    uVar4 = FUN_140011e58();
    uVar4 = uVar4 & 0xffffffffffffff00;
  }
  else {
    iVar2 = *(int *)(param_1 + 0x3c);
    if (iVar2 < 6) {
      if (iVar2 != 5) {
        if (iVar2 == 0) goto LAB_14000eb11;
        if (iVar2 == 1) {
          lVar5 = 1;
        }
        else {
          iVar2 = iVar2 + -2;
          if (iVar2 != 0) goto LAB_14000eae4;
          lVar5 = 2;
        }
      }
    }
    else if (((iVar2 != 6) && (iVar2 != 7)) && (iVar2 = iVar2 + -9, iVar2 != 0)) {
LAB_14000eae4:
      if (iVar2 == 1) {
LAB_14000eb11:
        lVar5 = 4;
      }
      else if (iVar2 != 2) {
        lVar5 = 0;
      }
    }
    if (lVar5 == 1) {
      *(undefined *)puVar1 = *(undefined *)(param_1 + 0x28);
    }
    else if (lVar5 == 2) {
      uVar4 = (ulonglong)*(ushort *)(param_1 + 0x28);
      *(ushort *)puVar1 = *(ushort *)(param_1 + 0x28);
    }
    else if (lVar5 == 4) {
      uVar4 = (ulonglong)*(uint *)(param_1 + 0x28);
      *(uint *)puVar1 = *(uint *)(param_1 + 0x28);
    }
    else {
      if (lVar5 != 8) goto LAB_14000eab0;
      uVar4 = (ulonglong)*(int *)(param_1 + 0x28);
      *puVar1 = uVar4;
    }
    *(undefined *)(param_1 + 0x40) = 1;
    uVar4 = CONCAT71((int7)(uVar4 >> 8),1);
  }
  return uVar4;
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::write_stored_string_tchar(char) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::positional_parameter_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::write_stored_string_tchar(char) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::write_stored_string_tchar(char) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void write_stored_string_tchar(longlong param_1)

{
  int *piVar1;
  longlong *plVar2;
  wchar_t _WCh;
  errno_t eVar3;
  wchar_t *pwVar4;
  int iVar5;
  undefined auStackY_58 [32];
  int local_28;
  char local_24 [12];
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStackY_58;
  if ((*(char *)(param_1 + 0x54) == '\0') || (*(int *)(param_1 + 0x50) < 1)) {
    plVar2 = (longlong *)(param_1 + 0x468);
    piVar1 = (int *)(param_1 + 0x28);
    if (((*(uint *)(*plVar2 + 0x14) >> 0xc & 1) == 0) || (*(longlong *)(*plVar2 + 8) != 0)) {
      __crt_stdio_output::
      output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_>::
      write_string_impl((output_adapter_common_char_class___crt_stdio_output__stream_output_adapter_char___
                         *)plVar2,*(char **)(param_1 + 0x48),*(int *)(param_1 + 0x50),piVar1,
                        (__crt_deferred_errno_cache *)(param_1 + 0x10));
    }
    else {
      *piVar1 = *piVar1 + *(int *)(param_1 + 0x50);
    }
  }
  else {
    pwVar4 = *(wchar_t **)(param_1 + 0x48);
    iVar5 = 0;
    if (*(int *)(param_1 + 0x50) != 0) {
      do {
        _WCh = *pwVar4;
        local_28 = 0;
        pwVar4 = pwVar4 + 1;
        eVar3 = wctomb_s(&local_28,local_24,6,_WCh);
        if ((eVar3 != 0) || (local_28 == 0)) {
          *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
          break;
        }
        plVar2 = (longlong *)(param_1 + 0x468);
        piVar1 = (int *)(param_1 + 0x28);
        if (((*(uint *)(*plVar2 + 0x14) >> 0xc & 1) == 0) || (*(longlong *)(*plVar2 + 8) != 0)) {
          __crt_stdio_output::
          output_adapter_common<char,class___crt_stdio_output::stream_output_adapter<char>_>::
          write_string_impl((output_adapter_common_char_class___crt_stdio_output__stream_output_adapter_char___
                             *)plVar2,local_24,local_28,piVar1,
                            (__crt_deferred_errno_cache *)(param_1 + 0x10));
        }
        else {
          *piVar1 = *piVar1 + local_28;
        }
        iVar5 = iVar5 + 1;
      } while (iVar5 != *(int *)(param_1 + 0x50));
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY_58);
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  public: int __cdecl <lambda_32f117a32e8f8eb613cbf2ca819ed45e>::operator()(void)const __ptr64
//  public: int __cdecl <lambda_a31071773b9a94e445cbd5d04ef99106>::operator()(void)const __ptr64
// 
// Library: Visual Studio 2017 Release

void FID_conflict_operator__(undefined8 *param_1)

{
  FILE *pFVar1;
  ulonglong uVar2;
  undefined auStack_4e8 [32];
  longlong local_4c8;
  undefined local_4c0 [16];
  char local_4b0;
  ulonglong local_4a8;
  undefined *local_4a0;
  undefined8 local_498;
  undefined8 local_490;
  undefined8 local_488;
  undefined8 local_480;
  undefined8 local_478;
  undefined4 local_470;
  undefined2 local_468;
  undefined4 local_458;
  undefined local_454;
  undefined8 local_50;
  LPVOID local_48;
  undefined8 local_40;
  undefined4 local_38;
  ulonglong local_28;
  
  local_28 = DAT_140038010 ^ (ulonglong)auStack_4e8;
  pFVar1 = *(FILE **)*param_1;
  uVar2 = __acrt_stdio_begin_temporary_buffering_nolock(pFVar1);
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_4c8,*(__crt_locale_pointers **)param_1[1]);
  local_4a0 = local_4c0;
  local_488 = *(undefined8 *)param_1[4];
  local_40 = *(undefined8 *)*param_1;
  local_490 = *(undefined8 *)param_1[3];
  local_4a8 = *(ulonglong *)param_1[2];
  local_498 = 0;
  local_480 = 0;
  local_478 = 0;
  local_470 = 0;
  local_468 = 0;
  local_458 = 0;
  local_454 = 0;
  local_50 = 0;
  local_48 = (LPVOID)0x0;
  local_38 = 0;
  FUN_14000dd64(&local_4a8);
  _free_base(local_48);
  local_48 = (LPVOID)0x0;
  if (local_4b0 != '\0') {
    *(uint *)(local_4c8 + 0x3a8) = *(uint *)(local_4c8 + 0x3a8) & 0xfffffffd;
  }
  __acrt_stdio_end_temporary_buffering_nolock((char)uVar2,pFVar1);
  __security_check_cookie(local_28 ^ (ulonglong)auStack_4e8);
  return;
}



// Library Function - Single Match
//  public: void __cdecl __crt_stdio_output::string_output_adapter<char>::write_string(char const *
// __ptr64 const,int,int * __ptr64 const,class __crt_deferred_errno_cache & __ptr64)const __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_stdio_output::string_output_adapter<char>::write_string
          (string_output_adapter_char_ *this,char *param_1,int param_2,int *param_3,
          __crt_deferred_errno_cache *param_4)

{
  undefined8 *puVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  
  if (param_2 != 0) {
    uVar4 = (ulonglong)param_2;
    puVar1 = *(undefined8 **)this;
    if (puVar1[2] == puVar1[1]) {
      if (*(char *)(puVar1 + 3) == '\0') {
        *param_3 = -1;
      }
      else {
        *param_3 = *param_3 + param_2;
      }
    }
    else {
      uVar2 = puVar1[1] - puVar1[2];
      uVar3 = uVar4;
      if (uVar2 < uVar4) {
        uVar3 = uVar2;
      }
      FUN_14001b140((undefined8 *)*puVar1,(undefined8 *)param_1,uVar3);
      **(longlong **)this = **(longlong **)this + uVar3;
      *(longlong *)(*(longlong *)this + 0x10) = *(longlong *)(*(longlong *)this + 0x10) + uVar3;
      if (*(char *)(*(longlong *)this + 0x18) == '\0') {
        if (uVar3 == uVar4) {
          *param_3 = *param_3 + (int)uVar3;
        }
        else {
          *param_3 = -1;
        }
      }
      else {
        *param_3 = *param_3 + param_2;
      }
    }
  }
  return;
}



undefined4 FUN_14000ee58(ulonglong *param_1)

{
  byte bVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  ulong *puVar5;
  int iVar7;
  ulonglong *puVar8;
  ulonglong uVar6;
  
  if ((param_1[0x8d] == 0) || (param_1[3] == 0)) {
    puVar5 = __doserrno();
    *puVar5 = 0x16;
    FUN_140011e58();
    uVar4 = 0xffffffff;
  }
  else {
    *(int *)(param_1 + 0x8e) = *(int *)(param_1 + 0x8e) + 1;
    if (*(int *)(param_1 + 0x8e) != 2) {
      do {
        *(undefined4 *)(param_1 + 10) = 0;
        *(undefined4 *)((longlong)param_1 + 0x2c) = 0;
LAB_14000f00d:
        cVar2 = *(char *)param_1[3];
        *(char *)((longlong)param_1 + 0x41) = cVar2;
        if (cVar2 != '\0') {
          param_1[3] = param_1[3] + 1;
          if (*(int *)(param_1 + 5) < 0) goto LAB_14000f022;
          if ((byte)(*(char *)((longlong)param_1 + 0x41) - 0x20U) < 0x5b) {
            uVar3 = (byte)(&DAT_140029370)[*(char *)((longlong)param_1 + 0x41) + -0x20] & 0xf;
          }
          else {
            uVar3 = 0;
          }
          bVar1 = (&DAT_140029370)[*(int *)((longlong)param_1 + 0x2c) + uVar3 * 8];
          uVar3 = (uint)(bVar1 >> 4);
          *(uint *)((longlong)param_1 + 0x2c) = uVar3;
          if (uVar3 == 8) {
            puVar5 = __doserrno();
            *puVar5 = 0x16;
            FUN_140011e58();
            return 0xffffffff;
          }
          if (bVar1 >> 4 == 0) {
            uVar6 = state_case_normal((longlong)param_1);
            cVar2 = (char)uVar6;
            goto LAB_14000f009;
          }
          if (uVar3 == 1) {
            *(undefined4 *)((longlong)param_1 + 0x34) = 0;
            *(undefined4 *)(param_1 + 6) = 0;
            *(undefined4 *)((longlong)param_1 + 0x3c) = 0;
            *(undefined *)(param_1 + 8) = 0;
            *(undefined4 *)(param_1 + 7) = 0xffffffff;
            *(undefined *)((longlong)param_1 + 0x54) = 0;
          }
          else {
            if (uVar3 != 2) {
              if (uVar3 == 3) {
                puVar8 = (ulonglong *)((longlong)param_1 + 0x34);
                if (*(char *)((longlong)param_1 + 0x41) == '*') {
                  param_1[4] = param_1[4] + 8;
                  iVar7 = *(int *)(param_1[4] - 8);
                  *(int *)puVar8 = iVar7;
                  if (iVar7 < 0) {
                    *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 4;
                    iVar7 = -iVar7;
LAB_14000efad:
                    *(int *)puVar8 = iVar7;
                  }
                  cVar2 = '\x01';
                }
                else {
LAB_14000ef62:
                  uVar6 = parse_int_from_format_string((longlong)param_1,(long *)puVar8);
                  cVar2 = (char)uVar6;
                }
              }
              else {
                if (uVar3 == 4) {
                  *(undefined4 *)(param_1 + 7) = 0;
                  goto LAB_14000f00d;
                }
                if (uVar3 == 5) {
                  puVar8 = param_1 + 7;
                  if (*(char *)((longlong)param_1 + 0x41) == '*') {
                    param_1[4] = param_1[4] + 8;
                    iVar7 = *(int *)(param_1[4] - 8);
                    if (*(int *)(param_1[4] - 8) < 0) {
                      iVar7 = -1;
                    }
                    goto LAB_14000efad;
                  }
                  goto LAB_14000ef62;
                }
                if (uVar3 == 6) {
                  uVar6 = FUN_14000f168(param_1);
                  cVar2 = (char)uVar6;
                }
                else {
                  if (uVar3 != 7) {
                    return 0xffffffff;
                  }
                  uVar6 = FUN_14000f2dc(param_1);
                  cVar2 = (char)uVar6;
                }
              }
LAB_14000f009:
              if (cVar2 == '\0') {
                return 0xffffffff;
              }
              goto LAB_14000f00d;
            }
            cVar2 = *(char *)((longlong)param_1 + 0x41);
            if (cVar2 == ' ') {
              *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 2;
            }
            else if (cVar2 == '#') {
              *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x20;
            }
            else if (cVar2 == '+') {
              *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 1;
            }
            else if (cVar2 == '-') {
              *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 4;
            }
            else if (cVar2 == '0') {
              *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 8;
            }
          }
          goto LAB_14000f00d;
        }
        param_1[3] = param_1[3] + 1;
LAB_14000f022:
        *(int *)(param_1 + 0x8e) = *(int *)(param_1 + 0x8e) + 1;
      } while (*(int *)(param_1 + 0x8e) != 2);
    }
    uVar4 = *(undefined4 *)(param_1 + 5);
  }
  return uVar4;
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::string_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::string_output_adapter<char> > >::state_case_normal(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::string_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::string_output_adapter<char> >
// >::state_case_normal(void) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong state_case_normal(longlong param_1)

{
  undefined uVar1;
  longlong lVar2;
  longlong lVar3;
  ulonglong uVar4;
  ulong *puVar5;
  
  uVar4 = FUN_14000f0d0(param_1);
  if ((char)uVar4 == '\0') {
    puVar5 = __doserrno();
    *puVar5 = 0x16;
    uVar4 = FUN_140011e58();
    uVar4 = uVar4 & 0xffffffffffffff00;
  }
  else {
    lVar2 = *(longlong *)(param_1 + 0x468);
    uVar1 = *(undefined *)(param_1 + 0x41);
    lVar3 = *(longlong *)(lVar2 + 8);
    if (*(longlong *)(lVar2 + 0x10) == lVar3) {
      if (*(char *)(lVar2 + 0x18) == '\0') {
        *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
      }
      else {
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
      }
    }
    else {
      *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
      *(longlong *)(lVar2 + 0x10) = *(longlong *)(lVar2 + 0x10) + 1;
      *(undefined *)**(undefined8 **)(param_1 + 0x468) = uVar1;
      **(longlong **)(param_1 + 0x468) = **(longlong **)(param_1 + 0x468) + 1;
    }
    uVar4 = CONCAT71((int7)((ulonglong)lVar3 >> 8),1);
  }
  return uVar4;
}



ulonglong FUN_14000f0d0(longlong param_1)

{
  char cVar1;
  byte bVar2;
  longlong lVar3;
  char *pcVar4;
  ulong *puVar5;
  ulonglong uVar6;
  
  bVar2 = *(byte *)(param_1 + 0x41);
  *(undefined *)(param_1 + 0x54) = 0;
  pcVar4 = *(char **)**(undefined8 **)(param_1 + 8);
  if (*(short *)(pcVar4 + (ulonglong)bVar2 * 2) < 0) {
    lVar3 = *(longlong *)(param_1 + 0x468);
    if (*(longlong *)(lVar3 + 0x10) == *(longlong *)(lVar3 + 8)) {
      if (*(char *)(lVar3 + 0x18) == '\0') {
        *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
      }
      else {
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
      }
    }
    else {
      *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
      *(longlong *)(lVar3 + 0x10) = *(longlong *)(lVar3 + 0x10) + 1;
      ***(byte ***)(param_1 + 0x468) = bVar2;
      **(longlong **)(param_1 + 0x468) = **(longlong **)(param_1 + 0x468) + 1;
    }
    cVar1 = **(char **)(param_1 + 0x18);
    pcVar4 = *(char **)(param_1 + 0x18) + 1;
    *(char *)(param_1 + 0x41) = cVar1;
    *(char **)(param_1 + 0x18) = pcVar4;
    if (cVar1 == '\0') {
      puVar5 = __doserrno();
      *puVar5 = 0x16;
      uVar6 = FUN_140011e58();
      return uVar6 & 0xffffffffffffff00;
    }
  }
  return CONCAT71((int7)((ulonglong)pcVar4 >> 8),1);
}



ulonglong FUN_14000f168(ulonglong *param_1)

{
  char cVar1;
  char *pcVar2;
  ulonglong in_RAX;
  ulonglong uVar3;
  ulong *puVar4;
  char *pcVar5;
  
  cVar1 = *(char *)((longlong)param_1 + 0x41);
  pcVar5 = (char *)(in_RAX & 0xffffffffffffff00);
  if (cVar1 == 'F') {
    if ((*(byte *)param_1 & 8) == 0) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 7;
      uVar3 = FUN_14000f2dc(param_1);
      return uVar3;
    }
  }
  else if (cVar1 == 'N') {
    if ((*(byte *)param_1 & 8) == 0) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 8;
LAB_14000f1a0:
      puVar4 = __doserrno();
      *puVar4 = 0x16;
      uVar3 = FUN_140011e58();
      return uVar3 & 0xffffffffffffff00;
    }
  }
  else {
    if (*(int *)((longlong)param_1 + 0x3c) != 0) goto LAB_14000f1a0;
    if (cVar1 == 'I') {
      pcVar2 = (char *)param_1[3];
      cVar1 = *pcVar2;
      if ((cVar1 == '3') && (pcVar2[1] == '2')) {
        pcVar5 = pcVar2 + 2;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 10;
        param_1[3] = (ulonglong)pcVar5;
      }
      else if ((cVar1 == '6') && (pcVar2[1] == '4')) {
        pcVar5 = pcVar2 + 2;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 0xb;
        param_1[3] = (ulonglong)pcVar5;
      }
      else if (((byte)(cVar1 + 0xa8U) < 0x21) &&
              (pcVar5 = (char *)(longlong)(char)(cVar1 + 0xa8U),
              (0x120821001U >> ((ulonglong)pcVar5 & 0x3f) & 1) != 0)) {
        *(undefined4 *)((longlong)param_1 + 0x3c) = 9;
      }
    }
    else if (cVar1 == 'L') {
      *(undefined4 *)((longlong)param_1 + 0x3c) = 8;
    }
    else if (cVar1 == 'T') {
      *(undefined4 *)((longlong)param_1 + 0x3c) = 0xd;
    }
    else {
      if (cVar1 == 'h') {
        if (*(char *)param_1[3] == 'h') {
          param_1[3] = (ulonglong)((char *)param_1[3] + 1);
          pcVar5 = (char *)0x1;
        }
        else {
          pcVar5 = (char *)0x2;
        }
      }
      else {
        if (cVar1 == 'j') {
          *(undefined4 *)((longlong)param_1 + 0x3c) = 5;
          goto LAB_14000f2d4;
        }
        if (cVar1 != 'l') {
          if (cVar1 == 't') {
            *(undefined4 *)((longlong)param_1 + 0x3c) = 7;
          }
          else {
            if (cVar1 != 'w') {
              uVar3 = CONCAT71((int7)((ulonglong)pcVar5 >> 8),1);
              if (cVar1 != 'z') {
                return uVar3;
              }
              *(undefined4 *)((longlong)param_1 + 0x3c) = 6;
              return uVar3;
            }
            *(undefined4 *)((longlong)param_1 + 0x3c) = 0xc;
          }
          goto LAB_14000f2d4;
        }
        if (*(char *)param_1[3] == 'l') {
          param_1[3] = (ulonglong)((char *)param_1[3] + 1);
          pcVar5 = &DAT_00000004;
        }
        else {
          pcVar5 = (char *)0x3;
        }
      }
      *(int *)((longlong)param_1 + 0x3c) = (int)pcVar5;
    }
  }
LAB_14000f2d4:
  return CONCAT71((int7)((ulonglong)pcVar5 >> 8),1);
}



ulonglong FUN_14000f2dc(ulonglong *param_1)

{
  ulonglong *puVar1;
  ulonglong *this;
  char cVar2;
  bool bVar3;
  uint uVar4;
  ulonglong uVar5;
  ulonglong extraout_RAX;
  longlong lVar6;
  undefined uVar7;
  int iVar8;
  byte bVar9;
  longlong lVar10;
  undefined2 local_res8;
  undefined local_resa;
  
  uVar4 = (uint)*(char *)((longlong)param_1 + 0x41);
  uVar5 = (ulonglong)uVar4;
  uVar7 = 0x78;
  lVar10 = 1;
  if ((int)uVar4 < 0x65) {
    if (uVar4 == 100) {
LAB_14000f3dc:
      *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x10;
LAB_14000f3e0:
      uVar4 = 10;
LAB_14000f3e5:
      bVar9 = 0;
LAB_14000f3e8:
      uVar5 = type_case_integer((longlong)param_1,uVar4,bVar9);
    }
    else {
      if (uVar4 == 0x41) goto LAB_14000f3ef;
      if (uVar4 == 0x43) {
LAB_14000f350:
        uVar5 = FUN_14000e52c((longlong)param_1);
      }
      else {
        if ((int)uVar4 < 0x45) goto LAB_14000f3f8;
        if ((int)uVar4 < 0x48) goto LAB_14000f3ef;
        if (uVar4 == 0x53) {
LAB_14000f398:
          uVar5 = type_case_s((longlong)param_1);
        }
        else {
          if (uVar4 == 0x58) goto LAB_14000f3ad;
          if (uVar4 != 0x5a) {
            if (uVar4 != 0x61) {
              if (uVar4 != 99) goto LAB_14000f3f8;
              goto LAB_14000f350;
            }
            goto LAB_14000f3ef;
          }
          uVar5 = type_case_Z((longlong)param_1);
        }
      }
    }
  }
  else {
    if (0x67 < (int)uVar4) {
      if (uVar4 == 0x69) goto LAB_14000f3dc;
      if (uVar4 == 0x6e) {
        uVar5 = type_case_n((longlong)param_1);
        goto LAB_14000f3f4;
      }
      if (uVar4 == 0x6f) {
        if ((*(uint *)(param_1 + 6) >> 5 & 1) != 0) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x80;
        }
        uVar4 = 8;
        goto LAB_14000f3e5;
      }
      if (uVar4 != 0x70) {
        if (uVar4 == 0x73) goto LAB_14000f398;
        if (uVar4 != 0x75) {
          if (uVar4 != 0x78) goto LAB_14000f3f8;
          uVar4 = 0x10;
          goto LAB_14000f3e5;
        }
        goto LAB_14000f3e0;
      }
      *(undefined4 *)(param_1 + 7) = 0x10;
      *(undefined4 *)((longlong)param_1 + 0x3c) = 0xb;
LAB_14000f3ad:
      bVar9 = 1;
      uVar4 = 0x10;
      goto LAB_14000f3e8;
    }
LAB_14000f3ef:
    uVar5 = FUN_14000e700(param_1);
  }
LAB_14000f3f4:
  if ((char)uVar5 != '\0') {
    if (*(char *)(param_1 + 8) == '\0') {
      uVar4 = *(uint *)(param_1 + 6);
      local_res8 = 0;
      local_resa = 0;
      lVar6 = 0;
      if ((uVar4 >> 4 & 1) != 0) {
        if ((uVar4 >> 6 & 1) == 0) {
          if ((uVar4 & 1) == 0) {
            if ((uVar4 >> 1 & 1) != 0) {
              local_res8 = 0x20;
              lVar6 = lVar10;
            }
          }
          else {
            local_res8 = 0x2b;
            lVar6 = lVar10;
          }
        }
        else {
          local_res8 = 0x2d;
          lVar6 = lVar10;
        }
      }
      cVar2 = *(char *)((longlong)param_1 + 0x41);
      if (((cVar2 + 0xa8U & 0xdf) == 0) && ((uVar4 >> 5 & 1) != 0)) {
        bVar3 = true;
      }
      else {
        bVar3 = false;
      }
      if ((bVar3) || ((cVar2 + 0xbfU & 0xdf) == 0)) {
        *(undefined *)((longlong)&local_res8 + lVar6) = 0x30;
        if ((cVar2 == 'X') || (cVar2 == 'A')) {
          uVar7 = 0x58;
        }
        *(undefined *)((longlong)&local_res8 + lVar6 + 1) = uVar7;
        lVar6 = lVar6 + 2;
      }
      puVar1 = param_1 + 5;
      this = param_1 + 0x8d;
      iVar8 = (*(int *)((longlong)param_1 + 0x34) - *(int *)(param_1 + 10)) - (int)lVar6;
      if ((uVar4 & 0xc) == 0) {
        __crt_stdio_output::
        write_multiple_characters_class___crt_stdio_output__string_output_adapter_char__char_
                  ((string_output_adapter_char_ *)this,' ',iVar8,(int *)puVar1);
      }
      __crt_stdio_output::string_output_adapter<char>::write_string
                ((string_output_adapter_char_ *)this,(char *)&local_res8,(int)lVar6,(int *)puVar1,
                 (__crt_deferred_errno_cache *)(param_1 + 2));
      if (((*(uint *)(param_1 + 6) >> 3 & 1) != 0) && ((*(uint *)(param_1 + 6) >> 2 & 1) == 0)) {
        __crt_stdio_output::
        write_multiple_characters_class___crt_stdio_output__string_output_adapter_char__char_
                  ((string_output_adapter_char_ *)this,'0',iVar8,(int *)puVar1);
      }
      uVar5 = write_stored_string_tchar((longlong)param_1);
      if ((-1 < *(int *)puVar1) &&
         (uVar5 = (ulonglong)(*(uint *)(param_1 + 6) >> 2), (*(uint *)(param_1 + 6) >> 2 & 1) != 0))
      {
        __crt_stdio_output::
        write_multiple_characters_class___crt_stdio_output__string_output_adapter_char__char_
                  ((string_output_adapter_char_ *)this,' ',iVar8,(int *)puVar1);
        uVar5 = extraout_RAX;
      }
    }
    return uVar5 & 0xffffffffffffff00 | 1;
  }
LAB_14000f3f8:
  return uVar5 & 0xffffffffffffff00;
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::string_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::string_output_adapter<char> > >::write_stored_string_tchar(char) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::string_output_adapter<char>,class
// __crt_stdio_output::positional_parameter_base<char,class
// __crt_stdio_output::string_output_adapter<char> > >::write_stored_string_tchar(char) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::string_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::string_output_adapter<char> >
// >::write_stored_string_tchar(char) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void write_stored_string_tchar(longlong param_1)

{
  wchar_t _WCh;
  errno_t eVar1;
  wchar_t *pwVar2;
  int iVar3;
  undefined auStackY_58 [32];
  int local_28;
  char local_24 [12];
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStackY_58;
  if ((*(char *)(param_1 + 0x54) == '\0') || (*(int *)(param_1 + 0x50) < 1)) {
    __crt_stdio_output::string_output_adapter<char>::write_string
              ((string_output_adapter_char_ *)(param_1 + 0x468),*(char **)(param_1 + 0x48),
               *(int *)(param_1 + 0x50),(int *)(param_1 + 0x28),
               (__crt_deferred_errno_cache *)(param_1 + 0x10));
  }
  else {
    pwVar2 = *(wchar_t **)(param_1 + 0x48);
    iVar3 = 0;
    if (*(int *)(param_1 + 0x50) != 0) {
      do {
        _WCh = *pwVar2;
        local_28 = 0;
        pwVar2 = pwVar2 + 1;
        eVar1 = wctomb_s(&local_28,local_24,6,_WCh);
        if ((eVar1 != 0) || (local_28 == 0)) {
          *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
          break;
        }
        __crt_stdio_output::string_output_adapter<char>::write_string
                  ((string_output_adapter_char_ *)(param_1 + 0x468),local_24,local_28,
                   (int *)(param_1 + 0x28),(__crt_deferred_errno_cache *)(param_1 + 0x10));
        iVar3 = iVar3 + 1;
      } while (iVar3 != *(int *)(param_1 + 0x50));
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY_58);
  return;
}



// Library Function - Single Match
//  public: void __cdecl __crt_stdio_output::string_output_adapter<wchar_t>::write_string(wchar_t
// const * __ptr64 const,int,int * __ptr64 const,class __crt_deferred_errno_cache & __ptr64)const
// __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_stdio_output::string_output_adapter<wchar_t>::write_string
          (string_output_adapter_wchar_t_ *this,wchar_t *param_1,int param_2,int *param_3,
          __crt_deferred_errno_cache *param_4)

{
  undefined8 *puVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  
  if (param_2 != 0) {
    uVar3 = (ulonglong)param_2;
    puVar1 = *(undefined8 **)this;
    if (puVar1[2] == puVar1[1]) {
      if (*(char *)(puVar1 + 3) == '\0') {
        *param_3 = -1;
      }
      else {
        *param_3 = *param_3 + param_2;
      }
    }
    else {
      uVar2 = puVar1[1] - puVar1[2];
      uVar4 = uVar3;
      if (uVar2 < uVar3) {
        uVar4 = uVar2;
      }
      FUN_14001b140((undefined8 *)*puVar1,(undefined8 *)param_1,uVar4 * 2);
      **(longlong **)this = **(longlong **)this + uVar4 * 2;
      *(longlong *)(*(longlong *)this + 0x10) = *(longlong *)(*(longlong *)this + 0x10) + uVar4;
      if (*(char *)(*(longlong *)this + 0x18) == '\0') {
        if (uVar4 == uVar3) {
          *param_3 = *param_3 + (int)uVar4;
        }
        else {
          *param_3 = -1;
        }
      }
      else {
        *param_3 = *param_3 + param_2;
      }
    }
  }
  return;
}



undefined4 FUN_14000f6c8(__uint64 *param_1)

{
  byte bVar1;
  undefined2 uVar2;
  short sVar3;
  __uint64 _Var4;
  char cVar5;
  uint uVar6;
  ulong *puVar7;
  undefined8 uVar8;
  int iVar9;
  __uint64 *p_Var10;
  
  if ((param_1[0x8d] == 0) || (param_1[3] == 0)) {
    puVar7 = __doserrno();
    *puVar7 = 0x16;
    FUN_140011e58();
    return 0xffffffff;
  }
  *(int *)(param_1 + 0x8e) = *(int *)(param_1 + 0x8e) + 1;
  iVar9 = *(int *)(param_1 + 0x8e);
  do {
    if (iVar9 == 2) {
      return *(undefined4 *)(param_1 + 5);
    }
    *(undefined4 *)(param_1 + 10) = 0;
    *(undefined4 *)((longlong)param_1 + 0x2c) = 0;
LAB_14000f8cb:
    sVar3 = *(short *)param_1[3];
    *(short *)((longlong)param_1 + 0x42) = sVar3;
    if (sVar3 != 0) {
      param_1[3] = param_1[3] + 2;
      if (*(int *)(param_1 + 5) < 0) goto LAB_14000f8e4;
      uVar6 = 0;
      if ((ushort)(*(ushort *)((longlong)param_1 + 0x42) - 0x20) < 0x5b) {
        uVar6 = *(byte *)((longlong)&PTR_FUN_140029350 +
                         (ulonglong)*(ushort *)((longlong)param_1 + 0x42)) & 0xf;
      }
      bVar1 = (&DAT_140029370)[*(int *)((longlong)param_1 + 0x2c) + uVar6 * 8];
      uVar6 = (uint)(bVar1 >> 4);
      *(uint *)((longlong)param_1 + 0x2c) = uVar6;
      if (uVar6 == 8) {
        puVar7 = __doserrno();
        *puVar7 = 0x16;
        FUN_140011e58();
        return 0xffffffff;
      }
      if (bVar1 >> 4 == 0) {
        uVar2 = *(undefined2 *)((longlong)param_1 + 0x42);
        *(undefined *)((longlong)param_1 + 0x54) = 1;
        _Var4 = param_1[0x8d];
        if (*(longlong *)(_Var4 + 0x10) == *(longlong *)(_Var4 + 8)) {
          if (*(char *)(_Var4 + 0x18) == '\0') {
            *(undefined4 *)(param_1 + 5) = 0xffffffff;
          }
          else {
            *(int *)(param_1 + 5) = *(int *)(param_1 + 5) + 1;
          }
        }
        else {
          *(int *)(param_1 + 5) = *(int *)(param_1 + 5) + 1;
          *(longlong *)(_Var4 + 0x10) = *(longlong *)(_Var4 + 0x10) + 1;
          **(undefined2 **)param_1[0x8d] = uVar2;
          *(longlong *)param_1[0x8d] = *(longlong *)param_1[0x8d] + 2;
        }
LAB_14000f8c5:
        cVar5 = '\x01';
LAB_14000f8c7:
        if (cVar5 == '\0') {
          return 0xffffffff;
        }
        goto LAB_14000f8cb;
      }
      if (uVar6 == 1) {
        param_1[6] = 0;
        *(undefined *)(param_1 + 8) = 0;
        *(undefined4 *)(param_1 + 7) = 0xffffffff;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 0;
        *(undefined *)((longlong)param_1 + 0x54) = 0;
      }
      else {
        if (uVar6 != 2) {
          if (uVar6 == 3) {
            p_Var10 = (__uint64 *)((longlong)param_1 + 0x34);
            if (*(short *)((longlong)param_1 + 0x42) == 0x2a) {
              param_1[4] = param_1[4] + 8;
              iVar9 = *(int *)(param_1[4] - 8);
              *(int *)p_Var10 = iVar9;
              if (-1 < iVar9) goto LAB_14000f8c5;
              *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 4;
              iVar9 = -iVar9;
LAB_14000f7f8:
              *(int *)p_Var10 = iVar9;
              goto LAB_14000f8c5;
            }
          }
          else {
            if (uVar6 == 4) {
              *(undefined4 *)(param_1 + 7) = 0;
              goto LAB_14000f8cb;
            }
            if (uVar6 != 5) {
              if (uVar6 == 6) {
                uVar8 = FUN_14000f9c8(param_1);
                cVar5 = (char)uVar8;
              }
              else {
                if (uVar6 != 7) {
                  return 0xffffffff;
                }
                cVar5 = FUN_14000fb60(param_1);
              }
              goto LAB_14000f8c7;
            }
            p_Var10 = param_1 + 7;
            if (*(short *)((longlong)param_1 + 0x42) == 0x2a) {
              param_1[4] = param_1[4] + 8;
              iVar9 = *(int *)(param_1[4] - 8);
              if (iVar9 < 0) {
                iVar9 = -1;
              }
              goto LAB_14000f7f8;
            }
          }
          uVar8 = parse_int_from_format_string((longlong)param_1,(long *)p_Var10);
          cVar5 = (char)uVar8;
          goto LAB_14000f8c7;
        }
        sVar3 = *(short *)((longlong)param_1 + 0x42);
        if (sVar3 == 0x20) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 2;
        }
        else if (sVar3 == 0x23) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x20;
        }
        else if (sVar3 == 0x2b) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 1;
        }
        else if (sVar3 == 0x2d) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 4;
        }
        else if (sVar3 == 0x30) {
          *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 8;
        }
      }
      goto LAB_14000f8cb;
    }
    param_1[3] = param_1[3] + 2;
LAB_14000f8e4:
    *(int *)(param_1 + 0x8e) = *(int *)(param_1 + 0x8e) + 1;
    iVar9 = *(int *)(param_1 + 0x8e);
  } while( true );
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::parse_int_from_format_string(int *
// __ptr64 const) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::positional_parameter_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::parse_int_from_format_string(int *
// __ptr64 const) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::parse_int_from_format_string(int *
// __ptr64 const) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::parse_int_from_format_string(int *
// __ptr64 const) __ptr64
//   9 names - too many to list
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong parse_int_from_format_string(longlong param_1,long *param_2)

{
  ulong uVar1;
  long lVar2;
  ulong *puVar3;
  ulong *puVar4;
  ulonglong uVar5;
  ulong *local_res8;
  
  puVar3 = *(ulong **)(param_1 + 0x10);
  if (puVar3 == (ulong *)0x0) {
    puVar3 = __doserrno();
    *(ulong **)(param_1 + 0x10) = puVar3;
  }
  uVar1 = *puVar3;
  *puVar3 = 0;
  local_res8 = (ulong *)0x0;
  lVar2 = wcstol((wchar_t *)(*(longlong *)(param_1 + 0x18) + -2),(wchar_t **)&local_res8,10);
  *param_2 = lVar2;
  puVar4 = *(ulong **)(param_1 + 0x10);
  if (puVar4 == (ulong *)0x0) {
    puVar4 = __doserrno();
    *(ulong **)(param_1 + 0x10) = puVar4;
  }
  if ((*puVar4 == 0x22) || (puVar4 = local_res8, local_res8 < *(ulong **)(param_1 + 0x18))) {
    uVar5 = (ulonglong)puVar4 & 0xffffffffffffff00;
  }
  else {
    *(ulong **)(param_1 + 0x18) = local_res8;
    uVar5 = CONCAT71((int7)((ulonglong)local_res8 >> 8),1);
  }
  if ((*puVar3 == 0) && (uVar1 != 0)) {
    *puVar3 = uVar1;
  }
  return uVar5;
}



undefined8 FUN_14000f9c8(__uint64 *param_1)

{
  short sVar1;
  short *psVar2;
  ushort uVar3;
  short *in_RAX;
  undefined8 uVar4;
  ulong *puVar5;
  ulonglong uVar6;
  
  if (*(short *)((longlong)param_1 + 0x42) == 0x46) {
    if ((*(byte *)param_1 & 8) == 0) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 7;
      uVar4 = FUN_14000fb60(param_1);
      return uVar4;
    }
  }
  else if (*(short *)((longlong)param_1 + 0x42) == 0x4e) {
    if ((*(byte *)param_1 & 8) == 0) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 8;
LAB_14000fa03:
      puVar5 = __doserrno();
      *puVar5 = 0x16;
      uVar6 = FUN_140011e58();
      return uVar6 & 0xffffffffffffff00;
    }
  }
  else {
    if (*(int *)((longlong)param_1 + 0x3c) != 0) goto LAB_14000fa03;
    uVar3 = *(ushort *)((longlong)param_1 + 0x42);
    in_RAX = (short *)(ulonglong)uVar3;
    if (uVar3 == 0x49) {
      psVar2 = (short *)param_1[3];
      sVar1 = *psVar2;
      if ((sVar1 == 0x33) && (psVar2[1] == 0x32)) {
        in_RAX = psVar2 + 2;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 10;
        param_1[3] = (__uint64)in_RAX;
      }
      else if ((sVar1 == 0x36) && (psVar2[1] == 0x34)) {
        in_RAX = psVar2 + 2;
        *(undefined4 *)((longlong)param_1 + 0x3c) = 0xb;
        param_1[3] = (__uint64)in_RAX;
      }
      else {
        uVar3 = sVar1 - 0x58;
        in_RAX = (short *)(ulonglong)uVar3;
        if ((uVar3 < 0x21) &&
           (in_RAX = (short *)(ulonglong)uVar3,
           (0x120821001U >> ((ulonglong)in_RAX & 0x3f) & 1) != 0)) {
          *(undefined4 *)((longlong)param_1 + 0x3c) = 9;
        }
      }
    }
    else if (uVar3 == 0x4c) {
      *(undefined4 *)((longlong)param_1 + 0x3c) = 8;
    }
    else if (uVar3 == 0x54) {
      *(undefined4 *)((longlong)param_1 + 0x3c) = 0xd;
    }
    else {
      if (uVar3 == 0x68) {
        if (*(short *)param_1[3] == 0x68) {
          param_1[3] = (__uint64)((short *)param_1[3] + 1);
          in_RAX = (short *)0x1;
        }
        else {
          in_RAX = (short *)0x2;
        }
      }
      else {
        if (uVar3 == 0x6a) {
          *(undefined4 *)((longlong)param_1 + 0x3c) = 5;
          goto LAB_14000fb58;
        }
        if (uVar3 != 0x6c) {
          if (uVar3 == 0x74) {
            *(undefined4 *)((longlong)param_1 + 0x3c) = 7;
          }
          else {
            if (uVar3 != 0x77) {
              uVar4 = CONCAT71((uint7)(byte)(uVar3 >> 8),1);
              if (uVar3 != 0x7a) {
                return uVar4;
              }
              *(undefined4 *)((longlong)param_1 + 0x3c) = 6;
              return uVar4;
            }
            *(undefined4 *)((longlong)param_1 + 0x3c) = 0xc;
          }
          goto LAB_14000fb58;
        }
        if (*(short *)param_1[3] == 0x6c) {
          param_1[3] = (__uint64)((short *)param_1[3] + 1);
          in_RAX = (short *)&DAT_00000004;
        }
        else {
          in_RAX = (short *)0x3;
        }
      }
      *(int *)((longlong)param_1 + 0x3c) = (int)in_RAX;
    }
  }
LAB_14000fb58:
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



void FUN_14000fb60(__uint64 *param_1)

{
  __uint64 *p_Var1;
  __uint64 *this;
  short sVar2;
  bool bVar3;
  char cVar4;
  ushort uVar5;
  ulonglong uVar7;
  uint uVar8;
  longlong lVar9;
  int iVar10;
  undefined2 uVar11;
  byte bVar12;
  undefined auStackY_68 [32];
  undefined4 local_38;
  undefined2 local_34;
  ulonglong local_30;
  undefined8 uVar6;
  
  local_30 = DAT_140038010 ^ (ulonglong)auStackY_68;
  uVar5 = *(ushort *)((longlong)param_1 + 0x42);
  uVar11 = 0x78;
  if (uVar5 < 0x65) {
    if (uVar5 == 100) {
LAB_14000fcaf:
      *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x10;
LAB_14000fcb3:
      uVar8 = 10;
      goto LAB_14000fcb8;
    }
    if (uVar5 == 0x41) {
LAB_14000fcc2:
      uVar6 = FUN_14001001c(param_1);
      cVar4 = (char)uVar6;
    }
    else if (uVar5 == 0x43) {
LAB_14000fc28:
      uVar6 = type_case_c_tchar(param_1);
      cVar4 = (char)uVar6;
    }
    else {
      if (uVar5 < 0x45) goto LAB_14000fbf3;
      if (uVar5 < 0x48) goto LAB_14000fcc2;
      if (uVar5 == 0x53) {
LAB_14000fc6b:
        uVar6 = FUN_14000ff58(param_1);
        cVar4 = (char)uVar6;
      }
      else {
        if (uVar5 == 0x58) goto LAB_14000fc80;
        if (uVar5 != 0x5a) {
          if (uVar5 != 0x61) {
            if (uVar5 != 99) goto LAB_14000fbf3;
            goto LAB_14000fc28;
          }
          goto LAB_14000fcc2;
        }
        uVar6 = type_case_Z(param_1);
        cVar4 = (char)uVar6;
      }
    }
  }
  else {
    if (uVar5 < 0x65) goto LAB_14000fbf3;
    if (uVar5 < 0x68) goto LAB_14000fcc2;
    if (uVar5 == 0x69) goto LAB_14000fcaf;
    if (uVar5 == 0x6e) {
      uVar7 = type_case_n((longlong)param_1);
      cVar4 = (char)uVar7;
      goto LAB_14000fcc7;
    }
    if (uVar5 == 0x6f) {
      if ((*(uint *)(param_1 + 6) >> 5 & 1) != 0) {
        *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x80;
      }
      uVar8 = 8;
LAB_14000fcb8:
      bVar12 = 0;
    }
    else {
      if (uVar5 != 0x70) {
        if (uVar5 == 0x73) goto LAB_14000fc6b;
        if (uVar5 == 0x75) goto LAB_14000fcb3;
        if (uVar5 != 0x78) goto LAB_14000fbf3;
        uVar8 = 0x10;
        goto LAB_14000fcb8;
      }
      *(undefined4 *)(param_1 + 7) = 0x10;
      *(undefined4 *)((longlong)param_1 + 0x3c) = 0xb;
LAB_14000fc80:
      bVar12 = 1;
      uVar8 = 0x10;
    }
    uVar7 = type_case_integer((longlong)param_1,uVar8,bVar12);
    cVar4 = (char)uVar7;
  }
LAB_14000fcc7:
  if ((cVar4 == '\0') || (*(char *)(param_1 + 8) != '\0')) goto LAB_14000fbf3;
  uVar8 = *(uint *)(param_1 + 6);
  local_38 = 0;
  local_34 = 0;
  lVar9 = 0;
  if ((uVar8 >> 4 & 1) != 0) {
    if ((uVar8 >> 6 & 1) == 0) {
      if ((uVar8 & 1) == 0) {
        if ((uVar8 >> 1 & 1) != 0) {
          local_38 = 0x20;
          lVar9 = 1;
        }
        goto LAB_14000fd2d;
      }
      uVar5 = 0x2b;
    }
    else {
      uVar5 = 0x2d;
    }
    local_38 = (uint)uVar5;
    lVar9 = 1;
  }
LAB_14000fd2d:
  sVar2 = *(short *)((longlong)param_1 + 0x42);
  if (((sVar2 - 0x58U & 0xffdf) == 0) && ((uVar8 >> 5 & 1) != 0)) {
    bVar3 = true;
  }
  else {
    bVar3 = false;
  }
  if ((bVar3) || ((sVar2 - 0x41U & 0xffdf) == 0)) {
    *(undefined2 *)((longlong)&local_38 + lVar9 * 2) = 0x30;
    if ((sVar2 == 0x58) || (sVar2 == 0x41)) {
      uVar11 = 0x58;
    }
    *(undefined2 *)((longlong)&local_38 + lVar9 * 2 + 2) = uVar11;
    lVar9 = lVar9 + 2;
  }
  p_Var1 = param_1 + 5;
  this = param_1 + 0x8d;
  iVar10 = (*(int *)((longlong)param_1 + 0x34) - *(int *)(param_1 + 10)) - (int)lVar9;
  if ((uVar8 & 0xc) == 0) {
    __crt_stdio_output::
    write_multiple_characters_class___crt_stdio_output__string_output_adapter_wchar_t__char_
              ((string_output_adapter_wchar_t_ *)this,' ',iVar10,(int *)p_Var1);
  }
  __crt_stdio_output::string_output_adapter<wchar_t>::write_string
            ((string_output_adapter_wchar_t_ *)this,(wchar_t *)&local_38,(int)lVar9,(int *)p_Var1,
             (__crt_deferred_errno_cache *)(param_1 + 2));
  if (((*(uint *)(param_1 + 6) >> 3 & 1) != 0) && ((*(uint *)(param_1 + 6) >> 2 & 1) == 0)) {
    __crt_stdio_output::
    write_multiple_characters_class___crt_stdio_output__string_output_adapter_wchar_t__char_
              ((string_output_adapter_wchar_t_ *)this,'0',iVar10,(int *)p_Var1);
  }
  write_stored_string_tchar((longlong)param_1);
  if ((-1 < *(int *)(param_1 + 5)) && ((*(uint *)(param_1 + 6) >> 2 & 1) != 0)) {
    __crt_stdio_output::
    write_multiple_characters_class___crt_stdio_output__string_output_adapter_wchar_t__char_
              ((string_output_adapter_wchar_t_ *)this,' ',iVar10,(int *)(param_1 + 5));
  }
LAB_14000fbf3:
  __security_check_cookie(local_30 ^ (ulonglong)auStackY_68);
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::type_case_c_tchar(wchar_t) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::type_case_c_tchar(wchar_t) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::type_case_c_tchar(wchar_t) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::type_case_c_tchar(wchar_t) __ptr64
//   6 names - too many to list
// 
// Library: Visual Studio 2017 Release

undefined8 type_case_c_tchar(__uint64 *param_1)

{
  __uint64 *p_Var1;
  undefined2 uVar2;
  int iVar3;
  undefined8 uVar4;
  undefined4 extraout_var_00;
  __uint64 *p_Var5;
  char local_res8;
  undefined local_res9;
  undefined7 extraout_var;
  
  *(undefined *)((longlong)param_1 + 0x54) = 1;
  p_Var1 = param_1 + 0xb;
  param_1[4] = param_1[4] + 8;
  uVar2 = *(undefined2 *)(param_1[4] - 8);
  local_res9 = __crt_stdio_output::is_wide_character_specifier_wchar_t_
                         (*param_1,SUB21(*(undefined2 *)((longlong)param_1 + 0x42),0),
                          *(length_modifier *)((longlong)param_1 + 0x3c));
  uVar4 = CONCAT71(extraout_var,local_res9);
  p_Var5 = (__uint64 *)param_1[0x8c];
  if ((bool)local_res9) {
    if (p_Var5 == (__uint64 *)0x0) {
      p_Var5 = p_Var1;
    }
    *(undefined2 *)p_Var5 = uVar2;
  }
  else {
    local_res8 = (char)uVar2;
    if (p_Var5 == (__uint64 *)0x0) {
      p_Var5 = p_Var1;
    }
    iVar3 = _mbtowc_l((wchar_t *)p_Var5,&local_res8,
                      (longlong)(int)((_locale_t)param_1[1])->locinfo->lc_collate_cp,
                      (_locale_t)param_1[1]);
    uVar4 = CONCAT44(extraout_var_00,iVar3);
    if (iVar3 < 0) {
      *(undefined *)(param_1 + 8) = 1;
    }
  }
  *(undefined4 *)(param_1 + 10) = 1;
  p_Var5 = (__uint64 *)param_1[0x8c];
  if ((__uint64 *)param_1[0x8c] == (__uint64 *)0x0) {
    p_Var5 = p_Var1;
  }
  param_1[9] = (__uint64)p_Var5;
  return CONCAT71((int7)((ulonglong)uVar4 >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::type_case_Z(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::type_case_Z(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::type_case_Z(void) __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::type_case_Z(void) __ptr64
//   6 names - too many to list
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release

undefined8 type_case_Z(__uint64 *param_1)

{
  ushort uVar1;
  ushort *puVar2;
  __uint64 _Var3;
  bool bVar4;
  ulonglong uVar5;
  
  param_1[4] = param_1[4] + 8;
  puVar2 = *(ushort **)(param_1[4] - 8);
  if ((puVar2 == (ushort *)0x0) || (_Var3 = *(__uint64 *)(puVar2 + 4), _Var3 == 0)) {
    uVar5 = 6;
    param_1[9] = (__uint64)&DAT_140031550;
  }
  else {
    bVar4 = __crt_stdio_output::is_wide_character_specifier_wchar_t_
                      (*param_1,SUB21(*(undefined2 *)((longlong)param_1 + 0x42),0),
                       *(length_modifier *)((longlong)param_1 + 0x3c));
    param_1[9] = _Var3;
    uVar1 = *puVar2;
    uVar5 = (ulonglong)uVar1;
    if (bVar4) {
      *(undefined *)((longlong)param_1 + 0x54) = 1;
      uVar5 = (ulonglong)(uVar1 >> 1);
      goto LAB_14000ff43;
    }
  }
  *(undefined *)((longlong)param_1 + 0x54) = 0;
LAB_14000ff43:
  *(int *)(param_1 + 10) = (int)uVar5;
  return CONCAT71((int7)(uVar5 >> 8),1);
}



undefined8 FUN_14000ff58(__uint64 *param_1)

{
  bool bVar1;
  int iVar2;
  size_t sVar3;
  wchar_t *pwVar4;
  wchar_t *_Src;
  uint uVar5;
  
  param_1[4] = param_1[4] + 8;
  iVar2 = *(int *)(param_1 + 7);
  _Src = *(wchar_t **)(param_1[4] - 8);
  param_1[9] = (__uint64)_Src;
  if (iVar2 == -1) {
    iVar2 = 0x7fffffff;
  }
  bVar1 = __crt_stdio_output::is_wide_character_specifier_wchar_t_
                    (*param_1,SUB21(*(undefined2 *)((longlong)param_1 + 0x42),0),
                     *(length_modifier *)((longlong)param_1 + 0x3c));
  if (bVar1) {
    if (_Src == (wchar_t *)0x0) {
      _Src = L"(null)";
      param_1[9] = (__uint64)L"(null)";
    }
    *(undefined *)((longlong)param_1 + 0x54) = 1;
    sVar3 = wcsnlen(_Src,(longlong)iVar2);
  }
  else {
    if (_Src == (wchar_t *)0x0) {
      _Src = L"渨汵⥬";
      param_1[9] = (__uint64)&DAT_140031550;
    }
    uVar5 = 0;
    if (0 < iVar2) {
      do {
        if (*(byte *)_Src == 0) break;
        pwVar4 = (wchar_t *)((longlong)_Src + 1);
        if (-1 < *(short *)(**(longlong **)param_1[1] + (ulonglong)*(byte *)_Src * 2)) {
          pwVar4 = _Src;
        }
        uVar5 = uVar5 + 1;
        _Src = (wchar_t *)((longlong)pwVar4 + 1);
      } while ((int)uVar5 < iVar2);
    }
    sVar3 = (size_t)uVar5;
  }
  *(int *)(param_1 + 10) = (int)sVar3;
  return CONCAT71((int7)(sVar3 >> 8),1);
}



undefined8 FUN_14001001c(ulonglong *param_1)

{
  ulonglong *puVar1;
  char cVar2;
  ushort uVar3;
  int iVar4;
  ulonglong uVar5;
  ulonglong *puVar6;
  ulonglong extraout_RAX;
  char *pcVar7;
  __uint64 _Var8;
  longlong lVar9;
  ulonglong uVar10;
  ulonglong *puVar11;
  double local_res8;
  
  *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x10;
  iVar4 = *(int *)(param_1 + 7);
  if (iVar4 < 0) {
    iVar4 = (-(uint)((*(short *)((longlong)param_1 + 0x42) - 0x41U & 0xffdf) != 0) & 0xfffffff9) +
            0xd;
    *(int *)(param_1 + 7) = iVar4;
  }
  else if ((iVar4 == 0) &&
          ((*(short *)((longlong)param_1 + 0x42) == 0x67 ||
           (iVar4 = 0, *(short *)((longlong)param_1 + 0x42) == 0x47)))) {
    *(undefined4 *)(param_1 + 7) = 1;
    iVar4 = 1;
  }
  puVar1 = param_1 + 0xb;
  uVar5 = FUN_140010634((longlong)puVar1,(longlong)(iVar4 + 0x15d));
  uVar10 = 0x200;
  if ((char)uVar5 == '\0') {
    if (param_1[0x8c] == 0) {
      iVar4 = 0x200;
    }
    else {
      iVar4 = (int)(param_1[0x8b] >> 1);
    }
    *(int *)(param_1 + 7) = iVar4 + -0x15d;
  }
  puVar6 = (ulonglong *)param_1[0x8c];
  if ((ulonglong *)param_1[0x8c] == (ulonglong *)0x0) {
    puVar6 = puVar1;
  }
  param_1[9] = (ulonglong)puVar6;
  param_1[4] = param_1[4] + 8;
  puVar6 = (ulonglong *)param_1[0x8c];
  local_res8 = *(double *)(param_1[4] - 8);
  if (puVar6 == (ulonglong *)0x0) {
    _Var8 = 0x200;
    puVar11 = param_1 + 0x4b;
    puVar6 = puVar1;
  }
  else {
    _Var8 = param_1[0x8b] >> 1;
    puVar11 = (ulonglong *)((param_1[0x8b] >> 1) + (longlong)puVar6);
    uVar10 = param_1[0x8b] >> 1;
  }
  __acrt_fp_format(&local_res8,puVar6,uVar10,(char *)puVar11,_Var8,
                   (int)*(char *)((longlong)param_1 + 0x42),*(uint *)(param_1 + 7),*param_1,
                   (__crt_locale_pointers *)param_1[1]);
  if (((*(uint *)(param_1 + 6) >> 5 & 1) != 0) && (*(int *)(param_1 + 7) == 0)) {
    __crt_stdio_output::force_decimal_point((char *)param_1[9],(__crt_locale_pointers *)param_1[1]);
  }
  uVar3 = *(short *)((longlong)param_1 + 0x42) - 0x47;
  uVar5 = (ulonglong)uVar3;
  if (((uVar3 & 0xffdf) == 0) &&
     (uVar5 = (ulonglong)(*(uint *)(param_1 + 6) >> 5), (*(uint *)(param_1 + 6) >> 5 & 1) == 0)) {
    __crt_stdio_output::crop_zeroes((char *)param_1[9],(__crt_locale_pointers *)param_1[1]);
    uVar5 = extraout_RAX;
  }
  pcVar7 = (char *)param_1[9];
  cVar2 = *pcVar7;
  uVar5 = uVar5 & 0xffffffffffffff00;
  if (cVar2 == '-') {
    *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) | 0x40;
    pcVar7 = pcVar7 + 1;
    param_1[9] = (ulonglong)pcVar7;
    cVar2 = *pcVar7;
  }
  if (((byte)(cVar2 + 0xb7U) < 0x26) &&
     ((0x2100000021U >> ((ulonglong)(byte)(cVar2 + 0xb7U) & 0x3f) & 1) != 0)) {
    *(uint *)(param_1 + 6) = *(uint *)(param_1 + 6) & 0xfffffff7;
    uVar5 = 0;
    *(undefined2 *)((longlong)param_1 + 0x42) = 0x73;
  }
  lVar9 = -1;
  do {
    lVar9 = lVar9 + 1;
  } while (pcVar7[lVar9] != '\0');
  *(int *)(param_1 + 10) = (int)lVar9;
  return CONCAT71((int7)(uVar5 >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::type_case_integer(unsigned int,bool)
// __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::console_output_adapter<wchar_t> > >::type_case_integer(unsigned int,bool)
// __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::type_case_integer(unsigned int,bool)
// __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::stream_output_adapter<wchar_t> > >::type_case_integer(unsigned int,bool)
// __ptr64
//   6 names - too many to list
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong type_case_integer(longlong param_1,uint param_2,byte param_3)

{
  ulong *puVar1;
  ulonglong uVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  
  iVar3 = *(int *)(param_1 + 0x3c);
  lVar5 = 8;
  if (iVar3 < 6) {
    if (iVar3 == 5) goto LAB_14001024b;
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        lVar5 = 1;
        goto LAB_14001024b;
      }
      iVar3 = iVar3 + -2;
      if (iVar3 == 0) {
        lVar5 = 2;
        goto LAB_14001024b;
      }
      goto LAB_14001023e;
    }
  }
  else {
    if (((iVar3 == 6) || (iVar3 == 7)) || (iVar3 = iVar3 + -9, iVar3 == 0)) goto LAB_14001024b;
LAB_14001023e:
    if (iVar3 != 1) {
      if (iVar3 != 2) {
        lVar5 = 0;
      }
      goto LAB_14001024b;
    }
  }
  lVar5 = 4;
LAB_14001024b:
  if (lVar5 == 1) {
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    if ((*(uint *)(param_1 + 0x30) >> 4 & 1) == 0) {
      uVar2 = (ulonglong)*(byte *)(*(longlong *)(param_1 + 0x20) + -8);
    }
    else {
      uVar2 = (ulonglong)*(char *)(*(longlong *)(param_1 + 0x20) + -8);
    }
  }
  else if (lVar5 == 2) {
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    if ((*(uint *)(param_1 + 0x30) >> 4 & 1) == 0) {
      uVar2 = (ulonglong)*(ushort *)(*(longlong *)(param_1 + 0x20) + -8);
    }
    else {
      uVar2 = (ulonglong)*(short *)(*(longlong *)(param_1 + 0x20) + -8);
    }
  }
  else if (lVar5 == 4) {
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    if ((*(uint *)(param_1 + 0x30) >> 4 & 1) == 0) {
      uVar2 = (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x20) + -8);
    }
    else {
      uVar2 = (ulonglong)*(int *)(*(longlong *)(param_1 + 0x20) + -8);
    }
  }
  else {
    if (lVar5 != 8) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      uVar2 = FUN_140011e58();
      return uVar2 & 0xffffffffffffff00;
    }
    *(longlong *)(param_1 + 0x20) = *(longlong *)(param_1 + 0x20) + 8;
    uVar2 = *(ulonglong *)(*(longlong *)(param_1 + 0x20) + -8);
  }
  uVar4 = *(uint *)(param_1 + 0x30);
  if (((uVar4 >> 4 & 1) != 0) && ((longlong)uVar2 < 0)) {
    uVar2 = -uVar2;
    uVar4 = uVar4 | 0x40;
    *(uint *)(param_1 + 0x30) = uVar4;
  }
  if (*(int *)(param_1 + 0x38) < 0) {
    *(undefined4 *)(param_1 + 0x38) = 1;
  }
  else {
    *(uint *)(param_1 + 0x30) = uVar4 & 0xfffffff7;
    FUN_14001071c(param_1 + 0x58,(longlong)*(int *)(param_1 + 0x38));
  }
  if (uVar2 == 0) {
    *(uint *)(param_1 + 0x30) = *(uint *)(param_1 + 0x30) & 0xffffffdf;
  }
  *(undefined *)(param_1 + 0x54) = 1;
  if (lVar5 == 8) {
    FUN_1400107c8(param_1,uVar2,(ulonglong)param_2,param_3);
  }
  else {
    FUN_14001086c(param_1,uVar2 & 0xffffffff,param_2,param_3);
  }
  uVar4 = *(uint *)(param_1 + 0x30) >> 7;
  uVar2 = (ulonglong)uVar4;
  if (((uVar4 & 1) != 0) &&
     ((uVar2 = 0, *(int *)(param_1 + 0x50) == 0 || (**(short **)(param_1 + 0x48) != 0x30)))) {
    *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + -2;
    **(undefined2 **)(param_1 + 0x48) = 0x30;
    *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
  }
  return CONCAT71((int7)(uVar2 >> 8),1);
}



// Library Function - Multiple Matches With Same Base Name
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::string_output_adapter<wchar_t>,class
// __crt_stdio_output::format_validation_base<wchar_t,class
// __crt_stdio_output::string_output_adapter<wchar_t> > >::write_stored_string_tchar(wchar_t)
// __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::string_output_adapter<wchar_t>,class
// __crt_stdio_output::positional_parameter_base<wchar_t,class
// __crt_stdio_output::string_output_adapter<wchar_t> > >::write_stored_string_tchar(wchar_t)
// __ptr64
//  private: bool __cdecl __crt_stdio_output::output_processor<wchar_t,class
// __crt_stdio_output::string_output_adapter<wchar_t>,class
// __crt_stdio_output::standard_base<wchar_t,class
// __crt_stdio_output::string_output_adapter<wchar_t> > >::write_stored_string_tchar(wchar_t)
// __ptr64
// 
// Library: Visual Studio 2017 Release

undefined8 write_stored_string_tchar(longlong param_1)

{
  longlong lVar1;
  int iVar2;
  undefined4 extraout_var;
  longlong extraout_RAX;
  char *_SrcCh;
  int iVar3;
  longlong lVar4;
  wchar_t local_res8 [4];
  
  if ((*(char *)(param_1 + 0x54) == '\0') && (0 < *(int *)(param_1 + 0x50))) {
    _SrcCh = *(char **)(param_1 + 0x48);
    iVar3 = 0;
    do {
      local_res8[0] = L'\0';
      iVar2 = _mbtowc_l(local_res8,_SrcCh,
                        (longlong)(int)(*(_locale_t *)(param_1 + 8))->locinfo->lc_collate_cp,
                        *(_locale_t *)(param_1 + 8));
      lVar4 = (longlong)iVar2;
      if (iVar2 < 1) {
        *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
        lVar4 = CONCAT44(extraout_var,iVar2);
        break;
      }
      lVar1 = *(longlong *)(param_1 + 0x468);
      if (*(longlong *)(lVar1 + 0x10) == *(longlong *)(lVar1 + 8)) {
        if (*(char *)(lVar1 + 0x18) == '\0') {
          *(undefined4 *)(param_1 + 0x28) = 0xffffffff;
        }
        else {
          *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
        }
      }
      else {
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
        *(longlong *)(lVar1 + 0x10) = *(longlong *)(lVar1 + 0x10) + 1;
        ***(wchar_t ***)(param_1 + 0x468) = local_res8[0];
        **(longlong **)(param_1 + 0x468) = **(longlong **)(param_1 + 0x468) + 2;
      }
      _SrcCh = _SrcCh + lVar4;
      iVar3 = iVar3 + 1;
    } while (iVar3 != *(int *)(param_1 + 0x50));
  }
  else {
    __crt_stdio_output::string_output_adapter<wchar_t>::write_string
              ((string_output_adapter_wchar_t_ *)(param_1 + 0x468),*(wchar_t **)(param_1 + 0x48),
               *(int *)(param_1 + 0x50),(int *)(param_1 + 0x28),
               (__crt_deferred_errno_cache *)(param_1 + 0x10));
    lVar4 = extraout_RAX;
  }
  return CONCAT71((int7)((ulonglong)lVar4 >> 8),1);
}



// Library Function - Single Match
//  void __cdecl __crt_stdio_output::write_multiple_characters<class
// __crt_stdio_output::string_output_adapter<wchar_t>,char>(class
// __crt_stdio_output::string_output_adapter<wchar_t> const & __ptr64,char,int,int * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl
__crt_stdio_output::
write_multiple_characters_class___crt_stdio_output__string_output_adapter_wchar_t__char_
          (string_output_adapter_wchar_t_ *param_1,char param_2,int param_3,int *param_4)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  
  if (0 < param_3) {
    iVar2 = *param_4;
    iVar3 = 0;
    do {
      lVar1 = *(longlong *)param_1;
      if (*(longlong *)(lVar1 + 0x10) == *(longlong *)(lVar1 + 8)) {
        if (*(char *)(lVar1 + 0x18) == '\0') {
          iVar2 = -1;
        }
        else {
          iVar2 = iVar2 + 1;
        }
        *param_4 = iVar2;
      }
      else {
        *param_4 = iVar2 + 1;
        *(longlong *)(*(longlong *)param_1 + 0x10) = *(longlong *)(*(longlong *)param_1 + 0x10) + 1;
        ***(short ***)param_1 = (short)param_2;
        **(longlong **)param_1 = **(longlong **)param_1 + 2;
        iVar2 = *param_4;
      }
    } while ((iVar2 != -1) && (iVar3 = iVar3 + 1, iVar3 < param_3));
  }
  return;
}



// Library Function - Single Match
//  void __cdecl __crt_stdio_output::write_multiple_characters<class
// __crt_stdio_output::string_output_adapter<char>,char>(class
// __crt_stdio_output::string_output_adapter<char> const & __ptr64,char,int,int * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl
__crt_stdio_output::
write_multiple_characters_class___crt_stdio_output__string_output_adapter_char__char_
          (string_output_adapter_char_ *param_1,char param_2,int param_3,int *param_4)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  
  if (0 < param_3) {
    iVar2 = *param_4;
    iVar3 = 0;
    do {
      lVar1 = *(longlong *)param_1;
      if (*(longlong *)(lVar1 + 0x10) == *(longlong *)(lVar1 + 8)) {
        if (*(char *)(lVar1 + 0x18) == '\0') {
          iVar2 = -1;
        }
        else {
          iVar2 = iVar2 + 1;
        }
        *param_4 = iVar2;
      }
      else {
        *param_4 = iVar2 + 1;
        *(longlong *)(*(longlong *)param_1 + 0x10) = *(longlong *)(*(longlong *)param_1 + 0x10) + 1;
        ***(char ***)param_1 = param_2;
        **(longlong **)param_1 = **(longlong **)param_1 + 1;
        iVar2 = *param_4;
      }
    } while ((iVar2 != -1) && (iVar3 = iVar3 + 1, iVar3 < param_3));
  }
  return;
}



// Library Function - Single Match
//  void __cdecl __crt_stdio_output::write_multiple_characters<class
// __crt_stdio_output::stream_output_adapter<char>,char>(class
// __crt_stdio_output::stream_output_adapter<char> const & __ptr64,char,int,int * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl
__crt_stdio_output::
write_multiple_characters_class___crt_stdio_output__stream_output_adapter_char__char_
          (stream_output_adapter_char_ *param_1,char param_2,int param_3,int *param_4)

{
  int iVar1;
  ulonglong uVar2;
  int iVar3;
  
  if (0 < param_3) {
    iVar3 = 0;
    do {
      if ((((*(uint *)(*(longlong *)param_1 + 0x14) >> 0xc & 1) == 0) ||
          (*(longlong *)(*(longlong *)param_1 + 8) != 0)) &&
         (uVar2 = _fputc_nolock(param_2,*(FILE **)param_1), (int)uVar2 == -1)) {
        *param_4 = -1;
        iVar1 = -1;
      }
      else {
        *param_4 = *param_4 + 1;
        iVar1 = *param_4;
      }
    } while ((iVar1 != -1) && (iVar3 = iVar3 + 1, iVar3 < param_3));
  }
  return;
}



ulonglong FUN_140010634(longlong param_1,ulonglong param_2)

{
  ulong *puVar1;
  LPVOID pvVar2;
  ulonglong uVar3;
  
  if (param_2 < 0x8000000000000000) {
    uVar3 = param_2 * 2;
    if (((*(longlong *)(param_1 + 0x408) == 0) && (uVar3 < 0x401)) ||
       (uVar3 < *(ulonglong *)(param_1 + 0x400) || uVar3 == *(ulonglong *)(param_1 + 0x400))) {
      uVar3 = 0x7fffffffffffff01;
    }
    else {
      pvVar2 = _malloc_base(uVar3);
      if (pvVar2 != (LPVOID)0x0) {
        _free_base(*(LPVOID *)(param_1 + 0x408));
        *(LPVOID *)(param_1 + 0x408) = pvVar2;
        *(ulonglong *)(param_1 + 0x400) = uVar3;
      }
      uVar3 = _free_base((LPVOID)0x0);
      uVar3 = uVar3 & 0xffffffffffffff00 | (ulonglong)(pvVar2 != (LPVOID)0x0);
    }
  }
  else {
    puVar1 = __doserrno();
    *puVar1 = 0xc;
    uVar3 = (ulonglong)puVar1 & 0xffffffffffffff00;
  }
  return uVar3;
}



// Library Function - Single Match
//  bool __cdecl __crt_stdio_output::is_wide_character_specifier<wchar_t>(unsigned
// __int64,wchar_t,enum __crt_stdio_output::length_modifier)
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release

bool __cdecl
__crt_stdio_output::is_wide_character_specifier_wchar_t_
          (__uint64 param_1,wchar_t param_2,length_modifier param_3)

{
  undefined in_DH;
  bool bVar1;
  
  if (param_3 == 2) {
    bVar1 = false;
  }
  else {
    if (((param_3 == 3) || (param_3 == 0xc)) || (param_3 == 0xd)) {
      return true;
    }
    bVar1 = (param_1 & 4) != 0;
    if ((CONCAT11(in_DH,param_2) - 99U & 0xffef) != 0) {
      return (param_1 & 4) == 0;
    }
  }
  return bVar1;
}



ulonglong FUN_14001071c(longlong param_1,ulonglong param_2)

{
  ulong *puVar1;
  LPVOID pvVar2;
  ulonglong uVar3;
  
  if (param_2 < 0x4000000000000000) {
    uVar3 = param_2 << 2;
    if (((*(longlong *)(param_1 + 0x408) == 0) && (uVar3 < 0x401)) ||
       (uVar3 < *(ulonglong *)(param_1 + 0x400) || uVar3 == *(ulonglong *)(param_1 + 0x400))) {
      uVar3 = 0x3fffffffffffff01;
    }
    else {
      pvVar2 = _malloc_base(uVar3);
      if (pvVar2 != (LPVOID)0x0) {
        _free_base(*(LPVOID *)(param_1 + 0x408));
        *(LPVOID *)(param_1 + 0x408) = pvVar2;
        *(ulonglong *)(param_1 + 0x400) = uVar3;
      }
      uVar3 = _free_base((LPVOID)0x0);
      uVar3 = uVar3 & 0xffffffffffffff00 | (ulonglong)(pvVar2 != (LPVOID)0x0);
    }
  }
  else {
    puVar1 = __doserrno();
    *puVar1 = 0xc;
    uVar3 = (ulonglong)puVar1 & 0xffffffffffffff00;
  }
  return uVar3;
}



void FUN_1400107c8(longlong param_1,ulonglong param_2,ulonglong param_3,byte param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  longlong lVar3;
  ushort uVar4;
  
  lVar3 = *(longlong *)(param_1 + 0x460);
  if (lVar3 == 0) {
    uVar1 = 0x100;
    lVar3 = param_1 + 0x58;
  }
  else {
    uVar1 = *(ulonglong *)(param_1 + 0x458) >> 2;
  }
  lVar3 = lVar3 + (uVar1 - 1) * 2;
  *(longlong *)(param_1 + 0x48) = lVar3;
  lVar2 = lVar3;
  while ((0 < *(int *)(param_1 + 0x38) || (param_2 != 0))) {
    *(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x38) + -1;
    uVar4 = (short)(param_2 % (param_3 & 0xffffffff)) + 0x30;
    if (0x39 < uVar4) {
      uVar4 = (ushort)(byte)((char)uVar4 + (param_4 ^ 1) * ' ' + '\a');
    }
    **(short **)(param_1 + 0x48) = (short)(char)uVar4;
    *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + -2;
    lVar2 = *(longlong *)(param_1 + 0x48);
    param_2 = param_2 / (param_3 & 0xffffffff);
  }
  *(int *)(param_1 + 0x50) = (int)(lVar3 - lVar2 >> 1);
  *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + 2;
  return;
}



void FUN_14001086c(longlong param_1,ulonglong param_2,uint param_3,byte param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  longlong lVar3;
  ushort uVar4;
  
  lVar3 = *(longlong *)(param_1 + 0x460);
  if (lVar3 == 0) {
    uVar1 = 0x100;
    lVar3 = param_1 + 0x58;
  }
  else {
    uVar1 = *(ulonglong *)(param_1 + 0x458) >> 2;
  }
  lVar3 = lVar3 + (uVar1 - 1) * 2;
  *(longlong *)(param_1 + 0x48) = lVar3;
  lVar2 = lVar3;
  uVar1 = param_2 & 0xffffffff;
  while( true ) {
    if ((*(int *)(param_1 + 0x38) < 1) && ((int)uVar1 == 0)) break;
    *(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x38) + -1;
    uVar4 = (short)(uVar1 % (ulonglong)param_3) + 0x30;
    if (0x39 < uVar4) {
      uVar4 = (ushort)(byte)((char)uVar4 + (param_4 ^ 1) * ' ' + '\a');
    }
    **(short **)(param_1 + 0x48) = (short)(char)uVar4;
    *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + -2;
    lVar2 = *(longlong *)(param_1 + 0x48);
    uVar1 = uVar1 / param_3;
  }
  *(int *)(param_1 + 0x50) = (int)(lVar3 - lVar2 >> 1);
  *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + 2;
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> >
// >::type_case_integer_parse_into_buffer<unsigned __int64>(unsigned __int64,unsigned int,bool)
// __ptr64
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::type_case_integer_parse_into_buffer<unsigned __int64>(unsigned __int64,unsigned int,bool)
// __ptr64
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::type_case_integer_parse_into_buffer<unsigned
// __int64>(unsigned __int64,unsigned int,bool) __ptr64
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::type_case_integer_parse_into_buffer<unsigned __int64>(unsigned __int64,unsigned int,bool)
// __ptr64
//   6 names - too many to list
// 
// Library: Visual Studio 2017 Release

void type_case_integer_parse_into_buffer__
               (longlong param_1,ulonglong param_2,ulonglong param_3,byte param_4)

{
  ulonglong uVar1;
  ulonglong uVar2;
  longlong lVar3;
  char cVar4;
  
  lVar3 = *(longlong *)(param_1 + 0x460);
  if (lVar3 == 0) {
    uVar1 = 0x200;
    lVar3 = param_1 + 0x58;
  }
  else {
    uVar1 = *(ulonglong *)(param_1 + 0x458) >> 1;
  }
  uVar1 = lVar3 + -1 + uVar1;
  *(ulonglong *)(param_1 + 0x48) = uVar1;
  uVar2 = uVar1 & 0xffffffff;
  while ((0 < *(int *)(param_1 + 0x38) || (param_2 != 0))) {
    *(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x38) + -1;
    cVar4 = (char)(param_2 % (param_3 & 0xffffffff)) + '0';
    if ('9' < cVar4) {
      cVar4 = cVar4 + (param_4 ^ 1) * ' ' + '\a';
    }
    **(char **)(param_1 + 0x48) = cVar4;
    *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + -1;
    uVar2 = *(ulonglong *)(param_1 + 0x48);
    param_2 = param_2 / (param_3 & 0xffffffff);
  }
  *(int *)(param_1 + 0x50) = (int)uVar1 - (int)uVar2;
  *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + 1;
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::console_output_adapter<char> >
// >::type_case_integer_parse_into_buffer<unsigned int>(unsigned int,unsigned int,bool) __ptr64
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::console_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::console_output_adapter<char> >
// >::type_case_integer_parse_into_buffer<unsigned int>(unsigned int,unsigned int,bool) __ptr64
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::format_validation_base<char,class
// __crt_stdio_output::stream_output_adapter<char> > >::type_case_integer_parse_into_buffer<unsigned
// int>(unsigned int,unsigned int,bool) __ptr64
//  private: void __cdecl __crt_stdio_output::output_processor<char,class
// __crt_stdio_output::stream_output_adapter<char>,class
// __crt_stdio_output::standard_base<char,class __crt_stdio_output::stream_output_adapter<char> >
// >::type_case_integer_parse_into_buffer<unsigned int>(unsigned int,unsigned int,bool) __ptr64
//   6 names - too many to list
// 
// Library: Visual Studio 2017 Release

void type_case_integer_parse_into_buffer__(longlong param_1,uint param_2,uint param_3,byte param_4)

{
  ulonglong uVar1;
  ulonglong uVar2;
  char cVar3;
  longlong lVar4;
  
  lVar4 = *(longlong *)(param_1 + 0x460);
  if (lVar4 == 0) {
    uVar1 = 0x200;
    lVar4 = param_1 + 0x58;
  }
  else {
    uVar1 = *(ulonglong *)(param_1 + 0x458) >> 1;
  }
  uVar1 = lVar4 + -1 + uVar1;
  *(ulonglong *)(param_1 + 0x48) = uVar1;
  uVar2 = uVar1 & 0xffffffff;
  while ((0 < *(int *)(param_1 + 0x38) || (param_2 != 0))) {
    *(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x38) + -1;
    cVar3 = (char)(param_2 % param_3) + '0';
    if ('9' < cVar3) {
      cVar3 = cVar3 + (param_4 ^ 1) * ' ' + '\a';
    }
    **(char **)(param_1 + 0x48) = cVar3;
    *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + -1;
    uVar2 = *(ulonglong *)(param_1 + 0x48);
    param_2 = param_2 / param_3;
  }
  *(int *)(param_1 + 0x50) = (int)uVar1 - (int)uVar2;
  *(longlong *)(param_1 + 0x48) = *(longlong *)(param_1 + 0x48) + 1;
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_74b93660f2d9eb3fb15c5de9eff9db7b>,class <lambda_32f117a32e8f8eb613cbf2ca819ed45e> &
// __ptr64,class <lambda_7322894ee7c8a2d41153fedefeab09e3> >(class
// <lambda_74b93660f2d9eb3fb15c5de9eff9db7b> && __ptr64,class
// <lambda_32f117a32e8f8eb613cbf2ca819ed45e> & __ptr64,class
// <lambda_7322894ee7c8a2d41153fedefeab09e3> && __ptr64) __ptr64
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_a62c933ada0517137acf5807a1eeac1f>,class <lambda_a31071773b9a94e445cbd5d04ef99106> &
// __ptr64,class <lambda_56065050dbf3ada7e59a83db45153de3> >(class
// <lambda_a62c933ada0517137acf5807a1eeac1f> && __ptr64,class
// <lambda_a31071773b9a94e445cbd5d04ef99106> & __ptr64,class
// <lambda_56065050dbf3ada7e59a83db45153de3> && __ptr64) __ptr64
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_d1b8e9147f7260ae436300a3cb83e6d4>,class <lambda_e638437c4db75b75056fab6aaf7e4f15> &
// __ptr64,class <lambda_8c9f37a989ed2ac074735e5b535e306a> >(class
// <lambda_d1b8e9147f7260ae436300a3cb83e6d4> && __ptr64,class
// <lambda_e638437c4db75b75056fab6aaf7e4f15> & __ptr64,class
// <lambda_8c9f37a989ed2ac074735e5b535e306a> && __ptr64) __ptr64
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_fe5404e9642edbb7c8ae71e1dcfa4018>,class <lambda_36eeb330e99a4f0bf8a7da86d0894cb9> &
// __ptr64,class <lambda_2fa474834de80dc12f7a3c6eddd7a366> >(class
// <lambda_fe5404e9642edbb7c8ae71e1dcfa4018> && __ptr64,class
// <lambda_36eeb330e99a4f0bf8a7da86d0894cb9> & __ptr64,class
// <lambda_2fa474834de80dc12f7a3c6eddd7a366> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 operator____(undefined8 param_1,longlong *param_2,undefined8 *param_3,longlong *param_4)

{
  undefined4 uVar1;
  
  FUN_14000d45c(*param_2);
  uVar1 = FID_conflict_operator__(param_3);
  FUN_14000d468(*param_4);
  return uVar1;
}



void FUN_140010a70(uint param_1)

{
  FUN_140010ba8(param_1,0,0);
  return;
}



void FUN_140010a7c(uint param_1)

{
  FUN_140010ba8(param_1,2,0);
  return;
}



void FUN_140010a88(void)

{
  FUN_140010ba8(0,0,1);
  return;
}



// Library Function - Single Match
//  _register_thread_local_exe_atexit_callback
// 
// Library: Visual Studio 2015 Release

void _register_thread_local_exe_atexit_callback(ushort *param_1)

{
  code *pcVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  
  uVar4 = 0x40 - ((uint)DAT_140038010 & 0x3f);
  bVar3 = (byte)uVar4;
  bVar2 = bVar3 & 0x3f;
  if (DAT_140038e08 == (((ulonglong)(0 >> bVar2) | 0L << 0x40 - bVar2) ^ DAT_140038010)) {
    bVar3 = bVar3 & 0x3f;
    DAT_140038e08 =
         ((ulonglong)param_1 >> bVar3 | (longlong)param_1 << 0x40 - bVar3) ^ DAT_140038010;
    return;
  }
  terminate((ushort *)(ulonglong)uVar4,param_1);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_140010aec(undefined8 param_1)

{
  DAT_140038e08 = param_1;
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Exceeded maximum restarts with more pending
// Library Function - Single Match
//  void __cdecl try_cor_exit_process(unsigned int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl try_cor_exit_process(uint param_1)

{
  BOOL BVar1;
  FARPROC pFVar2;
  HMODULE local_res10 [3];
  
  local_res10[0] = (HMODULE)0x0;
  BVar1 = GetModuleHandleExW(0,L"mscoree.dll",local_res10);
  if (BVar1 != 0) {
    pFVar2 = GetProcAddress(local_res10[0],"CorExitProcess");
    if (pFVar2 != (FARPROC)0x0) {
      (*pFVar2)(param_1);
    }
  }
  if (local_res10[0] != (HMODULE)0x0) {
    FreeLibrary(local_res10[0]);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl exit_or_terminate_process(unsigned int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl exit_or_terminate_process(uint param_1)

{
  int iVar1;
  HANDLE hProcess;
  
  iVar1 = __acrt_get_process_end_policy();
  if ((iVar1 != 1) && ((*(uint *)((longlong)ProcessEnvironmentBlock + 0xbc) >> 8 & 1) == 0)) {
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,param_1);
  }
  try_cor_exit_process(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



bool FUN_140010b9c(int param_1)

{
  return param_1 == -0x1f928c9d;
}



void FUN_140010ba8(uint param_1,int param_2,int param_3)

{
  code *pcVar1;
  HMODULE pHVar2;
  int *piVar3;
  int local_res10 [2];
  int local_res18 [2];
  undefined local_res20 [8];
  undefined local_38 [4];
  int local_34;
  int local_30 [2];
  int *local_28;
  int *local_20;
  undefined *local_18;
  
  local_res10[0] = param_2;
  local_res18[0] = param_3;
  if (param_3 == 0) {
    pHVar2 = GetModuleHandleW((LPCWSTR)0x0);
    if ((((pHVar2 != (HMODULE)0x0) && (*(short *)&pHVar2->unused == 0x5a4d)) &&
        (piVar3 = (int *)((longlong)&pHVar2->unused + (longlong)pHVar2[0xf].unused),
        *piVar3 == 0x4550)) &&
       (((*(short *)(piVar3 + 6) == 0x20b && (0xe < (uint)piVar3[0x21])) && (piVar3[0x3e] != 0)))) {
      try_cor_exit_process(param_1);
    }
  }
  local_28 = local_res10;
  local_res20[0] = 0;
  local_20 = local_res18;
  local_18 = local_res20;
  local_34 = 2;
  local_30[0] = 2;
  operator____(local_38,local_30,&local_28,&local_34);
  if (local_res18[0] != 0) {
    return;
  }
  exit_or_terminate_process(param_1);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_140010c64(int **param_1)

{
  byte bVar1;
  byte bVar2;
  undefined *puVar3;
  
  if (DAT_140038e14 != '\0') {
    return;
  }
  DAT_140038e10 = 1;
  if (**param_1 == 0) {
    bVar2 = (byte)DAT_140038010 & 0x3f;
    bVar1 = 0x40 - bVar2 & 0x3f;
    if (DAT_140038e08 != ((0UL >> bVar1 | 0L << 0x40 - bVar1) ^ DAT_140038010)) {
      (*(code *)((DAT_140038010 ^ DAT_140038e08) >> bVar2 |
                (DAT_140038010 ^ DAT_140038e08) << 0x40 - bVar2))(0,0,0);
    }
    puVar3 = &DAT_140039040;
  }
  else {
    if (**param_1 != 1) goto LAB_140010ce9;
    puVar3 = &DAT_140039058;
  }
  _execute_onexit_table(puVar3);
LAB_140010ce9:
  if (**param_1 == 0) {
    _initterm((undefined **)&DAT_140033ed0,(undefined **)&DAT_140033ef0);
  }
  _initterm((undefined **)&DAT_140033ef8,(undefined **)&DAT_140033f00);
  if (*param_1[1] == 0) {
    DAT_140038e14 = '\x01';
    *(undefined *)param_1[2] = 1;
  }
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_99476a1ad63dd22509b5d3e65b0ffc95>,class <lambda_ad1ced32f4ac17aa236e5ef05d6b3b7c> &
// __ptr64,class <lambda_f7424dd8d45958661754dc4f2697e9c3> >(class
// <lambda_99476a1ad63dd22509b5d3e65b0ffc95> && __ptr64,class
// <lambda_ad1ced32f4ac17aa236e5ef05d6b3b7c> & __ptr64,class
// <lambda_f7424dd8d45958661754dc4f2697e9c3> && __ptr64) __ptr64
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_d80eeec6fff315bfe5c115232f3240e3>,class <lambda_6e4b09c48022b2350581041d5f6b0c4c> &
// __ptr64,class <lambda_2358e3775559c9db80273638284d5e45> >(class
// <lambda_d80eeec6fff315bfe5c115232f3240e3> && __ptr64,class
// <lambda_6e4b09c48022b2350581041d5f6b0c4c> & __ptr64,class
// <lambda_2358e3775559c9db80273638284d5e45> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void operator____(undefined8 param_1,int *param_2,int **param_3,int *param_4)

{
  FID_conflict___acrt_lock(*param_2);
  FUN_140010c64(param_3);
  FID_conflict___acrt_lock(*param_4);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  _callnewh
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl _callnewh(size_t _Size)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = (code *)_query_new_handler();
  if ((pcVar2 != (code *)0x0) && (iVar1 = (*pcVar2)(_Size), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_140010da4(undefined8 param_1)

{
  _DAT_140038e18 = param_1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _query_new_handler
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong _query_new_handler(void)

{
  byte bVar1;
  ulonglong uVar2;
  
  FID_conflict___acrt_lock(0);
  bVar1 = (byte)DAT_140038010 & 0x3f;
  uVar2 = DAT_140038010 ^ _DAT_140038e18;
  FID_conflict___acrt_lock(0);
  return uVar2 >> bVar1 | uVar2 << 0x40 - bVar1;
}



undefined4 FUN_140010de0(void)

{
  undefined4 uVar1;
  
  uVar1 = DAT_140038e20;
  DAT_140038e20 = 1;
  return uVar1;
}



// Library Function - Single Match
//  _configthreadlocale
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl _configthreadlocale(int _Flag)

{
  uint uVar1;
  __acrt_ptd *p_Var2;
  ulong *puVar3;
  uint uVar4;
  
  p_Var2 = FUN_140017b04();
  uVar1 = *(uint *)(p_Var2 + 0x3a8);
  if (_Flag == -1) {
    DAT_140038910 = 0xffffffff;
  }
  else if (_Flag != 0) {
    if (_Flag == 1) {
      uVar4 = uVar1 | 2;
    }
    else {
      if (_Flag != 2) {
        puVar3 = __doserrno();
        *puVar3 = 0x16;
        FUN_140011e58();
        return -1;
      }
      uVar4 = uVar1 & 0xfffffffd;
    }
    *(uint *)(p_Var2 + 0x3a8) = uVar4;
  }
  return 2 - (uint)((uVar1 & 2) != 0);
}



// Library Function - Single Match
//  __acrt_uninitialize_locale
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_uninitialize_locale(void)

{
  _lambda_3e16ef9562a7dcce91392c22ab16ea36_ local_res8 [8];
  undefined4 local_res10 [2];
  undefined4 local_res18 [4];
  
  local_res10[0] = 4;
  local_res18[0] = 4;
  __crt_seh_guarded_call<void>::
  operator___class__lambda_410d79af7f07d98d83a3f525b3859a53__class__lambda_3e16ef9562a7dcce91392c22ab16ea36_____ptr64_class__lambda_38119f0e861e05405d8a144b9b982f0a___
            ((__crt_seh_guarded_call_void_ *)local_res8,
             (_lambda_410d79af7f07d98d83a3f525b3859a53_ *)local_res18,local_res8,
             (_lambda_38119f0e861e05405d8a144b9b982f0a_ *)local_res10);
  return;
}



// Library Function - Single Match
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_410d79af7f07d98d83a3f525b3859a53>,class <lambda_3e16ef9562a7dcce91392c22ab16ea36> &
// __ptr64,class <lambda_38119f0e861e05405d8a144b9b982f0a> >(class
// <lambda_410d79af7f07d98d83a3f525b3859a53> && __ptr64,class
// <lambda_3e16ef9562a7dcce91392c22ab16ea36> & __ptr64,class
// <lambda_38119f0e861e05405d8a144b9b982f0a> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_seh_guarded_call<void>::
operator___class__lambda_410d79af7f07d98d83a3f525b3859a53__class__lambda_3e16ef9562a7dcce91392c22ab16ea36_____ptr64_class__lambda_38119f0e861e05405d8a144b9b982f0a___
          (__crt_seh_guarded_call_void_ *this,_lambda_410d79af7f07d98d83a3f525b3859a53_ *param_1,
          _lambda_3e16ef9562a7dcce91392c22ab16ea36_ *param_2,
          _lambda_38119f0e861e05405d8a144b9b982f0a_ *param_3)

{
  undefined **ppuVar1;
  LPVOID *ppvVar2;
  
  FID_conflict___acrt_lock(*(int *)param_1);
  for (ppvVar2 = (LPVOID *)&DAT_140039a48; ppvVar2 != (LPVOID *)&DAT_140039a50;
      ppvVar2 = ppvVar2 + 1) {
    if ((undefined **)*ppvVar2 != &PTR_DAT_1400386f0) {
      ppuVar1 = _updatetlocinfoEx_nolock(ppvVar2,&PTR_DAT_1400386f0);
      *ppvVar2 = ppuVar1;
    }
  }
  FID_conflict___acrt_lock(*(int *)param_3);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _configure_wide_argv
// 
// Library: Visual Studio 2017 Release

int _configure_wide_argv(int param_1)

{
  LPCWSTR pWVar1;
  ulonglong uVar2;
  int iVar3;
  ulong *puVar4;
  LPCWSTR *ppWVar5;
  LPCWSTR *ppWVar6;
  int iVar7;
  short *psVar8;
  LPCWSTR *local_res10;
  ulonglong local_res18;
  ulonglong local_res20;
  
  iVar7 = 0;
  if (param_1 != 0) {
    if (param_1 - 1U < 2) {
      GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_140038e30,0x104);
      _DAT_140038df0 = &DAT_140038e30;
      if ((DAT_140038de8 == (short *)0x0) || (psVar8 = DAT_140038de8, *DAT_140038de8 == 0)) {
        psVar8 = (short *)&DAT_140038e30;
      }
      local_res18 = 0;
      local_res20 = 0;
      parse_command_line_wchar_t_
                ((wchar_t *)psVar8,(wchar_t **)0x0,(wchar_t *)0x0,&local_res18,&local_res20);
      uVar2 = local_res18;
      ppWVar5 = (LPCWSTR *)FUN_140011084(local_res18,local_res20,2);
      if (ppWVar5 == (LPCWSTR *)0x0) {
        puVar4 = __doserrno();
        iVar7 = 0xc;
        *puVar4 = 0xc;
        _free_base((LPVOID)0x0);
      }
      else {
        parse_command_line_wchar_t_
                  ((wchar_t *)psVar8,(wchar_t **)ppWVar5,(wchar_t *)(ppWVar5 + uVar2),&local_res18,
                   &local_res20);
        if (param_1 == 1) {
          _DAT_140038dcc = (int)local_res18 + -1;
          ppWVar6 = (LPCWSTR *)0x0;
          DAT_140038dd8 = ppWVar5;
        }
        else {
          local_res10 = (LPCWSTR *)0x0;
          iVar3 = thunk_FUN_14001c1c8(ppWVar5,&local_res10);
          ppWVar6 = local_res10;
          if (iVar3 != 0) {
            _free_base(local_res10);
            local_res10 = (LPCWSTR *)0x0;
            _free_base(ppWVar5);
            return iVar3;
          }
          _DAT_140038dcc = 0;
          pWVar1 = *local_res10;
          while (pWVar1 != (LPCWSTR)0x0) {
            local_res10 = local_res10 + 1;
            _DAT_140038dcc = _DAT_140038dcc + 1;
            pWVar1 = *local_res10;
          }
          local_res10 = (LPCWSTR *)0x0;
          DAT_140038dd8 = ppWVar6;
          _free_base((LPVOID)0x0);
          local_res10 = (LPCWSTR *)0x0;
          ppWVar6 = ppWVar5;
        }
        _free_base(ppWVar6);
      }
    }
    else {
      puVar4 = __doserrno();
      iVar7 = 0x16;
      *puVar4 = 0x16;
      FUN_140011e58();
    }
  }
  return iVar7;
}



LPVOID FUN_140011084(ulonglong param_1,ulonglong param_2,ulonglong param_3)

{
  LPVOID pvVar1;
  
  if ((param_1 < 0x1fffffffffffffff) &&
     (param_2 < SUB168((ZEXT816(0) << 0x40 | ZEXT816(0xffffffffffffffff)) / ZEXT816(param_3),0))) {
    if (param_2 * param_3 < ~(param_1 * 8)) {
      pvVar1 = _calloc_base(param_1 * 8 + param_2 * param_3,1);
      _free_base((LPVOID)0x0);
      return pvVar1;
    }
  }
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  void __cdecl parse_command_line<wchar_t>(wchar_t * __ptr64,wchar_t * __ptr64 * __ptr64,wchar_t *
// __ptr64,unsigned __int64 * __ptr64,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2017 Release

void __cdecl
parse_command_line_wchar_t_
          (wchar_t *param_1,wchar_t **param_2,wchar_t *param_3,__uint64 *param_4,__uint64 *param_5)

{
  bool bVar1;
  uint uVar2;
  short *psVar3;
  uint uVar4;
  short sVar5;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (wchar_t **)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  bVar1 = false;
  do {
    sVar5 = 0x22;
    if (*(short *)param_1 == 0x22) {
      bVar1 = !bVar1;
    }
    else {
      *param_5 = *param_5 + 1;
      if ((short *)param_3 != (short *)0x0) {
        *(short *)param_3 = *(short *)param_1;
        param_3 = (wchar_t *)((longlong)param_3 + 2);
      }
      sVar5 = *(short *)param_1;
      if (sVar5 == 0) goto LAB_140011179;
    }
    param_1 = (wchar_t *)((longlong)param_1 + 2);
  } while ((bVar1) || ((sVar5 != 0x20 && (sVar5 != 9))));
  if ((short *)param_3 != (short *)0x0) {
    *(short *)((longlong)param_3 + -2) = 0;
  }
LAB_140011179:
  bVar1 = false;
  while (sVar5 = *(short *)param_1, psVar3 = (short *)param_1, sVar5 != 0) {
    while ((sVar5 == 0x20 || (sVar5 == 9))) {
      psVar3 = psVar3 + 1;
      sVar5 = *psVar3;
    }
    if (sVar5 == 0) break;
    if ((short **)param_2 != (short **)0x0) {
      *param_2 = param_3;
      param_2 = (wchar_t **)((short **)param_2 + 1);
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      uVar4 = 1;
      uVar2 = 0;
      for (; *psVar3 == 0x5c; psVar3 = psVar3 + 1) {
        uVar2 = uVar2 + 1;
      }
      param_1 = (wchar_t *)psVar3;
      if (*psVar3 == 0x22) {
        if (((uVar2 & 1) == 0) &&
           ((!bVar1 || (param_1 = (wchar_t *)(psVar3 + 1), *(short *)param_1 != 0x22)))) {
          bVar1 = !bVar1;
          param_1 = (wchar_t *)psVar3;
          uVar4 = 0;
        }
        uVar2 = uVar2 >> 1;
      }
      while (uVar2 != 0) {
        uVar2 = uVar2 - 1;
        if ((short *)param_3 != (short *)0x0) {
          *(short *)param_3 = 0x5c;
          param_3 = (wchar_t *)((longlong)param_3 + 2);
        }
        *param_5 = *param_5 + 1;
      }
      sVar5 = *(short *)param_1;
      if ((sVar5 == 0) || ((!bVar1 && ((sVar5 == 0x20 || (sVar5 == 9)))))) break;
      if (uVar4 != 0) {
        if ((short *)param_3 != (short *)0x0) {
          *(short *)param_3 = sVar5;
          param_3 = (wchar_t *)((longlong)param_3 + 2);
        }
        *param_5 = *param_5 + 1;
      }
      psVar3 = (short *)((longlong)param_1 + 2);
    }
    if ((short *)param_3 != (short *)0x0) {
      *(short *)param_3 = 0;
      param_3 = (wchar_t *)((longlong)param_3 + 2);
    }
    *param_5 = *param_5 + 1;
  }
  if ((short **)param_2 != (short **)0x0) {
    *param_2 = (wchar_t *)0x0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// Library Function - Single Match
//  _initialize_onexit_table
// 
// Library: Visual Studio 2015 Release

undefined8 _initialize_onexit_table(ulonglong *param_1)

{
  byte bVar1;
  ulonglong uVar2;
  
  if (param_1 == (ulonglong *)0x0) {
    return 0xffffffff;
  }
  if (*param_1 == param_1[2]) {
    bVar1 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
    uVar2 = (0UL >> bVar1 | 0L << 0x40 - bVar1) ^ DAT_140038010;
    *param_1 = uVar2;
    param_1[1] = uVar2;
    param_1[2] = uVar2;
  }
  return 0;
}



// Library Function - Single Match
//  _register_onexit_function
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

void _register_onexit_function(longlong param_1,undefined8 param_2)

{
  longlong local_res8;
  undefined8 local_res10;
  undefined local_res18 [8];
  int local_res20 [2];
  int local_28 [2];
  longlong *local_20;
  undefined8 *local_18;
  
  local_20 = &local_res8;
  local_18 = &local_res10;
  local_res20[0] = 2;
  local_28[0] = 2;
  local_res8 = param_1;
  local_res10 = param_2;
  operator____(local_res18,local_28,&local_20,local_res20);
  return;
}



// Library Function - Single Match
//  _execute_onexit_table
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _execute_onexit_table(undefined8 param_1)

{
  undefined8 local_res8;
  __crt_seh_guarded_call_int_ local_res10 [8];
  undefined4 local_res18 [2];
  undefined4 local_res20 [2];
  undefined8 *local_18 [3];
  
  local_18[0] = &local_res8;
  local_res18[0] = 2;
  local_res20[0] = 2;
  local_res8 = param_1;
  __crt_seh_guarded_call<int>::
  operator___class__lambda_7777bce6b2f8c936911f934f8298dc43__class__lambda_f03950bc5685219e0bcd2087efbe011e_____ptr64_class__lambda_3883c3dff614d5e0c5f61bb1ac94921c___
            (local_res10,(_lambda_7777bce6b2f8c936911f934f8298dc43_ *)local_res20,
             (_lambda_f03950bc5685219e0bcd2087efbe011e_ *)local_18,
             (_lambda_3883c3dff614d5e0c5f61bb1ac94921c_ *)local_res18);
  return;
}



void FUN_14001134c(undefined8 param_1)

{
  _register_onexit_function((longlong)&DAT_140039040,param_1);
  return;
}



undefined8 FUN_14001135c(longlong **param_1)

{
  undefined8 uVar1;
  LPVOID pvVar2;
  byte bVar3;
  ulonglong *puVar4;
  ulonglong uVar5;
  LPVOID pvVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong *puVar9;
  ulonglong *puVar10;
  
  puVar4 = (ulonglong *)**param_1;
  if (puVar4 == (ulonglong *)0x0) {
LAB_14001138a:
    uVar1 = 0xffffffff;
  }
  else {
    bVar3 = (byte)DAT_140038010 & 0x3f;
    pvVar6 = (LPVOID)((*puVar4 ^ DAT_140038010) >> bVar3 | (*puVar4 ^ DAT_140038010) << 0x40 - bVar3
                     );
    puVar10 = (ulonglong *)
              ((puVar4[1] ^ DAT_140038010) >> bVar3 | (puVar4[1] ^ DAT_140038010) << 0x40 - bVar3);
    puVar4 = (ulonglong *)
             ((puVar4[2] ^ DAT_140038010) >> bVar3 | (puVar4[2] ^ DAT_140038010) << 0x40 - bVar3);
    if (puVar10 == puVar4) {
      uVar5 = (longlong)puVar4 - (longlong)pvVar6 >> 3;
      uVar7 = uVar5;
      if (0x200 < uVar5) {
        uVar7 = 0x200;
      }
      uVar8 = uVar7 + uVar5;
      if (uVar7 + uVar5 == 0) {
        uVar8 = 0x20;
      }
      if (uVar8 < uVar5) {
LAB_14001140c:
        uVar8 = uVar5 + 4;
        pvVar2 = _recalloc_base(pvVar6,uVar8,8);
        _free_base((LPVOID)0x0);
        if (pvVar2 == (LPVOID)0x0) goto LAB_14001138a;
      }
      else {
        pvVar2 = _recalloc_base(pvVar6,uVar8,8);
        _free_base((LPVOID)0x0);
        if (pvVar2 == (LPVOID)0x0) goto LAB_14001140c;
      }
      pvVar6 = pvVar2;
      puVar10 = (ulonglong *)((longlong)pvVar6 + uVar5 * 8);
      puVar4 = (ulonglong *)((longlong)pvVar6 + uVar8 * 8);
      bVar3 = -((byte)DAT_140038010 & 0x3f) & 0x3f;
      uVar5 = (0UL >> bVar3 | 0L << 0x40 - bVar3) ^ DAT_140038010;
      uVar7 = (ulonglong)((longlong)puVar4 + (7 - (longlong)puVar10)) >> 3;
      if (puVar4 < puVar10) {
        uVar7 = 0;
      }
      puVar9 = puVar10;
      if (uVar7 != 0) {
        for (; uVar7 != 0; uVar7 = uVar7 - 1) {
          *puVar9 = uVar5;
          puVar9 = puVar9 + 1;
        }
      }
    }
    bVar3 = -((byte)DAT_140038010 & 0x3f) & 0x3f;
    *puVar10 = ((ulonglong)*param_1[1] >> bVar3 | *param_1[1] << 0x40 - bVar3) ^ DAT_140038010;
    bVar3 = -((byte)DAT_140038010 & 0x3f) & 0x3f;
    *(ulonglong *)**param_1 =
         ((ulonglong)pvVar6 >> bVar3 | (longlong)pvVar6 << 0x40 - bVar3) ^ DAT_140038010;
    bVar3 = -((byte)DAT_140038010 & 0x3f) & 0x3f;
    *(ulonglong *)(**param_1 + 8) =
         ((ulonglong)(puVar10 + 1) >> bVar3 | (longlong)(puVar10 + 1) << 0x40 - bVar3) ^
         DAT_140038010;
    bVar3 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
    uVar1 = 0;
    *(ulonglong *)(**param_1 + 0x10) =
         ((ulonglong)puVar4 >> bVar3 | (longlong)puVar4 << 0x40 - bVar3) ^ DAT_140038010;
  }
  return uVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 FUN_140011520(longlong **param_1)

{
  byte bVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  ulonglong *puVar4;
  sbyte sVar5;
  ulonglong *puVar6;
  ulonglong uVar7;
  ulonglong *puVar8;
  uint uVar9;
  ulonglong uVar10;
  ulonglong *puVar11;
  ulonglong *puVar12;
  ulonglong *puVar13;
  
  puVar6 = (ulonglong *)**param_1;
  if (puVar6 == (ulonglong *)0x0) {
    uVar2 = 0xffffffff;
  }
  else {
    uVar9 = (uint)DAT_140038010 & 0x3f;
    sVar5 = (sbyte)uVar9;
    puVar8 = (ulonglong *)
             ((*puVar6 ^ DAT_140038010) >> sVar5 | (*puVar6 ^ DAT_140038010) << 0x40 - sVar5);
    puVar6 = (ulonglong *)
             ((puVar6[1] ^ DAT_140038010) >> sVar5 | (puVar6[1] ^ DAT_140038010) << 0x40 - sVar5);
    if ((longlong)puVar8 - 1U < 0xfffffffffffffffe) {
      uVar7 = (0UL >> (-sVar5 & 0x3fU) | 0L << 0x40 - (-sVar5 & 0x3fU)) ^ DAT_140038010;
      uVar3 = DAT_140038010;
      puVar12 = puVar6;
      puVar13 = puVar8;
      while (puVar6 = puVar6 + -1, puVar8 <= puVar6) {
        if (*puVar6 != uVar7) {
          uVar3 = *puVar6 ^ uVar3;
          *puVar6 = uVar7;
          (*(code *)(uVar3 >> (sbyte)uVar9 | uVar3 << 0x40 - (sbyte)uVar9))();
          uVar9 = (uint)DAT_140038010 & 0x3f;
          uVar10 = *(ulonglong *)**param_1 ^ DAT_140038010;
          uVar3 = ((ulonglong *)**param_1)[1] ^ DAT_140038010;
          sVar5 = (sbyte)uVar9;
          puVar11 = (ulonglong *)(uVar10 >> sVar5 | uVar10 << 0x40 - sVar5);
          puVar4 = (ulonglong *)(uVar3 >> sVar5 | uVar3 << 0x40 - sVar5);
          uVar3 = DAT_140038010;
          if ((puVar11 != puVar13) || (puVar4 != puVar12)) {
            puVar6 = puVar4;
            puVar8 = puVar11;
            puVar12 = puVar4;
            puVar13 = puVar11;
          }
        }
      }
      if (puVar8 != (ulonglong *)0xffffffffffffffff) {
        _free_base(puVar8);
        uVar3 = DAT_140038010;
      }
      bVar1 = 0x40 - ((byte)uVar3 & 0x3f) & 0x3f;
      uVar3 = (0UL >> bVar1 | 0L << 0x40 - bVar1) ^ uVar3;
      *(ulonglong *)**param_1 = uVar3;
      *(ulonglong *)(**param_1 + 8) = uVar3;
      *(ulonglong *)(**param_1 + 0x10) = uVar3;
    }
    uVar2 = 0;
  }
  return uVar2;
}



// Library Function - Multiple Matches With Same Base Name
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_638799b9deba96c50f710eeac98168cd>,class <lambda_22ebabd17bc4fa466a2aca6d8deb888d> &
// __ptr64,class <lambda_a6f7d7db0129f75315ebf26d50c089f1> >(class
// <lambda_638799b9deba96c50f710eeac98168cd> && __ptr64,class
// <lambda_22ebabd17bc4fa466a2aca6d8deb888d> & __ptr64,class
// <lambda_a6f7d7db0129f75315ebf26d50c089f1> && __ptr64) __ptr64
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_b8c45f8f788dd370798f47cfe8ac3a86>,class <lambda_4e60a939b0d047cfe11ddc22648dfba9> &
// __ptr64,class <lambda_332c3edc96d0294ec56c57d38c1cdfd5> >(class
// <lambda_b8c45f8f788dd370798f47cfe8ac3a86> && __ptr64,class
// <lambda_4e60a939b0d047cfe11ddc22648dfba9> & __ptr64,class
// <lambda_332c3edc96d0294ec56c57d38c1cdfd5> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong operator____(undefined8 param_1,int *param_2,longlong **param_3,int *param_4)

{
  ulonglong uVar1;
  
  FID_conflict___acrt_lock(*param_2);
  uVar1 = FUN_14001135c(param_3);
  FID_conflict___acrt_lock(*param_4);
  return uVar1 & 0xffffffff;
}



// Library Function - Single Match
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_7777bce6b2f8c936911f934f8298dc43>,class <lambda_f03950bc5685219e0bcd2087efbe011e> &
// __ptr64,class <lambda_3883c3dff614d5e0c5f61bb1ac94921c> >(class
// <lambda_7777bce6b2f8c936911f934f8298dc43> && __ptr64,class
// <lambda_f03950bc5685219e0bcd2087efbe011e> & __ptr64,class
// <lambda_3883c3dff614d5e0c5f61bb1ac94921c> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __thiscall
__crt_seh_guarded_call<int>::
operator___class__lambda_7777bce6b2f8c936911f934f8298dc43__class__lambda_f03950bc5685219e0bcd2087efbe011e_____ptr64_class__lambda_3883c3dff614d5e0c5f61bb1ac94921c___
          (__crt_seh_guarded_call_int_ *this,_lambda_7777bce6b2f8c936911f934f8298dc43_ *param_1,
          _lambda_f03950bc5685219e0bcd2087efbe011e_ *param_2,
          _lambda_3883c3dff614d5e0c5f61bb1ac94921c_ *param_3)

{
  undefined8 uVar1;
  
  FID_conflict___acrt_lock(*(int *)param_1);
  uVar1 = FUN_140011520((longlong **)param_2);
  FID_conflict___acrt_lock(*(int *)param_3);
  return (int)uVar1;
}



// Library Function - Single Match
//  __doserrno
// 
// Library: Visual Studio 2015 Release

ulong * __cdecl __doserrno(void)

{
  __acrt_ptd *p_Var1;
  ulong *puVar2;
  
  p_Var1 = FUN_140017c70();
  if (p_Var1 == (__acrt_ptd *)0x0) {
    puVar2 = (ulong *)&DAT_140038148;
  }
  else {
    puVar2 = (ulong *)(p_Var1 + 0x20);
  }
  return puVar2;
}



// Library Function - Single Match
//  __doserrno
// 
// Library: Visual Studio 2015 Release

ulong * __cdecl __doserrno(void)

{
  __acrt_ptd *p_Var1;
  ulong *puVar2;
  
  p_Var1 = FUN_140017c70();
  if (p_Var1 == (__acrt_ptd *)0x0) {
    puVar2 = &DAT_14003814c;
  }
  else {
    puVar2 = (ulong *)(p_Var1 + 0x24);
  }
  return puVar2;
}



// Library Function - Single Match
//  __acrt_errno_map_os_error
// 
// Library: Visual Studio 2015 Release

void __acrt_errno_map_os_error(int param_1)

{
  undefined4 uVar1;
  __acrt_ptd *p_Var2;
  int *piVar3;
  undefined4 *puVar4;
  
  p_Var2 = FUN_140017c70();
  if (p_Var2 == (__acrt_ptd *)0x0) {
    piVar3 = &DAT_14003814c;
  }
  else {
    piVar3 = (int *)(p_Var2 + 0x24);
  }
  *piVar3 = param_1;
  p_Var2 = FUN_140017c70();
  puVar4 = (undefined4 *)&DAT_140038148;
  if (p_Var2 != (__acrt_ptd *)0x0) {
    puVar4 = (undefined4 *)(p_Var2 + 0x20);
  }
  uVar1 = __acrt_errno_from_os_error(param_1);
  *puVar4 = uVar1;
  return;
}



// Library Function - Single Match
//  __acrt_errno_from_os_error
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 __acrt_errno_from_os_error(int param_1)

{
  uint uVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  int *piVar4;
  
  uVar3 = 0;
  piVar4 = &DAT_1400293d0;
  do {
    if (param_1 == *piVar4) {
      return (&DAT_1400293d4)[uVar3 * 2];
    }
    uVar1 = (int)uVar3 + 1;
    uVar3 = (ulonglong)uVar1;
    piVar4 = piVar4 + 2;
  } while (uVar1 < 0x2c);
  if (param_1 - 0x13U < 0x12) {
    return 0xd;
  }
  uVar2 = 0x16;
  if (param_1 - 0xbcU < 0xf) {
    uVar2 = 8;
  }
  return uVar2;
}



int __cdecl common_initialize_environment_nolock_wchar_t_(void)

{
  wchar_t **ppwVar1;
  int iVar2;
  undefined8 *puVar3;
  wchar_t **ppwVar4;
  
  iVar2 = 0;
  if (DAT_140039078 == (wchar_t **)0x0) {
    puVar3 = __dcrt_get_wide_environment_from_os();
    if (puVar3 == (undefined8 *)0x0) {
      iVar2 = -1;
    }
    else {
      ppwVar4 = create_environment_wchar_t_((wchar_t *)puVar3);
      ppwVar1 = ppwVar4;
      if (ppwVar4 == (wchar_t **)0x0) {
        iVar2 = -1;
        ppwVar4 = DAT_140039078;
        ppwVar1 = DAT_140039080;
      }
      DAT_140039080 = ppwVar1;
      DAT_140039078 = ppwVar4;
      _free_base((LPVOID)0x0);
    }
    _free_base(puVar3);
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



// Library Function - Single Match
//  _get_initial_wide_environment
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _get_initial_wide_environment(void)

{
  longlong lVar1;
  int iVar2;
  LPCSTR pCVar3;
  
  lVar1 = DAT_140039080;
  if (((DAT_140039080 == 0) && (lVar1 = DAT_140039078, DAT_140039078 == 0)) &&
     ((DAT_140039070 == 0 ||
      ((iVar2 = common_initialize_environment_nolock_wchar_t_(), lVar1 = DAT_140039078, iVar2 != 0
       && (pCVar3 = FUN_140011d04(), lVar1 = DAT_140039078, (int)pCVar3 != 0)))))) {
    lVar1 = 0;
  }
  DAT_140039080 = lVar1;
  return;
}



// Library Function - Single Match
//  __dcrt_get_or_create_narrow_environment_nolock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

longlong __dcrt_get_or_create_narrow_environment_nolock(void)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = DAT_140039070;
  if ((DAT_140039070 == 0) &&
     ((DAT_140039078 == 0 ||
      ((iVar1 = common_initialize_environment_nolock_char_(), lVar3 = DAT_140039070, iVar1 != 0 &&
       (lVar2 = FUN_140011c30(), lVar3 = DAT_140039070, (int)lVar2 != 0)))))) {
    lVar3 = 0;
  }
  return lVar3;
}



// Library Function - Single Match
//  __dcrt_get_or_create_wide_environment_nolock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

longlong __dcrt_get_or_create_wide_environment_nolock(void)

{
  int iVar1;
  LPCSTR pCVar2;
  longlong lVar3;
  
  lVar3 = DAT_140039078;
  if ((DAT_140039078 == 0) &&
     ((DAT_140039070 == 0 ||
      ((iVar1 = common_initialize_environment_nolock_wchar_t_(), lVar3 = DAT_140039078, iVar1 != 0
       && (pCVar2 = FUN_140011d04(), lVar3 = DAT_140039078, (int)pCVar2 != 0)))))) {
    lVar3 = 0;
  }
  return lVar3;
}



// Library Function - Single Match
//  __dcrt_uninitialize_environments_nolock
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __dcrt_uninitialize_environments_nolock(void)

{
  uninitialize_environment_internal__(&DAT_140039070);
  uninitialize_environment_internal__(&DAT_140039078);
  free_environment__(DAT_140039088);
  free_environment__(DAT_140039080);
  return;
}



// Library Function - Single Match
//  int __cdecl common_initialize_environment_nolock<char>(void)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl common_initialize_environment_nolock_char_(void)

{
  char **ppcVar1;
  int iVar2;
  char *pcVar3;
  char **ppcVar4;
  
  iVar2 = 0;
  if (DAT_140039070 == (char **)0x0) {
    __acrt_initialize_multibyte();
    pcVar3 = (char *)__dcrt_get_narrow_environment_from_os();
    if (pcVar3 == (char *)0x0) {
      iVar2 = -1;
    }
    else {
      ppcVar4 = create_environment_char_(pcVar3);
      ppcVar1 = ppcVar4;
      if (ppcVar4 == (char **)0x0) {
        iVar2 = -1;
        ppcVar4 = DAT_140039070;
        ppcVar1 = DAT_140039088;
      }
      DAT_140039088 = ppcVar1;
      DAT_140039070 = ppcVar4;
      _free_base((LPVOID)0x0);
    }
    _free_base(pcVar3);
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



// Library Function - Single Match
//  int __cdecl common_initialize_environment_nolock<wchar_t>(void)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl common_initialize_environment_nolock_wchar_t_(void)

{
  wchar_t **ppwVar1;
  int iVar2;
  undefined8 *puVar3;
  wchar_t **ppwVar4;
  
  iVar2 = 0;
  if (DAT_140039078 == (wchar_t **)0x0) {
    puVar3 = __dcrt_get_wide_environment_from_os();
    if (puVar3 == (undefined8 *)0x0) {
      iVar2 = -1;
    }
    else {
      ppwVar4 = create_environment_wchar_t_((wchar_t *)puVar3);
      ppwVar1 = ppwVar4;
      if (ppwVar4 == (wchar_t **)0x0) {
        iVar2 = -1;
        ppwVar4 = DAT_140039078;
        ppwVar1 = DAT_140039080;
      }
      DAT_140039080 = ppwVar1;
      DAT_140039078 = ppwVar4;
      _free_base((LPVOID)0x0);
    }
    _free_base(puVar3);
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



// Library Function - Multiple Matches With Same Base Name
//  void __cdecl uninitialize_environment_internal<char>(char * __ptr64 * __ptr64 & __ptr64)
//  void __cdecl uninitialize_environment_internal<wchar_t>(wchar_t * __ptr64 * __ptr64 & __ptr64)
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void uninitialize_environment_internal__(undefined8 *param_1)

{
  if ((LPVOID *)*param_1 != DAT_140039088) {
    free_environment__((LPVOID *)*param_1);
  }
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  void __cdecl uninitialize_environment_internal<char>(char * __ptr64 * __ptr64 & __ptr64)
//  void __cdecl uninitialize_environment_internal<wchar_t>(wchar_t * __ptr64 * __ptr64 & __ptr64)
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void uninitialize_environment_internal__(undefined8 *param_1)

{
  if ((LPVOID *)*param_1 != DAT_140039080) {
    free_environment__((LPVOID *)*param_1);
  }
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  void __cdecl free_environment<char>(char * __ptr64 * __ptr64 const)
//  void __cdecl free_environment<wchar_t>(wchar_t * __ptr64 * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void free_environment__(LPVOID *param_1)

{
  LPVOID pvVar1;
  LPVOID *ppvVar2;
  
  if (param_1 != (LPVOID *)0x0) {
    pvVar1 = *param_1;
    ppvVar2 = param_1;
    while (pvVar1 != (LPVOID)0x0) {
      _free_base(pvVar1);
      ppvVar2 = ppvVar2 + 1;
      pvVar1 = *ppvVar2;
    }
    _free_base(param_1);
  }
  return;
}



// Library Function - Single Match
//  char * __ptr64 * __ptr64 __cdecl create_environment<char>(char * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

char ** __cdecl create_environment_char_(char *param_1)

{
  code *pcVar1;
  ulong uVar2;
  char **ppcVar3;
  longlong lVar4;
  char **ppcVar5;
  char *pcVar6;
  char **ppcVar7;
  char cVar8;
  longlong lVar9;
  ulonglong uVar10;
  char **ppcVar11;
  
  ppcVar11 = (char **)0x0;
  cVar8 = *param_1;
  ppcVar7 = ppcVar11;
  pcVar6 = param_1;
  while (cVar8 != '\0') {
    ppcVar3 = (char **)((longlong)ppcVar7 + 1);
    if (cVar8 == '=') {
      ppcVar3 = ppcVar7;
    }
    lVar9 = -1;
    do {
      lVar4 = lVar9;
      lVar9 = lVar4 + 1;
    } while (pcVar6[lVar9] != '\0');
    pcVar6 = pcVar6 + lVar4 + 2;
    ppcVar7 = ppcVar3;
    cVar8 = *pcVar6;
  }
  ppcVar5 = (char **)_calloc_base((longlong)ppcVar7 + 1,8);
  ppcVar7 = ppcVar11;
  ppcVar3 = ppcVar5;
  if (ppcVar5 != (char **)0x0) {
    for (; ppcVar7 = ppcVar5, *param_1 != '\0'; param_1 = param_1 + uVar10) {
      lVar9 = -1;
      do {
        lVar4 = lVar9;
        lVar9 = lVar4 + 1;
      } while (param_1[lVar9] != '\0');
      uVar10 = lVar4 + 2;
      if (*param_1 != '=') {
        pcVar6 = (char *)_calloc_base(uVar10,1);
        if (pcVar6 == (char *)0x0) {
          free_environment__(ppcVar5);
          _free_base((LPVOID)0x0);
          ppcVar7 = ppcVar11;
          break;
        }
        uVar2 = FUN_140016cd4(pcVar6,uVar10,(longlong)param_1);
        if (uVar2 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar1 = (code *)swi(3);
          ppcVar7 = (char **)(*pcVar1)();
          return ppcVar7;
        }
        *ppcVar3 = pcVar6;
        ppcVar3 = ppcVar3 + 1;
        _free_base((LPVOID)0x0);
      }
    }
  }
  _free_base((LPVOID)0x0);
  return ppcVar7;
}



// Library Function - Single Match
//  wchar_t * __ptr64 * __ptr64 __cdecl create_environment<wchar_t>(wchar_t * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

wchar_t ** __cdecl create_environment_wchar_t_(wchar_t *param_1)

{
  code *pcVar1;
  ulong uVar2;
  short **ppsVar3;
  longlong lVar4;
  short **ppsVar5;
  short *psVar6;
  wchar_t **ppwVar7;
  short **ppsVar8;
  short sVar9;
  longlong lVar10;
  ulonglong uVar11;
  short **ppsVar12;
  
  ppsVar12 = (short **)0x0;
  sVar9 = *(short *)param_1;
  ppsVar8 = ppsVar12;
  psVar6 = (short *)param_1;
  while (sVar9 != 0) {
    ppsVar3 = (short **)((longlong)ppsVar8 + 1);
    if (sVar9 == 0x3d) {
      ppsVar3 = ppsVar8;
    }
    lVar10 = -1;
    do {
      lVar4 = lVar10;
      lVar10 = lVar4 + 1;
    } while (psVar6[lVar10] != 0);
    psVar6 = psVar6 + lVar4 + 2;
    ppsVar8 = ppsVar3;
    sVar9 = *psVar6;
  }
  ppsVar5 = (short **)_calloc_base((longlong)ppsVar8 + 1,8);
  ppsVar8 = ppsVar12;
  ppsVar3 = ppsVar5;
  if (ppsVar5 != (short **)0x0) {
    for (; ppsVar8 = ppsVar5, *(short *)param_1 != 0;
        param_1 = (wchar_t *)((longlong)param_1 + uVar11 * 2)) {
      lVar10 = -1;
      do {
        lVar4 = lVar10;
        lVar10 = lVar4 + 1;
      } while (*(short *)((longlong)param_1 + lVar10 * 2) != 0);
      uVar11 = lVar4 + 2;
      if (*(short *)param_1 != 0x3d) {
        psVar6 = (short *)_calloc_base(uVar11,2);
        if (psVar6 == (short *)0x0) {
          free_environment__(ppsVar5);
          _free_base((LPVOID)0x0);
          ppsVar8 = ppsVar12;
          break;
        }
        uVar2 = FUN_14001ba5c(psVar6,uVar11,(longlong)param_1);
        if (uVar2 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar1 = (code *)swi(3);
          ppwVar7 = (wchar_t **)(*pcVar1)();
          return ppwVar7;
        }
        *ppsVar3 = psVar6;
        ppsVar3 = ppsVar3 + 1;
        _free_base((LPVOID)0x0);
      }
    }
  }
  _free_base((LPVOID)0x0);
  return (wchar_t **)ppsVar8;
}



longlong FUN_140011c30(void)

{
  int iVar1;
  longlong lVar2;
  char *pcVar3;
  longlong *plVar4;
  
  plVar4 = DAT_140039078;
  if (DAT_140039078 == (longlong *)0x0) {
LAB_140011c4f:
    lVar2 = 0xffffffff;
  }
  else {
    for (; lVar2 = *plVar4, lVar2 != 0; plVar4 = plVar4 + 1) {
      iVar1 = __acrt_WideCharToMultiByte(0,0,(char)lVar2,0xff,0,0,0,0);
      if (iVar1 == 0) goto LAB_140011c4f;
      pcVar3 = (char *)_calloc_base((longlong)iVar1,1);
      if (pcVar3 == (char *)0x0) {
LAB_140011cf4:
        _free_base(pcVar3);
        goto LAB_140011c4f;
      }
      iVar1 = __acrt_WideCharToMultiByte(0,0,(char)*plVar4,0xff,(char)pcVar3,(char)iVar1,0,0);
      if (iVar1 == 0) goto LAB_140011cf4;
      common_set_variable_in_environment_nolock_char_(pcVar3,0);
      _free_base((LPVOID)0x0);
    }
  }
  return lVar2;
}



LPCSTR FUN_140011d04(void)

{
  int iVar1;
  LPCSTR pCVar2;
  LPWSTR pWVar3;
  LPCSTR *ppCVar4;
  
  ppCVar4 = DAT_140039070;
  if (DAT_140039070 == (LPCSTR *)0x0) {
LAB_140011d1f:
    pCVar2 = (LPCSTR)0xffffffff;
  }
  else {
    for (; pCVar2 = *ppCVar4, pCVar2 != (LPCSTR)0x0; ppCVar4 = ppCVar4 + 1) {
      iVar1 = __acrt_MultiByteToWideChar(0,0,pCVar2,-1,(LPWSTR)0x0,0);
      if (iVar1 == 0) goto LAB_140011d1f;
      pWVar3 = (LPWSTR)_calloc_base((longlong)iVar1,2);
      if (pWVar3 == (LPWSTR)0x0) {
LAB_140011da5:
        _free_base(pWVar3);
        goto LAB_140011d1f;
      }
      iVar1 = __acrt_MultiByteToWideChar(0,0,*ppCVar4,-1,pWVar3,iVar1);
      if (iVar1 == 0) goto LAB_140011da5;
      common_set_variable_in_environment_nolock_wchar_t_((wchar_t *)pWVar3,0);
      _free_base((LPVOID)0x0);
    }
  }
  return pCVar2;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  _initterm
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _initterm(undefined **param_1,undefined **param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar1 = 0;
  uVar2 = (ulonglong)((longlong)param_2 + (7 - (longlong)param_1)) >> 3;
  if (param_2 < param_1) {
    uVar2 = uVar1;
  }
  if (uVar2 != 0) {
    do {
      if ((code *)*param_1 != (code *)0x0) {
        (*(code *)*param_1)();
      }
      param_1 = (code **)param_1 + 1;
      uVar1 = uVar1 + 1;
    } while (uVar1 != uVar2);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  _initterm_e
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 _initterm_e(undefined **param_1,undefined **param_2)

{
  undefined8 uVar1;
  bool bVar2;
  
  bVar2 = param_1 == param_2;
  while( true ) {
    if (bVar2) {
      return 0;
    }
    if (((code *)*param_1 != (code *)0x0) && (uVar1 = (*(code *)*param_1)(), (int)uVar1 != 0))
    break;
    param_1 = (code **)param_1 + 1;
    bVar2 = param_1 == param_2;
  }
  return uVar1;
}



void FUN_140011e58(void)

{
  _invalid_parameter((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
  return;
}



// Library Function - Single Match
//  _invoke_watson
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl
_invoke_watson(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,uintptr_t param_5)

{
  code *pcVar1;
  BOOL BVar2;
  HANDLE pvVar3;
  undefined *puVar4;
  undefined auStack_28 [8];
  undefined auStack_20 [32];
  uint extraout_var;
  
  puVar4 = auStack_28;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(5);
    puVar4 = auStack_20;
  }
  *(undefined8 *)(puVar4 + -8) = 0x140011ea6;
  __acrt_call_reportfault(2,0xc0000417,1);
  *(undefined8 *)(puVar4 + -8) = 0x140011eac;
  pvVar3 = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000140011eb8. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess((HANDLE)((ulonglong)pvVar3 & 0xffffffff | (ulonglong)extraout_var << 0x20),
                   0xc0000417);
  return;
}



// Library Function - Single Match
//  __acrt_call_reportfault
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_call_reportfault(int param_1,DWORD param_2,DWORD param_3)

{
  BOOL BVar1;
  LONG LVar2;
  PRUNTIME_FUNCTION FunctionEntry;
  undefined auStackX_8 [8];
  undefined auStackY_608 [32];
  DWORD64 local_5c8;
  _EXCEPTION_POINTERS local_5c0;
  ulonglong local_5b0;
  PVOID local_5a8 [2];
  EXCEPTION_RECORD local_598;
  _CONTEXT local_4f8;
  ulonglong local_28;
  
  local_28 = DAT_140038010 ^ (ulonglong)auStackY_608;
  if (param_1 != -1) {
    FUN_14000b870();
  }
  FUN_14000ce30((undefined (*) [16])&local_598,0,0x98);
  FUN_14000ce30((undefined (*) [16])&local_4f8,0,0x4d0);
  local_5c0.ExceptionRecord = &local_598;
  local_5c0.ContextRecord = &local_4f8;
  RtlCaptureContext(&local_4f8);
  FunctionEntry = RtlLookupFunctionEntry(local_4f8.Rip,&local_5c8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_5c8,local_4f8.Rip,FunctionEntry,&local_4f8,local_5a8,&local_5b0,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  local_4f8.Rsp = (DWORD64)auStackX_8;
  local_598.ExceptionCode = param_2;
  local_598.ExceptionFlags = param_3;
  BVar1 = IsDebuggerPresent();
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  LVar2 = UnhandledExceptionFilter(&local_5c0);
  if (((LVar2 == 0) && (BVar1 == 0)) && (param_1 != -1)) {
    FUN_14000b870();
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStackY_608);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14001201c(undefined8 param_1)

{
  _DAT_140039090 = param_1;
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _invalid_parameter
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _invalid_parameter(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,
                       uintptr_t param_5)

{
  __acrt_ptd *p_Var1;
  byte bVar2;
  code *pcVar3;
  
  p_Var1 = FUN_140017c70();
  if (((p_Var1 == (__acrt_ptd *)0x0) || (pcVar3 = *(code **)(p_Var1 + 0x3b8), pcVar3 == (code *)0x0)
      ) && (bVar2 = (byte)DAT_140038010 & 0x3f,
           pcVar3 = (code *)((DAT_140038010 ^ _DAT_140039090) >> bVar2 |
                            (DAT_140038010 ^ _DAT_140039090) << 0x40 - bVar2), pcVar3 == (code *)0x0
           )) {
    _invoke_watson(param_1,param_2,param_3,param_4,param_5);
    pcVar3 = (code *)swi(3);
    (*pcVar3)();
    return;
  }
  (*pcVar3)(param_1,param_2,param_3,param_4,param_5);
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  _gmtime32
//  _gmtime64
//  _localtime32
//  _localtime64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

tm * __cdecl FID_conflict__localtime64(__time32_t *_Time)

{
  int iVar1;
  tm *ptVar2;
  tm *ptVar3;
  
  ptVar2 = __getgmtimebuf();
  ptVar3 = (tm *)0x0;
  if ((ptVar2 != (tm *)0x0) &&
     (iVar1 = FUN_140012124(ptVar2,(__int64 *)_Time), ptVar3 = ptVar2, iVar1 != 0)) {
    ptVar3 = (tm *)0x0;
  }
  return ptVar3;
}



int thunk_FUN_140012124(tm *param_1,__int64 *param_2)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  ulong *puVar4;
  undefined8 uVar5;
  longlong lVar6;
  longlong lVar7;
  int aiStackX_8 [4];
  int aiStackX_18 [2];
  int aiStackX_20 [2];
  longlong alStack_28 [2];
  
  if ((param_1 == (tm *)0x0) ||
     (FUN_14000ce30((undefined (*) [16])param_1,0xff,0x24), param_2 == (__int64 *)0x0)) {
    puVar4 = __doserrno();
    *puVar4 = 0x16;
    FUN_140011e58();
  }
  else {
    if ((-1 < *param_2) && (*param_2 < 0x793582b00)) {
      __tzset();
      aiStackX_18[0] = 0;
      aiStackX_20[0] = 0;
      aiStackX_8[0] = 0;
      uVar5 = FUN_14001d298(aiStackX_18);
      if ((int)uVar5 != 0) {
        _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
        pcVar1 = (code *)swi(3);
        iVar2 = (*pcVar1)();
        return iVar2;
      }
      uVar5 = FUN_14001d2c8(aiStackX_20);
      if ((int)uVar5 == 0) {
        uVar5 = FUN_14001d2f8(aiStackX_8);
        if ((int)uVar5 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar1 = (code *)swi(3);
          iVar2 = (*pcVar1)();
          return iVar2;
        }
        if (*param_2 - 0x3f481U < 0x7935041fe) {
          alStack_28[0] = *param_2 - (longlong)aiStackX_8[0];
          iVar2 = common_gmtime_s___int64_(param_1,alStack_28);
          if (iVar2 != 0) {
            return iVar2;
          }
          if ((aiStackX_18[0] != 0) && (iVar2 = _isindst(param_1), iVar2 != 0)) {
            alStack_28[0] = alStack_28[0] - aiStackX_20[0];
            iVar2 = common_gmtime_s___int64_(param_1,alStack_28);
            if (iVar2 != 0) {
              return iVar2;
            }
            param_1->tm_isdst = 1;
          }
        }
        else {
          iVar2 = common_gmtime_s___int64_(param_1,param_2);
          if (iVar2 != 0) {
            return iVar2;
          }
          iVar2 = param_1->tm_sec;
          if ((aiStackX_18[0] != 0) && (iVar3 = _isindst(param_1), iVar3 != 0)) {
            aiStackX_8[0] = aiStackX_8[0] + aiStackX_20[0];
            param_1->tm_isdst = 1;
          }
          lVar7 = (longlong)iVar2 - (longlong)aiStackX_8[0];
          lVar6 = SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0) + lVar7;
          iVar2 = (int)lVar7 + ((int)(lVar6 >> 5) - (int)(lVar6 >> 0x3f)) * -0x3c;
          param_1->tm_sec = iVar2;
          if (iVar2 < 0) {
            lVar7 = lVar7 + -0x3c;
            param_1->tm_sec = iVar2 + 0x3c;
          }
          lVar7 = lVar7 + SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0);
          lVar7 = ((lVar7 >> 5) - (lVar7 >> 0x3f)) + (longlong)param_1->tm_min;
          lVar6 = SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0) + lVar7;
          iVar2 = (int)lVar7 + ((int)(lVar6 >> 5) - (int)(lVar6 >> 0x3f)) * -0x3c;
          param_1->tm_min = iVar2;
          if (iVar2 < 0) {
            lVar7 = lVar7 + -0x3c;
            param_1->tm_min = iVar2 + 0x3c;
          }
          lVar7 = lVar7 + SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0);
          lVar7 = ((lVar7 >> 5) - (lVar7 >> 0x3f)) + (longlong)param_1->tm_hour;
          iVar2 = (int)lVar7 + (int)(lVar7 / 0x18) * -0x18;
          param_1->tm_hour = iVar2;
          if (iVar2 < 0) {
            lVar7 = lVar7 + -0x18;
            param_1->tm_hour = iVar2 + 0x18;
          }
          lVar7 = lVar7 / 6 + (lVar7 >> 0x3f);
          lVar7 = (lVar7 >> 2) - (lVar7 >> 0x3f);
          iVar2 = (int)lVar7;
          if (lVar7 < 1) {
            if (lVar7 < 0) {
              param_1->tm_mday = param_1->tm_mday + iVar2;
              param_1->tm_wday = (param_1->tm_wday + 7 + iVar2) % 7;
              iVar3 = param_1->tm_yday;
              if (param_1->tm_mday < 1) {
                param_1->tm_mon = 0xb;
                param_1->tm_mday = param_1->tm_mday + 0x1f;
                iVar3 = iVar3 + 0x16d;
                param_1->tm_year = param_1->tm_year + -1;
              }
              param_1->tm_yday = iVar3 + iVar2;
            }
          }
          else {
            param_1->tm_mday = param_1->tm_mday + iVar2;
            param_1->tm_yday = param_1->tm_yday + iVar2;
            param_1->tm_wday = (param_1->tm_wday + iVar2) % 7;
          }
        }
        return 0;
      }
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar1 = (code *)swi(3);
      iVar2 = (*pcVar1)();
      return iVar2;
    }
    puVar4 = __doserrno();
    *puVar4 = 0x16;
  }
  return 0x16;
}



int FUN_140012124(tm *param_1,__int64 *param_2)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  ulong *puVar4;
  undefined8 uVar5;
  longlong lVar6;
  longlong lVar7;
  int local_res8 [4];
  int local_res18 [2];
  int local_res20 [2];
  longlong local_28 [2];
  
  if ((param_1 == (tm *)0x0) ||
     (FUN_14000ce30((undefined (*) [16])param_1,0xff,0x24), param_2 == (__int64 *)0x0)) {
    puVar4 = __doserrno();
    *puVar4 = 0x16;
    FUN_140011e58();
  }
  else {
    if ((-1 < *param_2) && (*param_2 < 0x793582b00)) {
      __tzset();
      local_res18[0] = 0;
      local_res20[0] = 0;
      local_res8[0] = 0;
      uVar5 = FUN_14001d298(local_res18);
      if ((int)uVar5 != 0) {
        _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
        pcVar1 = (code *)swi(3);
        iVar2 = (*pcVar1)();
        return iVar2;
      }
      uVar5 = FUN_14001d2c8(local_res20);
      if ((int)uVar5 == 0) {
        uVar5 = FUN_14001d2f8(local_res8);
        if ((int)uVar5 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar1 = (code *)swi(3);
          iVar2 = (*pcVar1)();
          return iVar2;
        }
        if (*param_2 - 0x3f481U < 0x7935041fe) {
          local_28[0] = *param_2 - (longlong)local_res8[0];
          iVar2 = common_gmtime_s___int64_(param_1,local_28);
          if (iVar2 != 0) {
            return iVar2;
          }
          if ((local_res18[0] != 0) && (iVar2 = _isindst(param_1), iVar2 != 0)) {
            local_28[0] = local_28[0] - local_res20[0];
            iVar2 = common_gmtime_s___int64_(param_1,local_28);
            if (iVar2 != 0) {
              return iVar2;
            }
            param_1->tm_isdst = 1;
          }
        }
        else {
          iVar2 = common_gmtime_s___int64_(param_1,param_2);
          if (iVar2 != 0) {
            return iVar2;
          }
          iVar2 = param_1->tm_sec;
          if ((local_res18[0] != 0) && (iVar3 = _isindst(param_1), iVar3 != 0)) {
            local_res8[0] = local_res8[0] + local_res20[0];
            param_1->tm_isdst = 1;
          }
          lVar7 = (longlong)iVar2 - (longlong)local_res8[0];
          lVar6 = SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0) + lVar7;
          iVar2 = (int)lVar7 + ((int)(lVar6 >> 5) - (int)(lVar6 >> 0x3f)) * -0x3c;
          param_1->tm_sec = iVar2;
          if (iVar2 < 0) {
            lVar7 = lVar7 + -0x3c;
            param_1->tm_sec = iVar2 + 0x3c;
          }
          lVar7 = lVar7 + SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0);
          lVar7 = ((lVar7 >> 5) - (lVar7 >> 0x3f)) + (longlong)param_1->tm_min;
          lVar6 = SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0) + lVar7;
          iVar2 = (int)lVar7 + ((int)(lVar6 >> 5) - (int)(lVar6 >> 0x3f)) * -0x3c;
          param_1->tm_min = iVar2;
          if (iVar2 < 0) {
            lVar7 = lVar7 + -0x3c;
            param_1->tm_min = iVar2 + 0x3c;
          }
          lVar7 = lVar7 + SUB168(SEXT816(-0x7777777777777777) * SEXT816(lVar7) >> 0x40,0);
          lVar7 = ((lVar7 >> 5) - (lVar7 >> 0x3f)) + (longlong)param_1->tm_hour;
          iVar2 = (int)lVar7 + (int)(lVar7 / 0x18) * -0x18;
          param_1->tm_hour = iVar2;
          if (iVar2 < 0) {
            lVar7 = lVar7 + -0x18;
            param_1->tm_hour = iVar2 + 0x18;
          }
          lVar7 = lVar7 / 6 + (lVar7 >> 0x3f);
          lVar7 = (lVar7 >> 2) - (lVar7 >> 0x3f);
          iVar2 = (int)lVar7;
          if (lVar7 < 1) {
            if (lVar7 < 0) {
              param_1->tm_mday = param_1->tm_mday + iVar2;
              param_1->tm_wday = (param_1->tm_wday + 7 + iVar2) % 7;
              iVar3 = param_1->tm_yday;
              if (param_1->tm_mday < 1) {
                param_1->tm_mon = 0xb;
                param_1->tm_mday = param_1->tm_mday + 0x1f;
                iVar3 = iVar3 + 0x16d;
                param_1->tm_year = param_1->tm_year + -1;
              }
              param_1->tm_yday = iVar3 + iVar2;
            }
          }
          else {
            param_1->tm_mday = param_1->tm_mday + iVar2;
            param_1->tm_yday = param_1->tm_yday + iVar2;
            param_1->tm_wday = (param_1->tm_wday + iVar2) % 7;
          }
        }
        return 0;
      }
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar1 = (code *)swi(3);
      iVar2 = (*pcVar1)();
      return iVar2;
    }
    puVar4 = __doserrno();
    *puVar4 = 0x16;
  }
  return 0x16;
}



// WARNING: Removing unreachable block (ram,0x000140012784)

void FUN_140012448(int *param_1)

{
  longlong lVar1;
  code *pcVar2;
  int iVar3;
  bool bVar4;
  ulong *puVar5;
  longlong lVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  longlong lVar9;
  longlong lVar10;
  int iVar11;
  longlong lVar12;
  undefined auStackY_88 [32];
  ulonglong local_58;
  int local_50;
  int local_4c;
  tm local_48;
  ulonglong local_20;
  
  local_20 = DAT_140038010 ^ (ulonglong)auStackY_88;
  if (param_1 == (int *)0x0) {
    puVar5 = __doserrno();
    *puVar5 = 0x16;
    FUN_140011e58();
    goto LAB_1400125ca;
  }
  local_58 = (ulonglong)param_1[5];
  if ((0x44 < (longlong)local_58) && (local_58 < 0x44f)) {
    iVar11 = param_1[4];
    if ((iVar11 < 0) || (0xb < iVar11)) {
      iVar3 = iVar11 / 0xc;
      iVar11 = iVar11 % 0xc;
      param_1[4] = iVar11;
      local_58 = (longlong)iVar3 + local_58;
      if (iVar11 < 0) {
        iVar11 = iVar11 + 0xc;
        local_58 = local_58 - 1;
        param_1[4] = iVar11;
      }
      if (((longlong)local_58 < 0x45) || (0x44e < local_58)) goto LAB_1400125bb;
    }
    uVar8 = local_58;
    lVar12 = (longlong)*(int *)(&DAT_14002a598 + (longlong)iVar11 * 4);
    bVar4 = __crt_time_is_leap_year___int64_(local_58);
    if ((bVar4) && (1 < iVar11)) {
      lVar12 = lVar12 + 1;
    }
    lVar6 = uVar8 - 1;
    lVar1 = uVar8 + 299 +
            SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816((longlong)(uVar8 + 299)) >> 0x40,0);
    lVar9 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar6) >> 0x40,0) + lVar6;
    lVar10 = (longlong)param_1[3];
    lVar12 = uVar8 * 0x16d + -0x63df +
             ((longlong)(lVar6 + (ulonglong)((uint)(lVar6 >> 0x3f) & 3)) >> 2) + lVar12 +
             (((lVar1 >> 8) - (lVar1 >> 0x3f)) - ((lVar9 >> 6) - (lVar9 >> 0x3f)));
    local_58 = lVar12 + lVar10;
    if (lVar12 < 0) {
      if ((-1 < lVar10) || ((longlong)local_58 < 0)) goto LAB_1400125fa;
    }
    else if ((lVar10 < 0) || (-1 < (longlong)local_58)) {
LAB_1400125fa:
      lVar12 = local_58 * 0x18;
      uVar8 = local_58;
      if (local_58 != 0) {
        uVar8 = (ulonglong)(lVar12 / (longlong)local_58 != 0x18);
      }
      if ((int)uVar8 == 0) {
        lVar6 = (longlong)param_1[2];
        local_58 = lVar6 + lVar12;
        if (lVar12 < 0) {
          if ((-1 < lVar6) || ((longlong)local_58 < 0)) goto LAB_140012647;
        }
        else if ((lVar6 < 0) || (-1 < (longlong)local_58)) {
LAB_140012647:
          lVar12 = local_58 * 0x3c;
          uVar8 = local_58;
          if (local_58 != 0) {
            uVar8 = (ulonglong)(lVar12 / (longlong)local_58 != 0x3c);
          }
          if ((int)uVar8 == 0) {
            lVar6 = (longlong)param_1[1];
            local_58 = lVar6 + lVar12;
            if (lVar12 < 0) {
              if ((-1 < lVar6) || ((longlong)local_58 < 0)) goto LAB_140012698;
            }
            else if ((lVar6 < 0) || (-1 < (longlong)local_58)) {
LAB_140012698:
              lVar12 = local_58 * 0x3c;
              uVar8 = local_58;
              if (local_58 != 0) {
                uVar8 = (ulonglong)(lVar12 / (longlong)local_58 != 0x3c);
              }
              if ((int)uVar8 == 0) {
                lVar6 = (longlong)*param_1;
                local_58 = lVar6 + lVar12;
                if (lVar12 < 0) {
                  if ((-1 < lVar6) || ((longlong)local_58 < 0)) goto code_r0x0001400126f1;
                }
                else if ((lVar6 < 0) || (-1 < (longlong)local_58)) {
code_r0x0001400126f1:
                  __tzset();
                  local_4c = 0;
                  local_50 = 0;
                  uVar7 = FUN_14001d2c8(&local_4c);
                  if ((int)uVar7 != 0) {
                    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
                    pcVar2 = (code *)swi(3);
                    (*pcVar2)();
                    return;
                  }
                  uVar7 = FUN_14001d2f8(&local_50);
                  if ((int)uVar7 != 0) {
                    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
                    pcVar2 = (code *)swi(3);
                    (*pcVar2)();
                    return;
                  }
                  local_58 = local_58 + (longlong)local_50;
                  iVar11 = thunk_FUN_140012124(&local_48,(__int64 *)&local_58);
                  if (iVar11 == 0) {
                    if ((0 < param_1[8]) || ((param_1[8] < 0 && (0 < local_48.tm_isdst)))) {
                      local_58 = local_58 + (longlong)local_4c;
                      iVar11 = thunk_FUN_140012124(&local_48,(__int64 *)&local_58);
                      if (iVar11 != 0) goto LAB_1400125bb;
                    }
                    *param_1 = local_48.tm_sec;
                    param_1[1] = local_48.tm_min;
                    param_1[2] = local_48.tm_hour;
                    param_1[3] = local_48.tm_mday;
                    param_1[4] = local_48.tm_mon;
                    param_1[5] = local_48.tm_year;
                    param_1[6] = local_48.tm_wday;
                    param_1[7] = local_48.tm_yday;
                    param_1[8] = local_48.tm_isdst;
                    goto LAB_1400125ca;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_1400125bb:
  puVar5 = __doserrno();
  *puVar5 = 0x16;
LAB_1400125ca:
  __security_check_cookie(local_20 ^ (ulonglong)auStackY_88);
  return;
}



// Library Function - Single Match
//  bool __cdecl __crt_time_is_leap_year<__int64>(__int64)
// 
// Library: Visual Studio 2015 Release

bool __cdecl __crt_time_is_leap_year___int64_(__int64 param_1)

{
  uint uVar1;
  longlong lVar2;
  longlong lVar3;
  
  uVar1 = (uint)(param_1 >> 0x3f) & 3;
  if ((((int)param_1 + uVar1 & 3) == uVar1) &&
     (lVar2 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(param_1) >> 0x40,0) + param_1,
     param_1 != ((lVar2 >> 6) - (lVar2 >> 0x3f)) * 100)) {
    return true;
  }
  lVar2 = param_1 + 0x76c;
  lVar3 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar2) >> 0x40,0) + lVar2;
  return lVar2 == ((lVar3 >> 8) - (lVar3 >> 0x3f)) * 400;
}



int FUN_140012834(char *param_1)

{
  int iVar1;
  
  FID_conflict___acrt_lock(0xb);
  iVar1 = common_putenv_nolock_char_(param_1,(char *)0x0);
  FID_conflict___acrt_lock(0xb);
  return iVar1;
}



// Library Function - Single Match
//  int __cdecl common_putenv_nolock<char>(char const * __ptr64 const,char const * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl common_putenv_nolock_char_(char *param_1,char *param_2)

{
  bool bVar1;
  int iVar2;
  ulong *puVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  
  pcVar5 = (char *)0x0;
  iVar6 = 0;
  if ((DAT_140039070 == 0) && (DAT_140039078 == 0)) {
    return -1;
  }
  if (param_1 == (char *)0x0) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    return -1;
  }
  pcVar4 = create_environment_string_char_(param_1,param_2);
  if (pcVar4 != (char *)0x0) {
    iVar2 = common_set_variable_in_environment_nolock_char_(pcVar4,1);
    pcVar4 = pcVar5;
    if ((iVar2 == 0) &&
       ((DAT_140039078 == 0 ||
        (bVar1 = set_variable_in_other_environment_char_(param_1,param_2), pcVar4 = (char *)0x0,
        bVar1)))) goto LAB_140012902;
  }
  iVar6 = -1;
  pcVar5 = pcVar4;
LAB_140012902:
  _free_base(pcVar5);
  return iVar6;
}



// Library Function - Single Match
//  char * __ptr64 __cdecl create_environment_string<char>(char const * __ptr64 const,char const *
// __ptr64 const)
// 
// Library: Visual Studio 2017 Release

char * __cdecl create_environment_string_char_(char *param_1,char *param_2)

{
  longlong lVar1;
  size_t sVar2;
  size_t sVar3;
  ulong *puVar4;
  char *pcVar5;
  char *pcVar6;
  longlong lVar7;
  char *pcVar8;
  
  pcVar8 = (char *)0x0;
  if (param_2 == (char *)0x0) {
    pcVar6 = strchr(param_1,0x3d);
    if ((pcVar6 != (char *)0x0) &&
       ((0x7ffe < (longlong)pcVar6 - (longlong)param_1 ||
        (sVar2 = strnlen(pcVar6 + 1,0x7fff), 0x7ffe < sVar2)))) goto LAB_140012973;
    lVar1 = -1;
    do {
      lVar7 = lVar1;
      lVar1 = lVar7 + 1;
    } while (param_1[lVar7 + 1] != '\0');
    pcVar6 = (char *)_calloc_base(lVar7 + 2,1);
    if (pcVar6 == (char *)0x0) goto LAB_140012a3b;
    lVar7 = lVar7 + 2;
    pcVar8 = pcVar6;
    param_2 = param_1;
  }
  else {
    sVar2 = strnlen(param_1,0x7fff);
    sVar3 = strnlen(param_2,0x7fff);
    if ((0x7ffe < sVar2) || (0x7ffe < sVar3)) {
LAB_140012973:
      puVar4 = __doserrno();
      *puVar4 = 0x16;
      FUN_140011e58();
      return (char *)0x0;
    }
    pcVar5 = (char *)_calloc_base(sVar3 + sVar2 + 2,1);
    if (pcVar5 == (char *)0x0) goto LAB_140012a3b;
    FUN_140016cd4(pcVar5,sVar3 + sVar2 + 2,(longlong)param_1);
    pcVar5[sVar2] = '=';
    pcVar6 = pcVar5 + sVar2 + 1;
    lVar7 = sVar3 + 1;
    pcVar8 = pcVar5;
  }
  FUN_140016cd4(pcVar6,lVar7,(longlong)param_2);
LAB_140012a3b:
  _free_base((LPVOID)0x0);
  return pcVar8;
}



// Library Function - Single Match
//  bool __cdecl set_variable_in_other_environment<char>(char const * __ptr64 const,char const *
// __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

bool __cdecl set_variable_in_other_environment_char_(char *param_1,char *param_2)

{
  int iVar1;
  ulong *puVar2;
  LPWSTR pWVar3;
  LPWSTR pWVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  
  uVar6 = 0;
  iVar1 = __acrt_MultiByteToWideChar(0,0,param_1,-1,(LPWSTR)0x0,0);
  uVar5 = (ulonglong)iVar1;
  if (iVar1 == 0) {
LAB_140012aa3:
    puVar2 = __doserrno();
    *puVar2 = 0x2a;
    uVar5 = uVar6;
  }
  else if (param_2 != (char *)0x0) {
    iVar1 = __acrt_MultiByteToWideChar(0,0,param_2,-1,(LPWSTR)0x0,0);
    if (iVar1 == 0) goto LAB_140012aa3;
    uVar5 = uVar5 + (longlong)iVar1;
  }
  pWVar3 = (LPWSTR)_calloc_base(uVar5,2);
  pWVar4 = pWVar3;
  if (pWVar3 == (LPWSTR)0x0) goto LAB_140012b61;
  iVar1 = __acrt_MultiByteToWideChar(0,0,param_1,-1,pWVar3,(int)uVar5);
  if (iVar1 == 0) {
LAB_140012b10:
    puVar2 = __doserrno();
    *puVar2 = 0x2a;
  }
  else {
    if (param_2 != (char *)0x0) {
      (pWVar3 + iVar1)[-1] = L'=';
      iVar1 = __acrt_MultiByteToWideChar(0,0,param_2,-1,pWVar3 + iVar1,(int)uVar5 - iVar1);
      if (iVar1 == 0) goto LAB_140012b10;
    }
    pWVar4 = (LPWSTR)0x0;
    iVar1 = common_set_variable_in_environment_nolock_wchar_t_((wchar_t *)pWVar3,0);
    uVar6 = (ulonglong)(iVar1 == 0);
  }
LAB_140012b61:
  _free_base(pWVar4);
  return SUB81(uVar6,0);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined4 FUN_140012b88(int param_1,int *param_2)

{
  undefined4 uVar1;
  int *piVar2;
  code *pcVar3;
  int **ppiVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  undefined4 uVar8;
  
  ppiVar4 = (int **)FUN_140017c70();
  if (ppiVar4 == (int **)0x0) {
    return 0;
  }
  piVar2 = *ppiVar4;
  for (piVar5 = piVar2;
      (piVar6 = (int *)0x0, piVar5 != piVar2 + 0x30 && (piVar6 = piVar5, *piVar5 != param_1));
      piVar5 = piVar5 + 4) {
  }
  if (piVar6 == (int *)0x0) {
    return 0;
  }
  pcVar3 = *(code **)(piVar6 + 2);
  if (pcVar3 == (code *)0x0) {
    return 0;
  }
  if (pcVar3 == (code *)0x5) {
    *(undefined8 *)(piVar6 + 2) = 0;
    return 1;
  }
  if (pcVar3 == (code *)0x1) {
    return 0xffffffff;
  }
  piVar5 = ppiVar4[1];
  ppiVar4[1] = param_2;
  if (piVar6[1] != 8) {
    *(undefined8 *)(piVar6 + 2) = 0;
    (*pcVar3)(piVar6[1]);
    goto LAB_140012ce1;
  }
  for (piVar7 = piVar2 + 0xc; piVar7 != piVar2 + 0x30; piVar7 = piVar7 + 4) {
    *(undefined8 *)(piVar7 + 2) = 0;
  }
  uVar1 = *(undefined4 *)(ppiVar4 + 2);
  if (*piVar6 == -0x3fffff73) {
    uVar8 = 0x82;
LAB_140012cbb:
    *(undefined4 *)(ppiVar4 + 2) = uVar8;
  }
  else {
    if (*piVar6 == -0x3fffff72) {
      uVar8 = 0x83;
      goto LAB_140012cbb;
    }
    if (*piVar6 == -0x3fffff71) {
      uVar8 = 0x86;
      goto LAB_140012cbb;
    }
    if (*piVar6 == -0x3fffff70) {
      uVar8 = 0x81;
      goto LAB_140012cbb;
    }
    if (*piVar6 == -0x3fffff6f) {
      uVar8 = 0x84;
      goto LAB_140012cbb;
    }
    if (*piVar6 == -0x3fffff6e) {
      uVar8 = 0x8a;
      goto LAB_140012cbb;
    }
    if (*piVar6 == -0x3fffff6d) {
      uVar8 = 0x85;
      goto LAB_140012cbb;
    }
    if (*piVar6 == -0x3ffffd4c) {
      uVar8 = 0x8e;
      goto LAB_140012cbb;
    }
    uVar8 = uVar1;
    if (*piVar6 == -0x3ffffd4b) {
      uVar8 = 0x8d;
      goto LAB_140012cbb;
    }
  }
  (*pcVar3)(8,uVar8);
  *(undefined4 *)(ppiVar4 + 2) = uVar1;
LAB_140012ce1:
  ppiVar4[1] = piVar5;
  return 0xffffffff;
}



undefined4 FUN_140012d00(void)

{
  return DAT_140039098;
}



void FUN_140012d08(undefined4 param_1)

{
  DAT_140039098 = param_1;
  return;
}



// Library Function - Single Match
//  _set_fmode
// 
// Library: Visual Studio 2012 Release

errno_t __cdecl _set_fmode(int _Mode)

{
  errno_t eVar1;
  ulong *puVar2;
  
  if (((_Mode - 0x4000U & 0xffff3fff) == 0) && (_Mode != 0xc000)) {
    eVar1 = 0;
    DAT_14003a0cc = _Mode;
  }
  else {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    eVar1 = 0x16;
  }
  return eVar1;
}



// Library Function - Single Match
//  _get_fmode
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

errno_t __cdecl _get_fmode(int *_PMode)

{
  errno_t eVar1;
  ulong *puVar2;
  
  if (_PMode == (int *)0x0) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    eVar1 = 0x16;
  }
  else {
    *_PMode = DAT_14003a0cc;
    eVar1 = 0;
  }
  return eVar1;
}



// Library Function - Single Match
//  _setmode_nolock
// 
// Library: Visual Studio 2015 Release

int __cdecl _setmode_nolock(int _FileHandle,int _Mode)

{
  char cVar1;
  byte bVar2;
  longlong lVar3;
  int iVar4;
  longlong lVar5;
  longlong lVar6;
  
  lVar6 = (longlong)_FileHandle >> 6;
  lVar5 = (ulonglong)(_FileHandle & 0x3f) * 0x40;
  lVar3 = (&DAT_140039600)[lVar6];
  bVar2 = *(byte *)(lVar5 + 0x38 + lVar3);
  cVar1 = *(char *)(lVar5 + 0x39 + lVar3);
  if (_Mode == 0x4000) {
    *(byte *)(lVar5 + 0x38 + lVar3) = bVar2 | 0x80;
    *(undefined *)(lVar5 + 0x39 + (&DAT_140039600)[lVar6]) = 0;
  }
  else if (_Mode == 0x8000) {
    *(byte *)(lVar5 + 0x38 + lVar3) = bVar2 & 0x7f;
  }
  else if ((_Mode - 0x10000U & 0xfffeffff) == 0) {
    *(byte *)(lVar5 + 0x38 + lVar3) = bVar2 | 0x80;
    *(undefined *)(lVar5 + 0x39 + (&DAT_140039600)[lVar6]) = 2;
  }
  else if (_Mode == 0x40000) {
    *(byte *)(lVar5 + 0x38 + lVar3) = bVar2 | 0x80;
    *(undefined *)(lVar5 + 0x39 + (&DAT_140039600)[lVar6]) = 1;
  }
  if ((bVar2 & 0x80) == 0) {
    iVar4 = 0x8000;
  }
  else if (cVar1 == '\0') {
    iVar4 = 0x4000;
  }
  else {
    iVar4 = 0x10000;
    if (cVar1 == '\x01') {
      iVar4 = 0x40000;
    }
  }
  return iVar4;
}



undefined4 FUN_140012e60(void)

{
  return DAT_14003909c;
}



uint FUN_140012e68(uint param_1)

{
  uint uVar1;
  uint uVar2;
  ulong *puVar3;
  
  uVar2 = DAT_14003909c;
  uVar1 = param_1;
  if (1 < param_1) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    uVar2 = 0xffffffff;
    uVar1 = DAT_14003909c;
  }
  DAT_14003909c = uVar1;
  return uVar2;
}



// Library Function - Single Match
//  _time64
// 
// Library: Visual Studio 2015 Release

__time64_t __cdecl _time64(__time64_t *_Time)

{
  int iVar1;
  __time64_t local_18 [2];
  
  local_18[0] = 0;
  iVar1 = common_timespec_get_struct__timespec64_((_timespec64 *)local_18,1);
  if (iVar1 != 1) {
    local_18[0] = -1;
  }
  if (_Time != (__time64_t *)0x0) {
    *_Time = local_18[0];
  }
  return local_18[0];
}



// Library Function - Single Match
//  int __cdecl common_timespec_get<struct _timespec64>(struct _timespec64 * __ptr64 const,int)
// 
// Library: Visual Studio 2015 Release

int __cdecl common_timespec_get_struct__timespec64_(_timespec64 *param_1,int param_2)

{
  ulong *puVar1;
  longlong lVar2;
  longlong lVar3;
  _FILETIME local_res8 [4];
  
  if (param_1 == (_timespec64 *)0x0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
  }
  else if (param_2 == 1) {
    local_res8[0] = (_FILETIME)0x0;
    __acrt_GetSystemTimePreciseAsFileTime(local_res8);
    lVar3 = (longlong)local_res8[0] + -0x19db1ded53e8000;
    lVar2 = SUB168(SEXT816(-0x29406b2a1a85bd43) * SEXT816(lVar3) >> 0x40,0) + lVar3;
    lVar2 = (lVar2 >> 0x17) - (lVar2 >> 0x3f);
    if (lVar2 < 0x793582b00) {
      *(longlong *)param_1 = lVar2;
      *(int *)(param_1 + 8) = ((int)lVar3 + (int)lVar2 * -10000000) * 100;
      return 1;
    }
  }
  return 0;
}



int FUN_140012f6c(wint_t *param_1,wint_t *param_2)

{
  int iVar1;
  ulong *puVar2;
  ushort uVar3;
  longlong lVar4;
  ushort uVar5;
  wint_t wVar6;
  longlong local_28;
  localeinfo_struct local_20;
  char local_10;
  
  if (DAT_140038e20 == 0) {
    if ((param_1 != (wint_t *)0x0) && (param_2 != (wint_t *)0x0)) {
      lVar4 = (longlong)param_1 - (longlong)param_2;
      do {
        uVar5 = *(short *)(lVar4 + (longlong)param_2) + 0x20;
        if (0x19 < (ushort)(*(short *)(lVar4 + (longlong)param_2) - 0x41U)) {
          uVar5 = *(ushort *)(lVar4 + (longlong)param_2);
        }
        wVar6 = *param_2 + 0x20;
        if (0x19 < (ushort)(*param_2 - 0x41)) {
          wVar6 = *param_2;
        }
        param_2 = param_2 + 1;
      } while ((uVar5 != 0) && (uVar5 == wVar6));
      return (uint)uVar5 - (uint)wVar6;
    }
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    return 0x7fffffff;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)0x0);
  if ((param_1 == (wint_t *)0x0) || (param_2 == (wint_t *)0x0)) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    iVar1 = 0x7fffffff;
  }
  else {
    if ((local_20.locinfo)->locale_name[2] == (wchar_t *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_2;
      do {
        uVar5 = *(short *)(lVar4 + (longlong)param_2) + 0x20;
        if (0x19 < (ushort)(*(short *)(lVar4 + (longlong)param_2) - 0x41U)) {
          uVar5 = *(ushort *)(lVar4 + (longlong)param_2);
        }
        uVar3 = *param_2 + 0x20;
        if (0x19 < (ushort)(*param_2 - 0x41)) {
          uVar3 = *param_2;
        }
        param_2 = param_2 + 1;
      } while ((uVar5 != 0) && (uVar5 == uVar3));
    }
    else {
      do {
        uVar5 = _towlower_l(*param_1,&local_20);
        param_1 = param_1 + 1;
        uVar3 = _towlower_l(*param_2,&local_20);
        param_2 = param_2 + 1;
        if (uVar5 == 0) break;
      } while (uVar5 == uVar3);
    }
    iVar1 = (uint)uVar5 - (uint)uVar3;
  }
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return iVar1;
}



// Library Function - Single Match
//  _wcslwr_s_l
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

errno_t __cdecl _wcslwr_s_l(wchar_t *_Str,size_t _SizeInWords,_locale_t _Locale)

{
  int iVar1;
  longlong local_28;
  __crt_locale_pointers local_20 [16];
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)_Locale);
  iVar1 = _wcslwr_s_l_stat((wchar_t *)_Str,_SizeInWords,local_20);
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return iVar1;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe
// Library Function - Single Match
//  int __cdecl _wcslwr_s_l_stat(wchar_t * __ptr64,unsigned __int64,struct __crt_locale_pointers *
// __ptr64)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl _wcslwr_s_l_stat(wchar_t *param_1,__uint64 param_2,__crt_locale_pointers *param_3)

{
  short sVar1;
  longlong lVar2;
  wchar_t *pwVar3;
  int iVar4;
  int extraout_EAX;
  ulong *puVar5;
  size_t sVar6;
  ulonglong uVar7;
  undefined4 *puVar8;
  ulonglong uVar9;
  ulong uVar10;
  undefined *puVar11;
  undefined *puVar12;
  undefined8 uStackY_60;
  undefined auStackY_58 [32];
  ulonglong local_28 [2];
  
  puVar11 = auStackY_58;
  puVar12 = auStackY_58;
  local_28[0] = DAT_140038010 ^ (ulonglong)local_28;
  puVar8 = (undefined4 *)0x0;
  if (param_1 == (wchar_t *)0x0) {
LAB_14001318e:
    uStackY_60 = 0x140013193;
    puVar5 = __doserrno();
    uVar10 = 0x16;
  }
  else {
    uStackY_60 = 0x1400131ab;
    sVar6 = wcsnlen((wchar_t *)param_1,param_2);
    if (param_2 <= sVar6) {
      *(undefined2 *)param_1 = 0;
      goto LAB_14001318e;
    }
    if (*(wchar_t **)(*(longlong *)param_3 + 0x138) == (wchar_t *)0x0) {
      for (; sVar1 = *(short *)param_1, puVar12 = auStackY_58, sVar1 != 0;
          param_1 = (wchar_t *)((longlong)param_1 + 2)) {
        if ((ushort)(sVar1 - 0x41U) < 0x1a) {
          *(short *)param_1 = sVar1 + 0x20;
        }
      }
      goto LAB_140013320;
    }
    uStackY_60 = 0x1400131e0;
    iVar4 = __acrt_LCMapStringW(*(wchar_t **)(*(longlong *)param_3 + 0x138),0x100,(wchar_t *)param_1
                                ,-1,(LPWSTR)0x0,0);
    if (iVar4 == 0) {
      uStackY_60 = 0x1400131ec;
      puVar5 = __doserrno();
      *puVar5 = 0x2a;
      uStackY_60 = 0x1400131f8;
      __doserrno();
      puVar12 = auStackY_58;
      goto LAB_140013320;
    }
    if ((ulonglong)(longlong)iVar4 <= param_2) {
      uVar7 = (longlong)iVar4 * 2;
      uVar9 = uVar7 + 0x10;
      uVar9 = -(ulonglong)(uVar7 < uVar9) & uVar9;
      if (uVar9 == 0) {
LAB_1400132a8:
        if (puVar8 == (undefined4 *)0x0) goto LAB_1400132ad;
        lVar2 = *(longlong *)param_3;
        *(int *)(puVar12 + 0x28) = iVar4;
        *(undefined4 **)(puVar12 + 0x20) = puVar8;
        pwVar3 = *(wchar_t **)(lVar2 + 0x138);
        *(undefined8 *)(puVar12 + -8) = 0x1400132e6;
        iVar4 = __acrt_LCMapStringW(pwVar3,0x100,(wchar_t *)param_1,-1,*(LPWSTR *)(puVar12 + 0x20),
                                    *(int *)(puVar12 + 0x28));
        if (iVar4 == 0) {
          *(undefined8 *)(puVar12 + -8) = 0x140013301;
          puVar5 = __doserrno();
          *puVar5 = 0x2a;
        }
        else {
          *(undefined8 *)(puVar12 + -8) = 0x1400132f8;
          FUN_14001ba5c((short *)param_1,param_2,(longlong)puVar8);
        }
      }
      else {
        if (0x400 < uVar9) {
          uStackY_60 = 0x140013291;
          puVar8 = (undefined4 *)_malloc_base(uVar9);
          puVar12 = auStackY_58;
          if (puVar8 != (undefined4 *)0x0) {
            *puVar8 = 0xdddd;
            goto LAB_14001329f;
          }
          goto LAB_1400132a8;
        }
        uVar7 = uVar9 + 0xf;
        if (uVar7 <= uVar9) {
          uVar7 = 0xffffffffffffff0;
        }
        uStackY_60 = 0x140013274;
        lVar2 = -(uVar7 & 0xfffffffffffffff0);
        puVar12 = auStackY_58 + lVar2 + -8;
        puVar11 = auStackY_58 + lVar2 + -8;
        puVar8 = (undefined4 *)(&stack0xffffffffffffffd0 + lVar2);
        if (puVar8 != (undefined4 *)0x0) {
          *puVar8 = 0xcccc;
LAB_14001329f:
          puVar8 = puVar8 + 4;
          puVar12 = puVar11;
          goto LAB_1400132a8;
        }
LAB_1400132ad:
        *(undefined8 *)(puVar12 + -8) = 0x1400132b2;
        puVar5 = __doserrno();
        *puVar5 = 0xc;
        *(undefined8 *)(puVar12 + -8) = 0x1400132bd;
        __doserrno();
      }
      if ((puVar8 != (undefined4 *)0x0) && (puVar8[-4] == 0xdddd)) {
        *(undefined8 *)(puVar12 + -8) = 0x14001331e;
        _free_base(puVar8 + -4);
      }
      goto LAB_140013320;
    }
    *(undefined2 *)param_1 = 0;
    uStackY_60 = 0x140013233;
    puVar5 = __doserrno();
    uVar10 = 0x22;
  }
  *puVar5 = uVar10;
  uStackY_60 = 0x14001319f;
  FUN_140011e58();
  puVar12 = auStackY_58;
LAB_140013320:
  uVar9 = local_28[0] ^ (ulonglong)local_28;
  *(undefined8 *)(puVar12 + -8) = 0x14001332c;
  __security_check_cookie(uVar9);
  return extraout_EAX;
}



int FUN_140013348(wint_t *param_1,wint_t *param_2,longlong param_3)

{
  ulong *puVar1;
  ushort uVar2;
  longlong lVar3;
  ushort uVar4;
  int iVar5;
  wint_t wVar6;
  longlong local_28;
  localeinfo_struct local_20;
  char local_10;
  
  iVar5 = 0;
  if (DAT_140038e20 == 0) {
    if (param_3 != 0) {
      if ((param_1 == (wint_t *)0x0) || (param_2 == (wint_t *)0x0)) {
        puVar1 = __doserrno();
        *puVar1 = 0x16;
        FUN_140011e58();
        return 0x7fffffff;
      }
      lVar3 = (longlong)param_1 - (longlong)param_2;
      do {
        uVar4 = *(short *)(lVar3 + (longlong)param_2) + 0x20;
        if (0x19 < (ushort)(*(short *)(lVar3 + (longlong)param_2) - 0x41U)) {
          uVar4 = *(ushort *)(lVar3 + (longlong)param_2);
        }
        wVar6 = *param_2 + 0x20;
        if (0x19 < (ushort)(*param_2 - 0x41)) {
          wVar6 = *param_2;
        }
        param_2 = param_2 + 1;
        param_3 = param_3 + -1;
      } while (((param_3 != 0) && (uVar4 != 0)) && (uVar4 == wVar6));
      iVar5 = (uint)uVar4 - (uint)wVar6;
    }
    return iVar5;
  }
  iVar5 = 0;
  if (param_3 != 0) {
    if ((param_1 == (wint_t *)0x0) || (param_2 == (wint_t *)0x0)) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      FUN_140011e58();
      iVar5 = 0x7fffffff;
    }
    else {
      _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)0x0);
      if ((local_20.locinfo)->locale_name[2] == (wchar_t *)0x0) {
        lVar3 = (longlong)param_1 - (longlong)param_2;
        do {
          uVar4 = *(short *)(lVar3 + (longlong)param_2) + 0x20;
          if (0x19 < (ushort)(*(short *)(lVar3 + (longlong)param_2) - 0x41U)) {
            uVar4 = *(ushort *)(lVar3 + (longlong)param_2);
          }
          uVar2 = *param_2 + 0x20;
          if (0x19 < (ushort)(*param_2 - 0x41)) {
            uVar2 = *param_2;
          }
          param_2 = param_2 + 1;
          param_3 = param_3 + -1;
        } while (((param_3 != 0) && (uVar4 != 0)) && (uVar4 == uVar2));
      }
      else {
        do {
          uVar4 = _towlower_l(*param_1,&local_20);
          uVar2 = _towlower_l(*param_2,&local_20);
          param_1 = param_1 + 1;
          param_2 = param_2 + 1;
          param_3 = param_3 + -1;
          if ((param_3 == 0) || (uVar4 == 0)) break;
        } while (uVar4 == uVar2);
      }
      iVar5 = (uint)uVar4 - (uint)uVar2;
      if (local_10 != '\0') {
        *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
      }
    }
  }
  return iVar5;
}



FILE * FUN_14001351c(wchar_t *param_1,wchar_t *param_2)

{
  ulong *puVar1;
  FILE *pFVar2;
  FILE *local_res8;
  
  if (((param_1 == (wchar_t *)0x0) || (param_2 == (wchar_t *)0x0)) || (*param_2 == L'\0')) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
  }
  else if (*param_1 == L'\0') {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
  }
  else {
    __acrt_stdio_allocate_stream();
    if (local_res8 != (FILE *)0x0) {
      pFVar2 = FID_conflict__wopenfile(param_1,param_2,0x40,local_res8);
      if (pFVar2 == (FILE *)0x0) {
        __acrt_stdio_free_stream(SUB81(local_res8,0));
      }
      FUN_14000d468((longlong)local_res8);
      return pFVar2;
    }
    puVar1 = __doserrno();
    *puVar1 = 0x18;
  }
  return (FILE *)0x0;
}



// Library Function - Multiple Matches With Different Base Names
//  _wremove
//  _wrmdir
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl FID_conflict__wrmdir(wchar_t *_Filename)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  
  BVar1 = DeleteFileW(_Filename);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    __acrt_errno_map_os_error(DVar2);
    iVar3 = -1;
  }
  else {
    iVar3 = 0;
  }
  return iVar3;
}



int FUN_140013618(FILE *param_1)

{
  int iVar1;
  ulong *puVar2;
  
  if (param_1 == (FILE *)0x0) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
  }
  else {
    if ((*(uint *)((longlong)&param_1->_base + 4) >> 0xc & 1) == 0) {
      FUN_14000d45c((longlong)param_1);
      iVar1 = _fclose_nolock(param_1);
      FUN_14000d468((longlong)param_1);
      return iVar1;
    }
    __acrt_stdio_free_stream(SUB81(param_1,0));
  }
  return -1;
}



// Library Function - Single Match
//  _fclose_nolock
// 
// Library: Visual Studio 2017 Release

int __cdecl _fclose_nolock(FILE *_File)

{
  int iVar1;
  int iVar2;
  ulong *puVar3;
  undefined8 uVar4;
  
  if (_File == (FILE *)0x0) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    iVar1 = -1;
  }
  else {
    iVar1 = -1;
    if ((*(uint *)((longlong)&_File->_base + 4) >> 0xd & 1) != 0) {
      uVar4 = __acrt_stdio_flush_nolock(_File);
      iVar1 = (int)uVar4;
      __acrt_stdio_free_buffer_nolock(&_File->_ptr);
      iVar2 = _fileno(_File);
      iVar2 = _close(iVar2);
      if (iVar2 < 0) {
        iVar1 = -1;
      }
      else if (_File->_tmpfname != (char *)0x0) {
        _free_base(_File->_tmpfname);
        _File->_tmpfname = (char *)0x0;
      }
    }
    __acrt_stdio_free_stream(SUB81(_File,0));
  }
  return iVar1;
}



// Library Function - Single Match
//  fflush
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl fflush(FILE *_File)

{
  uint uVar1;
  int iVar2;
  __crt_seh_guarded_call_int_ local_res8 [8];
  FILE *local_res10;
  FILE *local_res18;
  FILE **local_res20;
  FILE *local_18 [3];
  
  local_res10 = _File;
  if (_File == (FILE *)0x0) {
    iVar2 = common_flush_all(false);
  }
  else {
    uVar1 = *(uint *)((longlong)&_File->_base + 4);
    if (((((byte)uVar1 & 3) == 2) && ((uVar1 & 0xc0) != 0)) || ((uVar1 >> 0xb & 1) != 0)) {
      local_res20 = &local_res10;
      local_res18 = _File;
      local_18[0] = _File;
      iVar2 = __crt_seh_guarded_call<int>::
              operator___class__lambda_c376a267cfb53b6959b3b692ec76b120__class__lambda_9a32fed5bf61b6b509b2d3f6003082a1_____ptr64_class__lambda_572fbb9fa0ab338edf41edfd4b5fcc8d___
                        (local_res8,(_lambda_c376a267cfb53b6959b3b692ec76b120_ *)local_18,
                         (_lambda_9a32fed5bf61b6b509b2d3f6003082a1_ *)&local_res20,
                         (_lambda_572fbb9fa0ab338edf41edfd4b5fcc8d_ *)&local_res18);
    }
    else {
      iVar2 = 0;
    }
  }
  return iVar2;
}



int __cdecl common_flush_all(bool param_1)

{
  int iVar1;
  
  iVar1 = common_flush_all(true);
  return iVar1;
}



// Library Function - Single Match
//  _fflush_nolock
// 
// Library: Visual Studio 2015 Release

int __cdecl _fflush_nolock(FILE *_File)

{
  int iVar1;
  undefined8 uVar2;
  
  if (_File == (FILE *)0x0) {
    iVar1 = common_flush_all(false);
    return iVar1;
  }
  uVar2 = __acrt_stdio_flush_nolock(_File);
  if ((int)uVar2 == 0) {
    if ((*(uint *)((longlong)&_File->_base + 4) >> 0xb & 1) != 0) {
      iVar1 = _fileno(_File);
      iVar1 = _commit(iVar1);
      if (iVar1 != 0) goto LAB_140013791;
    }
    iVar1 = 0;
  }
  else {
LAB_140013791:
    iVar1 = -1;
  }
  return iVar1;
}



// Library Function - Single Match
//  __acrt_stdio_flush_nolock
// 
// Library: Visual Studio 2017 Release

undefined8 __acrt_stdio_flush_nolock(FILE *param_1)

{
  uint *puVar1;
  short *psVar2;
  uint uVar3;
  uint uVar4;
  
  uVar4 = *(uint *)((longlong)&param_1->_base + 4);
  if ((((byte)uVar4 & 3) == 2) && ((uVar4 & 0xc0) != 0)) {
    uVar4 = *(int *)&param_1->_ptr - param_1->_cnt;
    *(undefined4 *)&param_1->_base = 0;
    psVar2 = *(short **)&param_1->_cnt;
    param_1->_ptr = (char *)psVar2;
    if (0 < (int)uVar4) {
      uVar3 = _fileno(param_1);
      uVar3 = FUN_14001f008(uVar3,psVar2,uVar4);
      if (uVar4 != uVar3) {
        LOCK();
        puVar1 = (uint *)((longlong)&param_1->_base + 4);
        *puVar1 = *puVar1 | 0x10;
        return 0xffffffff;
      }
      if ((*(uint *)((longlong)&param_1->_base + 4) >> 2 & 1) != 0) {
        LOCK();
        puVar1 = (uint *)((longlong)&param_1->_base + 4);
        *puVar1 = *puVar1 & 0xfffffffd;
      }
    }
  }
  return 0;
}



// Library Function - Single Match
//  int __cdecl common_flush_all(bool)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl common_flush_all(bool param_1)

{
  char local_res8 [8];
  __crt_seh_guarded_call_void_ local_res10 [8];
  int local_res18 [2];
  int local_res20 [2];
  undefined4 local_28;
  undefined4 local_24;
  int *local_20;
  char *local_18;
  int *local_10;
  
  local_res20[0] = 0;
  local_20 = local_res20;
  local_res18[0] = 0;
  local_18 = local_res8;
  local_10 = local_res18;
  local_28 = 8;
  local_24 = 8;
  local_res8[0] = param_1;
  __crt_seh_guarded_call<void>::
  operator___class__lambda_886d6c58226a84441f68b9f2b8217b83__class__lambda_ab61a845afdef5b7c387490eaf3616ee_____ptr64_class__lambda_f7f22ab5edc0698d5f6905b0d3f44752___
            (local_res10,(_lambda_886d6c58226a84441f68b9f2b8217b83_ *)&local_24,
             (_lambda_ab61a845afdef5b7c387490eaf3616ee_ *)&local_20,
             (_lambda_f7f22ab5edc0698d5f6905b0d3f44752_ *)&local_28);
  if (local_res8[0] != '\0') {
    local_res18[0] = local_res20[0];
  }
  return local_res18[0];
}



// Library Function - Single Match
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_842d9ff0dc9ef11c61343bbaebe7f885>,class <lambda_c5860995281e5c4ce005b3de8f5874ee> &
// __ptr64,class <lambda_d90129c13df834fdcbf8d2b88dafcf2d> >(class
// <lambda_842d9ff0dc9ef11c61343bbaebe7f885> && __ptr64,class
// <lambda_c5860995281e5c4ce005b3de8f5874ee> & __ptr64,class
// <lambda_d90129c13df834fdcbf8d2b88dafcf2d> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_seh_guarded_call<void>::
operator___class__lambda_842d9ff0dc9ef11c61343bbaebe7f885__class__lambda_c5860995281e5c4ce005b3de8f5874ee_____ptr64_class__lambda_d90129c13df834fdcbf8d2b88dafcf2d___
          (__crt_seh_guarded_call_void_ *this,_lambda_842d9ff0dc9ef11c61343bbaebe7f885_ *param_1,
          _lambda_c5860995281e5c4ce005b3de8f5874ee_ *param_2,
          _lambda_d90129c13df834fdcbf8d2b88dafcf2d_ *param_3)

{
  uint uVar1;
  int iVar2;
  
  FUN_14000d45c(*(longlong *)param_1);
  if ((**(longlong **)param_2 != 0) &&
     (uVar1 = *(uint *)(**(longlong **)param_2 + 0x14), (uVar1 >> 0xd & 1) != 0)) {
    if (((((byte)uVar1 & 3) == 2) && ((uVar1 & 0xc0) != 0)) || ((uVar1 >> 0xb & 1) != 0)) {
      if ((**(char **)(param_2 + 0x10) != '\0') ||
         ((*(uint *)(**(longlong **)param_2 + 0x14) >> 1 & 1) != 0)) {
        iVar2 = _fflush_nolock(**(FILE ***)param_2);
        if (iVar2 == -1) {
          **(undefined4 **)(param_2 + 0x18) = 0xffffffff;
        }
        else {
          **(int **)(param_2 + 8) = **(int **)(param_2 + 8) + 1;
        }
      }
    }
    else {
      **(int **)(param_2 + 8) = **(int **)(param_2 + 8) + 1;
    }
  }
  FUN_14000d468(*(longlong *)param_3);
  return;
}



// Library Function - Single Match
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_886d6c58226a84441f68b9f2b8217b83>,class <lambda_ab61a845afdef5b7c387490eaf3616ee> &
// __ptr64,class <lambda_f7f22ab5edc0698d5f6905b0d3f44752> >(class
// <lambda_886d6c58226a84441f68b9f2b8217b83> && __ptr64,class
// <lambda_ab61a845afdef5b7c387490eaf3616ee> & __ptr64,class
// <lambda_f7f22ab5edc0698d5f6905b0d3f44752> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_seh_guarded_call<void>::
operator___class__lambda_886d6c58226a84441f68b9f2b8217b83__class__lambda_ab61a845afdef5b7c387490eaf3616ee_____ptr64_class__lambda_f7f22ab5edc0698d5f6905b0d3f44752___
          (__crt_seh_guarded_call_void_ *this,_lambda_886d6c58226a84441f68b9f2b8217b83_ *param_1,
          _lambda_ab61a845afdef5b7c387490eaf3616ee_ *param_2,
          _lambda_f7f22ab5edc0698d5f6905b0d3f44752_ *param_3)

{
  longlong *plVar1;
  uint uVar2;
  longlong *plVar3;
  __crt_seh_guarded_call_void_ local_res10 [16];
  _lambda_f7f22ab5edc0698d5f6905b0d3f44752_ *local_res20;
  longlong local_58;
  longlong local_50;
  longlong local_48;
  longlong *local_40;
  longlong *local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  
  local_res20 = param_3;
  FID_conflict___acrt_lock(*(int *)param_1);
  plVar1 = DAT_140038dc0 + DAT_140038db8;
  for (plVar3 = DAT_140038dc0; local_40 = plVar3, plVar3 != plVar1; plVar3 = plVar3 + 1) {
    local_58 = *plVar3;
    if ((local_58 != 0) && (uVar2 = *(uint *)(local_58 + 0x14), (uVar2 >> 0xd & 1) != 0)) {
      if (((((byte)uVar2 & 3) == 2) && ((uVar2 & 0xc0) != 0)) || ((uVar2 >> 0xb & 1) != 0)) {
        local_20 = *(undefined8 *)(param_2 + 0x10);
        local_28 = *(undefined8 *)(param_2 + 8);
        local_30 = *(undefined8 *)param_2;
        local_38 = &local_58;
        local_50 = local_58;
        local_48 = local_58;
        operator___class__lambda_842d9ff0dc9ef11c61343bbaebe7f885__class__lambda_c5860995281e5c4ce005b3de8f5874ee_____ptr64_class__lambda_d90129c13df834fdcbf8d2b88dafcf2d___
                  (local_res10,(_lambda_842d9ff0dc9ef11c61343bbaebe7f885_ *)&local_48,
                   (_lambda_c5860995281e5c4ce005b3de8f5874ee_ *)&local_38,
                   (_lambda_d90129c13df834fdcbf8d2b88dafcf2d_ *)&local_50);
      }
      else {
        **(int **)param_2 = **(int **)param_2 + 1;
      }
    }
  }
  FID_conflict___acrt_lock(*(int *)param_3);
  return;
}



// Library Function - Single Match
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_c376a267cfb53b6959b3b692ec76b120>,class <lambda_9a32fed5bf61b6b509b2d3f6003082a1> &
// __ptr64,class <lambda_572fbb9fa0ab338edf41edfd4b5fcc8d> >(class
// <lambda_c376a267cfb53b6959b3b692ec76b120> && __ptr64,class
// <lambda_9a32fed5bf61b6b509b2d3f6003082a1> & __ptr64,class
// <lambda_572fbb9fa0ab338edf41edfd4b5fcc8d> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __thiscall
__crt_seh_guarded_call<int>::
operator___class__lambda_c376a267cfb53b6959b3b692ec76b120__class__lambda_9a32fed5bf61b6b509b2d3f6003082a1_____ptr64_class__lambda_572fbb9fa0ab338edf41edfd4b5fcc8d___
          (__crt_seh_guarded_call_int_ *this,_lambda_c376a267cfb53b6959b3b692ec76b120_ *param_1,
          _lambda_9a32fed5bf61b6b509b2d3f6003082a1_ *param_2,
          _lambda_572fbb9fa0ab338edf41edfd4b5fcc8d_ *param_3)

{
  int iVar1;
  
  FUN_14000d45c(*(longlong *)param_1);
  iVar1 = _fflush_nolock(**(FILE ***)param_2);
  FUN_14000d468(*(longlong *)param_3);
  return iVar1;
}



ulonglong FUN_140013a54(byte param_1,FILE *param_2)

{
  char **ppcVar1;
  uint uVar2;
  ulong *puVar3;
  ulonglong uVar4;
  undefined *puVar5;
  undefined auStack_38 [32];
  undefined *local_18;
  
  local_18 = auStack_38;
  if (param_2 == (FILE *)0x0) {
    local_18 = auStack_38;
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    return 0xffffffff;
  }
  FUN_14000d45c((longlong)param_2);
  if ((*(uint *)((longlong)&param_2->_base + 4) >> 0xc & 1) == 0) {
    uVar2 = _fileno(param_2);
    if (uVar2 + 2 < 2) {
      puVar5 = &DAT_140038170;
    }
    else {
      puVar5 = (undefined *)
               ((ulonglong)(uVar2 & 0x3f) * 0x40 + (&DAT_140039600)[(longlong)(int)uVar2 >> 6]);
    }
    if (puVar5[0x39] == '\0') {
      if (uVar2 + 2 < 2) {
        puVar5 = &DAT_140038170;
      }
      else {
        puVar5 = (undefined *)
                 ((ulonglong)(uVar2 & 0x3f) * 0x40 + (&DAT_140039600)[(longlong)(int)uVar2 >> 6]);
      }
      if ((puVar5[0x3d] & 1) == 0) goto LAB_140013b32;
    }
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    FUN_14001fb44(local_18,(PVOID)0x140013b2d);
    uVar4 = 0xffffffff;
  }
  else {
LAB_140013b32:
    ppcVar1 = &param_2->_base;
    *(int *)ppcVar1 = *(int *)ppcVar1 + -1;
    if (*(int *)ppcVar1 < 0) {
      uVar4 = __acrt_stdio_flush_and_write_narrow_nolock(param_1,param_2);
      uVar4 = uVar4 & 0xffffffff;
    }
    else {
      *param_2->_ptr = param_1;
      param_2->_ptr = param_2->_ptr + 1;
      uVar4 = (ulonglong)param_1;
    }
    FUN_14000d468((longlong)param_2);
  }
  return uVar4;
}



// Library Function - Single Match
//  _fputc_nolock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong _fputc_nolock(byte param_1,FILE *param_2)

{
  char **ppcVar1;
  uint *puVar2;
  bool bVar3;
  int iVar4;
  ulong *puVar5;
  FILE *pFVar6;
  
  ppcVar1 = &param_2->_base;
  *(int *)ppcVar1 = *(int *)ppcVar1 + -1;
  if (-1 < *(int *)ppcVar1) {
    *param_2->_ptr = param_1;
    param_2->_ptr = param_2->_ptr + 1;
    return (ulonglong)param_1;
  }
  iVar4 = _fileno(param_2);
  if ((*(uint *)((longlong)&param_2->_base + 4) & 6) == 0) {
    puVar5 = __doserrno();
    *puVar5 = 9;
  }
  else if ((*(uint *)((longlong)&param_2->_base + 4) >> 0xc & 1) == 0) {
    if ((*(uint *)((longlong)&param_2->_base + 4) & 1) != 0) {
      *(undefined4 *)&param_2->_base = 0;
      if ((*(uint *)((longlong)&param_2->_base + 4) >> 3 & 1) == 0) goto LAB_14001f9af;
      param_2->_ptr = *(char **)&param_2->_cnt;
      LOCK();
      puVar2 = (uint *)((longlong)&param_2->_base + 4);
      *puVar2 = *puVar2 & 0xfffffffe;
    }
    LOCK();
    puVar2 = (uint *)((longlong)&param_2->_base + 4);
    *puVar2 = *puVar2 | 2;
    LOCK();
    puVar2 = (uint *)((longlong)&param_2->_base + 4);
    *puVar2 = *puVar2 & 0xfffffff7;
    *(undefined4 *)&param_2->_base = 0;
    if (((*(uint *)((longlong)&param_2->_base + 4) & 0x4c0) == 0) &&
       (((pFVar6 = (FILE *)__acrt_iob_func(1), param_2 != pFVar6 &&
         (pFVar6 = (FILE *)__acrt_iob_func(2), param_2 != pFVar6)) ||
        (iVar4 = _isatty(iVar4), iVar4 == 0)))) {
      __acrt_stdio_allocate_buffer_nolock(&param_2->_ptr);
    }
    bVar3 = FUN_14001fa64(param_1,param_2);
    if (bVar3) {
      return (ulonglong)param_1;
    }
  }
  else {
    puVar5 = __doserrno();
    *puVar5 = 0x22;
  }
LAB_14001f9af:
  LOCK();
  puVar2 = (uint *)((longlong)&param_2->_base + 4);
  *puVar2 = *puVar2 | 0x10;
  return 0xffffffff;
}



// Library Function - Single Match
//  fread_s
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2015 Release

size_t __cdecl fread_s(void *_DstBuf,size_t _DstSize,size_t _ElementSize,size_t _Count,FILE *_File)

{
  ulong *puVar1;
  ulonglong uVar2;
  
  if ((_ElementSize != 0) && (_Count != 0)) {
    if (_File != (FILE *)0x0) {
      FUN_14000d45c((longlong)_File);
      uVar2 = FUN_140013c48((undefined (*) [16])_DstBuf,_DstSize,_ElementSize,_Count,_File);
      FUN_14000d468((longlong)_File);
      return uVar2;
    }
    if (_DstSize != 0xffffffffffffffff) {
      FUN_14000ce30((undefined (*) [16])_DstBuf,0,_DstSize);
    }
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
  }
  return 0;
}



// Library Function - Single Match
//  fread
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2015 Release

size_t __cdecl fread(void *_DstBuf,size_t _ElementSize,size_t _Count,FILE *_File)

{
  size_t sVar1;
  
  sVar1 = fread_s(_DstBuf,0xffffffffffffffff,_ElementSize,_Count,_File);
  return sVar1;
}



ulonglong FUN_140013c48(undefined (*param_1) [16],ulonglong param_2,ulonglong param_3,
                       ulonglong param_4,FILE *param_5)

{
  uint *puVar1;
  undefined8 *puVar2;
  uint uVar3;
  int iVar4;
  ulong *puVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  undefined (*pauVar8) [16];
  ulonglong uVar9;
  ulonglong uVar10;
  
  if ((param_3 != 0) && (param_4 != 0)) {
    if (param_1 != (undefined (*) [16])0x0) {
      if ((param_5 != (FILE *)0x0) &&
         (param_4 <= SUB168((ZEXT816(0) << 0x40 | ZEXT816(0xffffffffffffffff)) / ZEXT816(param_3),0)
         )) {
LAB_140013ce6:
        if ((*(uint *)((longlong)&param_5->_base + 4) & 0x4c0) == 0) {
          param_5._0_4_ = 0x1000;
        }
        else {
          param_5._0_4_ = param_5->_charbuf;
        }
        uVar7 = param_3 * param_4;
        pauVar8 = param_1;
        uVar9 = param_2;
        do {
          if (uVar7 == 0) {
            return param_4;
          }
          if ((*(uint *)((longlong)&param_5->_base + 4) & 0x4c0) == 0) {
LAB_140013dd6:
            if (uVar7 < (uint)param_5) {
              uVar6 = FUN_1400206c8(param_5);
              if ((int)uVar6 == -1) goto LAB_140013ec1;
              if (uVar9 == 0) goto LAB_140013e99;
              uVar7 = uVar7 - 1;
              uVar9 = uVar9 - 1;
              uVar10 = 1;
              (*pauVar8)[0] = (char)uVar6;
              param_5._0_4_ = param_5->_charbuf;
            }
            else {
              uVar10 = uVar7 & 0xffffffff;
              if (0x7fffffff < uVar7) {
                uVar10 = 0x7fffffff;
              }
              if ((uint)param_5 != 0) {
                uVar10 = (ulonglong)(uint)((int)uVar10 - (int)(uVar10 % (ulonglong)(uint)param_5));
              }
              if (uVar9 < uVar10) {
LAB_140013e99:
                if (param_2 != 0xffffffffffffffff) {
                  FUN_14000ce30(param_1,0,param_2);
                }
                puVar5 = __doserrno();
                *puVar5 = 0x22;
                goto LAB_140013c84;
              }
              *(undefined4 *)&param_5->_base = 0;
              param_5->_ptr = *(char **)&param_5->_cnt;
              uVar3 = _fileno(param_5);
              iVar4 = FUN_14001fc8c(uVar3,(LPWSTR)pauVar8,(uint)uVar10);
              if (iVar4 == 0) {
                LOCK();
                puVar1 = (uint *)((longlong)&param_5->_base + 4);
                *puVar1 = *puVar1 | 8;
                goto LAB_140013ec1;
              }
              if (iVar4 < 0) goto LAB_140013ebc;
              uVar10 = (ulonglong)iVar4;
              uVar7 = uVar7 - uVar10;
              uVar9 = uVar9 - uVar10;
            }
          }
          else {
            iVar4 = *(int *)&param_5->_base;
            if (iVar4 == 0) goto LAB_140013dd6;
            if (iVar4 < 0) {
LAB_140013ebc:
              LOCK();
              puVar1 = (uint *)((longlong)&param_5->_base + 4);
              *puVar1 = *puVar1 | 0x10;
LAB_140013ec1:
              return (param_3 * param_4 - uVar7) / param_3;
            }
            uVar10 = (longlong)iVar4;
            if (uVar7 < (ulonglong)(longlong)iVar4) {
              uVar10 = uVar7;
            }
            uVar10 = uVar10 & 0xffffffff;
            if (uVar9 < uVar10) goto LAB_140013e99;
            puVar2 = (undefined8 *)param_5->_ptr;
            if (uVar10 != 0) {
              if (pauVar8 == (undefined (*) [16])0x0) {
LAB_140013d67:
                puVar5 = __doserrno();
                *puVar5 = 0x16;
              }
              else {
                if ((puVar2 != (undefined8 *)0x0) && (uVar10 <= uVar9)) {
                  FUN_14001b140((undefined8 *)pauVar8,puVar2,uVar10);
                  goto LAB_140013dbd;
                }
                FUN_14000ce30(pauVar8,0,uVar9);
                if (puVar2 == (undefined8 *)0x0) goto LAB_140013d67;
                if (uVar10 <= uVar9) goto LAB_140013dbd;
                puVar5 = __doserrno();
                *puVar5 = 0x22;
              }
              FUN_140011e58();
            }
LAB_140013dbd:
            *(int *)&param_5->_base = *(int *)&param_5->_base - (int)uVar10;
            uVar7 = uVar7 - uVar10;
            param_5->_ptr = param_5->_ptr + uVar10;
            uVar9 = uVar9 - uVar10;
          }
          pauVar8 = (undefined (*) [16])(*pauVar8 + uVar10);
        } while( true );
      }
      if (param_2 != 0xffffffffffffffff) {
        FUN_14000ce30(param_1,0,param_2);
      }
      if ((param_5 != (FILE *)0x0) &&
         (param_4 <= SUB168((ZEXT816(0) << 0x40 | ZEXT816(0xffffffffffffffff)) / ZEXT816(param_3),0)
         )) goto LAB_140013ce6;
    }
    puVar5 = __doserrno();
    *puVar5 = 0x16;
LAB_140013c84:
    FUN_140011e58();
  }
  return 0;
}



void FUN_140013ed8(LPVOID param_1)

{
  _free_base(param_1);
  return;
}



void FUN_140013eec(FILE *param_1,int param_2,uint param_3)

{
  FUN_1400140b4(param_1,(longlong)param_2,param_3);
  return;
}



ulonglong FUN_140013ef4(longlong *param_1,longlong param_2,int param_3)

{
  uint uVar1;
  ulonglong in_RAX;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  
  if ((((param_3 != 2) &&
       (in_RAX = (ulonglong)*(uint *)((longlong)param_1 + 0x14),
       (*(uint *)((longlong)param_1 + 0x14) & 0x4c0) != 0)) &&
      (in_RAX = (ulonglong)*(uint *)((longlong)param_1 + 0x14),
      (*(uint *)((longlong)param_1 + 0x14) & 6) == 0)) && (0 < *(int *)(param_1 + 2))) {
    uVar1 = *(uint *)(param_1 + 3);
    in_RAX = (longlong)(int)uVar1 >> 6;
    lVar3 = (ulonglong)(uVar1 & 0x3f) * 0x40;
    if ((-1 < *(char *)((&DAT_140039600)[in_RAX] + 0x38 + lVar3)) &&
       (*(char *)((&DAT_140039600)[in_RAX] + 0x39 + lVar3) == '\0')) {
      lVar3 = param_2;
      if (param_3 == 0) {
        in_RAX = common_lseek_nolock___int64_(uVar1,0,1);
        if ((longlong)in_RAX < 0) goto LAB_140013fc6;
        lVar2 = in_RAX - (longlong)*(int *)(param_1 + 2);
        lVar3 = param_2 - lVar2;
        iVar4 = -(int)(param_2 >> 0x3f);
        in_RAX = (longlong)*(int *)(param_1 + 2);
        if ((iVar4 != -(int)(lVar2 >> 0x3f)) && (in_RAX = 0, iVar4 != -(int)(lVar3 >> 0x3f)))
        goto LAB_140013fc6;
      }
      if ((param_1[1] - *param_1 <= lVar3) && (lVar3 <= *(int *)(param_1 + 2))) {
        *param_1 = *param_1 + lVar3;
        *(int *)(param_1 + 2) = *(int *)(param_1 + 2) - (int)lVar3;
        return CONCAT71((int7)(in_RAX >> 8),1);
      }
    }
  }
LAB_140013fc6:
  return in_RAX & 0xffffffffffffff00;
}



int FUN_140013fd4(FILE *param_1,__int64 param_2,int param_3)

{
  uint *puVar1;
  int iVar2;
  ulong *puVar3;
  ulonglong uVar4;
  __int64 _Var5;
  
  if ((*(uint *)((longlong)&param_1->_base + 4) >> 0xd & 1) == 0) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    iVar2 = -1;
  }
  else {
    LOCK();
    puVar1 = (uint *)((longlong)&param_1->_base + 4);
    *puVar1 = *puVar1 & 0xfffffff7;
    uVar4 = FUN_140013ef4((longlong *)param_1,param_2,param_3);
    if ((char)uVar4 == '\0') {
      if (param_3 == 1) {
        uVar4 = thunk_FUN_14001447c(param_1);
        param_2 = param_2 + uVar4;
        param_3 = 0;
      }
      __acrt_stdio_flush_nolock(param_1);
      param_1->_ptr = *(char **)&param_1->_cnt;
      *(undefined4 *)&param_1->_base = 0;
      if ((*(uint *)((longlong)&param_1->_base + 4) >> 2 & 1) == 0) {
        if ((((byte)*(undefined4 *)((longlong)&param_1->_base + 4) & 0x41) == 0x41) &&
           ((*(uint *)((longlong)&param_1->_base + 4) >> 8 & 1) == 0)) {
          param_1->_charbuf = 0x200;
        }
      }
      else {
        LOCK();
        puVar1 = (uint *)((longlong)&param_1->_base + 4);
        *puVar1 = *puVar1 & 0xfffffffc;
      }
      _Var5 = common_lseek_nolock___int64_(param_1->_flag,param_2,param_3);
      iVar2 = (_Var5 != -1) - 1;
    }
    else {
      iVar2 = 0;
    }
  }
  return iVar2;
}



int FUN_1400140b4(FILE *param_1,__int64 param_2,uint param_3)

{
  int iVar1;
  ulong *puVar2;
  
  if ((param_1 == (FILE *)0x0) || (2 < param_3)) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    iVar1 = -1;
  }
  else {
    FUN_14000d45c((longlong)param_1);
    iVar1 = FUN_140013fd4(param_1,param_2,param_3);
    FUN_14000d468((longlong)param_1);
  }
  return iVar1;
}



ulonglong thunk_FUN_1400145ac(FILE *param_1)

{
  ulong *puVar1;
  ulonglong uVar2;
  
  if (param_1 == (FILE *)0x0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    uVar2 = 0xffffffff;
  }
  else {
    FUN_14000d45c((longlong)param_1);
    uVar2 = FUN_14001447c(param_1);
    if (0x7fffffff < (longlong)uVar2) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      uVar2 = 0xffffffff;
    }
    FUN_14000d468((longlong)param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  return uVar2;
}



ulonglong thunk_FUN_14001447c(FILE *param_1)

{
  char cVar1;
  uint uVar2;
  ulong *puVar3;
  __int64 _Var4;
  __int64 _Var5;
  longlong lVar6;
  longlong lVar7;
  ulonglong uVar8;
  
  if (param_1 == (FILE *)0x0) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
  }
  else {
    uVar2 = _fileno(param_1);
    if (*(int *)&param_1->_base < 0) {
      *(undefined4 *)&param_1->_base = 0;
    }
    _Var4 = thunk_FUN_140020844(uVar2,0,1);
    if (-1 < _Var4) {
      if ((*(uint *)((longlong)&param_1->_base + 4) & 0xc0) == 0) {
        return _Var4 - *(int *)&param_1->_base;
      }
      lVar7 = (longlong)(int)uVar2 >> 6;
      lVar6 = (ulonglong)(uVar2 & 0x3f) * 0x40;
      uVar8 = (longlong)param_1->_ptr - *(longlong *)&param_1->_cnt;
      cVar1 = *(char *)(lVar6 + 0x39 + (&DAT_140039600)[lVar7]);
      if ((*(uint *)((longlong)&param_1->_base + 4) & 3) == 0) {
        if ((*(uint *)((longlong)&param_1->_base + 4) >> 2 & 1) == 0) {
          puVar3 = __doserrno();
          *puVar3 = 0x16;
          return 0xffffffffffffffff;
        }
      }
      else {
        if ((cVar1 == '\x01') && ((*(byte *)(lVar6 + 0x3d + (&DAT_140039600)[lVar7]) & 2) != 0)) {
          uVar8 = FUN_1400141b4(param_1,_Var4);
          return uVar8;
        }
        if (*(char *)(lVar6 + 0x38 + (&DAT_140039600)[lVar7]) < '\0') {
          _Var5 = count_newline_bytes(*(char **)&param_1->_cnt,param_1->_ptr,
                                      (__crt_lowio_text_mode)CONCAT71(0x1400396,cVar1));
          uVar8 = uVar8 + _Var5;
        }
      }
      if (_Var4 == 0) {
        return uVar8;
      }
      if ((*(uint *)((longlong)&param_1->_base + 4) & 1) == 0) {
        if (cVar1 == '\x01') {
          uVar8 = uVar8 >> 1;
        }
        return uVar8 + _Var4;
      }
      uVar8 = FUN_140014330(param_1,_Var4,uVar8);
      return uVar8;
    }
  }
  return 0xffffffffffffffff;
}



// Library Function - Single Match
//  __int64 __cdecl count_newline_bytes(char const * __ptr64 const,char const * __ptr64 const,enum
// __crt_lowio_text_mode)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

__int64 __cdecl count_newline_bytes(char *param_1,char *param_2,__crt_lowio_text_mode param_3)

{
  short sVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong uVar4;
  longlong lVar5;
  ulonglong uVar6;
  longlong lVar7;
  ulonglong uVar8;
  char *pcVar9;
  
  if ((byte)((char)param_3 - 1U) < 2) {
    uVar2 = 0;
    uVar4 = (ulonglong)(param_2 + (1 - (longlong)param_1)) >> 1;
    if (param_2 < param_1) {
      uVar4 = uVar2;
    }
    uVar6 = uVar2;
    uVar8 = uVar2;
    if (uVar4 != 0) {
      do {
        sVar1 = *(short *)param_1;
        param_1 = (char *)((longlong)param_1 + 2);
        uVar2 = uVar6 + 1;
        if (sVar1 != 10) {
          uVar2 = uVar6;
        }
        uVar8 = uVar8 + 1;
        uVar6 = uVar2;
      } while (uVar8 != uVar4);
    }
    return uVar2 * 2;
  }
  lVar5 = 0;
  lVar3 = (longlong)param_2 - (longlong)param_1;
  if (param_2 < param_1) {
    lVar3 = lVar5;
  }
  lVar7 = lVar5;
  pcVar9 = param_1;
  if (lVar3 != 0) {
    do {
      lVar5 = lVar7 + 1;
      if (*pcVar9 != '\n') {
        lVar5 = lVar7;
      }
      pcVar9 = pcVar9 + 1;
      lVar7 = lVar5;
    } while ((longlong)pcVar9 - (longlong)param_1 != lVar3);
  }
  return lVar5;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

void FUN_1400141b4(FILE *param_1,__int64 param_2)

{
  uint uVar1;
  BOOL BVar2;
  longlong lVar3;
  __int64 _Var4;
  ulonglong uVar5;
  byte *pbVar6;
  longlong lVar7;
  longlong lVar8;
  undefined auStackY_1080 [32];
  uint local_1050 [3];
  byte abStack_1041 [4097];
  ulonglong local_40;
  undefined8 local_30;
  
  local_30 = 0x1400141d6;
  local_40 = DAT_140038010 ^ (ulonglong)auStackY_1080;
  uVar1 = _fileno(param_1);
  lVar7 = 0;
  if (*(int *)&param_1->_base != 0) {
    lVar3 = ((longlong)param_1->_ptr - *(longlong *)&param_1->_cnt) / 2;
    lVar8 = (ulonglong)(uVar1 & 0x3f) * 0x40;
    _Var4 = thunk_FUN_140020844(uVar1,*(__int64 *)
                                       (lVar8 + 0x30 + (&DAT_140039600)[(longlong)(int)uVar1 >> 6]),
                                0);
    if ((((_Var4 == *(longlong *)(lVar8 + 0x30 + (&DAT_140039600)[(longlong)(int)uVar1 >> 6])) &&
         (BVar2 = ReadFile(*(HANDLE *)(lVar8 + 0x28 + (&DAT_140039600)[(longlong)(int)uVar1 >> 6]),
                           abStack_1041 + 1,0x1000,local_1050,(LPOVERLAPPED)0x0), BVar2 != 0)) &&
        (_Var4 = thunk_FUN_140020844(uVar1,param_2,0), -1 < _Var4)) &&
       (uVar5 = (ulonglong)local_1050[0], lVar3 <= (longlong)uVar5)) {
      pbVar6 = abStack_1041;
      if (lVar3 != 0) {
        do {
          pbVar6 = pbVar6 + 1;
          if (abStack_1041 + uVar5 + 1 <= pbVar6) break;
          if (*pbVar6 == 0xd) {
            if ((pbVar6 < abStack_1041 + uVar5) && (pbVar6[1] == 10)) {
              pbVar6 = pbVar6 + 1;
            }
          }
          else {
            pbVar6 = pbVar6 + (char)(&DAT_1400389d0)[*pbVar6];
          }
          lVar7 = lVar7 + 1;
        } while (lVar7 != lVar3);
      }
    }
  }
  __security_check_cookie(local_40 ^ (ulonglong)auStackY_1080);
  return;
}



longlong FUN_140014330(FILE *param_1,longlong param_2,longlong param_3)

{
  byte bVar1;
  uint uVar2;
  __int64 _Var3;
  char *pcVar4;
  char *pcVar5;
  uint uVar6;
  longlong lVar7;
  longlong lVar8;
  bool bVar9;
  
  uVar2 = _fileno(param_1);
  lVar7 = (ulonglong)(uVar2 & 0x3f) * 0x40;
  bVar1 = *(byte *)(lVar7 + 0x39 + (&DAT_140039600)[(longlong)(int)uVar2 >> 6]);
  lVar8 = (ulonglong)(bVar1 == 1) + 1;
  if (*(int *)&param_1->_base != 0) {
    pcVar5 = param_1->_ptr + ((longlong)*(int *)&param_1->_base - *(longlong *)&param_1->_cnt);
    if (*(char *)(lVar7 + 0x38 + (&DAT_140039600)[(longlong)(int)uVar2 >> 6]) < '\0') {
      uVar6 = 0;
      _Var3 = thunk_FUN_140020844(uVar2,0,2);
      if (_Var3 == param_2) {
        _Var3 = count_newline_bytes(*(char **)&param_1->_cnt,
                                    *(char **)&param_1->_cnt + (longlong)pcVar5,
                                    uVar6 & 0xffffff00 | (uint)bVar1);
        bVar9 = (*(uint *)((longlong)&param_1->_base + 4) >> 5 & 1) == 0;
        pcVar5 = pcVar5 + _Var3;
      }
      else {
        _Var3 = thunk_FUN_140020844(uVar2,param_2,0);
        if (_Var3 == -1) {
          return -1;
        }
        pcVar4 = (char *)0x200;
        if (((0x200 < (longlong)pcVar5) ||
            ((*(uint *)((longlong)&param_1->_base + 4) >> 6 & 1) == 0)) ||
           ((*(uint *)((longlong)&param_1->_base + 4) >> 8 & 1) != 0)) {
          pcVar4 = (char *)(longlong)param_1->_charbuf;
        }
        bVar9 = (*(byte *)(lVar7 + 0x38 + (&DAT_140039600)[(longlong)(int)uVar2 >> 6]) & 4) == 0;
        pcVar5 = pcVar4;
      }
      if (!bVar9) {
        pcVar5 = pcVar5 + (ulonglong)((byte)(bVar1 - 1) < 2) + 1;
      }
    }
    param_2 = (param_3 / lVar8 - (longlong)pcVar5 / lVar8) + param_2;
  }
  return param_2;
}



ulonglong FUN_14001447c(FILE *param_1)

{
  char cVar1;
  uint uVar2;
  ulong *puVar3;
  __int64 _Var4;
  __int64 _Var5;
  longlong lVar6;
  longlong lVar7;
  ulonglong uVar8;
  
  if (param_1 == (FILE *)0x0) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
  }
  else {
    uVar2 = _fileno(param_1);
    if (*(int *)&param_1->_base < 0) {
      *(undefined4 *)&param_1->_base = 0;
    }
    _Var4 = thunk_FUN_140020844(uVar2,0,1);
    if (-1 < _Var4) {
      if ((*(uint *)((longlong)&param_1->_base + 4) & 0xc0) == 0) {
        return _Var4 - *(int *)&param_1->_base;
      }
      lVar7 = (longlong)(int)uVar2 >> 6;
      lVar6 = (ulonglong)(uVar2 & 0x3f) * 0x40;
      uVar8 = (longlong)param_1->_ptr - *(longlong *)&param_1->_cnt;
      cVar1 = *(char *)(lVar6 + 0x39 + (&DAT_140039600)[lVar7]);
      if ((*(uint *)((longlong)&param_1->_base + 4) & 3) == 0) {
        if ((*(uint *)((longlong)&param_1->_base + 4) >> 2 & 1) == 0) {
          puVar3 = __doserrno();
          *puVar3 = 0x16;
          return 0xffffffffffffffff;
        }
      }
      else {
        if ((cVar1 == '\x01') && ((*(byte *)(lVar6 + 0x3d + (&DAT_140039600)[lVar7]) & 2) != 0)) {
          uVar8 = FUN_1400141b4(param_1,_Var4);
          return uVar8;
        }
        if (*(char *)(lVar6 + 0x38 + (&DAT_140039600)[lVar7]) < '\0') {
          _Var5 = count_newline_bytes(*(char **)&param_1->_cnt,param_1->_ptr,
                                      (__crt_lowio_text_mode)CONCAT71(0x1400396,cVar1));
          uVar8 = uVar8 + _Var5;
        }
      }
      if (_Var4 == 0) {
        return uVar8;
      }
      if ((*(uint *)((longlong)&param_1->_base + 4) & 1) == 0) {
        if (cVar1 == '\x01') {
          uVar8 = uVar8 >> 1;
        }
        return uVar8 + _Var4;
      }
      uVar8 = FUN_140014330(param_1,_Var4,uVar8);
      return uVar8;
    }
  }
  return 0xffffffffffffffff;
}



ulonglong FUN_1400145ac(FILE *param_1)

{
  ulong *puVar1;
  ulonglong uVar2;
  
  if (param_1 == (FILE *)0x0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    uVar2 = 0xffffffff;
  }
  else {
    FUN_14000d45c((longlong)param_1);
    uVar2 = FUN_14001447c(param_1);
    if (0x7fffffff < (longlong)uVar2) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      uVar2 = 0xffffffff;
    }
    FUN_14000d468((longlong)param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  return uVar2;
}



// Library Function - Single Match
//  fwrite
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

size_t __cdecl fwrite(void *_Str,size_t _Size,size_t _Count,FILE *_File)

{
  ulong *puVar1;
  ulonglong uVar2;
  void *local_res8;
  size_t local_res10;
  size_t local_res18;
  FILE *local_res20;
  undefined local_48 [8];
  FILE *local_40;
  FILE *local_38;
  FILE **local_30;
  void **local_28;
  size_t *local_20;
  size_t *local_18;
  
  if ((_Size != 0) && (_Count != 0)) {
    local_res8 = _Str;
    local_res10 = _Size;
    local_res18 = _Count;
    local_res20 = _File;
    if (_File != (FILE *)0x0) {
      local_30 = &local_res20;
      local_28 = &local_res8;
      local_20 = &local_res10;
      local_18 = &local_res18;
      local_40 = _File;
      local_38 = _File;
      uVar2 = operator____(local_48,(longlong *)&local_38,&local_30,(longlong *)&local_40);
      return uVar2;
    }
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
  }
  return 0;
}



ulonglong FUN_1400146a0(undefined8 *param_1,ulonglong param_2,ulonglong param_3,FILE *param_4)

{
  uint *puVar1;
  int iVar2;
  ulonglong uVar3;
  uint uVar4;
  uint uVar5;
  ulong *puVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  uint uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  uint uVar12;
  
  if ((param_2 != 0) && (param_3 != 0)) {
    if ((param_4 != (FILE *)0x0) &&
       ((param_1 != (undefined8 *)0x0 &&
        (param_3 <= SUB168((ZEXT816(0) << 0x40 | ZEXT816(0xffffffffffffffff)) / ZEXT816(param_2),0))
        ))) {
      if ((*(uint *)((longlong)&param_4->_base + 4) & 0x4c0) == 0) {
        uVar12 = 0x1000;
      }
      else {
        uVar12 = param_4->_charbuf;
      }
      uVar11 = param_2 * param_3;
LAB_14001473d:
      do {
        if (uVar11 == 0) {
          return param_3;
        }
        if ((*(uint *)((longlong)&param_4->_base + 4) & 0xc0) != 0) {
          iVar2 = *(int *)&param_4->_base;
          uVar8 = (ulonglong)iVar2;
          if (iVar2 != 0) {
            if (iVar2 < 0) goto LAB_1400147fd;
            uVar3 = uVar8;
            if (uVar11 < uVar8) {
              uVar3 = uVar11;
            }
            uVar10 = uVar11;
            if (uVar11 >= uVar8) {
              uVar10 = uVar8;
            }
            FUN_14001b140((undefined8 *)param_4->_ptr,param_1,uVar10);
            uVar11 = uVar11 - uVar10;
            *(int *)&param_4->_base = *(int *)&param_4->_base - (int)uVar3;
            param_4->_ptr = param_4->_ptr + uVar10;
            param_1 = (undefined8 *)((longlong)param_1 + uVar10);
            goto LAB_14001473d;
          }
        }
        if (uVar11 < uVar12) {
          uVar8 = __acrt_stdio_flush_and_write_narrow_nolock(*(byte *)param_1,param_4);
          if ((int)uVar8 == -1) goto LAB_140014802;
          param_1 = (undefined8 *)((longlong)param_1 + 1);
          uVar11 = uVar11 - 1;
          uVar12 = 1;
          if (0 < param_4->_charbuf) {
            uVar12 = param_4->_charbuf;
          }
        }
        else {
          if (((*(uint *)((longlong)&param_4->_base + 4) & 0xc0) != 0) &&
             (uVar7 = __acrt_stdio_flush_nolock(param_4), (int)uVar7 != 0)) goto LAB_140014802;
          uVar8 = uVar11;
          if (uVar12 != 0) {
            uVar8 = uVar11 - uVar11 % (ulonglong)uVar12;
          }
          uVar9 = 0xfffffffe;
          if (uVar8 < 0xfffffffe) {
            uVar9 = (uint)uVar8;
          }
          uVar5 = _fileno(param_4);
          uVar5 = FUN_14001f008(uVar5,(short *)param_1,uVar9);
          if (uVar5 == 0xffffffff) goto LAB_1400147fd;
          uVar4 = uVar5;
          if (uVar9 < uVar5) {
            uVar4 = uVar9;
          }
          uVar11 = uVar11 - uVar4;
          param_1 = (undefined8 *)((longlong)param_1 + (ulonglong)uVar4);
          if (uVar5 < uVar9) {
LAB_1400147fd:
            LOCK();
            puVar1 = (uint *)((longlong)&param_4->_base + 4);
            *puVar1 = *puVar1 | 0x10;
LAB_140014802:
            return (param_2 * param_3 - uVar11) / param_2;
          }
        }
      } while( true );
    }
    puVar6 = __doserrno();
    *puVar6 = 0x16;
    FUN_140011e58();
  }
  return 0;
}



// Library Function - Multiple Matches With Different Base Names
//  public: unsigned __int64 __cdecl
// <lambda_532e024f4337e6fc7ad266c2bef9f4ed>::operator()(void)const __ptr64
//  public: unsigned __int64 __cdecl
// <lambda_96f4279ff90247a4c5c5d9824f56f8c1>::operator()(void)const __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

ulonglong FID_conflict_operator__(undefined8 *param_1)

{
  FILE *pFVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  
  pFVar1 = *(FILE **)*param_1;
  uVar2 = __acrt_stdio_begin_temporary_buffering_nolock(pFVar1);
  uVar3 = FUN_1400146a0(*(undefined8 **)param_1[1],*(ulonglong *)param_1[2],*(ulonglong *)param_1[3]
                        ,*(FILE **)*param_1);
  __acrt_stdio_end_temporary_buffering_nolock((char)uVar2,pFVar1);
  return uVar3;
}



// Library Function - Multiple Matches With Same Base Name
//  public: unsigned __int64 __cdecl __crt_seh_guarded_call<unsigned __int64>::operator()<class
// <lambda_2831f20263db5b546e098b45503eb778>,class <lambda_5856287d7ecd2be6c9197bb4007c3f6e> &
// __ptr64,class <lambda_0838d7e100fbcbd261b69cfea6abb102> >(class
// <lambda_2831f20263db5b546e098b45503eb778> && __ptr64,class
// <lambda_5856287d7ecd2be6c9197bb4007c3f6e> & __ptr64,class
// <lambda_0838d7e100fbcbd261b69cfea6abb102> && __ptr64) __ptr64
//  public: unsigned __int64 __cdecl __crt_seh_guarded_call<unsigned __int64>::operator()<class
// <lambda_5d4c3fee44080f75d5d9762853974fe0>,class <lambda_532e024f4337e6fc7ad266c2bef9f4ed> &
// __ptr64,class <lambda_c87bdc10097eb2402edb8ba9bdf0697b> >(class
// <lambda_5d4c3fee44080f75d5d9762853974fe0> && __ptr64,class
// <lambda_532e024f4337e6fc7ad266c2bef9f4ed> & __ptr64,class
// <lambda_c87bdc10097eb2402edb8ba9bdf0697b> && __ptr64) __ptr64
//  public: unsigned __int64 __cdecl __crt_seh_guarded_call<unsigned __int64>::operator()<class
// <lambda_bdbcead8b570fa3d5ec6d9679862a6e5>,class <lambda_96f4279ff90247a4c5c5d9824f56f8c1> &
// __ptr64,class <lambda_4606be27f17b5e5579e09050fab91818> >(class
// <lambda_bdbcead8b570fa3d5ec6d9679862a6e5> && __ptr64,class
// <lambda_96f4279ff90247a4c5c5d9824f56f8c1> & __ptr64,class
// <lambda_4606be27f17b5e5579e09050fab91818> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong operator____(undefined8 param_1,longlong *param_2,undefined8 *param_3,longlong *param_4)

{
  ulonglong uVar1;
  
  FUN_14000d45c(*param_2);
  uVar1 = FID_conflict_operator__(param_3);
  FUN_14000d468(*param_4);
  return uVar1;
}



void FUN_1400148ec(WCHAR param_1)

{
  FUN_1400209d0(param_1,4);
  return;
}



// Library Function - Single Match
//  _isleadbyte_l
// 
// Library: Visual Studio 2015 Release

int __cdecl _isleadbyte_l(int _C,_locale_t _Locale)

{
  ushort uVar1;
  longlong local_28;
  longlong *local_20;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)_Locale);
  uVar1 = *(ushort *)(*local_20 + (ulonglong)(_C & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



LPVOID _malloc_base(ulonglong param_1)

{
  int iVar1;
  LPVOID pvVar2;
  ulong *puVar3;
  
  if (param_1 < 0xffffffffffffffe1) {
    if (param_1 == 0) {
      param_1 = 1;
    }
    do {
      pvVar2 = HeapAlloc(DAT_1400395f8,0,param_1);
      if (pvVar2 != (LPVOID)0x0) {
        return pvVar2;
      }
      iVar1 = FUN_140012e60();
    } while ((iVar1 != 0) && (iVar1 = _callnewh(param_1), iVar1 != 0));
  }
  puVar3 = __doserrno();
  *puVar3 = 0xc;
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  strcmp
// 
// Libraries: Visual Studio 2012, Visual Studio 2015, Visual Studio 2017, Visual Studio 2019

int __cdecl strcmp(char *_Str1,char *_Str2)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  lVar3 = (longlong)_Str2 - (longlong)_Str1;
  uVar2 = (ulonglong)_Str1 & 7;
  while( true ) {
    if (uVar2 == 0) {
      while ((((int)lVar3 + (int)_Str1 & 0xfffU) < 0xff9 &&
             (uVar2 = *(ulonglong *)_Str1, uVar2 == *(ulonglong *)(lVar3 + (longlong)_Str1)))) {
        _Str1 = (char *)((longlong)_Str1 + 8);
        if ((~uVar2 & uVar2 + 0xfefefefefefefeff & 0x8080808080808080) != 0) {
          return 0;
        }
      }
    }
    bVar1 = *_Str1;
    if (bVar1 != *(byte *)(lVar3 + (longlong)_Str1)) break;
    _Str1 = (char *)((longlong)_Str1 + 1);
    if (bVar1 == 0) {
      return 0;
    }
    uVar2 = (ulonglong)_Str1 & 7;
  }
  return -(uint)(bVar1 < *(byte *)(lVar3 + (longlong)_Str1)) | 1;
}



// Library Function - Single Match
//  strcat
// 
// Library: Visual Studio

char * __cdecl strcat(char *_Dest,char *_Source)

{
  ulonglong uVar1;
  char cVar2;
  ulonglong *puVar3;
  ulonglong *puVar4;
  ulonglong *puVar5;
  longlong lVar6;
  
  uVar1 = (ulonglong)_Dest & 7;
  puVar3 = (ulonglong *)_Dest;
  while (uVar1 != 0) {
    puVar5 = puVar3;
    if (*(char *)puVar3 == '\0') goto LAB_140014a73;
    puVar3 = (ulonglong *)((longlong)puVar3 + 1);
    uVar1 = (ulonglong)puVar3 & 7;
  }
  do {
    do {
      puVar4 = puVar3;
      uVar1 = *puVar4;
      puVar3 = puVar4 + 1;
    } while (((uVar1 ^ 0xffffffffffffffff ^ uVar1 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    puVar5 = puVar4;
  } while ((((((char)uVar1 != '\0') &&
             (puVar5 = (ulonglong *)((longlong)puVar4 + 1), (char)(uVar1 >> 8) != '\0')) &&
            (puVar5 = (ulonglong *)((longlong)puVar4 + 2), (char)(uVar1 >> 0x10) != '\0')) &&
           ((puVar5 = (ulonglong *)((longlong)puVar4 + 3), (char)(uVar1 >> 0x18) != '\0' &&
            (puVar5 = (ulonglong *)((longlong)puVar4 + 4), (char)(uVar1 >> 0x20) != '\0')))) &&
          ((puVar5 = (ulonglong *)((longlong)puVar4 + 5), (char)(uVar1 >> 0x28) != '\0' &&
           ((puVar5 = (ulonglong *)((longlong)puVar4 + 6), (char)(uVar1 >> 0x30) != '\0' &&
            (puVar5 = (ulonglong *)((longlong)puVar4 + 7), (char)(uVar1 >> 0x38) != '\0'))))));
LAB_140014a73:
  lVar6 = (longlong)puVar5 - (longlong)_Source;
  uVar1 = (ulonglong)_Source & 7;
  while( true ) {
    if (uVar1 == 0) {
      while( true ) {
        while (uVar1 = *(ulonglong *)_Source,
              ((uVar1 ^ 0xffffffffffffffff ^ uVar1 + 0x7efefefefefefeff) & 0x8101010101010100) == 0)
        {
          *(ulonglong *)((longlong)_Source + lVar6) = uVar1;
          _Source = (char *)((longlong)_Source + 8);
        }
        *(char *)((longlong)_Source + lVar6) = (char)uVar1;
        if (((((char)uVar1 == '\0') ||
             (cVar2 = (char)(uVar1 >> 8), *(char *)((longlong)_Source + lVar6 + 1) = cVar2,
             cVar2 == '\0')) ||
            (cVar2 = (char)(uVar1 >> 0x10), *(char *)((longlong)_Source + lVar6 + 2) = cVar2,
            cVar2 == '\0')) ||
           (((cVar2 = (char)(uVar1 >> 0x18), *(char *)((longlong)_Source + lVar6 + 3) = cVar2,
             cVar2 == '\0' ||
             (cVar2 = (char)(uVar1 >> 0x20), *(char *)((longlong)_Source + lVar6 + 4) = cVar2,
             cVar2 == '\0')) ||
            ((cVar2 = (char)(uVar1 >> 0x28), *(char *)((longlong)_Source + lVar6 + 5) = cVar2,
             cVar2 == '\0' ||
             ((cVar2 = (char)(uVar1 >> 0x30), *(char *)((longlong)_Source + lVar6 + 6) = cVar2,
              cVar2 == '\0' ||
              (cVar2 = (char)(uVar1 >> 0x38), *(char *)((longlong)_Source + lVar6 + 7) = cVar2,
              cVar2 == '\0')))))))) break;
        _Source = (char *)((longlong)_Source + 8);
      }
      return _Dest;
    }
    cVar2 = *_Source;
    *(char *)((longlong)_Source + lVar6) = cVar2;
    if (cVar2 == '\0') break;
    _Source = (char *)((longlong)_Source + 1);
    uVar1 = (ulonglong)_Source & 7;
  }
  return _Dest;
}



longlong FUN_140014a70(longlong param_1,ulonglong *param_2)

{
  ulonglong uVar1;
  char cVar2;
  longlong lVar3;
  
  lVar3 = param_1 - (longlong)param_2;
  uVar1 = (ulonglong)param_2 & 7;
  while( true ) {
    if (uVar1 == 0) {
      while( true ) {
        while (uVar1 = *param_2,
              ((uVar1 ^ 0xffffffffffffffff ^ uVar1 + 0x7efefefefefefeff) & 0x8101010101010100) == 0)
        {
          *(ulonglong *)((longlong)param_2 + lVar3) = uVar1;
          param_2 = param_2 + 1;
        }
        *(char *)((longlong)param_2 + lVar3) = (char)uVar1;
        if ((((((char)uVar1 == '\0') ||
              (cVar2 = (char)(uVar1 >> 8), *(char *)((longlong)param_2 + lVar3 + 1) = cVar2,
              cVar2 == '\0')) ||
             (cVar2 = (char)(uVar1 >> 0x10), *(char *)((longlong)param_2 + lVar3 + 2) = cVar2,
             cVar2 == '\0')) ||
            ((cVar2 = (char)(uVar1 >> 0x18), *(char *)((longlong)param_2 + lVar3 + 3) = cVar2,
             cVar2 == '\0' ||
             (cVar2 = (char)(uVar1 >> 0x20), *(char *)((longlong)param_2 + lVar3 + 4) = cVar2,
             cVar2 == '\0')))) ||
           ((cVar2 = (char)(uVar1 >> 0x28), *(char *)((longlong)param_2 + lVar3 + 5) = cVar2,
            cVar2 == '\0' ||
            ((cVar2 = (char)(uVar1 >> 0x30), *(char *)((longlong)param_2 + lVar3 + 6) = cVar2,
             cVar2 == '\0' ||
             (cVar2 = (char)(uVar1 >> 0x38), *(char *)((longlong)param_2 + lVar3 + 7) = cVar2,
             cVar2 == '\0')))))) break;
        param_2 = param_2 + 1;
      }
      return param_1;
    }
    cVar2 = *(char *)param_2;
    *(char *)((longlong)param_2 + lVar3) = cVar2;
    if (cVar2 == '\0') break;
    param_2 = (ulonglong *)((longlong)param_2 + 1);
    uVar1 = (ulonglong)param_2 & 7;
  }
  return param_1;
}



void FUN_140014b28(undefined *param_1,__uint64 param_2,LPCSTR param_3,uint *param_4)

{
  FUN_140014b44(param_1,param_2,param_3,param_4,(__lc_time_data *)0x0,(__crt_locale_pointers *)0x0);
  return;
}



longlong FUN_140014b44(undefined *param_1,__uint64 param_2,LPCSTR param_3,uint *param_4,
                      __lc_time_data *param_5,__crt_locale_pointers *param_6)

{
  UINT UVar1;
  ulong uVar2;
  ulong *puVar3;
  WCHAR *pWVar4;
  longlong lVar5;
  longlong local_98;
  longlong local_90;
  char local_80;
  undefined8 local_78;
  undefined8 local_70;
  WCHAR *local_68;
  undefined8 local_60;
  undefined8 local_58;
  char local_50;
  undefined *local_48;
  __uint64 local_40;
  undefined *local_38;
  __uint64 local_30;
  longlong local_28;
  undefined local_20;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_98,param_6);
  UVar1 = *(UINT *)(local_90 + 0x18);
  if ((((param_1 == (undefined *)0x0) || (param_2 == 0)) || (*param_1 = 0, param_3 == (LPCSTR)0x0))
     || (param_4 == (uint *)0x0)) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    lVar5 = 0;
    goto LAB_140014c71;
  }
  local_78 = 0;
  local_70 = 0;
  local_68 = (WCHAR *)0x0;
  local_60 = 0;
  local_58 = 0;
  local_50 = '\0';
  uVar2 = FUN_140014ca8(param_3,(longlong)&local_78,UVar1);
  if (uVar2 == 0) {
    pWVar4 = (WCHAR *)_malloc_base(param_2 * 2);
    if (pWVar4 == (WCHAR *)0x0) {
LAB_140014c58:
      lVar5 = 0;
    }
    else {
      lVar5 = FUN_140020a40(pWVar4,param_2,local_68,param_4,param_5,param_6);
      if (lVar5 == 0) goto LAB_140014c58;
      local_28 = 0;
      local_20 = 0;
      local_48 = param_1;
      local_40 = param_2;
      local_38 = param_1;
      local_30 = param_2;
      uVar2 = FUN_140014d90(pWVar4,(longlong)&local_48,UVar1);
      if (uVar2 != 0) goto LAB_140014c58;
      lVar5 = local_28 + -1;
    }
    _free_base(pWVar4);
  }
  else {
    lVar5 = 0;
  }
  if (local_50 != '\0') {
    _free_base(local_68);
  }
LAB_140014c71:
  if (local_80 != '\0') {
    *(uint *)(local_98 + 0x3a8) = *(uint *)(local_98 + 0x3a8) & 0xfffffffd;
  }
  return lVar5;
}



ulong FUN_140014ca8(LPCSTR param_1,longlong param_2,UINT param_3)

{
  int iVar1;
  DWORD DVar2;
  ulong *puVar3;
  LPVOID pvVar4;
  uint uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  
  iVar1 = __acrt_MultiByteToWideChar(param_3,9,param_1,-1,(LPWSTR)0x0,0);
  uVar7 = (ulonglong)iVar1;
  if (iVar1 != 0) {
    uVar6 = *(ulonglong *)(param_2 + 0x18);
    if (uVar6 < uVar7) {
      if (*(char *)(param_2 + 0x28) != '\0') {
        _free_base(*(LPVOID *)(param_2 + 0x10));
        *(undefined *)(param_2 + 0x28) = 0;
      }
      pvVar4 = _malloc_base(uVar7 * 2);
      *(LPVOID *)(param_2 + 0x10) = pvVar4;
      uVar5 = ~-(uint)(pvVar4 != (LPVOID)0x0) & 0xc;
      uVar6 = 0;
      if (uVar5 == 0) {
        uVar6 = uVar7;
      }
      *(bool *)(param_2 + 0x28) = uVar5 == 0;
      *(ulonglong *)(param_2 + 0x18) = uVar6;
      if (uVar5 != 0) {
        return uVar5;
      }
    }
    iVar1 = __acrt_MultiByteToWideChar(param_3,9,param_1,-1,*(LPWSTR *)(param_2 + 0x10),(int)uVar6);
    if (iVar1 != 0) {
      *(longlong *)(param_2 + 0x20) = (longlong)iVar1;
      return 0;
    }
  }
  DVar2 = GetLastError();
  __acrt_errno_map_os_error(DVar2);
  puVar3 = __doserrno();
  return *puVar3;
}



ulong FUN_140014d90(undefined8 param_1,longlong param_2,uint param_3)

{
  int iVar1;
  DWORD DVar2;
  ulong *puVar3;
  
  iVar1 = __acrt_WideCharToMultiByte(param_3,0,(undefined)param_1,0xff,0,0,0,0);
  if (iVar1 != 0) {
    if (*(ulonglong *)(param_2 + 0x18) < (ulonglong)(longlong)iVar1) {
      if (*(char *)(param_2 + 0x28) != '\0') {
        *(undefined *)(param_2 + 0x28) = 0;
      }
      puVar3 = __doserrno();
      *puVar3 = 0x22;
      *(undefined *)(param_2 + 0x28) = 0;
      *(undefined8 *)(param_2 + 0x18) = 0;
      return 0x22;
    }
    iVar1 = __acrt_WideCharToMultiByte
                      (param_3,0,(undefined)param_1,0xff,(char)*(undefined8 *)(param_2 + 0x10),
                       (char)*(ulonglong *)(param_2 + 0x18),0,0);
    if (iVar1 != 0) {
      *(longlong *)(param_2 + 0x20) = (longlong)iVar1;
      return 0;
    }
  }
  DVar2 = GetLastError();
  __acrt_errno_map_os_error(DVar2);
  puVar3 = __doserrno();
  return *puVar3;
}



// Library Function - Single Match
//  strlen
// 
// Library: Visual Studio

size_t __cdecl strlen(char *_Str)

{
  char cVar1;
  ulonglong uVar2;
  ulonglong *puVar3;
  longlong lVar4;
  
  lVar4 = -(longlong)_Str;
  uVar2 = (ulonglong)_Str & 7;
  while (uVar2 != 0) {
    cVar1 = *_Str;
    _Str = (char *)((longlong)_Str + 1);
    if (cVar1 == '\0') goto LAB_140014ee8;
    uVar2 = (ulonglong)_Str & 7;
  }
  do {
    do {
      puVar3 = (ulonglong *)_Str;
      _Str = (char *)(puVar3 + 1);
    } while (((~*puVar3 ^ *puVar3 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    uVar2 = *puVar3;
    if ((char)uVar2 == '\0') {
      return (longlong)puVar3 + lVar4;
    }
    if ((char)(uVar2 >> 8) == '\0') {
      return (size_t)(char *)((longlong)puVar3 + lVar4 + 1);
    }
    if ((char)(uVar2 >> 0x10) == '\0') {
      return (size_t)(char *)((longlong)puVar3 + lVar4 + 2);
    }
    if ((char)(uVar2 >> 0x18) == '\0') {
      return (size_t)(char *)((longlong)puVar3 + lVar4 + 3);
    }
    if ((char)(uVar2 >> 0x20) == '\0') {
      return (size_t)(char *)((longlong)puVar3 + lVar4 + 4);
    }
    if ((char)(uVar2 >> 0x28) == '\0') {
      return (size_t)(char *)((longlong)puVar3 + lVar4 + 5);
    }
    if ((char)(uVar2 >> 0x30) == '\0') {
      return (size_t)(char *)((longlong)puVar3 + lVar4 + 6);
    }
  } while ((char)(uVar2 >> 0x38) != '\0');
LAB_140014ee8:
  return (size_t)(char *)((longlong)_Str + lVar4 + -1);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  terminate
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int terminate(ushort *param_1,ushort *param_2)

{
  ushort uVar1;
  __acrt_ptd *p_Var2;
  longlong lVar3;
  int iVar4;
  
  p_Var2 = FUN_140017b04();
  if (*(code **)(p_Var2 + 0x18) != (code *)0x0) {
    (**(code **)(p_Var2 + 0x18))();
  }
  abort();
  uVar1 = *param_2;
  iVar4 = (uint)*param_1 - (uint)uVar1;
  if (iVar4 == 0) {
    lVar3 = (longlong)param_1 - (longlong)param_2;
    do {
      if (uVar1 == 0) break;
      param_2 = param_2 + 1;
      uVar1 = *param_2;
      iVar4 = (uint)*(ushort *)(lVar3 + (longlong)param_2) - (uint)uVar1;
    } while (iVar4 == 0);
  }
  return (iVar4 >> 0x1f) - (-iVar4 >> 0x1f);
}



// Library Function - Single Match
//  wcscmp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl wcscmp(wchar_t *_Str1,wchar_t *_Str2)

{
  wchar_t wVar1;
  longlong lVar2;
  int iVar3;
  
  wVar1 = *_Str2;
  iVar3 = (uint)(ushort)*_Str1 - (uint)(ushort)wVar1;
  if (iVar3 == 0) {
    lVar2 = (longlong)_Str1 - (longlong)_Str2;
    do {
      if (wVar1 == L'\0') break;
      _Str2 = _Str2 + 1;
      wVar1 = *_Str2;
      iVar3 = (uint)*(ushort *)(lVar2 + (longlong)_Str2) - (uint)(ushort)wVar1;
    } while (iVar3 == 0);
  }
  return (iVar3 >> 0x1f) - (-iVar3 >> 0x1f);
}



// Library Function - Single Match
//  wcsnlen
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

size_t __cdecl wcsnlen(wchar_t *_Src,size_t _MaxCount)

{
  size_t sVar1;
  undefined (*pauVar2) [32];
  wchar_t *pwVar3;
  ulonglong uVar4;
  undefined auVar5 [16];
  undefined in_YMM1 [32];
  ushort uVar6;
  
  pauVar2 = (undefined (*) [32])_Src;
  if (DAT_140038018 < 5) {
    if (DAT_140038018 < 1) {
      if ((undefined (*) [32])_Src != (undefined (*) [32])(_Src + _MaxCount)) {
        do {
          if (*(short *)*pauVar2 == 0) break;
          pauVar2 = (undefined (*) [32])(*pauVar2 + 2);
        } while (pauVar2 != (undefined (*) [32])(_Src + _MaxCount));
      }
    }
    else if (((ulonglong)_Src & 1) == 0) {
      uVar4 = (ulonglong)((uint)_Src & 0xf);
      uVar4 = (-(ulonglong)(uVar4 != 0) & 0x10 - uVar4) >> 1;
      if (_MaxCount < uVar4) {
        uVar4 = _MaxCount;
      }
      pwVar3 = _Src;
      if (_Src != _Src + uVar4) {
        do {
          if (*pwVar3 == L'\0') break;
          pwVar3 = pwVar3 + 1;
        } while (pwVar3 != _Src + uVar4);
      }
      sVar1 = (longlong)pwVar3 - (longlong)_Src >> 1;
      if (sVar1 != uVar4) {
        return sVar1;
      }
      for (pauVar2 = (undefined (*) [32])(_Src + sVar1);
          pauVar2 != (undefined (*) [32])(_Src + (_MaxCount - uVar4 & 0xfffffffffffffff0) + sVar1);
          pauVar2 = (undefined (*) [32])(*pauVar2 + 0x10)) {
        uVar6 = -(ushort)(*(short *)(*pauVar2 + 0xe) == 0);
        auVar5 = CONCAT214(uVar6,CONCAT212(-(ushort)(*(short *)(*pauVar2 + 0xc) == 0),
                                           CONCAT210(-(ushort)(*(short *)(*pauVar2 + 10) == 0),
                                                     CONCAT28(-(ushort)(*(short *)(*pauVar2 + 8) ==
                                                                       0),
                                                              CONCAT26(-(ushort)(*(short *)(*pauVar2
                                                                                           + 6) == 0
                                                                                ),
                                                                       CONCAT24(-(ushort)(*(short *)
                                                  (*pauVar2 + 4) == 0),
                                                  CONCAT22(-(ushort)(*(short *)(*pauVar2 + 2) == 0),
                                                           -(ushort)(*(short *)*pauVar2 == 0))))))))
        ;
        if ((ushort)((ushort)(SUB161(auVar5 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar5 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar5 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar5 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar5 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar5 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar5 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar5 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar5 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar5 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar5 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar5 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar5 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar5 >> 0x6f,0) & 1) << 0xd |
                     (ushort)((byte)(uVar6 >> 7) & 1) << 0xe | uVar6 & 0x8000) != 0) break;
      }
      for (; (pauVar2 != (undefined (*) [32])(_Src + _MaxCount) && (*(short *)*pauVar2 != 0));
          pauVar2 = (undefined (*) [32])(*pauVar2 + 2)) {
      }
    }
    else if ((undefined (*) [32])_Src != (undefined (*) [32])(_Src + _MaxCount)) {
      do {
        if (*(short *)*pauVar2 == 0) break;
        pauVar2 = (undefined (*) [32])(*pauVar2 + 2);
      } while (pauVar2 != (undefined (*) [32])(_Src + _MaxCount));
    }
  }
  else if (((ulonglong)_Src & 1) == 0) {
    uVar4 = (ulonglong)((uint)_Src & 0x1f);
    uVar4 = (-(ulonglong)(uVar4 != 0) & 0x20 - uVar4) >> 1;
    if (_MaxCount < uVar4) {
      uVar4 = _MaxCount;
    }
    pwVar3 = _Src;
    if (_Src != _Src + uVar4) {
      do {
        if (*pwVar3 == L'\0') break;
        pwVar3 = pwVar3 + 1;
      } while (pwVar3 != _Src + uVar4);
    }
    sVar1 = (longlong)pwVar3 - (longlong)_Src >> 1;
    if (sVar1 != uVar4) {
      return sVar1;
    }
    for (pauVar2 = (undefined (*) [32])(_Src + sVar1);
        pauVar2 != (undefined (*) [32])(_Src + (_MaxCount - uVar4 & 0xffffffffffffffe0) + sVar1);
        pauVar2 = pauVar2[1]) {
      auVar5 = vpxor_avx(SUB3216(in_YMM1,0),SUB3216(in_YMM1,0));
      in_YMM1 = vpcmpeqw_avx2(ZEXT1632(auVar5),*pauVar2);
      vzeroupper_avx();
      if (((uint)(SUB321(in_YMM1 >> 7,0) & 1) | (uint)(SUB321(in_YMM1 >> 0xf,0) & 1) << 1 |
           (uint)(SUB321(in_YMM1 >> 0x17,0) & 1) << 2 | (uint)(SUB321(in_YMM1 >> 0x1f,0) & 1) << 3 |
           (uint)(SUB321(in_YMM1 >> 0x27,0) & 1) << 4 | (uint)(SUB321(in_YMM1 >> 0x2f,0) & 1) << 5 |
           (uint)(SUB321(in_YMM1 >> 0x37,0) & 1) << 6 | (uint)(SUB321(in_YMM1 >> 0x3f,0) & 1) << 7 |
           (uint)(SUB321(in_YMM1 >> 0x47,0) & 1) << 8 | (uint)(SUB321(in_YMM1 >> 0x4f,0) & 1) << 9 |
           (uint)(SUB321(in_YMM1 >> 0x57,0) & 1) << 10 |
           (uint)(SUB321(in_YMM1 >> 0x5f,0) & 1) << 0xb |
           (uint)(SUB321(in_YMM1 >> 0x67,0) & 1) << 0xc |
           (uint)(SUB321(in_YMM1 >> 0x6f,0) & 1) << 0xd |
           (uint)(SUB321(in_YMM1 >> 0x77,0) & 1) << 0xe | (uint)SUB321(in_YMM1 >> 0x7f,0) << 0xf |
           (uint)(SUB321(in_YMM1 >> 0x87,0) & 1) << 0x10 |
           (uint)(SUB321(in_YMM1 >> 0x8f,0) & 1) << 0x11 |
           (uint)(SUB321(in_YMM1 >> 0x97,0) & 1) << 0x12 |
           (uint)(SUB321(in_YMM1 >> 0x9f,0) & 1) << 0x13 |
           (uint)(SUB321(in_YMM1 >> 0xa7,0) & 1) << 0x14 |
           (uint)(SUB321(in_YMM1 >> 0xaf,0) & 1) << 0x15 |
           (uint)(SUB321(in_YMM1 >> 0xb7,0) & 1) << 0x16 | (uint)SUB321(in_YMM1 >> 0xbf,0) << 0x17 |
           (uint)(SUB321(in_YMM1 >> 199,0) & 1) << 0x18 |
           (uint)(SUB321(in_YMM1 >> 0xcf,0) & 1) << 0x19 |
           (uint)(SUB321(in_YMM1 >> 0xd7,0) & 1) << 0x1a |
           (uint)(SUB321(in_YMM1 >> 0xdf,0) & 1) << 0x1b |
           (uint)(SUB321(in_YMM1 >> 0xe7,0) & 1) << 0x1c |
           (uint)(SUB321(in_YMM1 >> 0xef,0) & 1) << 0x1d |
           (uint)(SUB321(in_YMM1 >> 0xf7,0) & 1) << 0x1e | (uint)SUB321(in_YMM1 >> 0xff,0) << 0x1f)
          != 0) break;
    }
    for (; (pauVar2 != (undefined (*) [32])(_Src + _MaxCount) && (*(short *)*pauVar2 != 0));
        pauVar2 = (undefined (*) [32])(*pauVar2 + 2)) {
    }
  }
  else if ((undefined (*) [32])_Src != (undefined (*) [32])(_Src + _MaxCount)) {
    do {
      if (*(short *)*pauVar2 == 0) break;
      pauVar2 = (undefined (*) [32])(*pauVar2 + 2);
    } while (pauVar2 != (undefined (*) [32])(_Src + _MaxCount));
  }
  return (longlong)pauVar2 - (longlong)_Src >> 1;
}



// Library Function - Single Match
//  strnlen
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

size_t __cdecl strnlen(char *_Str,size_t _MaxCount)

{
  undefined *puVar1;
  undefined (*pauVar2) [32];
  ulonglong uVar3;
  undefined auVar4 [16];
  undefined in_YMM1 [32];
  byte bVar5;
  
  pauVar2 = (undefined (*) [32])_Str;
  if (DAT_140038018 < 5) {
    if (DAT_140038018 < 1) {
      if ((undefined (*) [32])_Str != (undefined (*) [32])(_Str + _MaxCount)) {
        do {
          if ((*pauVar2)[0] == '\0') break;
          pauVar2 = (undefined (*) [32])(*pauVar2 + 1);
        } while (pauVar2 != (undefined (*) [32])(_Str + _MaxCount));
      }
    }
    else {
      uVar3 = (ulonglong)((uint)_Str & 0xf);
      uVar3 = -(ulonglong)(uVar3 != 0) & 0x10 - uVar3;
      if (_MaxCount < uVar3) {
        uVar3 = _MaxCount;
      }
      if ((undefined (*) [32])_Str != (undefined (*) [32])(_Str + uVar3)) {
        do {
          if ((*pauVar2)[0] == '\0') break;
          pauVar2 = (undefined (*) [32])(*pauVar2 + 1);
        } while (pauVar2 != (undefined (*) [32])(_Str + uVar3));
      }
      if ((longlong)pauVar2 - (longlong)_Str != uVar3) {
        return (longlong)pauVar2 - (longlong)_Str;
      }
      puVar1 = *pauVar2;
      while ((pauVar2 != (undefined (*) [32])(puVar1 + (_MaxCount - uVar3 & 0xfffffffffffffff0)) &&
             (bVar5 = -((*pauVar2)[0xf] == '\0'),
             auVar4 = CONCAT115(bVar5,CONCAT114(-((*pauVar2)[0xe] == '\0'),
                                                CONCAT113(-((*pauVar2)[0xd] == '\0'),
                                                          CONCAT112(-((*pauVar2)[0xc] == '\0'),
                                                                    CONCAT111(-((*pauVar2)[0xb] ==
                                                                               '\0'),CONCAT110(-((*
                                                  pauVar2)[10] == '\0'),
                                                  CONCAT19(-((*pauVar2)[9] == '\0'),
                                                           CONCAT18(-((*pauVar2)[8] == '\0'),
                                                                    CONCAT17(-((*pauVar2)[7] == '\0'
                                                                              ),CONCAT16(-((*pauVar2
                                                  )[6] == '\0'),
                                                  CONCAT15(-((*pauVar2)[5] == '\0'),
                                                           CONCAT14(-((*pauVar2)[4] == '\0'),
                                                                    CONCAT13(-((*pauVar2)[3] == '\0'
                                                                              ),CONCAT12(-((*pauVar2
                                                  )[2] == '\0'),
                                                  CONCAT11(-((*pauVar2)[1] == '\0'),
                                                           -((*pauVar2)[0] == '\0')))))))))))))))),
             (ushort)((ushort)(SUB161(auVar4 >> 7,0) & 1) |
                      (ushort)(SUB161(auVar4 >> 0xf,0) & 1) << 1 |
                      (ushort)(SUB161(auVar4 >> 0x17,0) & 1) << 2 |
                      (ushort)(SUB161(auVar4 >> 0x1f,0) & 1) << 3 |
                      (ushort)(SUB161(auVar4 >> 0x27,0) & 1) << 4 |
                      (ushort)(SUB161(auVar4 >> 0x2f,0) & 1) << 5 |
                      (ushort)(SUB161(auVar4 >> 0x37,0) & 1) << 6 |
                      (ushort)(SUB161(auVar4 >> 0x3f,0) & 1) << 7 |
                      (ushort)(SUB161(auVar4 >> 0x47,0) & 1) << 8 |
                      (ushort)(SUB161(auVar4 >> 0x4f,0) & 1) << 9 |
                      (ushort)(SUB161(auVar4 >> 0x57,0) & 1) << 10 |
                      (ushort)(SUB161(auVar4 >> 0x5f,0) & 1) << 0xb |
                      (ushort)(SUB161(auVar4 >> 0x67,0) & 1) << 0xc |
                      (ushort)(SUB161(auVar4 >> 0x6f,0) & 1) << 0xd |
                      (ushort)(SUB161(auVar4 >> 0x77,0) & 1) << 0xe | (ushort)(bVar5 >> 7) << 0xf)
             == 0))) {
        pauVar2 = (undefined (*) [32])(*pauVar2 + 0x10);
      }
      for (; (pauVar2 != (undefined (*) [32])(_Str + _MaxCount) && ((*pauVar2)[0] != '\0'));
          pauVar2 = (undefined (*) [32])(*pauVar2 + 1)) {
      }
    }
  }
  else {
    uVar3 = (ulonglong)((uint)_Str & 0x1f);
    uVar3 = -(ulonglong)(uVar3 != 0) & 0x20 - uVar3;
    if (_MaxCount < uVar3) {
      uVar3 = _MaxCount;
    }
    if ((undefined (*) [32])_Str != (undefined (*) [32])(_Str + uVar3)) {
      do {
        if ((*pauVar2)[0] == '\0') break;
        pauVar2 = (undefined (*) [32])(*pauVar2 + 1);
      } while (pauVar2 != (undefined (*) [32])(_Str + uVar3));
    }
    if ((longlong)pauVar2 - (longlong)_Str != uVar3) {
      return (longlong)pauVar2 - (longlong)_Str;
    }
    puVar1 = *pauVar2;
    for (; pauVar2 != (undefined (*) [32])(puVar1 + (_MaxCount - uVar3 & 0xffffffffffffffe0));
        pauVar2 = pauVar2[1]) {
      auVar4 = vpxor_avx(SUB3216(in_YMM1,0),SUB3216(in_YMM1,0));
      in_YMM1 = vpcmpeqb_avx2(ZEXT1632(auVar4),*pauVar2);
      vzeroupper_avx();
      if (((uint)(SUB321(in_YMM1 >> 7,0) & 1) | (uint)(SUB321(in_YMM1 >> 0xf,0) & 1) << 1 |
           (uint)(SUB321(in_YMM1 >> 0x17,0) & 1) << 2 | (uint)(SUB321(in_YMM1 >> 0x1f,0) & 1) << 3 |
           (uint)(SUB321(in_YMM1 >> 0x27,0) & 1) << 4 | (uint)(SUB321(in_YMM1 >> 0x2f,0) & 1) << 5 |
           (uint)(SUB321(in_YMM1 >> 0x37,0) & 1) << 6 | (uint)(SUB321(in_YMM1 >> 0x3f,0) & 1) << 7 |
           (uint)(SUB321(in_YMM1 >> 0x47,0) & 1) << 8 | (uint)(SUB321(in_YMM1 >> 0x4f,0) & 1) << 9 |
           (uint)(SUB321(in_YMM1 >> 0x57,0) & 1) << 10 |
           (uint)(SUB321(in_YMM1 >> 0x5f,0) & 1) << 0xb |
           (uint)(SUB321(in_YMM1 >> 0x67,0) & 1) << 0xc |
           (uint)(SUB321(in_YMM1 >> 0x6f,0) & 1) << 0xd |
           (uint)(SUB321(in_YMM1 >> 0x77,0) & 1) << 0xe | (uint)SUB321(in_YMM1 >> 0x7f,0) << 0xf |
           (uint)(SUB321(in_YMM1 >> 0x87,0) & 1) << 0x10 |
           (uint)(SUB321(in_YMM1 >> 0x8f,0) & 1) << 0x11 |
           (uint)(SUB321(in_YMM1 >> 0x97,0) & 1) << 0x12 |
           (uint)(SUB321(in_YMM1 >> 0x9f,0) & 1) << 0x13 |
           (uint)(SUB321(in_YMM1 >> 0xa7,0) & 1) << 0x14 |
           (uint)(SUB321(in_YMM1 >> 0xaf,0) & 1) << 0x15 |
           (uint)(SUB321(in_YMM1 >> 0xb7,0) & 1) << 0x16 | (uint)SUB321(in_YMM1 >> 0xbf,0) << 0x17 |
           (uint)(SUB321(in_YMM1 >> 199,0) & 1) << 0x18 |
           (uint)(SUB321(in_YMM1 >> 0xcf,0) & 1) << 0x19 |
           (uint)(SUB321(in_YMM1 >> 0xd7,0) & 1) << 0x1a |
           (uint)(SUB321(in_YMM1 >> 0xdf,0) & 1) << 0x1b |
           (uint)(SUB321(in_YMM1 >> 0xe7,0) & 1) << 0x1c |
           (uint)(SUB321(in_YMM1 >> 0xef,0) & 1) << 0x1d |
           (uint)(SUB321(in_YMM1 >> 0xf7,0) & 1) << 0x1e | (uint)SUB321(in_YMM1 >> 0xff,0) << 0x1f)
          != 0) break;
    }
    for (; (pauVar2 != (undefined (*) [32])(_Str + _MaxCount) && ((*pauVar2)[0] != '\0'));
        pauVar2 = (undefined (*) [32])(*pauVar2 + 1)) {
    }
  }
  return (longlong)pauVar2 - (longlong)_Str;
}



// Library Function - Single Match
//  wcsncat
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

wchar_t * __cdecl wcsncat(wchar_t *_Dest,wchar_t *_Source,size_t _Count)

{
  wchar_t wVar1;
  size_t sVar2;
  wchar_t *pwVar3;
  longlong lVar4;
  
  sVar2 = 0;
  wVar1 = *_Dest;
  pwVar3 = _Dest;
  while (wVar1 != L'\0') {
    pwVar3 = pwVar3 + 1;
    wVar1 = *pwVar3;
  }
  if (_Count != 0) {
    lVar4 = (longlong)_Source - (longlong)pwVar3;
    do {
      wVar1 = *(wchar_t *)(lVar4 + (longlong)pwVar3);
      *pwVar3 = wVar1;
      pwVar3 = pwVar3 + 1;
      if (wVar1 == L'\0') {
        return _Dest;
      }
      sVar2 = sVar2 + 1;
    } while (sVar2 != _Count);
  }
  *pwVar3 = L'\0';
  return _Dest;
}



// Library Function - Single Match
//  wcsncmp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl wcsncmp(wchar_t *_Str1,wchar_t *_Str2,size_t _MaxCount)

{
  if (_MaxCount == 0) {
    return 0;
  }
  for (; ((_MaxCount = _MaxCount - 1, _MaxCount != 0 && (*_Str1 != L'\0')) && (*_Str1 == *_Str2));
      _Str1 = _Str1 + 1) {
    _Str2 = _Str2 + 1;
  }
  return (uint)(ushort)*_Str1 - (uint)(ushort)*_Str2;
}



short * FUN_14001530c(short *param_1,short *param_2,short **param_3)

{
  ulong *puVar1;
  short *psVar2;
  short *psVar3;
  short sVar4;
  
  if (((param_3 == (short **)0x0) || (param_2 == (short *)0x0)) ||
     ((param_1 == (short *)0x0 && (*param_3 == (short *)0x0)))) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    return (short *)0x0;
  }
  if (param_1 == (short *)0x0) {
    param_1 = *param_3;
  }
  while ((*param_1 != 0 && (sVar4 = *param_2, psVar2 = param_2, sVar4 != 0))) {
    do {
      if (sVar4 == *param_1) break;
      sVar4 = psVar2[1];
      psVar2 = psVar2 + 1;
    } while (sVar4 != 0);
    if (sVar4 == 0) break;
    param_1 = param_1 + 1;
  }
  sVar4 = *param_1;
  psVar2 = param_1;
  do {
    psVar3 = psVar2;
    if (sVar4 == 0) {
LAB_1400153e7:
      *param_3 = psVar3;
      psVar2 = (short *)0x0;
      if (psVar3 != param_1) {
        psVar2 = param_1;
      }
      return psVar2;
    }
    sVar4 = *param_2;
    psVar3 = param_2;
    while ((sVar4 != 0 && (sVar4 != *psVar2))) {
      psVar3 = psVar3 + 1;
      sVar4 = *psVar3;
    }
    psVar3 = psVar2 + 1;
    if (sVar4 != 0) {
      *psVar2 = 0;
      goto LAB_1400153e7;
    }
    sVar4 = *psVar3;
    psVar2 = psVar3;
  } while( true );
}



// Library Function - Single Match
//  _ValidateImageBase
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

BOOL __cdecl _ValidateImageBase(PBYTE pImageBase)

{
  if (((*(short *)pImageBase == 0x5a4d) &&
      (*(int *)(pImageBase + *(int *)(pImageBase + 0x3c)) == 0x4550)) &&
     (*(short *)((longlong)(pImageBase + *(int *)(pImageBase + 0x3c)) + 0x18) == 0x20b)) {
    return 1;
  }
  return 0;
}



// Library Function - Single Match
//  _FindPESection
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

PIMAGE_SECTION_HEADER __cdecl _FindPESection(PBYTE pImageBase,DWORD_PTR rva)

{
  int iVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  uint uVar3;
  
  iVar1 = *(int *)(pImageBase + 0x3c);
  uVar3 = 0;
  p_Var2 = (PIMAGE_SECTION_HEADER)
           (pImageBase +
           (ulonglong)*(ushort *)(pImageBase + (longlong)iVar1 + 0x14) + 0x18 + (longlong)iVar1);
  if (*(ushort *)(pImageBase + (longlong)iVar1 + 6) != 0) {
    do {
      if ((p_Var2->VirtualAddress <= rva) &&
         (rva < (p_Var2->Misc).PhysicalAddress + p_Var2->VirtualAddress)) {
        return p_Var2;
      }
      uVar3 = uVar3 + 1;
      p_Var2 = p_Var2 + 1;
    } while (uVar3 < *(ushort *)(pImageBase + (longlong)iVar1 + 6));
  }
  return (PIMAGE_SECTION_HEADER)0x0;
}



// Library Function - Single Match
//  _IsNonwritableInCurrentImage
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

BOOL __cdecl _IsNonwritableInCurrentImage(PBYTE pTarget)

{
  uint uVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  
  uVar1 = _ValidateImageBase((PBYTE)&IMAGE_DOS_HEADER_140000000);
  p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)uVar1;
  if (uVar1 != 0) {
    p_Var2 = _FindPESection((PBYTE)&IMAGE_DOS_HEADER_140000000,(DWORD_PTR)(pTarget + -0x140000000));
    if (p_Var2 != (PIMAGE_SECTION_HEADER)0x0) {
      p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)(~(p_Var2->Characteristics >> 0x1f) & 1);
    }
  }
  return (BOOL)p_Var2;
}



// Library Function - Single Match
//  _NLG_Notify
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void _NLG_Notify(void)

{
  FUN_140015500();
  return;
}



void FUN_140015500(void)

{
  return;
}



void FUN_140015510(void)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x000140015527)
// WARNING: Removing unreachable block (ram,0x00014001553d)
// WARNING: Removing unreachable block (ram,0x000140015543)
// Library Function - Single Match
//  __except_validate_context_record
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __except_validate_context_record(longlong param_1)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __vcrt_initialize_ptd
// 
// Library: Visual Studio 2017 Release

ulonglong __vcrt_initialize_ptd(void)

{
  int iVar1;
  ulonglong uVar2;
  
  uVar2 = __vcrt_FlsAlloc(FUN_1400156b0);
  DAT_140038150 = (DWORD)uVar2;
  if (DAT_140038150 != 0xffffffff) {
    iVar1 = __vcrt_FlsSetValue(DAT_140038150,&DAT_1400390a0);
    if (iVar1 != 0) {
      _DAT_140039118 = 0xfffffffe;
      _DAT_140039120 = 0xfffffffffffffffe;
      return 0xffffffffffffff01;
    }
    uVar2 = __vcrt_uninitialize_ptd();
  }
  return uVar2 & 0xffffffffffffff00;
}



// Library Function - Single Match
//  __vcrt_uninitialize_ptd
// 
// Library: Visual Studio 2017 Release

undefined __vcrt_uninitialize_ptd(void)

{
  if (DAT_140038150 != -1) {
    __vcrt_FlsFree(DAT_140038150);
    DAT_140038150 = -1;
  }
  return 1;
}



// Library Function - Single Match
//  __vcrt_getptd
// 
// Library: Visual Studio 2017 Release

void __vcrt_getptd(void)

{
  code *pcVar1;
  LPVOID pvVar2;
  
  pvVar2 = __vcrt_getptd_noexit();
  if (pvVar2 != (LPVOID)0x0) {
    return;
  }
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// Library Function - Single Match
//  __vcrt_getptd_noexit
// 
// Library: Visual Studio 2017 Release

LPVOID __vcrt_getptd_noexit(void)

{
  DWORD dwErrCode;
  int iVar1;
  LPVOID pvVar2;
  LPVOID pvVar3;
  LPVOID pvVar4;
  
  if (DAT_140038150 == 0xffffffff) {
    pvVar3 = (LPVOID)0x0;
  }
  else {
    dwErrCode = GetLastError();
    pvVar2 = (LPVOID)__vcrt_FlsGetValue(DAT_140038150);
    pvVar4 = (LPVOID)0x0;
    pvVar3 = pvVar4;
    if (((pvVar2 != (LPVOID)0xffffffffffffffff) && (pvVar3 = pvVar2, pvVar2 == (LPVOID)0x0)) &&
       (iVar1 = __vcrt_FlsSetValue(DAT_140038150,(LPVOID)0xffffffffffffffff), pvVar3 = pvVar4,
       iVar1 != 0)) {
      pvVar3 = _calloc_base(1,0x90);
      if ((pvVar3 == (LPVOID)0x0) || (iVar1 = __vcrt_FlsSetValue(DAT_140038150,pvVar3), iVar1 == 0))
      {
        __vcrt_FlsSetValue(DAT_140038150,(LPVOID)0x0);
        pvVar2 = pvVar3;
      }
      else {
        *(undefined4 *)((longlong)pvVar3 + 0x78) = 0xfffffffe;
        *(undefined8 *)((longlong)pvVar3 + 0x80) = 0xfffffffffffffffe;
        pvVar2 = pvVar4;
        pvVar4 = pvVar3;
      }
      FUN_140013ed8(pvVar2);
      pvVar3 = pvVar4;
    }
    SetLastError(dwErrCode);
  }
  return pvVar3;
}



void FUN_1400156b0(undefined *param_1)

{
  if ((param_1 != (undefined *)0x0) && (param_1 != &DAT_1400390a0)) {
    FUN_140013ed8(param_1);
  }
  return;
}



void FUN_1400156d0(_s_FuncInfo *param_1,__uint64 *param_2)

{
  __FrameHandler3::StateFromIp(param_1,(_xDISPATCHER_CONTEXT *)param_2,*param_2);
  return;
}



// Library Function - Single Match
//  public: static int __cdecl __FrameHandler3::StateFromIp(struct _s_FuncInfo const *
// __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,unsigned __int64)
// 
// Library: Visual Studio 2017 Release

int __cdecl
__FrameHandler3::StateFromIp(_s_FuncInfo *param_1,_xDISPATCHER_CONTEXT *param_2,__uint64 param_3)

{
  longlong lVar1;
  code *pcVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  
  if (param_1 != (_s_FuncInfo *)0x0) {
    lVar6 = (longlong)(int)param_1->dispIPToStateMap;
    lVar1 = *(longlong *)(param_2 + 8);
    if (lVar6 + lVar1 != 0) {
      uVar5 = 0;
      if (param_1->nIPMapEntries != 0) {
        do {
          if (param_3 < (ulonglong)*(uint *)(lVar6 + uVar5 * 8 + lVar1) + lVar1) break;
          uVar4 = (int)uVar5 + 1;
          uVar5 = (ulonglong)uVar4;
        } while (uVar4 < param_1->nIPMapEntries);
        if ((int)uVar5 != 0) {
          return *(int *)(lVar6 + (ulonglong)((int)uVar5 - 1) * 8 + 4 + lVar1);
        }
      }
      return -1;
    }
  }
  terminate((ushort *)param_1,(ushort *)param_2);
  pcVar2 = (code *)swi(3);
  iVar3 = (*pcVar2)();
  return iVar3;
}



// Library Function - Single Match
//  public: static int __cdecl __FrameHandler3::GetCurrentState(unsigned __int64 * __ptr64,struct
// _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2017 Release

int __cdecl
__FrameHandler3::GetCurrentState
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  
  iVar1 = *(int *)((longlong)param_3->dispUnwindHelp + *param_1);
  if (iVar1 == -2) {
    iVar1 = StateFromIp(param_3,param_2,*(__uint64 *)param_2);
  }
  return iVar1;
}



// Library Function - Single Match
//  public: static void __cdecl __FrameHandler3::SetState(unsigned __int64 * __ptr64,struct
// _s_FuncInfo const * __ptr64,int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl __FrameHandler3::SetState(__uint64 *param_1,_s_FuncInfo *param_2,int param_3)

{
  *(int *)((longlong)param_2->dispUnwindHelp + *param_1) = param_3;
  return;
}



// Library Function - Single Match
//  public: static void __cdecl __FrameHandler3::SetUnwindTryBlock(unsigned __int64 * __ptr64,struct
// _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64,int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl
__FrameHandler3::SetUnwindTryBlock
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,int param_4)

{
  __uint64 *p_Var1;
  __uint64 local_res18 [2];
  
  p_Var1 = GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  if (*(int *)((longlong)param_3->dispUnwindHelp + 4 + *p_Var1) < param_4) {
    *(int *)((longlong)param_3->dispUnwindHelp + 4 + *p_Var1) = param_4;
  }
  return;
}



// Library Function - Single Match
//  public: static int __cdecl __FrameHandler3::GetUnwindTryBlock(unsigned __int64 * __ptr64,struct
// _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl
__FrameHandler3::GetUnwindTryBlock
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  __uint64 *p_Var1;
  __uint64 local_res18 [2];
  
  p_Var1 = GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  return *(int *)((longlong)param_3->dispUnwindHelp + 4 + *p_Var1);
}



void FUN_1400157dc(__uint64 *param_1,__uint64 *param_2,_s_FuncInfo *param_3,int param_4)

{
  code *pcVar1;
  int iVar2;
  __uint64 *p_Var3;
  longlong lVar4;
  longlong lVar5;
  __uint64 *p_Var6;
  longlong lVar7;
  
  p_Var3 = (__uint64 *)_GetImageBase();
  p_Var6 = param_1;
  iVar2 = __FrameHandler3::GetCurrentState(param_1,(_xDISPATCHER_CONTEXT *)param_2,param_3);
  lVar4 = __vcrt_getptd();
  *(int *)(lVar4 + 0x30) = *(int *)(lVar4 + 0x30) + 1;
  do {
    if ((iVar2 == -1) || (iVar2 <= param_4)) {
      lVar4 = __vcrt_getptd();
      if (0 < *(int *)(lVar4 + 0x30)) {
        lVar4 = __vcrt_getptd();
        *(int *)(lVar4 + 0x30) = *(int *)(lVar4 + 0x30) + -1;
      }
      if ((iVar2 == -1) || (iVar2 <= param_4)) {
        __FrameHandler3::SetState(param_1,param_3,iVar2);
        return;
      }
LAB_140015969:
      terminate((ushort *)p_Var6,(ushort *)param_2);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    if ((iVar2 < 0) || (param_3->maxState <= iVar2)) {
      terminate((ushort *)p_Var6,(ushort *)param_2);
      goto LAB_140015969;
    }
    lVar4 = _GetImageBase();
    lVar7 = (longlong)iVar2 * 8;
    iVar2 = *(int *)((int)param_3->dispUnwindMap + lVar7 + lVar4);
    lVar4 = _GetImageBase();
    p_Var6 = (__uint64 *)((int)param_3->dispUnwindMap + lVar7);
    if (*(int *)((longlong)p_Var6 + lVar4 + 4) == 0) {
      lVar4 = 0;
    }
    else {
      lVar5 = _GetImageBase();
      lVar4 = _GetImageBase();
      p_Var6 = (__uint64 *)(longlong)*(int *)((int)param_3->dispUnwindMap + lVar7 + 4 + lVar5);
      lVar4 = lVar4 + (longlong)p_Var6;
    }
    if (lVar4 != 0) {
      __FrameHandler3::SetState(param_1,param_3,iVar2);
      lVar4 = _GetImageBase();
      if (*(int *)((int)param_3->dispUnwindMap + lVar7 + 4 + lVar4) != 0) {
        _GetImageBase();
        _GetImageBase();
      }
      param_2 = param_1;
      _CallSettingFrame();
      p_Var6 = p_Var3;
      FUN_14000c920(p_Var3);
    }
  } while( true );
}



// Library Function - Single Match
//  public: static int __cdecl __FrameHandler3::GetHandlerSearchState(unsigned __int64 *
// __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl
__FrameHandler3::GetHandlerSearchState
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  int iVar2;
  __uint64 local_res20;
  
  iVar1 = FUN_1400156d0(param_3,(__uint64 *)param_2);
  GetEstablisherFrame(param_1,param_2,param_3,&local_res20);
  iVar2 = GetUnwindTryBlock(param_1,param_2,param_3);
  if (iVar2 < iVar1) {
    SetState(&local_res20,param_3,iVar1);
    SetUnwindTryBlock(param_1,param_2,param_3,iVar1);
  }
  else {
    iVar1 = GetUnwindTryBlock(param_1,param_2,param_3);
  }
  return iVar1;
}



// Library Function - Single Match
//  public: static void * __ptr64 __cdecl __FrameHandler3::CxxCallCatchBlock(struct
// _EXCEPTION_RECORD * __ptr64)
// 
// Library: Visual Studio 2017 Release

void * __cdecl __FrameHandler3::CxxCallCatchBlock(_EXCEPTION_RECORD *param_1)

{
  undefined8 uVar1;
  undefined8 uVar2;
  int *piVar3;
  ULONG_PTR UVar4;
  ULONG_PTR UVar5;
  longlong *plVar6;
  int iVar7;
  longlong lVar8;
  undefined8 *puVar9;
  void *pvVar10;
  longlong *plVar11;
  undefined8 local_48 [2];
  
  lVar8 = __vcrt_getptd();
  uVar1 = *(undefined8 *)(lVar8 + 0x28);
  lVar8 = __vcrt_getptd();
  uVar2 = *(undefined8 *)(lVar8 + 0x20);
  piVar3 = (int *)param_1->ExceptionInformation[6];
  UVar4 = param_1->ExceptionInformation[5];
  UVar5 = param_1->ExceptionInformation[4];
  plVar6 = (longlong *)param_1->ExceptionInformation[1];
  __except_validate_context_record(UVar5);
  lVar8 = __vcrt_getptd();
  *(int **)(lVar8 + 0x20) = piVar3;
  lVar8 = __vcrt_getptd();
  *(ULONG_PTR *)(lVar8 + 0x28) = UVar5;
  lVar8 = __vcrt_getptd();
  puVar9 = _CreateFrameInfo(local_48,*(undefined8 *)(*(longlong *)(lVar8 + 0x20) + 0x28));
  if (param_1->ExceptionInformation[7] != 0) {
    __vcrt_getptd();
  }
  plVar11 = plVar6;
  pvVar10 = (void *)_CallSettingFrame();
  _FindAndUnlinkFrame((ushort *)puVar9,(ushort *)plVar11);
  if ((((*piVar3 == -0x1f928c9d) && (piVar3[6] == 4)) && (piVar3[8] + 0xe66cfae0U < 3)) &&
     (iVar7 = _IsExceptionObjectToBeDestroyed(*(longlong *)(piVar3 + 10)), iVar7 != 0)) {
    __DestructExceptionObject(piVar3);
  }
  lVar8 = __vcrt_getptd();
  *(undefined8 *)(lVar8 + 0x20) = uVar2;
  lVar8 = __vcrt_getptd();
  *(undefined8 *)(lVar8 + 0x28) = uVar1;
  *(undefined8 *)((longlong)*(int *)(UVar4 + 0x1c) + *plVar6) = 0xfffffffffffffffe;
  return pvVar10;
}



void FUN_140015bfc(undefined8 param_1,undefined *UNRECOVERED_JUMPTABLE,undefined8 param_3)

{
                    // WARNING: Could not recover jumptable at 0x000140015c02. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)UNRECOVERED_JUMPTABLE)(param_1,param_3);
  return;
}



// Library Function - Single Match
//  void __cdecl _CallMemberFunction2(void * __ptr64 const,void * __ptr64 const,void * __ptr64
// const,int)
// 
// Library: Visual Studio 2017 Release

void __cdecl _CallMemberFunction2(void *param_1,void *param_2,void *param_3,int param_4)

{
                    // WARNING: Could not recover jumptable at 0x000140015c14. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)param_2)(param_1,param_3,param_4);
  return;
}



undefined8 * FUN_140015c18(undefined8 *param_1)

{
  param_1[2] = 0;
  param_1[1] = "bad exception";
  *param_1 = std::bad_exception::vftable;
  return param_1;
}



// Library Function - Single Match
//  int __cdecl ExFilterRethrow(struct _EXCEPTION_POINTERS * __ptr64,struct EHExceptionRecord *
// __ptr64,int * __ptr64)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl ExFilterRethrow(_EXCEPTION_POINTERS *param_1,EHExceptionRecord *param_2,int *param_3)

{
  PEXCEPTION_RECORD pEVar1;
  int iVar2;
  longlong lVar3;
  
  pEVar1 = param_1->ExceptionRecord;
  *param_3 = 0;
  if (((((pEVar1->ExceptionCode == 0xe06d7363) && (pEVar1->NumberParameters == 4)) &&
       ((2 < *(int *)pEVar1->ExceptionInformation + 0xe66cfae0U ||
        ((pEVar1->ExceptionInformation[1] != *(ULONG_PTR *)(param_2 + 0x28) ||
         (*param_3 = 1, pEVar1->ExceptionCode == 0xe06d7363)))))) && (pEVar1->NumberParameters == 4)
      ) && ((*(int *)pEVar1->ExceptionInformation + 0xe66cfae0U < 3 &&
            (pEVar1->ExceptionInformation[2] == 0)))) {
    lVar3 = __vcrt_getptd();
    *(undefined4 *)(lVar3 + 0x40) = 1;
    iVar2 = 1;
    *param_3 = 1;
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



ulonglong FUN_140015d00(ushort *param_1,int *param_2)

{
  int iVar1;
  code *pcVar2;
  ulonglong in_RAX;
  longlong lVar3;
  longlong lVar4;
  ulonglong uVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  byte bVar9;
  byte bVar10;
  
  if (param_2 == (int *)0x0) {
    terminate(param_1,(ushort *)0x0);
    pcVar2 = (code *)swi(3);
    uVar5 = (*pcVar2)();
    return uVar5;
  }
  bVar9 = 0;
  iVar7 = 0;
  bVar10 = 0;
  if (0 < *param_2) {
    do {
      lVar3 = _GetThrowImageBase();
      piVar8 = (int *)((longlong)*(int *)(*(longlong *)(param_1 + 0x18) + 0xc) + 4 + lVar3);
      lVar3 = _GetThrowImageBase();
      in_RAX = *(ulonglong *)(param_1 + 0x18);
      iVar6 = *(int *)(lVar3 + *(int *)(in_RAX + 0xc));
      bVar9 = bVar10;
      if (0 < iVar6) {
        do {
          lVar3 = _GetThrowImageBase();
          iVar1 = *piVar8;
          lVar4 = _GetImageBase();
          in_RAX = TypeMatchHelper__((byte *)((longlong)param_2[1] + (longlong)iVar7 * 0x14 + lVar4)
                                     ,(byte *)(lVar3 + iVar1),*(byte **)(param_1 + 0x18));
          if ((int)in_RAX != 0) {
            bVar9 = 1;
            break;
          }
          iVar6 = iVar6 + -1;
          piVar8 = piVar8 + 1;
        } while (0 < iVar6);
      }
      iVar7 = iVar7 + 1;
      bVar10 = bVar9;
    } while (iVar7 < *param_2);
  }
  return in_RAX & 0xffffffffffffff00 | (ulonglong)bVar9;
}



// Library Function - Single Match
//  unsigned char __cdecl Is_bad_exception_allowed(struct _s_ESTypeList const * __ptr64)
// 
// Library: Visual Studio 2017 Release

uchar __cdecl Is_bad_exception_allowed(_s_ESTypeList *param_1)

{
  uint uVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  longlong lVar5;
  
  iVar4 = 0;
  if (0 < *(int *)param_1) {
    lVar5 = 0;
    do {
      lVar2 = _GetImageBase();
      if (*(int *)(*(int *)(param_1 + 4) + lVar5 + 4 + lVar2) == 0) {
        lVar2 = 0;
      }
      else {
        lVar3 = _GetImageBase();
        lVar2 = _GetImageBase();
        lVar2 = lVar2 + *(int *)(*(int *)(param_1 + 4) + lVar5 + 4 + lVar3);
      }
      uVar1 = __std_type_info_compare(lVar2 + 8,0x140038cb8);
      if (uVar1 == 0) {
        return '\x01';
      }
      iVar4 = iVar4 + 1;
      lVar5 = lVar5 + 0x14;
    } while (iVar4 < *(int *)param_1);
  }
  return '\0';
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8
FUN_140015e6c(_s_FuncInfo *param_1,_s_FuncInfo *param_2,_CONTEXT *param_3,_s_FuncInfo *param_4,
             _s_FuncInfo *param_5,int param_6,__uint64 *param_7,byte param_8)

{
  int iVar1;
  longlong lVar2;
  undefined8 uVar3;
  _s_FuncInfo *p_Var4;
  _s_FuncInfo *p_Var5;
  code *pcVar6;
  undefined8 in_stack_ffffffffffffffe0;
  undefined4 uVar7;
  
  uVar7 = (undefined4)((ulonglong)in_stack_ffffffffffffffe0 >> 0x20);
  __except_validate_context_record((longlong)param_3);
  lVar2 = __vcrt_getptd();
  p_Var5 = (_s_FuncInfo *)0x80000029;
  p_Var4 = (_s_FuncInfo *)0x19930522;
  if ((*(int *)(lVar2 + 0x40) == 0) && (param_1->magicNumber_and_bbtFlags != 0xe06d7363)) {
    if (param_1->magicNumber_and_bbtFlags == 0x80000029) {
      if (param_1->dispIPToStateMap == 0xf) {
        if (*(longlong *)&param_1[2].dispTryBlockMap == 0x19930520) goto LAB_140015ef2;
        goto LAB_140015ed8;
      }
    }
    else {
LAB_140015ed8:
      if (param_1->magicNumber_and_bbtFlags == 0x80000026) goto LAB_140015ef2;
    }
    if ((0x19930521 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff)) &&
       ((*(byte *)&param_5->EHFlags & 1) != 0)) {
      return 1;
    }
  }
LAB_140015ef2:
  if ((*(byte *)&param_1->maxState & 0x66) != 0) {
    if (param_5->maxState == 0) {
      return 1;
    }
    if (param_6 != 0) {
      return 1;
    }
    if ((*(byte *)&param_1->maxState & 0x20) != 0) {
      if (param_1->magicNumber_and_bbtFlags == 0x80000026) {
        p_Var4 = param_5;
        p_Var5 = param_4;
        iVar1 = __FrameHandler3::StateFromIp
                          (param_5,(_xDISPATCHER_CONTEXT *)param_4,
                           *(__uint64 *)&param_4->dispESTypeList);
        if ((iVar1 < -1) || (param_5->maxState <= iVar1)) {
LAB_1400160ac:
          terminate((ushort *)p_Var4,(ushort *)p_Var5);
          pcVar6 = (code *)swi(3);
          uVar3 = (*pcVar6)();
          return uVar3;
        }
      }
      else {
        if (param_1->magicNumber_and_bbtFlags != 0x80000029) goto LAB_140015f78;
        iVar1 = param_1[1].dispTryBlockMap;
        if ((iVar1 < -1) || (param_5->maxState <= iVar1)) goto LAB_1400160ac;
        param_2 = *(_s_FuncInfo **)(param_1 + 1);
      }
      FUN_1400157dc((__uint64 *)param_2,(__uint64 *)param_4,param_5,iVar1);
      return 1;
    }
LAB_140015f78:
    __FrameHandler3::FrameUnwindToEmptyState
              ((__uint64 *)param_2,(_xDISPATCHER_CONTEXT *)param_4,param_5);
    return 1;
  }
  if (param_5->nTryBlocks == 0) {
    if (0x19930520 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff)) {
      if (param_5->dispESTypeList == 0) {
        lVar2 = 0;
      }
      else {
        lVar2 = _GetImageBase();
        lVar2 = lVar2 + (int)param_5->dispESTypeList;
      }
      if (lVar2 != 0) goto LAB_140015fdc;
    }
    if ((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930522) {
      return 1;
    }
    if (((uint)param_5->EHFlags >> 2 & 1) == 0) {
      return 1;
    }
  }
LAB_140015fdc:
  if (((param_1->magicNumber_and_bbtFlags == 0xe06d7363) && (2 < (uint)param_1->dispIPToStateMap))
     && (0x19930522 < (uint)param_1->dispESTypeList)) {
    if (*(int *)(*(longlong *)&param_1[1].dispUnwindMap + 8) == 0) {
      pcVar6 = (code *)0x0;
    }
    else {
      lVar2 = _GetThrowImageBase();
      pcVar6 = (code *)(*(int *)(*(longlong *)&param_1[1].dispUnwindMap + 8) + lVar2);
    }
    if (pcVar6 != (code *)0x0) {
      uVar3 = (*pcVar6)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,
                        CONCAT44(uVar7,(uint)param_8));
      return uVar3;
    }
  }
  FUN_1400164b8(param_1,param_2,param_3,param_4,param_5,param_8,param_6,param_7);
  return 1;
}



// Library Function - Multiple Matches With Same Base Name
//  int __cdecl TypeMatchHelper<struct _s_HandlerType const >(struct _s_HandlerType const *
// __ptr64,struct _s_CatchableType const * __ptr64,struct _s_ThrowInfo const * __ptr64)
//  int __cdecl TypeMatchHelper<class __FrameHandler3>(struct _s_HandlerType const * __ptr64,struct
// _s_CatchableType const * __ptr64,struct _s_ThrowInfo const * __ptr64)
// 
// Library: Visual Studio 2017 Release

undefined8 TypeMatchHelper__(byte *param_1,byte *param_2,byte *param_3)

{
  char cVar1;
  char cVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  char *pcVar6;
  int iVar7;
  int iVar8;
  
  lVar5 = 0;
  iVar7 = 0;
  lVar3 = lVar5;
  iVar8 = iVar7;
  if (*(int *)(param_1 + 4) != 0) {
    iVar8 = *(int *)(param_1 + 4);
    lVar3 = _GetImageBase();
    lVar3 = iVar8 + lVar3;
  }
  if (lVar3 != 0) {
    lVar3 = lVar5;
    if (iVar8 != 0) {
      iVar7 = *(int *)(param_1 + 4);
      lVar3 = _GetImageBase();
      lVar3 = iVar7 + lVar3;
    }
    if ((*(char *)(lVar3 + 0x10) != '\0') && (((*param_1 & 0x80) == 0 || ((*param_2 & 0x10) == 0))))
    {
      lVar3 = lVar5;
      if (iVar7 != 0) {
        lVar3 = _GetImageBase();
        lVar3 = lVar3 + *(int *)(param_1 + 4);
      }
      lVar4 = _GetThrowImageBase();
      if (lVar3 != lVar4 + *(int *)(param_2 + 4)) {
        if (*(int *)(param_1 + 4) != 0) {
          lVar5 = _GetImageBase();
          lVar5 = lVar5 + *(int *)(param_1 + 4);
        }
        lVar3 = _GetThrowImageBase();
        pcVar6 = (char *)(lVar5 + 0x10);
        lVar3 = ((longlong)*(int *)(param_2 + 4) + 0x10 + lVar3) - (longlong)pcVar6;
        do {
          cVar1 = *pcVar6;
          cVar2 = pcVar6[lVar3];
          if (cVar1 != cVar2) break;
          pcVar6 = pcVar6 + 1;
        } while (cVar2 != '\0');
        if (cVar1 != cVar2) {
          return 0;
        }
      }
      if (((*param_2 & 2) != 0) && ((*param_1 & 8) == 0)) {
        return 0;
      }
      if (((*param_3 & 1) != 0) && ((*param_1 & 1) == 0)) {
        return 0;
      }
      if (((*param_3 & 4) != 0) && ((*param_1 & 4) == 0)) {
        return 0;
      }
      if (((*param_3 & 2) != 0) && ((*param_1 & 2) == 0)) {
        return 0;
      }
      return 1;
    }
  }
  return 1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_1400161f8(longlong param_1,longlong *param_2,int *param_3,byte *param_4)

{
  code *pcVar1;
  longlong lVar2;
  undefined8 *puVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  int iVar7;
  int iVar8;
  
  puVar6 = (undefined8 *)0x0;
  iVar7 = 0;
  puVar3 = puVar6;
  iVar8 = iVar7;
  if (param_3[1] != 0) {
    iVar8 = param_3[1];
    lVar2 = _GetImageBase();
    puVar3 = (undefined8 *)(iVar8 + lVar2);
  }
  if (puVar3 == (undefined8 *)0x0) {
    return 0;
  }
  puVar5 = puVar6;
  if (iVar8 != 0) {
    lVar2 = _GetImageBase();
    puVar5 = (undefined8 *)(lVar2 + param_3[1]);
  }
  if (*(char *)(puVar5 + 2) == '\0') {
    return 0;
  }
  if ((param_3[2] == 0) && (-1 < *param_3)) {
    return 0;
  }
  if (-1 < *param_3) {
    param_2 = (longlong *)((longlong)param_3[2] + *param_2);
  }
  if ((((*(byte *)param_3 & 0x80) == 0) || ((*param_4 & 0x10) == 0)) || (DAT_140038db0 == 0)) {
    if ((*(byte *)param_3 & 8) != 0) {
      puVar6 = *(undefined8 **)(param_1 + 0x28);
      if ((puVar6 != (undefined8 *)0x0) && (param_2 != (longlong *)0x0)) {
        *param_2 = (longlong)puVar6;
        goto LAB_140016317;
      }
      goto LAB_1400163da;
    }
    if ((*param_4 & 1) != 0) {
      puVar3 = *(undefined8 **)(param_1 + 0x28);
      if ((puVar3 != (undefined8 *)0x0) && (param_2 != (longlong *)0x0)) {
        FUN_14001b140(param_2,puVar3,(longlong)*(int *)(param_4 + 0x14));
        if (*(int *)(param_4 + 0x14) != 8) {
          return 0;
        }
        if (*param_2 == 0) {
          return 0;
        }
        puVar6 = (undefined8 *)*param_2;
        goto LAB_140016317;
      }
      goto LAB_1400163df;
    }
    puVar5 = puVar6;
    if (*(int *)(param_4 + 0x18) != 0) {
      iVar7 = *(int *)(param_4 + 0x18);
      lVar2 = _GetThrowImageBase();
      puVar5 = (undefined8 *)(iVar7 + lVar2);
    }
    if (puVar5 != (undefined8 *)0x0) {
      if ((*(longlong *)(param_1 + 0x28) != 0) && (param_2 != (longlong *)0x0)) {
        if (iVar7 != 0) {
          lVar2 = _GetThrowImageBase();
          puVar6 = (undefined8 *)(lVar2 + *(int *)(param_4 + 0x18));
        }
        puVar5 = puVar6;
        if (puVar6 != (undefined8 *)0x0) {
          return (ulonglong)(((*param_4 & 4) != 0) + 1);
        }
      }
      goto LAB_1400163e9;
    }
    puVar5 = *(undefined8 **)(param_1 + 0x28);
    if ((puVar5 != (undefined8 *)0x0) && (param_2 != (longlong *)0x0)) {
      iVar8 = *(int *)(param_4 + 0x14);
      puVar3 = (undefined8 *)__AdjustPointer((longlong)puVar5,(int *)(param_4 + 8));
      FUN_14001b140(param_2,puVar3,(longlong)iVar8);
      return 0;
    }
  }
  else {
    puVar6 = (undefined8 *)(*(code *)DAT_140038db0)();
    if ((puVar6 != (undefined8 *)0x0) && (param_2 != (longlong *)0x0)) {
      *param_2 = (longlong)puVar6;
LAB_140016317:
      lVar2 = __AdjustPointer((longlong)puVar6,(int *)(param_4 + 8));
      *param_2 = lVar2;
      return 0;
    }
    terminate((ushort *)puVar5,(ushort *)puVar3);
    puVar6 = puVar5;
LAB_1400163da:
    terminate((ushort *)puVar6,(ushort *)puVar3);
    puVar5 = puVar6;
LAB_1400163df:
    terminate((ushort *)puVar5,(ushort *)puVar3);
  }
  terminate((ushort *)puVar5,(ushort *)puVar3);
LAB_1400163e9:
  terminate((ushort *)puVar5,(ushort *)puVar3);
  terminate((ushort *)puVar5,(ushort *)puVar3);
  pcVar1 = (code *)swi(3);
  uVar4 = (*pcVar1)();
  return uVar4;
}



// Library Function - Single Match
//  void __cdecl BuildCatchObjectInternal<struct _s_HandlerType const >(struct EHExceptionRecord *
// __ptr64,void * __ptr64,struct _s_HandlerType const * __ptr64,struct _s_CatchableType const *
// __ptr64)
// 
// Library: Visual Studio 2017 Release

void __cdecl
BuildCatchObjectInternal_struct__s_HandlerType_const__
          (EHExceptionRecord *param_1,void *param_2,_s_HandlerType *param_3,
          _s_CatchableType *param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  void *pvVar3;
  undefined *UNRECOVERED_JUMPTABLE;
  void *pvVar4;
  
  UNRECOVERED_JUMPTABLE = (undefined *)0x0;
  pvVar4 = param_2;
  if (-1 < *(int *)param_3) {
                    // WARNING: Load size is inaccurate
    pvVar4 = (void *)((longlong)*(int *)(param_3 + 8) + *param_2);
  }
  uVar1 = FUN_1400161f8((longlong)param_1,(longlong *)param_2,(int *)param_3,(byte *)param_4);
  if ((int)uVar1 == 1) {
    if (*(int *)(param_4 + 0x18) != 0) {
      lVar2 = _GetThrowImageBase();
      UNRECOVERED_JUMPTABLE = (undefined *)(lVar2 + *(int *)(param_4 + 0x18));
    }
    lVar2 = __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    FUN_140015bfc(pvVar4,UNRECOVERED_JUMPTABLE,lVar2);
  }
  else if ((int)uVar1 == 2) {
    if (*(int *)(param_4 + 0x18) != 0) {
      lVar2 = _GetThrowImageBase();
      UNRECOVERED_JUMPTABLE = (undefined *)(lVar2 + *(int *)(param_4 + 0x18));
    }
    pvVar3 = (void *)__AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    _CallMemberFunction2(pvVar4,UNRECOVERED_JUMPTABLE,pvVar3,1);
  }
  return;
}



void FUN_1400164b8(_s_FuncInfo *param_1,_s_FuncInfo *param_2,_CONTEXT *param_3,_s_FuncInfo *param_4,
                  _s_FuncInfo *param_5,uchar param_6,int param_7,__uint64 *param_8)

{
  uint uVar1;
  code *pcVar2;
  bool bVar3;
  uchar uVar4;
  bool bVar5;
  int iVar6;
  uint uVar7;
  longlong lVar8;
  ulonglong uVar9;
  int *piVar10;
  undefined8 uVar11;
  _s_FuncInfo *p_Var12;
  __uint64 *p_Var13;
  _s_FuncInfo *p_Var14;
  _s_FuncInfo *p_Var15;
  _s_FuncInfo *p_Var16;
  int *piVar17;
  _CONTEXT *local_res18;
  uchar local_b7;
  _s_FuncInfo *local_90;
  _s_FuncInfo *local_88;
  uint local_80;
  uint uStack_7c;
  uint uStack_78;
  uint uStack_74;
  _s_FuncInfo *local_68;
  _s_FuncInfo *local_60;
  uint local_58;
  uint uStack_54;
  uint uStack_50;
  uint uStack_4c;
  uint local_40;
  
  local_b7 = '\0';
  bVar5 = false;
  bVar3 = false;
  p_Var14 = param_2;
  p_Var15 = param_4;
  iVar6 = __FrameHandler3::GetHandlerSearchState
                    ((__uint64 *)param_2,(_xDISPATCHER_CONTEXT *)param_4,param_5);
  if ((iVar6 < -1) || (param_5->maxState <= iVar6)) goto LAB_140016913;
  p_Var16 = p_Var14;
  local_res18 = param_3;
  if ((param_1->magicNumber_and_bbtFlags == 0xe06d7363) &&
     (((param_1->dispIPToStateMap == 4 && (param_1->dispESTypeList + 0xe66cfae0 < 3)) &&
      (*(longlong *)&param_1[1].dispUnwindMap == 0)))) {
    lVar8 = __vcrt_getptd();
    if (*(longlong *)(lVar8 + 0x20) == 0) {
      return;
    }
    lVar8 = __vcrt_getptd();
    param_1 = *(_s_FuncInfo **)(lVar8 + 0x20);
    lVar8 = __vcrt_getptd();
    p_Var14 = *(_s_FuncInfo **)&param_1[1].dispTryBlockMap;
    local_b7 = '\x01';
    local_res18 = *(_CONTEXT **)(lVar8 + 0x28);
    FUN_14000c94c(p_Var14);
    if (((param_1->magicNumber_and_bbtFlags == 0xe06d7363) && (param_1->dispIPToStateMap == 4)) &&
       ((param_1->dispESTypeList + 0xe66cfae0 < 3 && (*(longlong *)&param_1[1].dispUnwindMap == 0)))
       ) goto LAB_140016913;
    lVar8 = __vcrt_getptd();
    p_Var16 = p_Var14;
    if (*(longlong *)(lVar8 + 0x38) != 0) {
      lVar8 = __vcrt_getptd();
      p_Var14 = *(_s_FuncInfo **)(lVar8 + 0x38);
      lVar8 = __vcrt_getptd();
      *(undefined8 *)(lVar8 + 0x38) = 0;
      p_Var16 = param_1;
      p_Var15 = p_Var14;
      uVar9 = FUN_140015d00((ushort *)param_1,(int *)p_Var14);
      if ((char)uVar9 == '\0') {
        uVar4 = Is_bad_exception_allowed((_s_ESTypeList *)p_Var14);
        if (uVar4 != '\0') {
          __DestructExceptionObject((int *)param_1);
          FUN_140015c18((undefined8 *)&local_80);
          _CxxThrowException(&local_80,(ThrowInfo *)&DAT_140037170);
          pcVar2 = (code *)swi(3);
          (*pcVar2)();
          return;
        }
        goto LAB_140016913;
      }
    }
  }
  p_Var14 = p_Var16;
  local_68 = param_5;
  local_60 = param_4;
  if (((param_1->magicNumber_and_bbtFlags == 0xe06d7363) && (param_1->dispIPToStateMap == 4)) &&
     (param_1->dispESTypeList + 0xe66cfae0 < 3)) {
    if (param_5->nTryBlocks != 0) {
      p_Var15 = (_s_FuncInfo *)&local_68;
      p_Var14 = (_s_FuncInfo *)&local_58;
      __FrameHandler3::GetRangeOfTrysToCheck((TryBlockMap *)p_Var14,(int)p_Var15,iVar6);
      local_80 = local_58;
      uStack_7c = uStack_54;
      uStack_78 = uStack_50;
      uStack_74 = uStack_4c;
      if (uStack_50 < local_40) {
        do {
          p_Var15 = (_s_FuncInfo *)((ulonglong)uStack_50 * 5);
          p_Var14 = (_s_FuncInfo *)
                    (longlong)*(int *)(*(longlong *)CONCAT44(uStack_7c,local_80) + 0x10);
          piVar17 = (int *)((longlong)&p_Var14->magicNumber_and_bbtFlags +
                           *(longlong *)(*(longlong *)(CONCAT44(uStack_54,local_58) + 8) + 8) +
                           (ulonglong)uStack_50 * 0x14);
          if ((*piVar17 == iVar6 || *piVar17 < iVar6) && (iVar6 <= piVar17[1])) {
            uVar1 = piVar17[3];
            uVar9 = 0;
            p_Var15 = (_s_FuncInfo *)((longlong)piVar17[4] + *(longlong *)&param_4->dispUnwindMap);
            local_88 = p_Var15;
            bVar5 = bVar3;
            if (uVar1 != 0) {
              do {
                p_Var16 = (_s_FuncInfo *)(&local_88->magicNumber_and_bbtFlags + uVar9 * 5);
                lVar8 = _GetThrowImageBase();
                piVar10 = (int *)(lVar8 + 4 +
                                 (longlong)*(int *)(*(longlong *)&param_1[1].dispUnwindMap + 0xc));
                lVar8 = _GetThrowImageBase();
                p_Var15 = (_s_FuncInfo *)
                          (longlong)*(int *)(*(longlong *)&param_1[1].dispUnwindMap + 0xc);
                uVar7 = *(uint *)((longlong)&p_Var15->magicNumber_and_bbtFlags + lVar8);
                p_Var14 = (_s_FuncInfo *)(ulonglong)uVar7;
                for (; 0 < (int)uVar7; uVar7 = uVar7 - 1) {
                  lVar8 = _GetThrowImageBase();
                  p_Var15 = (_s_FuncInfo *)(lVar8 + *piVar10);
                  p_Var14 = p_Var16;
                  local_90 = p_Var15;
                  uVar11 = TypeMatchHelper__((byte *)p_Var16,(byte *)p_Var15,
                                             *(byte **)&param_1[1].dispUnwindMap);
                  if ((int)uVar11 != 0) {
                    bVar3 = true;
                    p_Var14 = param_1;
                    p_Var15 = param_2;
                    CatchIt_class___FrameHandler3_
                              ((EHExceptionRecord *)param_1,(__uint64 *)param_2,local_res18,
                               (_xDISPATCHER_CONTEXT *)param_4,param_5,(_s_HandlerType *)p_Var16,
                               (_s_CatchableType *)local_90,(_s_TryBlockMapEntry *)piVar17,param_7,
                               param_8,local_b7,param_6);
                    bVar5 = true;
                    goto LAB_1400167a1;
                  }
                  piVar10 = piVar10 + 1;
                }
                uVar7 = (int)uVar9 + 1;
                uVar9 = (ulonglong)uVar7;
              } while (uVar7 != uVar1);
            }
          }
LAB_1400167a1:
          uStack_50 = uStack_50 + 1;
        } while (uStack_50 < local_40);
        if (bVar5) goto LAB_1400168c8;
      }
    }
    p_Var16 = (_s_FuncInfo *)0x0;
    if (0x19930520 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff)) {
      p_Var12 = p_Var16;
      if (param_5->dispESTypeList != 0) {
        lVar8 = _GetImageBase();
        p_Var14 = (_s_FuncInfo *)(longlong)(int)param_5->dispESTypeList;
        p_Var12 = (_s_FuncInfo *)((longlong)&p_Var14->magicNumber_and_bbtFlags + lVar8);
      }
      if ((p_Var12 != (_s_FuncInfo *)0x0) ||
         ((((uint)param_5->EHFlags >> 2 & 1) != 0 &&
          (p_Var14 = param_4, p_Var15 = param_5,
          bVar5 = __FrameHandler3::ExecutionInCatch((_xDISPATCHER_CONTEXT *)param_4,param_5), !bVar5
          )))) {
        if (((uint)param_5->EHFlags >> 2 & 1) != 0) goto LAB_140016913;
        if (param_5->dispESTypeList != 0) {
          lVar8 = _GetImageBase();
          p_Var16 = (_s_FuncInfo *)(lVar8 + (int)param_5->dispESTypeList);
        }
        p_Var14 = param_1;
        uVar9 = FUN_140015d00((ushort *)param_1,(int *)p_Var16);
        p_Var15 = p_Var16;
        if ((char)uVar9 == '\0') {
          p_Var13 = __FrameHandler3::GetEstablisherFrame
                              ((__uint64 *)param_2,(_xDISPATCHER_CONTEXT *)param_4,param_5,
                               (__uint64 *)&local_90);
          __FrameHandler3::UnwindNestedFrames
                    ((__uint64 *)param_2,(EHExceptionRecord *)param_1,local_res18,p_Var13,
                     (void *)0x0,param_5,-1,-1,(_s_HandlerType *)0x0,(_xDISPATCHER_CONTEXT *)param_4
                     ,param_6);
          p_Var14 = param_2;
          p_Var15 = param_1;
        }
      }
    }
  }
  else if (param_5->nTryBlocks != 0) {
    if (param_6 != '\0') goto LAB_140016913;
    FUN_1400169ec((int *)param_1,(__uint64 *)param_2,local_res18,(_xDISPATCHER_CONTEXT *)param_4,
                  param_5,iVar6,param_7,param_8);
    p_Var14 = param_1;
    p_Var15 = param_2;
  }
LAB_1400168c8:
  lVar8 = __vcrt_getptd();
  if (*(longlong *)(lVar8 + 0x38) == 0) {
    return;
  }
LAB_140016913:
  terminate((ushort *)p_Var14,(ushort *)p_Var15);
  pcVar2 = (code *)swi(3);
  (*pcVar2)();
  return;
}



// Library Function - Single Match
//  void __cdecl CatchIt<class __FrameHandler3>(struct EHExceptionRecord * __ptr64,unsigned __int64
// * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo
// const * __ptr64,struct _s_HandlerType const * __ptr64,struct _s_CatchableType const *
// __ptr64,struct _s_TryBlockMapEntry const * __ptr64,int,unsigned __int64 * __ptr64,unsigned
// char,unsigned char)
// 
// Library: Visual Studio 2017 Release

void __cdecl
CatchIt_class___FrameHandler3_
          (EHExceptionRecord *param_1,__uint64 *param_2,_CONTEXT *param_3,
          _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,_s_HandlerType *param_6,
          _s_CatchableType *param_7,_s_TryBlockMapEntry *param_8,int param_9,__uint64 *param_10,
          uchar param_11,uchar param_12)

{
  __uint64 *p_Var1;
  longlong lVar2;
  __uint64 local_res10;
  
  p_Var1 = __FrameHandler3::GetEstablisherFrame(param_2,param_4,param_5,&local_res10);
  if (param_7 != (_s_CatchableType *)0x0) {
    BuildCatchObjectInternal_struct__s_HandlerType_const__(param_1,p_Var1,param_6,param_7);
  }
  lVar2 = _GetImageBase();
  __FrameHandler3::UnwindNestedFrames
            (param_2,param_1,param_3,p_Var1,(void *)(lVar2 + *(int *)(param_6 + 0xc)),param_5,
             *(int *)param_8,*(int *)(param_8 + 8),param_6,param_4,param_12);
  return;
}



void FUN_1400169ec(int *param_1,__uint64 *param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4,
                  _s_FuncInfo *param_5,int param_6,int param_7,__uint64 *param_8)

{
  code *pcVar1;
  int iVar2;
  longlong lVar3;
  PVOID pvVar4;
  __uint64 *p_Var5;
  int *piVar6;
  _s_HandlerType *p_Var7;
  _s_FuncInfo *local_78;
  _xDISPATCHER_CONTEXT *local_70;
  undefined4 local_68;
  undefined4 uStack_64;
  uint uStack_60;
  undefined4 uStack_5c;
  undefined4 local_58;
  undefined4 uStack_54;
  uint uStack_50;
  undefined4 uStack_4c;
  uint local_40;
  
  if (*param_1 != -0x7ffffffd) {
    piVar6 = param_1;
    p_Var5 = param_2;
    lVar3 = __vcrt_getptd();
    if (*(longlong *)(lVar3 + 0x10) != 0) {
      piVar6 = (int *)0x0;
      pvVar4 = EncodePointer((PVOID)0x0);
      lVar3 = __vcrt_getptd();
      if ((((*(PVOID *)(lVar3 + 0x10) != pvVar4) && (*param_1 != -0x1fbcb0b3)) &&
          (*param_1 != -0x1fbcbcae)) &&
         (piVar6 = param_1, p_Var5 = param_2, iVar2 = _CallSETranslator__(param_1,param_2,param_3),
         iVar2 != 0)) {
        return;
      }
    }
    local_78 = param_5;
    local_70 = param_4;
    if (param_5->nTryBlocks == 0) {
      terminate((ushort *)piVar6,(ushort *)p_Var5);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    __FrameHandler3::GetRangeOfTrysToCheck((TryBlockMap *)&local_58,(int)&local_78,param_6);
    local_68 = local_58;
    uStack_64 = uStack_54;
    uStack_60 = uStack_50;
    uStack_5c = uStack_4c;
    if (uStack_50 < local_40) {
      do {
        piVar6 = (int *)((longlong)*(int *)(*(longlong *)CONCAT44(uStack_64,local_68) + 0x10) +
                         (ulonglong)uStack_50 * 0x14 +
                        *(longlong *)(*(longlong *)(CONCAT44(uStack_54,local_58) + 8) + 8));
        if ((*piVar6 == param_6 || *piVar6 < param_6) && (param_6 <= piVar6[1])) {
          p_Var7 = (_s_HandlerType *)
                   (*(longlong *)(param_4 + 8) + -0x14 +
                   (longlong)piVar6[4] + (ulonglong)(uint)piVar6[3] * 0x14);
          if (*(int *)(p_Var7 + 4) == 0) {
            lVar3 = 0;
            iVar2 = 0;
          }
          else {
            iVar2 = *(int *)(p_Var7 + 4);
            lVar3 = _GetImageBase();
            lVar3 = lVar3 + iVar2;
          }
          if (lVar3 != 0) {
            if (iVar2 == 0) {
              lVar3 = 0;
            }
            else {
              lVar3 = _GetImageBase();
              lVar3 = lVar3 + *(int *)(p_Var7 + 4);
            }
            if (*(char *)(lVar3 + 0x10) != '\0') goto LAB_140016bea;
          }
          if (((byte)*p_Var7 & 0x40) == 0) {
            CatchIt_class___FrameHandler3_
                      ((EHExceptionRecord *)param_1,param_2,param_3,param_4,param_5,p_Var7,
                       (_s_CatchableType *)0x0,(_s_TryBlockMapEntry *)piVar6,param_7,param_8,'\x01',
                       '\0');
          }
        }
LAB_140016bea:
        uStack_50 = uStack_50 + 1;
      } while (uStack_50 < local_40);
    }
  }
  return;
}



// Library Function - Single Match
//  __GSHandlerCheckCommon
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __GSHandlerCheckCommon(ulonglong param_1,longlong param_2,uint *param_3)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*(byte *)param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  uVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8);
  if ((*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xf) != 0) {
    param_1 = param_1 + (*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xfffffff0);
  }
  __security_check_cookie(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



// Library Function - Single Match
//  __security_check_cookie
// 
// Libraries: Visual Studio 2015, Visual Studio 2017, Visual Studio 2019

void __cdecl __security_check_cookie(uintptr_t _StackCookie)

{
  if ((_StackCookie == DAT_140038010) && ((short)(_StackCookie >> 0x30) == 0)) {
    return;
  }
  __report_gsfailure(_StackCookie);
  return;
}



ulong FUN_140016cd4(char *param_1,longlong param_2,longlong param_3)

{
  char cVar1;
  ulong *puVar2;
  char *pcVar3;
  longlong lVar4;
  longlong lVar5;
  ulong uVar6;
  
  if ((param_1 != (char *)0x0) && (param_2 != 0)) {
    if (param_3 != 0) {
      pcVar3 = param_1;
      do {
        lVar5 = param_2;
        cVar1 = pcVar3[param_3 - (longlong)param_1];
        *pcVar3 = cVar1;
        pcVar3 = pcVar3 + 1;
        if (cVar1 == '\0') break;
        param_2 = lVar5 + -1;
      } while (lVar5 + -1 != 0);
      lVar4 = lVar5 + -1;
      if (cVar1 == '\0') {
        lVar4 = lVar5;
      }
      if (lVar4 != 0) {
        return 0;
      }
      *param_1 = '\0';
      puVar2 = __doserrno();
      uVar6 = 0x22;
      goto LAB_140016cf7;
    }
    *param_1 = '\0';
  }
  puVar2 = __doserrno();
  uVar6 = 0x16;
LAB_140016cf7:
  *puVar2 = uVar6;
  FUN_140011e58();
  return uVar6;
}



// Library Function - Single Match
//  __vcrt_initialize_locks
// 
// Library: Visual Studio 2017 Release

undefined8 __vcrt_initialize_locks(void)

{
  undefined8 uVar1;
  ulonglong uVar2;
  uint uVar3;
  
  uVar2 = 0;
  do {
    uVar1 = __vcrt_InitializeCriticalSectionEx
                      ((LPCRITICAL_SECTION)(&DAT_140039198 + uVar2 * 0x28),4000,0);
    if ((int)uVar1 == 0) {
      uVar2 = __vcrt_uninitialize_locks();
      return uVar2 & 0xffffffffffffff00;
    }
    DAT_1400391c0 = DAT_1400391c0 + 1;
    uVar3 = (int)uVar2 + 1;
    uVar2 = (ulonglong)uVar3;
  } while (uVar3 == 0);
  return CONCAT71((int7)((ulonglong)uVar1 >> 8),1);
}



// Library Function - Single Match
//  __vcrt_uninitialize_locks
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

undefined8 __vcrt_uninitialize_locks(void)

{
  undefined8 in_RAX;
  undefined8 extraout_RAX;
  ulonglong uVar1;
  
  uVar1 = (ulonglong)DAT_1400391c0;
  while ((int)uVar1 != 0) {
    uVar1 = (ulonglong)((int)uVar1 - 1);
    DeleteCriticalSection((LPCRITICAL_SECTION)(&DAT_140039198 + uVar1 * 0x28));
    DAT_1400391c0 = DAT_1400391c0 - 1;
    in_RAX = extraout_RAX;
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __vcrt_FlsAlloc
// 
// Library: Visual Studio 2017 Release

void __vcrt_FlsAlloc(undefined8 param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(0,"FlsAlloc",(module_id *)&DAT_140029970,
                                    (module_id *)&DAT_140029978);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)(param_1);
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000140016e02. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __vcrt_FlsFree
// 
// Library: Visual Studio 2017 Release

void __vcrt_FlsFree(undefined4 param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(1,"FlsFree",(module_id *)&DAT_140029978,
                                    (module_id *)&DAT_140029980);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000140016e4b. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree(param_1);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __vcrt_FlsGetValue
// 
// Library: Visual Studio 2017 Release

void __vcrt_FlsGetValue(undefined4 param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(2,"FlsGetValue",(module_id *)&DAT_140029980,
                                    (module_id *)&DAT_140029988);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000140016e93. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue(param_1);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __vcrt_FlsSetValue
// 
// Library: Visual Studio 2017 Release

void __vcrt_FlsSetValue(DWORD param_1,LPVOID param_2)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(3,"FlsSetValue",(module_id *)&DAT_140029988,
                                    (module_id *)&DAT_140029990);
  if (pcVar1 == (code *)0x0) {
    TlsSetValue(param_1,param_2);
  }
  else {
    (*pcVar1)();
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __vcrt_InitializeCriticalSectionEx
// 
// Library: Visual Studio 2017 Release

void __vcrt_InitializeCriticalSectionEx(LPCRITICAL_SECTION param_1,DWORD param_2,undefined4 param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(4,"InitializeCriticalSectionEx",(module_id *)&DAT_140029990,
                                    (module_id *)&DAT_140029998);
  if (pcVar1 == (code *)0x0) {
    InitializeCriticalSectionAndSpinCount(param_1,param_2);
  }
  else {
    (*pcVar1)(param_1,param_2,param_3);
  }
  return;
}



// Library Function - Single Match
//  __vcrt_initialize_winapi_thunks
// 
// Library: Visual Studio 2017 Release

void __vcrt_initialize_winapi_thunks(void)

{
  undefined8 uVar1;
  longlong lVar2;
  undefined8 *puVar3;
  
  uVar1 = DAT_140038010;
  puVar3 = &DAT_1400391e0;
  for (lVar2 = 5; lVar2 != 0; lVar2 = lVar2 + -1) {
    *puVar3 = uVar1;
    puVar3 = puVar3 + 1;
  }
  return;
}



// Library Function - Single Match
//  __vcrt_uninitialize_winapi_thunks
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

void __vcrt_uninitialize_winapi_thunks(char param_1)

{
  HMODULE hLibModule;
  HMODULE *ppHVar1;
  
  if (param_1 == '\0') {
    ppHVar1 = (HMODULE *)&DAT_1400391c8;
    do {
      hLibModule = *ppHVar1;
      if (hLibModule != (HMODULE)0x0) {
        if (hLibModule != (HMODULE)0xffffffffffffffff) {
          FreeLibrary(hLibModule);
        }
        *ppHVar1 = (HMODULE)0x0;
      }
      ppHVar1 = ppHVar1 + 1;
    } while (ppHVar1 != (HMODULE *)&DAT_1400391e0);
  }
  return;
}



// Library Function - Single Match
//  void * __ptr64 __cdecl try_get_function(enum `anonymous namespace'::function_id,char const *
// __ptr64 const,enum A0x14c33c87::module_id const * __ptr64 const,enum A0x14c33c87::module_id const
// * __ptr64 const)
// 
// Library: Visual Studio 2017 Release

void * __cdecl
try_get_function(function_id param_1,char *param_2,module_id *param_3,module_id *param_4)

{
  module_id mVar1;
  wchar_t *lpLibFileName;
  HMODULE pHVar2;
  byte bVar3;
  DWORD DVar4;
  int iVar5;
  HMODULE hLibModule;
  FARPROC pFVar6;
  void *pvVar7;
  
  bVar3 = (byte)DAT_140038010 & 0x3f;
  pvVar7 = (void *)((DAT_140038010 ^ (&DAT_1400391e0)[param_1]) >> bVar3 |
                   (DAT_140038010 ^ (&DAT_1400391e0)[param_1]) << 0x40 - bVar3);
  if (pvVar7 != (void *)0xffffffffffffffff) {
    if (pvVar7 != (void *)0x0) {
      return pvVar7;
    }
    if (param_3 != param_4) {
      do {
        mVar1 = *param_3;
        hLibModule = (HMODULE)(&DAT_1400391c8)[mVar1];
        if (hLibModule == (HMODULE)0x0) {
          lpLibFileName = (wchar_t *)(&PTR_u_api_ms_win_core_fibers_l1_1_1_140029958)[mVar1];
          hLibModule = LoadLibraryExW(lpLibFileName,(HANDLE)0x0,0x800);
          if (hLibModule == (HMODULE)0x0) {
            DVar4 = GetLastError();
            if (((DVar4 == 0x57) && (iVar5 = wcsncmp(lpLibFileName,L"api-ms-",7), iVar5 != 0)) &&
               (iVar5 = wcsncmp(lpLibFileName,L"ext-ms-",7), iVar5 != 0)) {
              hLibModule = LoadLibraryExW(lpLibFileName,(HANDLE)0x0,0);
            }
            else {
              hLibModule = (HMODULE)0x0;
            }
          }
          if (hLibModule != (HMODULE)0x0) {
            pHVar2 = (HMODULE)(&DAT_1400391c8)[mVar1];
            (&DAT_1400391c8)[mVar1] = hLibModule;
            if (pHVar2 != (HMODULE)0x0) {
              FreeLibrary(hLibModule);
            }
            goto LAB_1400170f6;
          }
          (&DAT_1400391c8)[mVar1] = 0xffffffffffffffff;
        }
        else if (hLibModule != (HMODULE)0xffffffffffffffff) {
LAB_1400170f6:
          if (hLibModule != (HMODULE)0x0) goto LAB_140017111;
        }
        param_3 = param_3 + 1;
      } while (param_3 != param_4);
    }
    hLibModule = (HMODULE)0x0;
LAB_140017111:
    if ((hLibModule != (HMODULE)0x0) &&
       (pFVar6 = GetProcAddress(hLibModule,param_2), pFVar6 != (FARPROC)0x0)) {
      bVar3 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
      (&DAT_1400391e0)[param_1] =
           ((ulonglong)pFVar6 >> bVar3 | (longlong)pFVar6 << 0x40 - bVar3) ^ DAT_140038010;
      return pFVar6;
    }
    bVar3 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
    (&DAT_1400391e0)[param_1] = (0xffffffffffffffffU >> bVar3 | -1L << 0x40 - bVar3) ^ DAT_140038010
    ;
  }
  return (void *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14001719c(void)

{
  _DAT_140039208 = DAT_140038010;
  return;
}



undefined8 FUN_1400171b0(void)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong *puVar4;
  
  bVar1 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
  uVar2 = ((ulonglong)(0 >> bVar1) | 0L << 0x40 - bVar1) ^ DAT_140038010;
  puVar4 = &DAT_1400392b0;
  for (lVar3 = 0x22; lVar3 != 0; lVar3 = lVar3 + -1) {
    *puVar4 = uVar2;
    puVar4 = puVar4 + 1;
  }
  return CONCAT71((int7)(uVar2 >> 8),1);
}



// Library Function - Single Match
//  __acrt_uninitialize_winapi_thunks
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_uninitialize_winapi_thunks(char param_1)

{
  HMODULE hLibModule;
  undefined8 *in_RAX;
  HMODULE *ppHVar1;
  
  if (param_1 == '\0') {
    ppHVar1 = (HMODULE *)&DAT_140039210;
    do {
      hLibModule = *ppHVar1;
      if (hLibModule != (HMODULE)0x0) {
        if (hLibModule != (HMODULE)0xffffffffffffffff) {
          FreeLibrary(hLibModule);
        }
        *ppHVar1 = (HMODULE)0x0;
      }
      ppHVar1 = ppHVar1 + 1;
      in_RAX = &DAT_1400392b0;
    } while (ppHVar1 != (HMODULE *)&DAT_1400392b0);
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_CompareStringEx
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_CompareStringEx
               (wchar_t *param_1,DWORD param_2,PCNZWCH param_3,int param_4,PCNZWCH param_5,
               int param_6,undefined8 param_7,undefined8 param_8,undefined8 param_9)

{
  LCID Locale;
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(1,"CompareStringEx",(module_id *)&DAT_140029a40,
                                    (module_id *)&DAT_140029a48);
  if (pcVar1 == (code *)0x0) {
    Locale = __acrt_LocaleNameToLCID(param_1,0);
    CompareStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_FlsAlloc
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_FlsAlloc(undefined8 param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(3,"FlsAlloc",(module_id *)&DAT_140029a48,
                                    (module_id *)&DAT_140029a50);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)(param_1);
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000140017361. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_FlsFree
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_FlsFree(undefined4 param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(4,"FlsFree",(module_id *)&DAT_140029a50,
                                    (module_id *)&DAT_140029a58);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001400173a7. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree(param_1);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_FlsGetValue
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_FlsGetValue(undefined4 param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(5,"FlsGetValue",(module_id *)&DAT_140029a58,
                                    (module_id *)&DAT_140029a60);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001400173ef. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue(param_1);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_FlsSetValue
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_FlsSetValue(DWORD param_1,LPVOID param_2)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(6,"FlsSetValue",(module_id *)&DAT_140029a60,
                                    (module_id *)&DAT_140029a68);
  if (pcVar1 == (code *)0x0) {
    TlsSetValue(param_1,param_2);
  }
  else {
    (*pcVar1)();
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_GetDateFormatEx
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_GetDateFormatEx
               (wchar_t *param_1,DWORD param_2,SYSTEMTIME *param_3,LPCWSTR param_4,LPWSTR param_5,
               int param_6,undefined8 param_7)

{
  LCID Locale;
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(8,"GetDateFormatEx",(module_id *)&DAT_140029a68,
                                    (module_id *)&DAT_140029a70);
  if (pcVar1 == (code *)0x0) {
    Locale = __acrt_LocaleNameToLCID(param_1,0);
    GetDateFormatW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6,param_7);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_GetSystemTimePreciseAsFileTime
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_GetSystemTimePreciseAsFileTime(LPFILETIME param_1)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(0xd,"GetSystemTimePreciseAsFileTime",(module_id *)&DAT_140029a70
                                    ,(module_id *)&DAT_140029a74);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
                    // WARNING: Treating indirect jump as call
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000140017545. Too many branches
                    // WARNING: Treating indirect jump as call
  GetSystemTimeAsFileTime(param_1);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_GetTimeFormatEx
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_GetTimeFormatEx
               (wchar_t *param_1,DWORD param_2,SYSTEMTIME *param_3,LPCWSTR param_4,LPWSTR param_5,
               int param_6)

{
  LCID Locale;
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(0xe,"GetTimeFormatEx",(module_id *)&DAT_140029a78,
                                    (module_id *)&DAT_140029a80);
  if (pcVar1 == (code *)0x0) {
    Locale = __acrt_LocaleNameToLCID(param_1,0);
    GetTimeFormatW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_InitializeCriticalSectionEx
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_InitializeCriticalSectionEx(LPCRITICAL_SECTION param_1,DWORD param_2,undefined4 param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(0x12,"InitializeCriticalSectionEx",(module_id *)&DAT_140029a80,
                                    (module_id *)&DAT_140029a88);
  if (pcVar1 == (code *)0x0) {
    InitializeCriticalSectionAndSpinCount(param_1,param_2);
  }
  else {
    (*pcVar1)(param_1,param_2,param_3);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_LCMapStringEx
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_LCMapStringEx
               (wchar_t *param_1,DWORD param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
               int param_6,undefined8 param_7,undefined8 param_8,undefined8 param_9)

{
  LCID Locale;
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(0x14,"LCMapStringEx",(module_id *)&DAT_140029a88,
                                    (module_id *)&DAT_140029a90);
  if (pcVar1 == (code *)0x0) {
    Locale = __acrt_LocaleNameToLCID(param_1,0);
    LCMapStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_LocaleNameToLCID
// 
// Library: Visual Studio 2017 Release

void __acrt_LocaleNameToLCID(wchar_t *param_1,undefined4 param_2)

{
  code *pcVar1;
  
  pcVar1 = (code *)try_get_function(0x16,"LocaleNameToLCID",(module_id *)&DAT_140029a90,
                                    (module_id *)&DAT_140029a98);
  if (pcVar1 == (code *)0x0) {
    __acrt_DownlevelLocaleNameToLCID(param_1);
  }
  else {
    (*pcVar1)(param_1,param_2);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// Library Function - Single Match
//  __acrt_AppPolicyGetProcessTerminationMethodInternal
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_AppPolicyGetProcessTerminationMethodInternal(undefined8 param_1)

{
  code *pcVar1;
  undefined8 uVar2;
  
  pcVar1 = (code *)try_get_function(0x1c,"AppPolicyGetProcessTerminationMethod",
                                    (module_id *)&DAT_140029a98,(module_id *)&DAT_140029a9c);
  if (pcVar1 != (code *)0x0) {
    uVar2 = (*pcVar1)(0xfffffffffffffffa,param_1);
                    // WARNING: Treating indirect jump as call
    return uVar2;
  }
  return 0xc0000225;
}



// Library Function - Single Match
//  void * __ptr64 __cdecl try_get_function(enum `anonymous namespace'::function_id,char const *
// __ptr64 const,enum A0x391cf84c::module_id const * __ptr64 const,enum A0x391cf84c::module_id const
// * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void * __cdecl
try_get_function(function_id param_1,char *param_2,module_id *param_3,module_id *param_4)

{
  module_id mVar1;
  wchar_t *lpLibFileName;
  HMODULE pHVar2;
  byte bVar3;
  DWORD DVar4;
  int iVar5;
  HMODULE hLibModule;
  FARPROC pFVar6;
  void *pvVar7;
  
  bVar3 = (byte)DAT_140038010 & 0x3f;
  pvVar7 = (void *)((DAT_140038010 ^ (&DAT_1400392b0)[param_1]) >> bVar3 |
                   (DAT_140038010 ^ (&DAT_1400392b0)[param_1]) << 0x40 - bVar3);
  if (pvVar7 != (void *)0xffffffffffffffff) {
    if (pvVar7 != (void *)0x0) {
      return pvVar7;
    }
    if (param_3 != param_4) {
      do {
        mVar1 = *param_3;
        hLibModule = (HMODULE)(&DAT_140039210)[mVar1];
        if (hLibModule == (HMODULE)0x0) {
          lpLibFileName = (wchar_t *)(&PTR_u_api_ms_win_core_datetime_l1_1_1_1400299a0)[mVar1];
          hLibModule = LoadLibraryExW(lpLibFileName,(HANDLE)0x0,0x800);
          if (hLibModule == (HMODULE)0x0) {
            DVar4 = GetLastError();
            if (((DVar4 == 0x57) && (iVar5 = wcsncmp(lpLibFileName,L"api-ms-",7), iVar5 != 0)) &&
               (iVar5 = wcsncmp(lpLibFileName,L"ext-ms-",7), iVar5 != 0)) {
              hLibModule = LoadLibraryExW(lpLibFileName,(HANDLE)0x0,0);
            }
            else {
              hLibModule = (HMODULE)0x0;
            }
          }
          if (hLibModule != (HMODULE)0x0) {
            pHVar2 = (HMODULE)(&DAT_140039210)[mVar1];
            (&DAT_140039210)[mVar1] = hLibModule;
            if (pHVar2 != (HMODULE)0x0) {
              FreeLibrary(hLibModule);
            }
            goto LAB_14001790a;
          }
          (&DAT_140039210)[mVar1] = 0xffffffffffffffff;
        }
        else if (hLibModule != (HMODULE)0xffffffffffffffff) {
LAB_14001790a:
          if (hLibModule != (HMODULE)0x0) goto LAB_140017925;
        }
        param_3 = param_3 + 1;
      } while (param_3 != param_4);
    }
    hLibModule = (HMODULE)0x0;
LAB_140017925:
    if ((hLibModule != (HMODULE)0x0) &&
       (pFVar6 = GetProcAddress(hLibModule,param_2), pFVar6 != (FARPROC)0x0)) {
      bVar3 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
      (&DAT_1400392b0)[param_1] =
           ((ulonglong)pFVar6 >> bVar3 | (longlong)pFVar6 << 0x40 - bVar3) ^ DAT_140038010;
      return pFVar6;
    }
    bVar3 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
    (&DAT_1400392b0)[param_1] = (0xffffffffffffffffU >> bVar3 | -1L << 0x40 - bVar3) ^ DAT_140038010
    ;
  }
  return (void *)0x0;
}



// Library Function - Single Match
//  __acrt_initialize_locks
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_initialize_locks(void)

{
  undefined8 uVar1;
  ulonglong uVar2;
  uint uVar3;
  
  uVar2 = 0;
  do {
    uVar1 = __acrt_InitializeCriticalSectionEx
                      ((LPCRITICAL_SECTION)(&DAT_1400393c0 + uVar2 * 0x28),4000,0);
    if ((int)uVar1 == 0) {
      uVar2 = __acrt_uninitialize_locks();
      return uVar2 & 0xffffffffffffff00;
    }
    DAT_1400395f0 = DAT_1400395f0 + 1;
    uVar3 = (int)uVar2 + 1;
    uVar2 = (ulonglong)uVar3;
  } while (uVar3 < 0xe);
  return CONCAT71((int7)((ulonglong)uVar1 >> 8),1);
}



// Library Function - Single Match
//  __acrt_uninitialize_locks
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_uninitialize_locks(void)

{
  undefined8 in_RAX;
  undefined8 extraout_RAX;
  ulonglong uVar1;
  
  uVar1 = (ulonglong)DAT_1400395f0;
  while ((int)uVar1 != 0) {
    uVar1 = (ulonglong)((int)uVar1 - 1);
    DeleteCriticalSection((LPCRITICAL_SECTION)(&DAT_1400393c0 + uVar1 * 0x28));
    DAT_1400395f0 = DAT_1400395f0 - 1;
    in_RAX = extraout_RAX;
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// Library Function - Multiple Matches With Different Base Names
//  __acrt_lock
//  __acrt_unlock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void FID_conflict___acrt_lock(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x000140017a4a. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_1400393c0 + (longlong)param_1 * 0x28));
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  __acrt_lock
//  __acrt_unlock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void FID_conflict___acrt_lock(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x000140017a66. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_1400393c0 + (longlong)param_1 * 0x28));
  return;
}



bool FUN_140017a70(void)

{
  HANDLE pvVar1;
  uint7 extraout_var;
  
  pvVar1 = GetProcessHeap();
  DAT_1400395f8 = (ulonglong)pvVar1 & 0xff | (ulonglong)extraout_var << 8;
  return ((ulonglong)pvVar1 & 0xff | (ulonglong)extraout_var << 8) != 0;
}



undefined FUN_140017a90(void)

{
  DAT_1400395f8 = 0;
  return 1;
}



// Library Function - Single Match
//  __acrt_initialize_ptd
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong __acrt_initialize_ptd(void)

{
  ulonglong uVar1;
  __acrt_ptd *p_Var2;
  
  uVar1 = __acrt_FlsAlloc(FUN_140017d30);
  DAT_140038160 = (int)uVar1;
  if (DAT_140038160 != -1) {
    p_Var2 = FUN_140017c70();
    if (p_Var2 != (__acrt_ptd *)0x0) {
      return CONCAT71((int7)((ulonglong)p_Var2 >> 8),1);
    }
    uVar1 = __acrt_uninitialize_ptd();
  }
  return uVar1 & 0xffffffffffffff00;
}



// Library Function - Single Match
//  __acrt_uninitialize_ptd
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined __acrt_uninitialize_ptd(void)

{
  if (DAT_140038160 != -1) {
    __acrt_FlsFree(DAT_140038160);
    DAT_140038160 = -1;
  }
  return 1;
}



__acrt_ptd * FUN_140017b04(void)

{
  code *pcVar1;
  DWORD dwErrCode;
  int iVar2;
  __acrt_ptd *p_Var3;
  
  dwErrCode = GetLastError();
  if ((DAT_140038160 == 0xffffffff) ||
     (p_Var3 = (__acrt_ptd *)__acrt_FlsGetValue(DAT_140038160), p_Var3 == (__acrt_ptd *)0x0)) {
    iVar2 = __acrt_FlsSetValue(DAT_140038160,(LPVOID)0xffffffffffffffff);
    if (iVar2 != 0) {
      p_Var3 = (__acrt_ptd *)_calloc_base(1,0x3c8);
      if (p_Var3 == (__acrt_ptd *)0x0) {
        __acrt_FlsSetValue(DAT_140038160,(LPVOID)0x0);
        p_Var3 = (__acrt_ptd *)0x0;
      }
      else {
        iVar2 = __acrt_FlsSetValue(DAT_140038160,p_Var3);
        if (iVar2 != 0) {
          construct_ptd_array(p_Var3);
          _free_base((LPVOID)0x0);
          goto LAB_140017ba5;
        }
        __acrt_FlsSetValue(DAT_140038160,(LPVOID)0x0);
      }
      _free_base(p_Var3);
    }
  }
  else if (p_Var3 != (__acrt_ptd *)0xffffffffffffffff) goto LAB_140017ba5;
  p_Var3 = (__acrt_ptd *)0x0;
LAB_140017ba5:
  SetLastError(dwErrCode);
  if (p_Var3 == (__acrt_ptd *)0x0) {
    abort();
    pcVar1 = (code *)swi(3);
    p_Var3 = (__acrt_ptd *)(*pcVar1)();
    return p_Var3;
  }
  return p_Var3;
}



// Library Function - Single Match
//  __acrt_getptd_head
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

__acrt_ptd * __acrt_getptd_head(void)

{
  code *pcVar1;
  int iVar2;
  __acrt_ptd *p_Var3;
  
  if ((DAT_140038160 == 0xffffffff) ||
     (p_Var3 = (__acrt_ptd *)__acrt_FlsGetValue(DAT_140038160), p_Var3 == (__acrt_ptd *)0x0)) {
    iVar2 = __acrt_FlsSetValue(DAT_140038160,(LPVOID)0xffffffffffffffff);
    if (iVar2 == 0) goto LAB_140017c69;
    p_Var3 = (__acrt_ptd *)_calloc_base(1,0x3c8);
    if (p_Var3 == (__acrt_ptd *)0x0) {
      __acrt_FlsSetValue(DAT_140038160,(LPVOID)0x0);
      p_Var3 = (__acrt_ptd *)0x0;
    }
    else {
      iVar2 = __acrt_FlsSetValue(DAT_140038160,p_Var3);
      if (iVar2 != 0) {
        construct_ptd_array(p_Var3);
        _free_base((LPVOID)0x0);
        goto LAB_140017c5b;
      }
      __acrt_FlsSetValue(DAT_140038160,(LPVOID)0x0);
    }
    _free_base(p_Var3);
  }
  else {
    if (p_Var3 == (__acrt_ptd *)0xffffffffffffffff) goto LAB_140017c69;
LAB_140017c5b:
    if (p_Var3 != (__acrt_ptd *)0x0) {
      return p_Var3;
    }
  }
LAB_140017c69:
  abort();
  pcVar1 = (code *)swi(3);
  p_Var3 = (__acrt_ptd *)(*pcVar1)();
  return p_Var3;
}



__acrt_ptd * FUN_140017c70(void)

{
  DWORD dwErrCode;
  int iVar1;
  __acrt_ptd *p_Var2;
  
  dwErrCode = GetLastError();
  if ((DAT_140038160 == 0xffffffff) ||
     (p_Var2 = (__acrt_ptd *)__acrt_FlsGetValue(DAT_140038160), p_Var2 == (__acrt_ptd *)0x0)) {
    iVar1 = __acrt_FlsSetValue(DAT_140038160,(LPVOID)0xffffffffffffffff);
    if (iVar1 != 0) {
      p_Var2 = (__acrt_ptd *)_calloc_base(1,0x3c8);
      if (p_Var2 == (__acrt_ptd *)0x0) {
        __acrt_FlsSetValue(DAT_140038160,(LPVOID)0x0);
        p_Var2 = (__acrt_ptd *)0x0;
      }
      else {
        iVar1 = __acrt_FlsSetValue(DAT_140038160,p_Var2);
        if (iVar1 != 0) {
          construct_ptd_array(p_Var2);
          _free_base((LPVOID)0x0);
          goto LAB_140017d11;
        }
        __acrt_FlsSetValue(DAT_140038160,(LPVOID)0x0);
      }
      _free_base(p_Var2);
    }
  }
  else if (p_Var2 != (__acrt_ptd *)0xffffffffffffffff) goto LAB_140017d11;
  p_Var2 = (__acrt_ptd *)0x0;
LAB_140017d11:
  SetLastError(dwErrCode);
  return p_Var2;
}



void FUN_140017d30(__acrt_ptd *param_1)

{
  if (param_1 != (__acrt_ptd *)0x0) {
    destroy_ptd_array(param_1);
    _free_base(param_1);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl replace_current_thread_locale_nolock(struct __acrt_ptd * __ptr64 const,struct
// __crt_locale_data * __ptr64 const)
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl replace_current_thread_locale_nolock(__acrt_ptd *param_1,__crt_locale_data *param_2)

{
  undefined **ppuVar1;
  
  if (*(longlong *)(param_1 + 0x90) != 0) {
    __acrt_release_locale_ref(*(longlong *)(param_1 + 0x90));
    ppuVar1 = *(undefined ***)(param_1 + 0x90);
    if (((ppuVar1 != DAT_140039a48) && (ppuVar1 != &PTR_DAT_1400386f0)) &&
       (*(int *)(ppuVar1 + 2) == 0)) {
      __acrt_free_locale(ppuVar1);
    }
  }
  *(__crt_locale_data **)(param_1 + 0x90) = param_2;
  if (param_2 != (__crt_locale_data *)0x0) {
    __acrt_add_locale_ref((longlong)param_2);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl construct_ptd_array(struct __acrt_ptd * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl construct_ptd_array(__acrt_ptd *param_1)

{
  undefined local_res10 [8];
  int local_res18 [2];
  int local_res20 [2];
  int local_38;
  int local_34;
  __acrt_ptd *local_30;
  undefined8 *local_28;
  __acrt_ptd **local_20;
  __acrt_ptd **local_18;
  undefined8 **local_10;
  
  local_20 = &local_30;
  local_res18[0] = 5;
  local_res20[0] = 5;
  local_18 = &local_30;
  local_10 = &local_28;
  local_38 = 4;
  local_34 = 4;
  local_28 = &DAT_140039a48;
  *(undefined4 *)(param_1 + 0x28) = 1;
  *(undefined **)param_1 = &DAT_140029530;
  *(undefined4 *)(param_1 + 0x3a8) = 1;
  *(undefined **)(param_1 + 0x88) = &DAT_1400382b0;
  *(undefined2 *)(param_1 + 0xbc) = 0x43;
  *(undefined2 *)(param_1 + 0x1c2) = 0x43;
  *(undefined8 *)(param_1 + 0x3a0) = 0;
  local_30 = param_1;
  operator____(local_res10,local_res20,(longlong **)&local_20,local_res18);
  operator____(local_res10,&local_34,&local_18,&local_38);
  return;
}



// Library Function - Single Match
//  void __cdecl destroy_ptd_array(struct __acrt_ptd * __ptr64 const)
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl destroy_ptd_array(__acrt_ptd *param_1)

{
  undefined local_res10 [8];
  int local_res18 [2];
  int local_res20 [2];
  int local_28;
  int local_24;
  __acrt_ptd *local_20;
  __acrt_ptd **local_18;
  __acrt_ptd **local_10;
  
  local_18 = &local_20;
  local_res18[0] = 5;
  local_res20[0] = 5;
  local_10 = &local_20;
  local_28 = 4;
  local_24 = 4;
  local_20 = param_1;
  if (*(undefined **)param_1 != &DAT_140029530) {
    _free_base(*(undefined **)param_1);
  }
  _free_base(*(LPVOID *)(local_20 + 0x70));
  _free_base(*(LPVOID *)(local_20 + 0x58));
  _free_base(*(LPVOID *)(local_20 + 0x60));
  _free_base(*(LPVOID *)(local_20 + 0x68));
  _free_base(*(LPVOID *)(local_20 + 0x48));
  _free_base(*(LPVOID *)(local_20 + 0x50));
  _free_base(*(LPVOID *)(local_20 + 0x78));
  _free_base(*(LPVOID *)(local_20 + 0x80));
  _free_base(*(LPVOID *)(local_20 + 0x3c0));
  operator____(local_res10,local_res20,(longlong **)&local_18,local_res18);
  operator____(local_res10,&local_24,&local_10,&local_28);
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_0ae27a3a962d80f24befdcbee591983d>,class <lambda_8d0ee55de4b1038c4002e0adecdf1839> &
// __ptr64,class <lambda_dc504788e8f1664fe9b84e20bfb512f2> >(class
// <lambda_0ae27a3a962d80f24befdcbee591983d> && __ptr64,class
// <lambda_8d0ee55de4b1038c4002e0adecdf1839> & __ptr64,class
// <lambda_dc504788e8f1664fe9b84e20bfb512f2> && __ptr64) __ptr64
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_72d1df2b273a38828b1ce30cbf4cdab5>,class <lambda_876a65b173b8412d3a47c70a915b0cf4> &
// __ptr64,class <lambda_41932305e351933ebe8f8be3ed8bb5dc> >(class
// <lambda_72d1df2b273a38828b1ce30cbf4cdab5> && __ptr64,class
// <lambda_876a65b173b8412d3a47c70a915b0cf4> & __ptr64,class
// <lambda_41932305e351933ebe8f8be3ed8bb5dc> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void operator____(undefined8 param_1,int *param_2,longlong **param_3,int *param_4)

{
  FID_conflict___acrt_lock(*param_2);
  LOCK();
  **(int **)(**param_3 + 0x88) = **(int **)(**param_3 + 0x88) + 1;
  FID_conflict___acrt_lock(*param_4);
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_5e887d1dcbef67a5eb4283622ba103bf>,class <lambda_4466841279450cc726390878d4a41900> &
// __ptr64,class <lambda_341c25c0346d94847f1f3c463c57e077> >(class
// <lambda_5e887d1dcbef67a5eb4283622ba103bf> && __ptr64,class
// <lambda_4466841279450cc726390878d4a41900> & __ptr64,class
// <lambda_341c25c0346d94847f1f3c463c57e077> && __ptr64) __ptr64
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_aa87e3671a710a21b5dc78c0bdf72e11>,class <lambda_92619d2358a28f41a33ba319515a20b9> &
// __ptr64,class <lambda_6992ecaafeb10aed2b74cb1fae11a551> >(class
// <lambda_aa87e3671a710a21b5dc78c0bdf72e11> && __ptr64,class
// <lambda_92619d2358a28f41a33ba319515a20b9> & __ptr64,class
// <lambda_6992ecaafeb10aed2b74cb1fae11a551> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void operator____(undefined8 param_1,int *param_2,undefined8 *param_3,int *param_4)

{
  FID_conflict___acrt_lock(*param_2);
  replace_current_thread_locale_nolock(*(__acrt_ptd **)*param_3,**(__crt_locale_data ***)param_3[1])
  ;
  FID_conflict___acrt_lock(*param_4);
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_46352004c1216016012b18bd6f87e700>,class <lambda_3bd07e1a1191394380780325891bf33f> &
// __ptr64,class <lambda_334532d3f185bcaa59b5be82d7d22bff> >(class
// <lambda_46352004c1216016012b18bd6f87e700> && __ptr64,class
// <lambda_3bd07e1a1191394380780325891bf33f> & __ptr64,class
// <lambda_334532d3f185bcaa59b5be82d7d22bff> && __ptr64) __ptr64
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_f2e299630e499de9f9a165e60fcd3db5>,class <lambda_2ae9d31cdba2644fcbeaf08da7c24588> &
// __ptr64,class <lambda_40d01ff24d0e7b3814fdbdcee8eab3c7> >(class
// <lambda_f2e299630e499de9f9a165e60fcd3db5> && __ptr64,class
// <lambda_2ae9d31cdba2644fcbeaf08da7c24588> & __ptr64,class
// <lambda_40d01ff24d0e7b3814fdbdcee8eab3c7> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void operator____(undefined8 param_1,int *param_2,longlong **param_3,int *param_4)

{
  int iVar1;
  int *piVar2;
  
  FID_conflict___acrt_lock(*param_2);
  piVar2 = *(int **)(**param_3 + 0x88);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    if ((iVar1 == 1) && (piVar2 != (int *)&DAT_1400382b0)) {
      _free_base(piVar2);
    }
  }
  FID_conflict___acrt_lock(*param_4);
  return;
}



// Library Function - Multiple Matches With Same Base Name
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_2d41944a1d46af3157314b8a01080d33>,class <lambda_8f455de75cd7d7f24b4096f044d8b9e6> &
// __ptr64,class <lambda_aa500f224e6afead328df44964fe2772> >(class
// <lambda_2d41944a1d46af3157314b8a01080d33> && __ptr64,class
// <lambda_8f455de75cd7d7f24b4096f044d8b9e6> & __ptr64,class
// <lambda_aa500f224e6afead328df44964fe2772> && __ptr64) __ptr64
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_fb3a7dec4e47f37f22dae91bb15c9095>,class <lambda_698284760c8add0bfb0756c19673e34b> &
// __ptr64,class <lambda_dfb8eca1e75fef3034a8fb18dd509707> >(class
// <lambda_fb3a7dec4e47f37f22dae91bb15c9095> && __ptr64,class
// <lambda_698284760c8add0bfb0756c19673e34b> & __ptr64,class
// <lambda_dfb8eca1e75fef3034a8fb18dd509707> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void operator____(undefined8 param_1,int *param_2,undefined8 *param_3,int *param_4)

{
  FID_conflict___acrt_lock(*param_2);
  replace_current_thread_locale_nolock(*(__acrt_ptd **)*param_3,(__crt_locale_data *)0x0);
  FID_conflict___acrt_lock(*param_4);
  return;
}



// Library Function - Single Match
//  __acrt_initialize_lowio
// 
// Library: Visual Studio 2015 Release

ulonglong __acrt_initialize_lowio(void)

{
  longlong lVar1;
  ulonglong uVar2;
  bool bVar3;
  
  FID_conflict___acrt_lock(7);
  lVar1 = FUN_14001e574(0);
  bVar3 = (int)lVar1 == 0;
  if (bVar3) {
    initialize_inherited_file_handles_nolock();
    initialize_stdio_handles_nolock();
  }
  uVar2 = FID_conflict___acrt_lock(7);
  return uVar2 & 0xffffffffffffff00 | (ulonglong)bVar3;
}



// Library Function - Single Match
//  __acrt_uninitialize_lowio
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

undefined __acrt_uninitialize_lowio(void)

{
  ulonglong uVar1;
  
  uVar1 = 0;
  do {
    if (*(LPCRITICAL_SECTION *)((longlong)&DAT_140039600 + uVar1) != (LPCRITICAL_SECTION)0x0) {
      __acrt_lowio_destroy_handle_array(*(LPCRITICAL_SECTION *)((longlong)&DAT_140039600 + uVar1));
      *(undefined8 *)((longlong)&DAT_140039600 + uVar1) = 0;
    }
    uVar1 = uVar1 + 8;
  } while (uVar1 < 0x400);
  return 1;
}



// Library Function - Single Match
//  void __cdecl initialize_inherited_file_handles_nolock(void)
// 
// Library: Visual Studio 2015 Release

void __cdecl initialize_inherited_file_handles_nolock(void)

{
  DWORD DVar1;
  longlong lVar2;
  HANDLE *ppvVar3;
  longlong lVar4;
  uint *puVar5;
  uint uVar6;
  ulonglong uVar7;
  _STARTUPINFOW local_78;
  
  GetStartupInfoW(&local_78);
  lVar4 = 0;
  if ((local_78.cbReserved2 != 0) && ((uint *)local_78.lpReserved2 != (uint *)0x0)) {
    puVar5 = (uint *)((longlong)local_78.lpReserved2 + 4);
    ppvVar3 = (HANDLE *)((longlong)(int)*(uint *)local_78.lpReserved2 + (longlong)puVar5);
    uVar6 = 0x2000;
    if ((int)*(uint *)local_78.lpReserved2 < 0x2000) {
      uVar6 = *(uint *)local_78.lpReserved2;
    }
    FUN_14001e574(uVar6);
    if ((int)DAT_140039a00 < (int)uVar6) {
      uVar6 = DAT_140039a00;
    }
    uVar7 = (ulonglong)uVar6;
    if (uVar6 != 0) {
      do {
        if ((((*ppvVar3 != (HANDLE)0xffffffffffffffff) && (*ppvVar3 != (HANDLE)0xfffffffffffffffe))
            && ((*(byte *)puVar5 & 1) != 0)) &&
           (((*(byte *)puVar5 & 8) != 0 || (DVar1 = GetFileType(*ppvVar3), DVar1 != 0)))) {
          lVar2 = (ulonglong)((uint)lVar4 & 0x3f) * 0x40 + (&DAT_140039600)[lVar4 >> 6];
          *(HANDLE *)(lVar2 + 0x28) = *ppvVar3;
          *(byte *)(lVar2 + 0x38) = *(byte *)puVar5;
        }
        lVar4 = lVar4 + 1;
        puVar5 = (uint *)((longlong)puVar5 + 1);
        ppvVar3 = ppvVar3 + 1;
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
  }
  return;
}



// Library Function - Single Match
//  void __cdecl initialize_stdio_handles_nolock(void)
// 
// Library: Visual Studio 2015 Release

void __cdecl initialize_stdio_handles_nolock(void)

{
  uint uVar1;
  HANDLE hFile;
  DWORD nStdHandle;
  longlong lVar2;
  uint uVar3;
  longlong lVar4;
  
  uVar3 = 0;
  lVar4 = 0;
  do {
    lVar2 = (ulonglong)(uVar3 & 0x3f) * 0x40 + (&DAT_140039600)[(longlong)(int)uVar3 >> 6];
    if (*(longlong *)(lVar2 + 0x28) + 2U < 2) {
      *(undefined *)(lVar2 + 0x38) = 0x81;
      if (uVar3 == 0) {
        nStdHandle = 0xfffffff6;
      }
      else if (uVar3 == 1) {
        nStdHandle = 0xfffffff5;
      }
      else {
        nStdHandle = 0xfffffff4;
      }
      hFile = GetStdHandle(nStdHandle);
      if ((longlong)hFile + 1U < 2) {
        uVar1 = 0;
      }
      else {
        uVar1 = GetFileType(hFile);
      }
      if (uVar1 == 0) {
        *(byte *)(lVar2 + 0x38) = *(byte *)(lVar2 + 0x38) | 0x40;
        *(undefined8 *)(lVar2 + 0x28) = 0xfffffffffffffffe;
        if (DAT_140038dc0 != 0) {
          *(undefined4 *)(*(longlong *)(lVar4 + DAT_140038dc0) + 0x18) = 0xfffffffe;
        }
      }
      else {
        *(HANDLE *)(lVar2 + 0x28) = hFile;
        if ((uVar1 & 0xff) == 2) {
          *(byte *)(lVar2 + 0x38) = *(byte *)(lVar2 + 0x38) | 0x40;
        }
        else if ((uVar1 & 0xff) == 3) {
          *(byte *)(lVar2 + 0x38) = *(byte *)(lVar2 + 0x38) | 8;
        }
      }
    }
    else {
      *(byte *)(lVar2 + 0x38) = *(byte *)(lVar2 + 0x38) | 0x80;
    }
    uVar3 = uVar3 + 1;
    lVar4 = lVar4 + 8;
  } while (uVar3 != 3);
  return;
}



// Library Function - Single Match
//  __acrt_update_thread_multibyte_data
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_update_thread_multibyte_data(void)

{
  __acrt_ptd *p_Var1;
  
  p_Var1 = FUN_140017b04();
  update_thread_multibyte_data_internal(p_Var1,(__crt_multibyte_data **)&DAT_140039a08);
  return;
}



// Library Function - Single Match
//  __acrt_initialize_multibyte
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_initialize_multibyte(void)

{
  int iVar1;
  undefined8 in_RAX;
  __acrt_ptd *p_Var2;
  undefined4 extraout_var;
  
  if (DAT_140039a24 == '\0') {
    DAT_140039a18 = &DAT_1400385f0;
    DAT_140039a08 = &DAT_1400382b0;
    DAT_140039a10 = &DAT_1400384e0;
    p_Var2 = __acrt_getptd_head();
    iVar1 = setmbcp_internal(-3,true,p_Var2,(__crt_multibyte_data **)&DAT_140039a08);
    in_RAX = CONCAT44(extraout_var,iVar1);
    DAT_140039a24 = '\x01';
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1400183a0(int param_1,__crt_multibyte_data *param_2)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  BOOL BVar4;
  uint *puVar5;
  __crt_multibyte_data *p_Var6;
  wchar_t *pwVar7;
  longlong lVar8;
  BYTE *pBVar9;
  ulonglong uVar10;
  byte *pbVar11;
  undefined2 *puVar12;
  byte *pbVar13;
  uint uVar14;
  uint uVar15;
  byte *pbVar17;
  undefined auStack_78 [32];
  _cpinfo local_58;
  ulonglong local_40;
  wchar_t *pwVar16;
  
  local_40 = DAT_140038010 ^ (ulonglong)auStack_78;
  uVar3 = getSystemCP(param_1);
  pwVar7 = (wchar_t *)0x0;
  if (uVar3 != 0) {
    puVar5 = &DAT_1400381c0;
    pwVar16 = pwVar7;
LAB_1400183f2:
    if (*puVar5 != uVar3) goto code_r0x0001400183fa;
    FUN_14000ce30((undefined (*) [16])(param_2 + 0x18),0,0x101);
    pbVar17 = &DAT_1400381b0;
    lVar8 = 4;
    pbVar13 = &DAT_1400381d0 + (longlong)pwVar16 * 0x30;
    do {
      bVar1 = *pbVar13;
      pbVar11 = pbVar13;
      while ((bVar1 != 0 && (pbVar11[1] != 0))) {
        bVar1 = *pbVar11;
        uVar15 = (uint)bVar1;
        if (bVar1 <= pbVar11[1]) {
          uVar14 = (uint)bVar1;
          do {
            uVar14 = uVar14 + 1;
            if (0x100 < uVar14) break;
            uVar15 = uVar15 + 1;
            param_2[(ulonglong)uVar14 + 0x18] =
                 (__crt_multibyte_data)((byte)param_2[(ulonglong)uVar14 + 0x18] | *pbVar17);
          } while (uVar15 <= pbVar11[1]);
        }
        pbVar11 = pbVar11 + 2;
        bVar1 = *pbVar11;
      }
      pbVar13 = pbVar13 + 8;
      pbVar17 = pbVar17 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    *(uint *)(param_2 + 4) = uVar3;
    *(undefined4 *)(param_2 + 8) = 1;
    if (uVar3 == 0x3a4) {
      pwVar7 = L"ja-JP";
    }
    else if (uVar3 == 0x3a8) {
      pwVar7 = L"zh-CN";
    }
    else if (uVar3 == 0x3b5) {
      pwVar7 = L"ko-KR";
    }
    else if (uVar3 == 0x3b6) {
      pwVar7 = L"zh-TW";
    }
    *(wchar_t **)(param_2 + 0x220) = pwVar7;
    puVar12 = (undefined2 *)(param_2 + 0xc);
    lVar8 = 6;
    do {
      *puVar12 = *(undefined2 *)
                  (((longlong)pwVar16 * 0x30 - (longlong)param_2) + 0x1400381b8 + (longlong)puVar12)
      ;
      puVar12 = puVar12 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    goto LAB_140018628;
  }
LAB_1400183d3:
  setSBCS(param_2);
LAB_140018632:
  __security_check_cookie(local_40 ^ (ulonglong)auStack_78);
  return;
code_r0x0001400183fa:
  uVar15 = (int)pwVar16 + 1;
  pwVar16 = (wchar_t *)(ulonglong)uVar15;
  puVar5 = puVar5 + 0xc;
  if (4 < uVar15) goto code_r0x000140018407;
  goto LAB_1400183f2;
code_r0x000140018407:
  if ((uVar3 == 65000) || (BVar4 = IsValidCodePage(uVar3 & 0xffff), BVar4 == 0)) goto LAB_140018632;
  if (uVar3 == 0xfde9) {
    *(undefined8 *)(param_2 + 4) = 0xfde9;
    *(undefined8 *)(param_2 + 0x220) = 0;
    *(undefined4 *)(param_2 + 0x18) = 0;
    *(undefined2 *)(param_2 + 0x1c) = 0;
  }
  else {
    BVar4 = GetCPInfo(uVar3,&local_58);
    if (BVar4 == 0) {
      if (_DAT_140039a20 == 0) goto LAB_140018632;
      goto LAB_1400183d3;
    }
    FUN_14000ce30((undefined (*) [16])(param_2 + 0x18),0,0x101);
    *(uint *)(param_2 + 4) = uVar3;
    *(undefined8 *)(param_2 + 0x220) = 0;
    if (local_58.MaxCharSize == 2) {
      pBVar9 = local_58.LeadByte;
      while ((local_58.LeadByte[0] != 0 && (pBVar9[1] != 0))) {
        bVar1 = *pBVar9;
        if (bVar1 <= pBVar9[1]) {
          uVar3 = (uint)bVar1;
          uVar10 = (ulonglong)(((uint)pBVar9[1] - (uint)bVar1) + 1);
          do {
            uVar3 = uVar3 + 1;
            param_2[(ulonglong)uVar3 + 0x18] =
                 (__crt_multibyte_data)((byte)param_2[(ulonglong)uVar3 + 0x18] | 4);
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
        }
        pBVar9 = pBVar9 + 2;
        local_58.LeadByte[0] = *pBVar9;
      }
      p_Var6 = param_2 + 0x1a;
      lVar8 = 0xfe;
      do {
        *p_Var6 = (__crt_multibyte_data)((byte)*p_Var6 | 8);
        p_Var6 = p_Var6 + 1;
        lVar8 = lVar8 + -1;
      } while (lVar8 != 0);
      iVar2 = *(int *)(param_2 + 4);
      if (iVar2 == 0x3a4) {
        pwVar7 = L"ja-JP";
      }
      else if (iVar2 == 0x3a8) {
        pwVar7 = L"zh-CN";
      }
      else if (iVar2 == 0x3b5) {
        pwVar7 = L"ko-KR";
      }
      else if (iVar2 == 0x3b6) {
        pwVar7 = L"zh-TW";
      }
      *(wchar_t **)(param_2 + 0x220) = pwVar7;
      pwVar7 = (wchar_t *)0x1;
    }
    *(int *)(param_2 + 8) = (int)pwVar7;
  }
  puVar12 = (undefined2 *)(param_2 + 0xc);
  for (lVar8 = 6; lVar8 != 0; lVar8 = lVar8 + -1) {
    *puVar12 = 0;
    puVar12 = puVar12 + 1;
  }
LAB_140018628:
  setSBUpLow(param_2);
  goto LAB_140018632;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  int __cdecl getSystemCP(int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl getSystemCP(int param_1)

{
  longlong local_28;
  longlong local_20;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)0x0);
  _DAT_140039a20 = 0;
  if (param_1 == -2) {
    _DAT_140039a20 = 1;
    param_1 = GetOEMCP();
  }
  else if (param_1 == -3) {
    _DAT_140039a20 = 1;
    param_1 = GetACP();
  }
  else if (param_1 == -4) {
    _DAT_140039a20 = 1;
    param_1 = *(UINT *)(local_20 + 0xc);
  }
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return param_1;
}



// Library Function - Single Match
//  void __cdecl setSBCS(struct __crt_multibyte_data * __ptr64)
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl setSBCS(__crt_multibyte_data *param_1)

{
  longlong lVar1;
  __crt_multibyte_data *p_Var2;
  undefined (*pauVar3) [16];
  longlong lVar4;
  undefined2 *puVar5;
  
  pauVar3 = (undefined (*) [16])(param_1 + 0x18);
  lVar4 = 0x101;
  FUN_14000ce30(pauVar3,0,0x101);
  *(undefined8 *)(param_1 + 4) = 0;
  *(undefined8 *)(param_1 + 0x220) = 0;
  puVar5 = (undefined2 *)(param_1 + 0xc);
  for (lVar1 = 6; lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  do {
    (*pauVar3)[0] =
         *(undefined *)(((longlong)&DAT_1400382b0 - (longlong)param_1) + (longlong)pauVar3);
    pauVar3 = (undefined (*) [16])(*pauVar3 + 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  p_Var2 = param_1 + 0x119;
  lVar1 = 0x100;
  do {
    *p_Var2 = p_Var2[(longlong)&DAT_1400382b0 - (longlong)param_1];
    p_Var2 = p_Var2 + 1;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



// Library Function - Single Match
//  struct __crt_multibyte_data * __ptr64 __cdecl update_thread_multibyte_data_internal(struct
// __acrt_ptd * __ptr64 const,struct __crt_multibyte_data * __ptr64 * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

__crt_multibyte_data * __cdecl
update_thread_multibyte_data_internal(__acrt_ptd *param_1,__crt_multibyte_data **param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int iVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  ulong *puVar9;
  __acrt_ptd *p_Var10;
  undefined4 *puVar11;
  char cVar12;
  __crt_multibyte_data **pp_Var13;
  longlong lVar14;
  int *piVar15;
  undefined4 *puVar16;
  __acrt_ptd *in_R8;
  __crt_multibyte_data **in_R9;
  __crt_seh_guarded_call_void_ a_Stack_60 [4];
  undefined4 uStack_5c;
  undefined4 auStack_58 [2];
  __acrt_ptd **pp_Stack_50;
  undefined *puStack_48;
  __acrt_ptd *p_Stack_40;
  __crt_multibyte_data **pp_Stack_38;
  __acrt_ptd *p_Stack_10;
  
  pp_Var13 = param_2;
  if (((*(uint *)(param_1 + 0x3a8) & DAT_140038910) == 0) || (*(longlong *)(param_1 + 0x90) == 0)) {
    FID_conflict___acrt_lock(5);
    piVar15 = *(int **)(param_1 + 0x88);
    if (piVar15 != (int *)*param_2) {
      if (piVar15 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar15;
        *piVar15 = *piVar15 + -1;
        if ((iVar5 == 1) && (piVar15 != (int *)&DAT_1400382b0)) {
          _free_base(piVar15);
        }
      }
      piVar15 = (int *)*param_2;
      *(int **)(param_1 + 0x88) = piVar15;
      LOCK();
      *piVar15 = *piVar15 + 1;
    }
    p_Var10 = (__acrt_ptd *)0x5;
    FID_conflict___acrt_lock(5);
  }
  else {
    piVar15 = *(int **)(param_1 + 0x88);
    p_Var10 = param_1;
  }
  iVar5 = (int)p_Var10;
  cVar12 = (char)pp_Var13;
  if (piVar15 != (int *)0x0) {
    return (__crt_multibyte_data *)piVar15;
  }
  abort();
  p_Stack_40 = param_1;
  pp_Stack_38 = param_2;
  p_Stack_10 = in_R8;
  update_thread_multibyte_data_internal(in_R8,in_R9);
  iVar5 = getSystemCP(iVar5);
  if (iVar5 == *(int *)(*(longlong *)(p_Stack_10 + 0x88) + 4)) {
    uVar6 = 0;
    goto LAB_140018922;
  }
  puVar7 = (undefined4 *)_malloc_base(0x228);
  if (puVar7 == (undefined4 *)0x0) {
LAB_140018915:
    uVar6 = 0xffffffff;
    puVar16 = puVar7;
  }
  else {
    lVar14 = 4;
    puVar16 = *(undefined4 **)(p_Stack_10 + 0x88);
    puVar4 = puVar7;
    do {
      puVar11 = puVar4;
      puVar8 = puVar16;
      uVar1 = puVar8[1];
      uVar2 = puVar8[2];
      uVar3 = puVar8[3];
      *puVar11 = *puVar8;
      puVar11[1] = uVar1;
      puVar11[2] = uVar2;
      puVar11[3] = uVar3;
      uVar1 = puVar8[5];
      uVar2 = puVar8[6];
      uVar3 = puVar8[7];
      puVar11[4] = puVar8[4];
      puVar11[5] = uVar1;
      puVar11[6] = uVar2;
      puVar11[7] = uVar3;
      uVar1 = puVar8[9];
      uVar2 = puVar8[10];
      uVar3 = puVar8[0xb];
      puVar11[8] = puVar8[8];
      puVar11[9] = uVar1;
      puVar11[10] = uVar2;
      puVar11[0xb] = uVar3;
      uVar1 = puVar8[0xd];
      uVar2 = puVar8[0xe];
      uVar3 = puVar8[0xf];
      puVar11[0xc] = puVar8[0xc];
      puVar11[0xd] = uVar1;
      puVar11[0xe] = uVar2;
      puVar11[0xf] = uVar3;
      uVar1 = puVar8[0x11];
      uVar2 = puVar8[0x12];
      uVar3 = puVar8[0x13];
      puVar11[0x10] = puVar8[0x10];
      puVar11[0x11] = uVar1;
      puVar11[0x12] = uVar2;
      puVar11[0x13] = uVar3;
      uVar1 = puVar8[0x15];
      uVar2 = puVar8[0x16];
      uVar3 = puVar8[0x17];
      puVar11[0x14] = puVar8[0x14];
      puVar11[0x15] = uVar1;
      puVar11[0x16] = uVar2;
      puVar11[0x17] = uVar3;
      uVar1 = puVar8[0x19];
      uVar2 = puVar8[0x1a];
      uVar3 = puVar8[0x1b];
      puVar11[0x18] = puVar8[0x18];
      puVar11[0x19] = uVar1;
      puVar11[0x1a] = uVar2;
      puVar11[0x1b] = uVar3;
      uVar1 = puVar8[0x1d];
      uVar2 = puVar8[0x1e];
      uVar3 = puVar8[0x1f];
      puVar11[0x1c] = puVar8[0x1c];
      puVar11[0x1d] = uVar1;
      puVar11[0x1e] = uVar2;
      puVar11[0x1f] = uVar3;
      lVar14 = lVar14 + -1;
      puVar16 = puVar8 + 0x20;
      puVar4 = puVar11 + 0x20;
    } while (lVar14 != 0);
    uVar1 = puVar8[0x21];
    uVar2 = puVar8[0x22];
    uVar3 = puVar8[0x23];
    puVar11[0x20] = puVar8[0x20];
    puVar11[0x21] = uVar1;
    puVar11[0x22] = uVar2;
    puVar11[0x23] = uVar3;
    uVar1 = puVar8[0x25];
    uVar2 = puVar8[0x26];
    uVar3 = puVar8[0x27];
    puVar11[0x24] = puVar8[0x24];
    puVar11[0x25] = uVar1;
    puVar11[0x26] = uVar2;
    puVar11[0x27] = uVar3;
    *(undefined8 *)(puVar11 + 0x28) = *(undefined8 *)(puVar8 + 0x28);
    *puVar7 = 0;
    uVar6 = FUN_1400183a0(iVar5,(__crt_multibyte_data *)puVar7);
    if (uVar6 == 0xffffffff) {
      puVar9 = __doserrno();
      *puVar9 = 0x16;
      goto LAB_140018915;
    }
    if (cVar12 == '\0') {
      FUN_140010de0();
    }
    piVar15 = *(int **)(p_Stack_10 + 0x88);
    LOCK();
    iVar5 = *piVar15;
    *piVar15 = *piVar15 + -1;
    if ((iVar5 == 1) && (*(undefined **)(p_Stack_10 + 0x88) != &DAT_1400382b0)) {
      _free_base(*(undefined **)(p_Stack_10 + 0x88));
    }
    *puVar7 = 1;
    puVar16 = (undefined4 *)0x0;
    *(undefined4 **)(p_Stack_10 + 0x88) = puVar7;
    if ((((byte)p_Stack_10[0x3a8] & 2) == 0) && ((DAT_140038910 & 1) == 0)) {
      pp_Stack_50 = &p_Stack_10;
      puStack_48 = &stack0xfffffffffffffff8;
      uStack_5c = 5;
      auStack_58[0] = 5;
      __crt_seh_guarded_call<void>::
      operator___class__lambda_efdfa57d1f175319df784efa44bb7b81__class__lambda_5f0a4c1567f8adc6734073e5d1e1b35c_____ptr64_class__lambda_2e8a7d3640ea6ccb4c2413664c2db6fd___
                (a_Stack_60,(_lambda_efdfa57d1f175319df784efa44bb7b81_ *)auStack_58,
                 (_lambda_5f0a4c1567f8adc6734073e5d1e1b35c_ *)&pp_Stack_50,
                 (_lambda_2e8a7d3640ea6ccb4c2413664c2db6fd_ *)&uStack_5c);
      if (cVar12 != '\0') {
        PTR_DAT_140038850 = *in_R9;
        puVar16 = (undefined4 *)0x0;
      }
    }
  }
  _free_base(puVar16);
LAB_140018922:
  return (__crt_multibyte_data *)(ulonglong)uVar6;
}



// Library Function - Single Match
//  int __cdecl setmbcp_internal(int,bool,struct __acrt_ptd * __ptr64 const,struct
// __crt_multibyte_data * __ptr64 * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl
setmbcp_internal(int param_1,bool param_2,__acrt_ptd *param_3,__crt_multibyte_data **param_4)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  ulong *puVar10;
  undefined4 *puVar11;
  longlong lVar12;
  undefined4 *puVar13;
  __acrt_ptd *local_res18;
  __crt_multibyte_data **local_res20;
  __crt_seh_guarded_call_void_ local_38 [4];
  undefined4 local_34;
  undefined4 local_30 [2];
  __acrt_ptd **local_28;
  __crt_multibyte_data ***local_20;
  
  local_res18 = param_3;
  local_res20 = param_4;
  update_thread_multibyte_data_internal(param_3,param_4);
  iVar7 = getSystemCP(param_1);
  if (iVar7 == *(int *)(*(longlong *)(local_res18 + 0x88) + 4)) {
    return 0;
  }
  puVar8 = (undefined4 *)_malloc_base(0x228);
  if (puVar8 != (undefined4 *)0x0) {
    lVar12 = 4;
    puVar13 = *(undefined4 **)(local_res18 + 0x88);
    puVar6 = puVar8;
    do {
      puVar11 = puVar6;
      puVar9 = puVar13;
      uVar3 = puVar9[1];
      uVar4 = puVar9[2];
      uVar5 = puVar9[3];
      *puVar11 = *puVar9;
      puVar11[1] = uVar3;
      puVar11[2] = uVar4;
      puVar11[3] = uVar5;
      uVar3 = puVar9[5];
      uVar4 = puVar9[6];
      uVar5 = puVar9[7];
      puVar11[4] = puVar9[4];
      puVar11[5] = uVar3;
      puVar11[6] = uVar4;
      puVar11[7] = uVar5;
      uVar3 = puVar9[9];
      uVar4 = puVar9[10];
      uVar5 = puVar9[0xb];
      puVar11[8] = puVar9[8];
      puVar11[9] = uVar3;
      puVar11[10] = uVar4;
      puVar11[0xb] = uVar5;
      uVar3 = puVar9[0xd];
      uVar4 = puVar9[0xe];
      uVar5 = puVar9[0xf];
      puVar11[0xc] = puVar9[0xc];
      puVar11[0xd] = uVar3;
      puVar11[0xe] = uVar4;
      puVar11[0xf] = uVar5;
      uVar3 = puVar9[0x11];
      uVar4 = puVar9[0x12];
      uVar5 = puVar9[0x13];
      puVar11[0x10] = puVar9[0x10];
      puVar11[0x11] = uVar3;
      puVar11[0x12] = uVar4;
      puVar11[0x13] = uVar5;
      uVar3 = puVar9[0x15];
      uVar4 = puVar9[0x16];
      uVar5 = puVar9[0x17];
      puVar11[0x14] = puVar9[0x14];
      puVar11[0x15] = uVar3;
      puVar11[0x16] = uVar4;
      puVar11[0x17] = uVar5;
      uVar3 = puVar9[0x19];
      uVar4 = puVar9[0x1a];
      uVar5 = puVar9[0x1b];
      puVar11[0x18] = puVar9[0x18];
      puVar11[0x19] = uVar3;
      puVar11[0x1a] = uVar4;
      puVar11[0x1b] = uVar5;
      uVar3 = puVar9[0x1d];
      uVar4 = puVar9[0x1e];
      uVar5 = puVar9[0x1f];
      puVar11[0x1c] = puVar9[0x1c];
      puVar11[0x1d] = uVar3;
      puVar11[0x1e] = uVar4;
      puVar11[0x1f] = uVar5;
      lVar12 = lVar12 + -1;
      puVar13 = puVar9 + 0x20;
      puVar6 = puVar11 + 0x20;
    } while (lVar12 != 0);
    uVar3 = puVar9[0x21];
    uVar4 = puVar9[0x22];
    uVar5 = puVar9[0x23];
    puVar11[0x20] = puVar9[0x20];
    puVar11[0x21] = uVar3;
    puVar11[0x22] = uVar4;
    puVar11[0x23] = uVar5;
    uVar3 = puVar9[0x25];
    uVar4 = puVar9[0x26];
    uVar5 = puVar9[0x27];
    puVar11[0x24] = puVar9[0x24];
    puVar11[0x25] = uVar3;
    puVar11[0x26] = uVar4;
    puVar11[0x27] = uVar5;
    *(undefined8 *)(puVar11 + 0x28) = *(undefined8 *)(puVar9 + 0x28);
    *puVar8 = 0;
    iVar7 = FUN_1400183a0(iVar7,(__crt_multibyte_data *)puVar8);
    if (iVar7 != -1) {
      if (!param_2) {
        FUN_140010de0();
      }
      piVar2 = *(int **)(local_res18 + 0x88);
      LOCK();
      iVar1 = *piVar2;
      *piVar2 = *piVar2 + -1;
      if ((iVar1 == 1) && (*(undefined **)(local_res18 + 0x88) != &DAT_1400382b0)) {
        _free_base(*(undefined **)(local_res18 + 0x88));
      }
      *puVar8 = 1;
      puVar13 = (undefined4 *)0x0;
      *(undefined4 **)(local_res18 + 0x88) = puVar8;
      puVar8 = puVar13;
      if ((((byte)local_res18[0x3a8] & 2) == 0) && (((byte)DAT_140038910 & 1) == 0)) {
        local_28 = &local_res18;
        local_20 = &local_res20;
        local_34 = 5;
        local_30[0] = 5;
        __crt_seh_guarded_call<void>::
        operator___class__lambda_efdfa57d1f175319df784efa44bb7b81__class__lambda_5f0a4c1567f8adc6734073e5d1e1b35c_____ptr64_class__lambda_2e8a7d3640ea6ccb4c2413664c2db6fd___
                  (local_38,(_lambda_efdfa57d1f175319df784efa44bb7b81_ *)local_30,
                   (_lambda_5f0a4c1567f8adc6734073e5d1e1b35c_ *)&local_28,
                   (_lambda_2e8a7d3640ea6ccb4c2413664c2db6fd_ *)&local_34);
        if (param_2) {
          PTR_DAT_140038850 = *local_res20;
          puVar8 = (undefined4 *)0x0;
        }
      }
      goto LAB_140018918;
    }
    puVar10 = __doserrno();
    *puVar10 = 0x16;
  }
  iVar7 = -1;
LAB_140018918:
  _free_base(puVar8);
  return iVar7;
}



// Library Function - Single Match
//  void __cdecl setSBUpLow(struct __crt_multibyte_data * __ptr64)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl setSBUpLow(__crt_multibyte_data *param_1)

{
  byte bVar1;
  __crt_multibyte_data _Var2;
  BOOL BVar3;
  uint uVar4;
  longlong lVar5;
  CHAR *pCVar6;
  ulonglong uVar7;
  BYTE *pBVar8;
  WORD *pWVar9;
  longlong lVar10;
  undefined auStackY_788 [32];
  _cpinfo local_738;
  CHAR local_718 [255];
  __crt_multibyte_data a_Stack_619 [256];
  __crt_multibyte_data a_Stack_519 [257];
  WORD local_418 [512];
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStackY_788;
  if ((*(UINT *)(param_1 + 4) == 0xfde9) ||
     (BVar3 = GetCPInfo(*(UINT *)(param_1 + 4),&local_738), BVar3 == 0)) {
    uVar4 = 0;
    lVar10 = 1;
    do {
      if (uVar4 - 0x41 < 0x1a) {
        param_1[lVar10 + 0x18] = (__crt_multibyte_data)((byte)param_1[lVar10 + 0x18] | 0x10);
        _Var2 = (__crt_multibyte_data)((char)uVar4 + ' ');
      }
      else if (uVar4 - 0x61 < 0x1a) {
        param_1[lVar10 + 0x18] = (__crt_multibyte_data)((byte)param_1[lVar10 + 0x18] | 0x20);
        _Var2 = (__crt_multibyte_data)((char)uVar4 + -0x20);
      }
      else {
        _Var2 = (__crt_multibyte_data)0x0;
      }
      param_1[lVar10 + 0x118] = _Var2;
      uVar4 = uVar4 + 1;
      lVar10 = lVar10 + 1;
    } while (uVar4 < 0x100);
  }
  else {
    uVar4 = 0;
    pCVar6 = local_718;
    lVar10 = 0x100;
    do {
      *pCVar6 = (CHAR)uVar4;
      uVar4 = uVar4 + 1;
      pCVar6 = pCVar6 + 1;
    } while (uVar4 < 0x100);
    pBVar8 = local_738.LeadByte;
    local_718[0] = ' ';
    while (local_738.LeadByte[0] != 0) {
      bVar1 = pBVar8[1];
      uVar7 = (ulonglong)local_738.LeadByte[0];
      while ((uVar4 = (uint)uVar7, uVar4 <= bVar1 && (uVar4 < 0x100))) {
        local_718[uVar7] = ' ';
        uVar7 = (ulonglong)(uVar4 + 1);
      }
      pBVar8 = pBVar8 + 2;
      local_738.LeadByte[0] = *pBVar8;
    }
    __acrt_GetStringTypeA
              ((__crt_locale_pointers *)0x0,1,local_718,0x100,local_418,*(UINT *)(param_1 + 4),0);
    __acrt_LCMapStringA((__crt_locale_pointers *)0x0,*(wchar_t **)(param_1 + 0x220),0x100,local_718,
                        0x100,(char *)(a_Stack_619 + 1),0x100,*(int *)(param_1 + 4),0);
    __acrt_LCMapStringA((__crt_locale_pointers *)0x0,*(wchar_t **)(param_1 + 0x220),0x200,local_718,
                        0x100,(char *)(a_Stack_519 + 1),0x100,*(int *)(param_1 + 4),0);
    lVar5 = 1;
    pWVar9 = local_418;
    do {
      if ((*(byte *)pWVar9 & 1) == 0) {
        if ((*(byte *)pWVar9 & 2) == 0) {
          _Var2 = (__crt_multibyte_data)0x0;
        }
        else {
          param_1[lVar5 + 0x18] = (__crt_multibyte_data)((byte)param_1[lVar5 + 0x18] | 0x20);
          _Var2 = a_Stack_519[lVar5];
        }
      }
      else {
        param_1[lVar5 + 0x18] = (__crt_multibyte_data)((byte)param_1[lVar5 + 0x18] | 0x10);
        _Var2 = a_Stack_619[lVar5];
      }
      param_1[lVar5 + 0x118] = _Var2;
      pWVar9 = pWVar9 + 1;
      lVar5 = lVar5 + 1;
      lVar10 = lVar10 + -1;
    } while (lVar10 != 0);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY_788);
  return;
}



// Library Function - Single Match
//  public: void __cdecl __crt_seh_guarded_call<void>::operator()<class
// <lambda_efdfa57d1f175319df784efa44bb7b81>,class <lambda_5f0a4c1567f8adc6734073e5d1e1b35c> &
// __ptr64,class <lambda_2e8a7d3640ea6ccb4c2413664c2db6fd> >(class
// <lambda_efdfa57d1f175319df784efa44bb7b81> && __ptr64,class
// <lambda_5f0a4c1567f8adc6734073e5d1e1b35c> & __ptr64,class
// <lambda_2e8a7d3640ea6ccb4c2413664c2db6fd> && __ptr64) __ptr64
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __thiscall
__crt_seh_guarded_call<void>::
operator___class__lambda_efdfa57d1f175319df784efa44bb7b81__class__lambda_5f0a4c1567f8adc6734073e5d1e1b35c_____ptr64_class__lambda_2e8a7d3640ea6ccb4c2413664c2db6fd___
          (__crt_seh_guarded_call_void_ *this,_lambda_efdfa57d1f175319df784efa44bb7b81_ *param_1,
          _lambda_5f0a4c1567f8adc6734073e5d1e1b35c_ *param_2,
          _lambda_2e8a7d3640ea6ccb4c2413664c2db6fd_ *param_3)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  ulong *puVar7;
  undefined (*pauVar8) [16];
  undefined (*pauVar9) [16];
  longlong lVar10;
  
  FID_conflict___acrt_lock(*(int *)param_1);
  puVar6 = (undefined4 *)(*(longlong *)(**(longlong **)param_2 + 0x88) + 0x18);
  if (DAT_140039a10 == (undefined (*) [16])0x0) {
LAB_140018c71:
    puVar7 = __doserrno();
    *puVar7 = 0x16;
    FUN_140011e58();
  }
  else {
    if (puVar6 == (undefined4 *)0x0) {
      FUN_14000ce30(DAT_140039a10,0,0x101);
      goto LAB_140018c71;
    }
    lVar10 = 2;
    pauVar9 = DAT_140039a10;
    do {
      uVar3 = puVar6[1];
      uVar4 = puVar6[2];
      uVar5 = puVar6[3];
      *(undefined4 *)*pauVar9 = *puVar6;
      *(undefined4 *)(*pauVar9 + 4) = uVar3;
      *(undefined4 *)(*pauVar9 + 8) = uVar4;
      *(undefined4 *)(*pauVar9 + 0xc) = uVar5;
      uVar3 = puVar6[5];
      uVar4 = puVar6[6];
      uVar5 = puVar6[7];
      *(undefined4 *)pauVar9[1] = puVar6[4];
      *(undefined4 *)(pauVar9[1] + 4) = uVar3;
      *(undefined4 *)(pauVar9[1] + 8) = uVar4;
      *(undefined4 *)(pauVar9[1] + 0xc) = uVar5;
      uVar3 = puVar6[9];
      uVar4 = puVar6[10];
      uVar5 = puVar6[0xb];
      *(undefined4 *)pauVar9[2] = puVar6[8];
      *(undefined4 *)(pauVar9[2] + 4) = uVar3;
      *(undefined4 *)(pauVar9[2] + 8) = uVar4;
      *(undefined4 *)(pauVar9[2] + 0xc) = uVar5;
      uVar3 = puVar6[0xd];
      uVar4 = puVar6[0xe];
      uVar5 = puVar6[0xf];
      *(undefined4 *)pauVar9[3] = puVar6[0xc];
      *(undefined4 *)(pauVar9[3] + 4) = uVar3;
      *(undefined4 *)(pauVar9[3] + 8) = uVar4;
      *(undefined4 *)(pauVar9[3] + 0xc) = uVar5;
      uVar3 = puVar6[0x11];
      uVar4 = puVar6[0x12];
      uVar5 = puVar6[0x13];
      *(undefined4 *)pauVar9[4] = puVar6[0x10];
      *(undefined4 *)(pauVar9[4] + 4) = uVar3;
      *(undefined4 *)(pauVar9[4] + 8) = uVar4;
      *(undefined4 *)(pauVar9[4] + 0xc) = uVar5;
      uVar3 = puVar6[0x15];
      uVar4 = puVar6[0x16];
      uVar5 = puVar6[0x17];
      *(undefined4 *)pauVar9[5] = puVar6[0x14];
      *(undefined4 *)(pauVar9[5] + 4) = uVar3;
      *(undefined4 *)(pauVar9[5] + 8) = uVar4;
      *(undefined4 *)(pauVar9[5] + 0xc) = uVar5;
      uVar3 = puVar6[0x19];
      uVar4 = puVar6[0x1a];
      uVar5 = puVar6[0x1b];
      *(undefined4 *)pauVar9[6] = puVar6[0x18];
      *(undefined4 *)(pauVar9[6] + 4) = uVar3;
      *(undefined4 *)(pauVar9[6] + 8) = uVar4;
      *(undefined4 *)(pauVar9[6] + 0xc) = uVar5;
      pauVar8 = pauVar9[8];
      uVar3 = puVar6[0x1d];
      uVar4 = puVar6[0x1e];
      uVar5 = puVar6[0x1f];
      *(undefined4 *)pauVar9[7] = puVar6[0x1c];
      *(undefined4 *)(pauVar9[7] + 4) = uVar3;
      *(undefined4 *)(pauVar9[7] + 8) = uVar4;
      *(undefined4 *)(pauVar9[7] + 0xc) = uVar5;
      puVar6 = puVar6 + 0x20;
      lVar10 = lVar10 + -1;
      pauVar9 = pauVar8;
    } while (lVar10 != 0);
    (*pauVar8)[0] = *(undefined *)puVar6;
  }
  lVar10 = 2;
  puVar6 = (undefined4 *)(*(longlong *)(**(longlong **)param_2 + 0x88) + 0x119);
  if (DAT_140039a18 != (undefined (*) [16])0x0) {
    pauVar9 = DAT_140039a18;
    if (puVar6 != (undefined4 *)0x0) {
      do {
        uVar3 = puVar6[1];
        uVar4 = puVar6[2];
        uVar5 = puVar6[3];
        *(undefined4 *)*pauVar9 = *puVar6;
        *(undefined4 *)(*pauVar9 + 4) = uVar3;
        *(undefined4 *)(*pauVar9 + 8) = uVar4;
        *(undefined4 *)(*pauVar9 + 0xc) = uVar5;
        uVar3 = puVar6[5];
        uVar4 = puVar6[6];
        uVar5 = puVar6[7];
        *(undefined4 *)pauVar9[1] = puVar6[4];
        *(undefined4 *)(pauVar9[1] + 4) = uVar3;
        *(undefined4 *)(pauVar9[1] + 8) = uVar4;
        *(undefined4 *)(pauVar9[1] + 0xc) = uVar5;
        uVar3 = puVar6[9];
        uVar4 = puVar6[10];
        uVar5 = puVar6[0xb];
        *(undefined4 *)pauVar9[2] = puVar6[8];
        *(undefined4 *)(pauVar9[2] + 4) = uVar3;
        *(undefined4 *)(pauVar9[2] + 8) = uVar4;
        *(undefined4 *)(pauVar9[2] + 0xc) = uVar5;
        uVar3 = puVar6[0xd];
        uVar4 = puVar6[0xe];
        uVar5 = puVar6[0xf];
        *(undefined4 *)pauVar9[3] = puVar6[0xc];
        *(undefined4 *)(pauVar9[3] + 4) = uVar3;
        *(undefined4 *)(pauVar9[3] + 8) = uVar4;
        *(undefined4 *)(pauVar9[3] + 0xc) = uVar5;
        uVar3 = puVar6[0x11];
        uVar4 = puVar6[0x12];
        uVar5 = puVar6[0x13];
        *(undefined4 *)pauVar9[4] = puVar6[0x10];
        *(undefined4 *)(pauVar9[4] + 4) = uVar3;
        *(undefined4 *)(pauVar9[4] + 8) = uVar4;
        *(undefined4 *)(pauVar9[4] + 0xc) = uVar5;
        uVar3 = puVar6[0x15];
        uVar4 = puVar6[0x16];
        uVar5 = puVar6[0x17];
        *(undefined4 *)pauVar9[5] = puVar6[0x14];
        *(undefined4 *)(pauVar9[5] + 4) = uVar3;
        *(undefined4 *)(pauVar9[5] + 8) = uVar4;
        *(undefined4 *)(pauVar9[5] + 0xc) = uVar5;
        uVar3 = puVar6[0x19];
        uVar4 = puVar6[0x1a];
        uVar5 = puVar6[0x1b];
        *(undefined4 *)pauVar9[6] = puVar6[0x18];
        *(undefined4 *)(pauVar9[6] + 4) = uVar3;
        *(undefined4 *)(pauVar9[6] + 8) = uVar4;
        *(undefined4 *)(pauVar9[6] + 0xc) = uVar5;
        uVar3 = puVar6[0x1d];
        uVar4 = puVar6[0x1e];
        uVar5 = puVar6[0x1f];
        *(undefined4 *)pauVar9[7] = puVar6[0x1c];
        *(undefined4 *)(pauVar9[7] + 4) = uVar3;
        *(undefined4 *)(pauVar9[7] + 8) = uVar4;
        *(undefined4 *)(pauVar9[7] + 0xc) = uVar5;
        puVar6 = puVar6 + 0x20;
        lVar10 = lVar10 + -1;
        pauVar9 = pauVar9[8];
      } while (lVar10 != 0);
      goto LAB_140018d18;
    }
    FUN_14000ce30(DAT_140039a18,0,0x100);
  }
  puVar7 = __doserrno();
  *puVar7 = 0x16;
  FUN_140011e58();
LAB_140018d18:
  piVar2 = *(int **)**(undefined8 **)(param_2 + 8);
  LOCK();
  iVar1 = *piVar2;
  *piVar2 = *piVar2 + -1;
  if ((iVar1 == 1) && (*(undefined **)(LPVOID *)**(undefined8 **)(param_2 + 8) != &DAT_1400382b0)) {
    _free_base(*(LPVOID *)**(undefined8 **)(param_2 + 8));
  }
  *(undefined8 *)**(undefined8 **)(param_2 + 8) = *(undefined8 *)(**(longlong **)param_2 + 0x88);
  LOCK();
  **(int **)(**(longlong **)param_2 + 0x88) = **(int **)(**(longlong **)param_2 + 0x88) + 1;
  FID_conflict___acrt_lock(*(int *)param_3);
  return;
}



// Library Function - Single Match
//  _free_base
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void _free_base(LPVOID param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  ulong uVar3;
  ulong *puVar4;
  
  if ((param_1 != (LPVOID)0x0) && (BVar1 = HeapFree(DAT_1400395f8,0,param_1), BVar1 == 0)) {
    puVar4 = __doserrno();
    DVar2 = GetLastError();
    uVar3 = __acrt_errno_from_os_error(DVar2);
    *puVar4 = uVar3;
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 FUN_140018dc4(undefined **param_1,undefined **param_2)

{
  code **in_RAX;
  code **ppcVar1;
  
  ppcVar1 = (code **)param_1;
  if (param_1 != param_2) {
    do {
      in_RAX = (code **)*ppcVar1;
      if ((in_RAX != (code **)0x0) && (in_RAX = (code **)(*(code *)in_RAX)(), (char)in_RAX == '\0'))
      break;
      ppcVar1 = ppcVar1 + 2;
    } while (ppcVar1 != (code **)param_2);
    if (ppcVar1 != (code **)param_2) {
      if (ppcVar1 != (code **)param_1) {
        ppcVar1 = ppcVar1 + -1;
        do {
          if ((ppcVar1[-1] != (code *)0x0) && (*ppcVar1 != (code *)0x0)) {
            (**ppcVar1)(0);
          }
          in_RAX = ppcVar1 + -1;
          ppcVar1 = ppcVar1 + -2;
        } while (in_RAX != (code **)param_1);
      }
      return (ulonglong)in_RAX & 0xffffffffffffff00;
    }
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 FUN_140018e44(longlong param_1,longlong param_2)

{
  code *in_RAX;
  bool bVar1;
  
  bVar1 = param_1 == param_2;
  while (!bVar1) {
    in_RAX = *(code **)(param_2 + -8);
    if (in_RAX != (code *)0x0) {
      in_RAX = (code *)(*in_RAX)(0);
    }
    param_2 = param_2 + -0x10;
    bVar1 = param_2 == param_1;
  }
  return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_140018e80(undefined8 param_1)

{
  _DAT_140039a28 = param_1;
  _DAT_140039a30 = param_1;
  _DAT_140039a38 = param_1;
  _DAT_140039a40 = param_1;
  return;
}



// Library Function - Single Match
//  __acrt_get_sigabrt_handler
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_get_sigabrt_handler(void)

{
  undefined local_res8 [8];
  int local_res10 [2];
  int local_res18 [4];
  
  local_res10[0] = 3;
  local_res18[0] = 3;
  operator____(local_res8,local_res18,local_res8,local_res10);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 FUN_140018ed0(uint param_1)

{
  longlong lVar1;
  bool bVar2;
  ulong *puVar3;
  __acrt_ptd *p_Var4;
  longlong lVar5;
  undefined8 uVar6;
  byte bVar7;
  code *pcVar8;
  code **ppcVar9;
  longlong *plVar10;
  undefined4 local_res10;
  longlong local_res18;
  longlong *plVar11;
  
  plVar11 = (longlong *)0x0;
  plVar10 = (longlong *)0x0;
  local_res10 = 0;
  bVar2 = true;
  if (param_1 == 2) {
LAB_140018f19:
    if (param_1 == 2) {
      ppcVar9 = (code **)&DAT_140039a28;
    }
    else if (param_1 == 6) {
LAB_140018f9f:
      ppcVar9 = (code **)&DAT_140039a38;
      plVar10 = plVar11;
    }
    else if (param_1 == 0xf) {
      ppcVar9 = (code **)&DAT_140039a40;
    }
    else if (param_1 == 0x15) {
      ppcVar9 = (code **)&DAT_140039a30;
      plVar10 = plVar11;
    }
    else {
      if (param_1 == 0x16) goto LAB_140018f9f;
      ppcVar9 = (code **)0x0;
      plVar10 = plVar11;
    }
  }
  else {
    if (param_1 != 4) {
      if (param_1 != 6) {
        if ((param_1 == 8) || (param_1 == 0xb)) goto LAB_140018f41;
        if ((param_1 != 0xf) && (1 < param_1 - 0x15)) goto LAB_140018f7f;
      }
      goto LAB_140018f19;
    }
LAB_140018f41:
    plVar10 = (longlong *)FUN_140017c70();
    if (plVar10 == (longlong *)0x0) {
      return 0xffffffff;
    }
    lVar5 = *plVar10;
    lVar1 = lVar5 + 0xc0;
    for (; lVar5 != lVar1; lVar5 = lVar5 + 0x10) {
      if (*(uint *)(lVar5 + 4) == param_1) goto LAB_140018f7a;
    }
    lVar5 = 0;
LAB_140018f7a:
    if (lVar5 == 0) {
LAB_140018f7f:
      puVar3 = __doserrno();
      *puVar3 = 0x16;
      FUN_140011e58();
      return 0xffffffff;
    }
    ppcVar9 = (code **)(lVar5 + 8);
    bVar2 = false;
  }
  local_res18 = 0;
  if (bVar2) {
    FID_conflict___acrt_lock(3);
  }
  pcVar8 = *ppcVar9;
  if (bVar2) {
    bVar7 = (byte)DAT_140038010 & 0x3f;
    pcVar8 = (code *)(((ulonglong)pcVar8 ^ DAT_140038010) >> bVar7 |
                     ((ulonglong)pcVar8 ^ DAT_140038010) << 0x40 - bVar7);
  }
  if (pcVar8 == (code *)0x1) goto LAB_1400190b6;
  if (pcVar8 == (code *)0x0) {
    if (bVar2) {
      FID_conflict___acrt_lock(3);
    }
    FUN_140010a7c(3);
    pcVar8 = (code *)swi(3);
    uVar6 = (*pcVar8)();
    return uVar6;
  }
  if ((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) {
    local_res18 = plVar10[1];
    plVar10[1] = 0;
    if (param_1 == 8) {
      p_Var4 = FUN_140017b04();
      local_res10 = *(undefined4 *)(p_Var4 + 0x10);
      p_Var4 = FUN_140017b04();
      *(undefined4 *)(p_Var4 + 0x10) = 0x8c;
      goto LAB_140019059;
    }
  }
  else {
LAB_140019059:
    if (param_1 == 8) {
      lVar1 = *plVar10;
      for (lVar5 = lVar1 + 0x30; lVar5 != lVar1 + 0xc0; lVar5 = lVar5 + 0x10) {
        *(undefined8 *)(lVar5 + 8) = 0;
      }
      goto LAB_1400190b6;
    }
  }
  bVar7 = 0x40 - ((byte)DAT_140038010 & 0x3f) & 0x3f;
  *ppcVar9 = (code *)(((ulonglong)(0 >> bVar7) | 0L << 0x40 - bVar7) ^ DAT_140038010);
LAB_1400190b6:
  if (bVar2) {
    FID_conflict___acrt_lock(3);
  }
  if (pcVar8 != (code *)0x1) {
    if (param_1 == 8) {
      p_Var4 = FUN_140017b04();
      (*pcVar8)(8,*(undefined4 *)(p_Var4 + 0x10),_guard_dispatch_icall);
    }
    else {
      (*pcVar8)(param_1,_guard_dispatch_icall);
    }
    if (((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) &&
       (plVar10[1] = local_res18, param_1 == 8)) {
      p_Var4 = FUN_140017b04();
      *(undefined4 *)(p_Var4 + 0x10) = local_res10;
    }
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Multiple Matches With Same Base Name
//  public: void (__cdecl*__cdecl __crt_seh_guarded_call<void (__cdecl*)(int)>::operator()<class
// <lambda_450d765d439847d4c735a33c368b5fc0>,class <lambda_44731a7d0e6d81c3e6aa82d741081786> &
// __ptr64,class <lambda_601a2a7da3b7a96e9554ac7215c4b07c> >(class
// <lambda_450d765d439847d4c735a33c368b5fc0> && __ptr64,class
// <lambda_44731a7d0e6d81c3e6aa82d741081786> & __ptr64,class
// <lambda_601a2a7da3b7a96e9554ac7215c4b07c> && __ptr64) __ptr64)(int)
//  public: void (__cdecl*__cdecl __crt_seh_guarded_call<void (__cdecl*)(int)>::operator()<class
// <lambda_c36588078e9f5dfd39652860aa6b3aaf>,class <lambda_ec61778202f4f5fc7e7711acc23c3bca> &
// __ptr64,class <lambda_dc9d2797ccde5d239b4a0efae8ebd7db> >(class
// <lambda_c36588078e9f5dfd39652860aa6b3aaf> && __ptr64,class
// <lambda_ec61778202f4f5fc7e7711acc23c3bca> & __ptr64,class
// <lambda_dc9d2797ccde5d239b4a0efae8ebd7db> && __ptr64) __ptr64)(int)
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong operator____(undefined8 param_1,int *param_2,undefined8 param_3,int *param_4)

{
  byte bVar1;
  ulonglong uVar2;
  
  FID_conflict___acrt_lock(*param_2);
  bVar1 = (byte)DAT_140038010 & 0x3f;
  uVar2 = DAT_140038010 ^ _DAT_140039a38;
  FID_conflict___acrt_lock(*param_4);
  return uVar2 >> bVar1 | uVar2 << 0x40 - bVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __acrt_stdio_begin_temporary_buffering_nolock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong __acrt_stdio_begin_temporary_buffering_nolock(FILE *param_1)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  undefined4 extraout_var;
  FILE *pFVar4;
  char *pcVar5;
  char **ppcVar6;
  
  iVar3 = _fileno(param_1);
  iVar3 = _isatty(iVar3);
  pFVar4 = (FILE *)CONCAT44(extraout_var,iVar3);
  if (iVar3 == 0) {
LAB_14001925a:
    return (ulonglong)pFVar4 & 0xffffffffffffff00;
  }
  pFVar4 = (FILE *)__acrt_iob_func(1);
  if (param_1 == pFVar4) {
    ppcVar6 = (char **)&DAT_140039a50;
  }
  else {
    pFVar4 = (FILE *)__acrt_iob_func(2);
    if (param_1 != pFVar4) goto LAB_14001925a;
    ppcVar6 = (char **)&DAT_140039a58;
  }
  _DAT_140038dc8 = _DAT_140038dc8 + 1;
  uVar2 = *(uint *)((longlong)&param_1->_base + 4);
  pFVar4 = (FILE *)(ulonglong)uVar2;
  if ((uVar2 & 0x4c0) != 0) goto LAB_14001925a;
  LOCK();
  puVar1 = (uint *)((longlong)&param_1->_base + 4);
  *puVar1 = *puVar1 | 0x282;
  pcVar5 = *ppcVar6;
  if (pcVar5 == (char *)0x0) {
    pcVar5 = (char *)_malloc_base(0x1000);
    *ppcVar6 = pcVar5;
    _free_base((LPVOID)0x0);
    pcVar5 = *ppcVar6;
    if (pcVar5 == (char *)0x0) {
      *(undefined4 *)&param_1->_base = 2;
      *(int **)&param_1->_cnt = &param_1->_file;
      param_1->_ptr = (char *)&param_1->_file;
      param_1->_charbuf = 2;
      goto LAB_14001923c;
    }
  }
  *(char **)&param_1->_cnt = pcVar5;
  pcVar5 = *ppcVar6;
  param_1->_ptr = pcVar5;
  *(undefined4 *)&param_1->_base = 0x1000;
  param_1->_charbuf = 0x1000;
LAB_14001923c:
  return CONCAT71((int7)((ulonglong)pcVar5 >> 8),1);
}



// Library Function - Single Match
//  __acrt_stdio_end_temporary_buffering_nolock
// 
// Library: Visual Studio 2017 Release

void __acrt_stdio_end_temporary_buffering_nolock(char param_1,FILE *param_2)

{
  uint *puVar1;
  
  if ((param_1 != '\0') && ((*(uint *)((longlong)&param_2->_base + 4) >> 9 & 1) != 0)) {
    __acrt_stdio_flush_nolock(param_2);
    LOCK();
    puVar1 = (uint *)((longlong)&param_2->_base + 4);
    *puVar1 = *puVar1 & 0xfffffd7f;
    param_2->_charbuf = 0;
    *(undefined8 *)&param_2->_cnt = 0;
    param_2->_ptr = (char *)0x0;
  }
  return;
}



// Library Function - Single Match
//  _calloc_base
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

LPVOID _calloc_base(ulonglong param_1,ulonglong param_2)

{
  int iVar1;
  LPVOID pvVar2;
  ulong *puVar3;
  size_t dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_1 * param_2;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar2 = HeapAlloc(DAT_1400395f8,8,dwBytes);
      if (pvVar2 != (LPVOID)0x0) {
        return pvVar2;
      }
      iVar1 = FUN_140012e60();
    } while ((iVar1 != 0) && (iVar1 = _callnewh(dwBytes), iVar1 != 0));
  }
  puVar3 = __doserrno();
  *puVar3 = 0xc;
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  _fcloseall
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl _fcloseall(void)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  int local_18;
  
  local_18 = 0;
  FID_conflict___acrt_lock(8);
  for (iVar3 = 3; iVar3 != DAT_140038db8; iVar3 = iVar3 + 1) {
    lVar4 = (longlong)iVar3;
    lVar1 = *(longlong *)(DAT_140038dc0 + lVar4 * 8);
    if (lVar1 != 0) {
      if (((*(uint *)(lVar1 + 0x14) >> 0xd & 1) != 0) &&
         (iVar2 = FUN_140013618(*(FILE **)(DAT_140038dc0 + lVar4 * 8)), iVar2 != -1)) {
        local_18 = local_18 + 1;
      }
      DeleteCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(DAT_140038dc0 + lVar4 * 8) + 0x30));
      _free_base(*(LPVOID *)(DAT_140038dc0 + lVar4 * 8));
      *(undefined8 *)(DAT_140038dc0 + lVar4 * 8) = 0;
    }
  }
  FID_conflict___acrt_lock(8);
  return local_18;
}



// Library Function - Single Match
//  __acrt_stdio_free_buffer_nolock
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

void __acrt_stdio_free_buffer_nolock(undefined8 *param_1)

{
  if (((*(uint *)((longlong)param_1 + 0x14) >> 0xd & 1) != 0) &&
     ((*(uint *)((longlong)param_1 + 0x14) >> 6 & 1) != 0)) {
    _free_base((LPVOID)param_1[1]);
    LOCK();
    *(uint *)((longlong)param_1 + 0x14) = *(uint *)((longlong)param_1 + 0x14) & 0xfffffebf;
    param_1[1] = 0;
    *param_1 = 0;
    *(undefined4 *)(param_1 + 2) = 0;
  }
  return;
}



uint FUN_140019410(uint param_1)

{
  uint uVar1;
  longlong local_28;
  longlong *local_20 [2];
  char local_10;
  
  if (DAT_140038e20 == 0) {
    uVar1 = *(ushort *)(PTR_DAT_1400386f0 + (ulonglong)(param_1 & 0xff) * 2) & 4;
  }
  else {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)0x0);
    if (*(int *)(local_20[0] + 1) < 2) {
      uVar1 = *(ushort *)(*local_20[0] + (ulonglong)(param_1 & 0xff) * 2) & 4;
    }
    else {
      uVar1 = FUN_1400229f8(param_1,4,(__crt_locale_pointers *)local_20);
    }
    if (local_10 != '\0') {
      *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
    }
  }
  return uVar1;
}



// Library Function - Single Match
//  tolower
// 
// Library: Visual Studio 2017 Release

int __cdecl tolower(int _C)

{
  if (DAT_140038e20 == 0) {
    if (_C - 0x41U < 0x1a) {
      _C = _C + 0x20;
    }
  }
  else {
    _C = _tolower_l(_C,(_locale_t)0x0);
  }
  return _C;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Single Match
//  _tolower_l
// 
// Library: Visual Studio 2015 Release

int __cdecl _tolower_l(int _C,_locale_t _Locale)

{
  int iVar1;
  ulonglong uVar2;
  ulong *puVar3;
  ushort local_res8;
  undefined local_resa;
  undefined2 local_res18;
  undefined local_res1a;
  longlong local_28;
  localeinfo_struct local_20;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)_Locale);
  if ((uint)_C < 0x100) {
    uVar2 = FUN_1400195f4(_C,(longlong **)&local_20);
    if ((char)uVar2 != '\0') {
      _C = (int)(local_20.locinfo)->pclmap[_C];
    }
  }
  else {
    local_res8 = 0;
    local_resa = 0;
    if (((int)(local_20.locinfo)->lc_collate_cp < 2) ||
       (iVar1 = _isleadbyte_l(_C >> 8 & 0xff,&local_20), iVar1 == 0)) {
      puVar3 = __doserrno();
      iVar1 = 1;
      *puVar3 = 0x2a;
      local_res8 = (ushort)(byte)_C;
    }
    else {
      iVar1 = 2;
      local_res8 = CONCAT11((byte)_C,(char)((uint)_C >> 8));
      local_resa = 0;
    }
    local_res18 = 0;
    local_res1a = 0;
    iVar1 = __acrt_LCMapStringA((__crt_locale_pointers *)&local_20,
                                (wchar_t *)(local_20.locinfo)->locale_name[2],0x100,
                                (char *)&local_res8,iVar1,(char *)&local_res18,3,
                                (local_20.locinfo)->lc_time_cp,1);
    if (iVar1 != 0) {
      _C = (int)(byte)local_res18;
      if (iVar1 != 1) {
        if (local_10 == '\0') {
          return (uint)CONCAT11((byte)local_res18,local_res18._1_1_);
        }
        *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
        return (uint)CONCAT11((byte)local_res18,local_res18._1_1_);
      }
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return _C;
}



ulonglong FUN_1400195f4(uint param_1,longlong **param_2)

{
  ushort uVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  if ((param_2 == (longlong **)0x0) || (*(int *)(*param_2 + 1) < 2)) {
    if (param_2 == (longlong **)0x0) {
      lVar3 = FUN_14001b8a8();
      uVar1 = *(ushort *)(lVar3 + (ulonglong)(byte)param_1 * 2);
    }
    else {
      uVar1 = *(ushort *)(**param_2 + (ulonglong)(byte)param_1 * 2);
    }
    uVar2 = (ulonglong)(uVar1 & 1);
  }
  else {
    uVar2 = FUN_1400229f8(param_1,1,(__crt_locale_pointers *)param_2);
  }
  return uVar2 & 0xffffffffffffff00 | (ulonglong)((int)uVar2 != 0);
}



// Library Function - Single Match
//  _malloc_base
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

LPVOID _malloc_base(ulonglong param_1)

{
  int iVar1;
  LPVOID pvVar2;
  ulong *puVar3;
  
  if (param_1 < 0xffffffffffffffe1) {
    if (param_1 == 0) {
      param_1 = 1;
    }
    do {
      pvVar2 = HeapAlloc(DAT_1400395f8,0,param_1);
      if (pvVar2 != (LPVOID)0x0) {
        return pvVar2;
      }
      iVar1 = FUN_140012e60();
    } while ((iVar1 != 0) && (iVar1 = _callnewh(param_1), iVar1 != 0));
  }
  puVar3 = __doserrno();
  *puVar3 = 0xc;
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  wcstol
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

long __cdecl wcstol(wchar_t *_Str,wchar_t **_EndPtr,int _Radix)

{
  uint uVar1;
  wchar_t *local_18;
  wchar_t **local_10;
  
  if (_EndPtr != (wchar_t **)0x0) {
    *_EndPtr = _Str;
  }
  local_18 = _Str;
  local_10 = _EndPtr;
  uVar1 = FUN_140019a38((__crt_locale_pointers *)0x0,&local_18,_Radix,1);
  return uVar1;
}



// Library Function - Single Match
//  strtol
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

long __cdecl strtol(char *_Str,char **_EndPtr,int _Radix)

{
  uint uVar1;
  byte *local_18;
  char **local_10;
  
  if (_EndPtr != (char **)0x0) {
    *_EndPtr = _Str;
  }
  local_18 = (byte *)_Str;
  local_10 = _EndPtr;
  uVar1 = FUN_1400196fc((__crt_locale_pointers *)0x0,&local_18,_Radix,1);
  return uVar1;
}



uint FUN_1400196fc(__crt_locale_pointers *param_1,byte **param_2,uint param_3,byte param_4)

{
  byte *pbVar1;
  uint uVar2;
  bool bVar3;
  byte bVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  ulong *puVar8;
  longlong *plVar9;
  byte bVar10;
  byte bVar11;
  byte *pbVar12;
  uint uVar13;
  longlong local_48;
  longlong *local_40 [2];
  char local_30;
  
  if ((*param_2 == (byte *)0x0) || ((param_3 != 0 && (0x22 < param_3 - 2)))) {
    puVar8 = __doserrno();
    *puVar8 = 0x16;
    FUN_140011e58();
LAB_140019734:
    if ((byte **)param_2[1] != (byte **)0x0) {
      *(byte **)param_2[1] = *param_2;
    }
    return 0;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_48,param_1);
  pbVar1 = *param_2;
  uVar13 = 0;
  bVar10 = *pbVar1;
  plVar9 = local_40[0];
  pbVar12 = pbVar1;
  while( true ) {
    pbVar12 = pbVar12 + 1;
    *param_2 = pbVar12;
    if (*(int *)(plVar9 + 1) < 2) {
      uVar5 = *(ushort *)(*plVar9 + (ulonglong)bVar10 * 2) & 8;
    }
    else {
      uVar5 = FUN_1400229f8((uint)bVar10,8,(__crt_locale_pointers *)local_40);
      pbVar12 = *param_2;
      plVar9 = local_40[0];
    }
    if (uVar5 == 0) break;
    pbVar12 = *param_2;
    bVar10 = *pbVar12;
  }
  bVar11 = param_4 | 2;
  if ((bVar10 == 0x2d) || (bVar11 = param_4, bVar10 == 0x2b)) {
    bVar10 = *pbVar12;
    pbVar12 = pbVar12 + 1;
    *param_2 = pbVar12;
  }
  if ((param_3 == 0) || (uVar5 = param_3, param_3 == 0x10)) {
    if ((byte)(bVar10 - 0x30) < 10) {
      iVar6 = (char)bVar10 + -0x30;
    }
    else if ((byte)(bVar10 + 0x9f) < 0x1a) {
      iVar6 = (char)bVar10 + -0x57;
    }
    else if ((byte)(bVar10 + 0xbf) < 0x1a) {
      iVar6 = (char)bVar10 + -0x37;
    }
    else {
      iVar6 = -1;
    }
    if (iVar6 == 0) {
      bVar4 = *pbVar12;
      *param_2 = pbVar12 + 1;
      if ((bVar4 + 0xa8 & 0xdf) == 0) {
        bVar10 = pbVar12[1];
        pbVar12 = pbVar12 + 2;
        *param_2 = pbVar12;
        uVar5 = 0x10;
        if (param_3 != 0) {
          uVar5 = param_3;
        }
      }
      else {
        uVar5 = 8;
        if (param_3 != 0) {
          uVar5 = param_3;
        }
        *param_2 = pbVar12;
        if ((bVar4 != 0) && (*pbVar12 != bVar4)) {
          puVar8 = __doserrno();
          *puVar8 = 0x16;
          FUN_140011e58();
          pbVar12 = *param_2;
        }
      }
    }
    else {
      uVar5 = 10;
      if (param_3 != 0) {
        uVar5 = param_3;
      }
    }
  }
  uVar2 = (uint)(0xffffffff / (ulonglong)uVar5);
  while( true ) {
    if ((byte)(bVar10 - 0x30) < 10) {
      uVar7 = (int)(char)bVar10 - 0x30;
    }
    else if ((byte)(bVar10 + 0x9f) < 0x1a) {
      uVar7 = (int)(char)bVar10 - 0x57;
    }
    else if ((byte)(bVar10 + 0xbf) < 0x1a) {
      uVar7 = (int)(char)bVar10 - 0x37;
    }
    else {
      uVar7 = 0xffffffff;
    }
    if ((uVar7 == 0xffffffff) || (uVar5 <= uVar7)) break;
    if ((uVar13 < uVar2) || ((uVar13 == uVar2 && (uVar7 <= (uint)(0xffffffff % (ulonglong)uVar5)))))
    {
      bVar3 = true;
      uVar13 = uVar13 * uVar5 + uVar7;
    }
    else {
      bVar3 = false;
    }
    bVar10 = **param_2;
    pbVar12 = *param_2 + 1;
    *param_2 = pbVar12;
    bVar4 = bVar11 | 0xc;
    bVar11 = bVar11 | 8;
    if (!bVar3) {
      bVar11 = bVar4;
    }
  }
  *param_2 = pbVar12 + -1;
  if ((bVar10 != 0) && (pbVar12[-1] != bVar10)) {
    puVar8 = __doserrno();
    *puVar8 = 0x16;
    FUN_140011e58();
  }
  if ((bVar11 & 8) == 0) {
    *param_2 = pbVar1;
    if (local_30 != '\0') {
      *(uint *)(local_48 + 0x3a8) = *(uint *)(local_48 + 0x3a8) & 0xfffffffd;
    }
    goto LAB_140019734;
  }
  uVar5 = 0x7fffffff;
  if ((bVar11 & 4) == 0) {
    if ((bVar11 & 1) != 0) {
      if ((bVar11 & 2) != 0) {
        uVar5 = 0x80000000;
      }
      if (uVar5 < uVar13) goto LAB_14001998e;
    }
    if ((bVar11 & 2) != 0) {
      uVar13 = -uVar13;
    }
  }
  else {
LAB_14001998e:
    puVar8 = __doserrno();
    *puVar8 = 0x22;
    if ((bVar11 & 1) != 0) {
      if ((bVar11 & 2) != 0) {
        if (local_30 != '\0') {
          *(uint *)(local_48 + 0x3a8) = *(uint *)(local_48 + 0x3a8) & 0xfffffffd;
        }
        if ((byte **)param_2[1] != (byte **)0x0) {
          *(byte **)param_2[1] = *param_2;
        }
        return 0x80000000;
      }
      if (local_30 != '\0') {
        *(uint *)(local_48 + 0x3a8) = *(uint *)(local_48 + 0x3a8) & 0xfffffffd;
      }
      if ((byte **)param_2[1] == (byte **)0x0) {
        return 0x7fffffff;
      }
      *(byte **)param_2[1] = *param_2;
      return 0x7fffffff;
    }
    uVar13 = 0xffffffff;
  }
  if (local_30 != '\0') {
    *(uint *)(local_48 + 0x3a8) = *(uint *)(local_48 + 0x3a8) & 0xfffffffd;
  }
  if ((byte **)param_2[1] == (byte **)0x0) {
    return uVar13;
  }
  *(byte **)param_2[1] = *param_2;
  return uVar13;
}



uint FUN_140019a38(__crt_locale_pointers *param_1,WCHAR **param_2,uint param_3,byte param_4)

{
  WCHAR WVar1;
  WCHAR *pWVar2;
  WCHAR *pWVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  ushort uVar7;
  int iVar8;
  ulong *puVar9;
  undefined6 extraout_var;
  uint uVar10;
  WCHAR WVar11;
  uint uVar12;
  byte bVar13;
  uint uVar14;
  longlong local_48 [3];
  char local_30;
  
  uVar12 = 0;
  if ((*param_2 == (WCHAR *)0x0) || ((param_3 != 0 && (0x22 < param_3 - 2)))) {
    puVar9 = __doserrno();
    *puVar9 = 0x16;
    FUN_140011e58();
    goto LAB_140019a6f;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_48,param_1);
  pWVar2 = *param_2;
  WVar11 = *pWVar2;
  pWVar3 = pWVar2;
  while( true ) {
    *param_2 = pWVar3 + 1;
    uVar7 = FUN_1400209d0(WVar11,8);
    if ((int)CONCAT62(extraout_var,uVar7) == 0) break;
    pWVar3 = *param_2;
    WVar11 = *pWVar3;
  }
  bVar13 = param_4 | 2;
  if (WVar11 != L'-') {
    bVar13 = param_4;
  }
  if ((WVar11 + L'ￕ' & 0xfffdU) == 0) {
    WVar11 = **param_2;
    *param_2 = *param_2 + 1;
  }
  iVar8 = 0xff10;
  uVar14 = param_3;
  if ((param_3 & 0xffffffef) != 0) goto LAB_140019d91;
  if ((ushort)WVar11 < 0x30) goto LAB_140019cee;
  if ((ushort)WVar11 < 0x3a) {
    iVar8 = (ushort)WVar11 - 0x30;
LAB_140019ce9:
    if (iVar8 == -1) goto LAB_140019cee;
  }
  else {
    if (0xff0f < (ushort)WVar11) {
      if ((ushort)WVar11 < 0xff1a) {
LAB_140019be2:
        iVar8 = (uint)(ushort)WVar11 - iVar8;
      }
      else {
        iVar8 = -1;
      }
      goto LAB_140019ce9;
    }
    if (0x65f < (ushort)WVar11) {
      if ((ushort)WVar11 < 0x66a) {
        iVar8 = (ushort)WVar11 - 0x660;
        goto LAB_140019ce9;
      }
      if (0x6ef < (ushort)WVar11) {
        if ((ushort)WVar11 < 0x6fa) {
          iVar8 = (ushort)WVar11 - 0x6f0;
          goto LAB_140019ce9;
        }
        if (0x965 < (ushort)WVar11) {
          if ((ushort)WVar11 < 0x970) {
            iVar8 = (ushort)WVar11 - 0x966;
            goto LAB_140019ce9;
          }
          if (0x9e5 < (ushort)WVar11) {
            if ((ushort)WVar11 < 0x9f0) {
              iVar8 = (ushort)WVar11 - 0x9e6;
              goto LAB_140019ce9;
            }
            iVar8 = 0xa66;
            if ((0xa65 < (ushort)WVar11) &&
               (((ushort)WVar11 < 0xa70 ||
                ((iVar8 = 0xae6, 0xae5 < (ushort)WVar11 &&
                 (((ushort)WVar11 < 0xaf0 ||
                  ((iVar8 = 0xb66, 0xb65 < (ushort)WVar11 &&
                   (((ushort)WVar11 < 0xb70 ||
                    ((iVar8 = 0xc66, 0xc65 < (ushort)WVar11 &&
                     (((ushort)WVar11 < 0xc70 ||
                      ((iVar8 = 0xce6, 0xce5 < (ushort)WVar11 &&
                       (((ushort)WVar11 < 0xcf0 ||
                        ((iVar8 = 0xd66, 0xd65 < (ushort)WVar11 &&
                         (((ushort)WVar11 < 0xd70 ||
                          ((iVar8 = 0xe50, 0xe4f < (ushort)WVar11 &&
                           (((ushort)WVar11 < 0xe5a ||
                            ((iVar8 = 0xed0, 0xecf < (ushort)WVar11 &&
                             (((ushort)WVar11 < 0xeda ||
                              ((iVar8 = 0xf20, 0xf1f < (ushort)WVar11 &&
                               (((ushort)WVar11 < 0xf2a ||
                                ((iVar8 = 0x1040, 0x103f < (ushort)WVar11 &&
                                 (((ushort)WVar11 < 0x104a ||
                                  ((iVar8 = 0x17e0, 0x17df < (ushort)WVar11 &&
                                   (((ushort)WVar11 < 0x17ea ||
                                    (iVar8 = 0x1810, (ushort)(WVar11 + L'\xe7f0') < 10))))))))))))))
                             )))))))))))))))))))))))))))))) goto LAB_140019be2;
          }
        }
      }
    }
LAB_140019cee:
    if (((ushort)(WVar11 + L'﾿') < 0x1a) || ((ushort)(WVar11 + L'ﾟ') < 0x1a)) {
      uVar14 = (ushort)WVar11 - 0x20;
      if (0x19 < (ushort)(WVar11 + L'���')) {
        uVar14 = (uint)(ushort)WVar11;
      }
      iVar8 = uVar14 - 0x37;
    }
    else {
      iVar8 = -1;
    }
  }
  if (iVar8 == 0) {
    pWVar3 = *param_2;
    WVar1 = *pWVar3;
    *param_2 = pWVar3 + 1;
    if ((WVar1 + L'ﾨ' & 0xffdfU) != 0) {
      uVar14 = 8;
      if (param_3 != 0) {
        uVar14 = param_3;
      }
      *param_2 = pWVar3;
      if ((WVar1 != L'\0') && (*pWVar3 != WVar1)) {
        puVar9 = __doserrno();
        *puVar9 = 0x16;
        FUN_140011e58();
      }
      goto LAB_140019d91;
    }
    WVar11 = pWVar3[1];
    *param_2 = pWVar3 + 2;
    uVar14 = 0x10;
  }
  else {
    uVar14 = 10;
  }
  if (param_3 != 0) {
    uVar14 = param_3;
  }
LAB_140019d91:
  uVar4 = (uint)(0xffffffff / (ulonglong)uVar14);
  do {
    if ((ushort)WVar11 < 0x30) goto LAB_140019f54;
    if ((ushort)WVar11 < 0x3a) {
      uVar10 = (ushort)WVar11 - 0x30;
LAB_140019f4f:
      if (uVar10 == 0xffffffff) goto LAB_140019f54;
    }
    else {
      if (0xff0f < (ushort)WVar11) {
        if ((ushort)WVar11 < 0xff1a) {
          uVar10 = (ushort)WVar11 - 0xff10;
        }
        else {
          uVar10 = 0xffffffff;
        }
        goto LAB_140019f4f;
      }
      iVar8 = 0x660;
      if (0x65f < (ushort)WVar11) {
        if ((ushort)WVar11 < 0x66a) {
LAB_140019de0:
          uVar10 = (uint)(ushort)WVar11 - iVar8;
          goto LAB_140019f4f;
        }
        iVar8 = 0x6f0;
        if (0x6ef < (ushort)WVar11) {
          if ((ushort)WVar11 < 0x6fa) goto LAB_140019de0;
          iVar8 = 0x966;
          if (0x965 < (ushort)WVar11) {
            if ((ushort)WVar11 < 0x970) goto LAB_140019de0;
            iVar8 = 0x9e6;
            if (0x9e5 < (ushort)WVar11) {
              if ((ushort)WVar11 < 0x9f0) goto LAB_140019de0;
              iVar8 = 0xa66;
              if (0xa65 < (ushort)WVar11) {
                if ((ushort)WVar11 < 0xa70) goto LAB_140019de0;
                iVar8 = 0xae6;
                if (0xae5 < (ushort)WVar11) {
                  if ((ushort)WVar11 < 0xaf0) goto LAB_140019de0;
                  iVar8 = 0xb66;
                  if (0xb65 < (ushort)WVar11) {
                    if ((ushort)WVar11 < 0xb70) goto LAB_140019de0;
                    iVar8 = 0xc66;
                    if (0xc65 < (ushort)WVar11) {
                      if ((ushort)WVar11 < 0xc70) goto LAB_140019de0;
                      iVar8 = 0xce6;
                      if (0xce5 < (ushort)WVar11) {
                        if ((ushort)WVar11 < 0xcf0) goto LAB_140019de0;
                        iVar8 = 0xd66;
                        if (0xd65 < (ushort)WVar11) {
                          if ((ushort)WVar11 < 0xd70) goto LAB_140019de0;
                          iVar8 = 0xe50;
                          if (0xe4f < (ushort)WVar11) {
                            if ((ushort)WVar11 < 0xe5a) goto LAB_140019de0;
                            iVar8 = 0xed0;
                            if (0xecf < (ushort)WVar11) {
                              if ((ushort)WVar11 < 0xeda) goto LAB_140019de0;
                              iVar8 = 0xf20;
                              if (0xf1f < (ushort)WVar11) {
                                if ((ushort)WVar11 < 0xf2a) goto LAB_140019de0;
                                iVar8 = 0x1040;
                                if (0x103f < (ushort)WVar11) {
                                  if ((ushort)WVar11 < 0x104a) goto LAB_140019de0;
                                  iVar8 = 0x17e0;
                                  if (0x17df < (ushort)WVar11) {
                                    if ((ushort)WVar11 < 0x17ea) goto LAB_140019de0;
                                    if ((ushort)(WVar11 + L'\xe7f0') < 10) {
                                      uVar10 = (ushort)WVar11 - 0x1810;
                                      goto LAB_140019f4f;
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
LAB_140019f54:
      if (((ushort)(WVar11 + L'﾿') < 0x1a) || ((ushort)(WVar11 + L'ﾟ') < 0x1a)) {
        uVar10 = (ushort)WVar11 - 0x20;
        if (0x19 < (ushort)(WVar11 + L'ﾟ')) {
          uVar10 = (uint)(ushort)WVar11;
        }
        uVar10 = uVar10 - 0x37;
      }
      else {
        uVar10 = 0xffffffff;
      }
    }
    if ((uVar10 == 0xffffffff) || (uVar14 <= uVar10)) break;
    if ((uVar12 < uVar4) ||
       ((uVar12 == uVar4 && (uVar10 <= (uint)(0xffffffff % (ulonglong)uVar14))))) {
      bVar5 = true;
      uVar12 = uVar12 * uVar14 + uVar10;
    }
    else {
      bVar5 = false;
    }
    WVar11 = **param_2;
    *param_2 = *param_2 + 1;
    bVar6 = bVar13 | 0xc;
    bVar13 = bVar13 | 8;
    if (!bVar5) {
      bVar13 = bVar6;
    }
  } while( true );
  pWVar3 = *param_2;
  *param_2 = pWVar3 + -1;
  if ((WVar11 != L'\0') && (pWVar3[-1] != WVar11)) {
    puVar9 = __doserrno();
    *puVar9 = 0x16;
    FUN_140011e58();
  }
  if ((bVar13 & 8) == 0) {
    *param_2 = pWVar2;
    if (local_30 != '\0') {
      *(uint *)(local_48[0] + 0x3a8) = *(uint *)(local_48[0] + 0x3a8) & 0xfffffffd;
    }
LAB_140019a6f:
    if ((WCHAR **)param_2[1] != (WCHAR **)0x0) {
      *(WCHAR **)param_2[1] = *param_2;
    }
    return 0;
  }
  uVar14 = 0x7fffffff;
  if ((bVar13 & 4) == 0) {
    if ((bVar13 & 1) != 0) {
      if ((bVar13 & 2) != 0) {
        uVar14 = 0x80000000;
      }
      if (uVar14 < uVar12) goto LAB_14001a03f;
    }
    if ((bVar13 & 2) != 0) {
      uVar12 = -uVar12;
    }
  }
  else {
LAB_14001a03f:
    puVar9 = __doserrno();
    *puVar9 = 0x22;
    if ((bVar13 & 1) != 0) {
      if ((bVar13 & 2) != 0) {
        if (local_30 != '\0') {
          *(uint *)(local_48[0] + 0x3a8) = *(uint *)(local_48[0] + 0x3a8) & 0xfffffffd;
        }
        if ((WCHAR **)param_2[1] != (WCHAR **)0x0) {
          *(WCHAR **)param_2[1] = *param_2;
        }
        return 0x80000000;
      }
      if (local_30 != '\0') {
        *(uint *)(local_48[0] + 0x3a8) = *(uint *)(local_48[0] + 0x3a8) & 0xfffffffd;
      }
      if ((WCHAR **)param_2[1] == (WCHAR **)0x0) {
        return 0x7fffffff;
      }
      *(WCHAR **)param_2[1] = *param_2;
      return 0x7fffffff;
    }
    uVar12 = 0xffffffff;
  }
  if (local_30 != '\0') {
    *(uint *)(local_48[0] + 0x3a8) = *(uint *)(local_48[0] + 0x3a8) & 0xfffffffd;
  }
  if ((WCHAR **)param_2[1] == (WCHAR **)0x0) {
    return uVar12;
  }
  *(WCHAR **)param_2[1] = *param_2;
  return uVar12;
}



void FUN_14001a0ec(wchar_t *param_1,char *param_2,size_t param_3)

{
  _mbtowc_l(param_1,param_2,param_3,(_locale_t)0x0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _mbtowc_l
// 
// Library: Visual Studio 2017 Release

int __cdecl _mbtowc_l(wchar_t *_DstCh,char *_SrcCh,size_t _SrcSizeInBytes,_locale_t _Locale)

{
  int iVar1;
  __uint64 _Var2;
  ulong *puVar3;
  uint uVar4;
  longlong local_28;
  localeinfo_struct local_20;
  char local_10;
  
  if ((_SrcCh == (char *)0x0) || (_SrcSizeInBytes == 0)) {
    _DAT_140039a60 = 0;
    return 0;
  }
  if (*_SrcCh == '\0') {
    if (_DstCh != (wchar_t *)0x0) {
      *_DstCh = L'\0';
    }
    return 0;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)_Locale);
  if ((local_20.locinfo)->lc_time_cp == 0xfde9) {
    _Var2 = __crt_mbstring::__mbrtowc_utf8
                      ((wchar_t *)_DstCh,_SrcCh,_SrcSizeInBytes,(_Mbstatet *)&DAT_140039a60);
    uVar4 = (uint)_Var2;
    if ((int)uVar4 < 0) {
      uVar4 = 0xffffffff;
    }
    goto LAB_14001a18f;
  }
  if ((local_20.locinfo)->locale_name[2] == (wchar_t *)0x0) {
    if (_DstCh != (wchar_t *)0x0) {
      *_DstCh = (ushort)(byte)*_SrcCh;
    }
LAB_14001a18a:
    uVar4 = 1;
  }
  else {
    iVar1 = _isleadbyte_l((uint)(byte)*_SrcCh,&local_20);
    if (iVar1 == 0) {
      iVar1 = __acrt_MultiByteToWideChar
                        ((local_20.locinfo)->lc_time_cp,9,_SrcCh,1,_DstCh,
                         (uint)(_DstCh != (wchar_t *)0x0));
      if (iVar1 != 0) goto LAB_14001a18a;
    }
    else {
      uVar4 = (local_20.locinfo)->lc_collate_cp;
      if ((((1 < (int)uVar4) && ((int)uVar4 <= (int)_SrcSizeInBytes)) &&
          (iVar1 = __acrt_MultiByteToWideChar
                             ((local_20.locinfo)->lc_time_cp,9,_SrcCh,uVar4,_DstCh,
                              (uint)(_DstCh != (wchar_t *)0x0)), iVar1 != 0)) ||
         (((ulonglong)(longlong)(int)(local_20.locinfo)->lc_collate_cp <= _SrcSizeInBytes &&
          (_SrcCh[1] != '\0')))) {
        uVar4 = (local_20.locinfo)->lc_collate_cp;
        goto LAB_14001a18f;
      }
    }
    puVar3 = __doserrno();
    uVar4 = 0xffffffff;
    *puVar3 = 0x2a;
  }
LAB_14001a18f:
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return uVar4;
}



// Library Function - Single Match
//  wctomb_s
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

errno_t __cdecl wctomb_s(int *_SizeConverted,char *_MbCh,rsize_t _SizeInBytes,wchar_t _WCh)

{
  undefined8 uVar1;
  
  uVar1 = FUN_14001a284(_SizeConverted,(undefined (*) [16])_MbCh,_SizeInBytes,_WCh,
                        (__crt_locale_pointers *)0x0);
  return (errno_t)uVar1;
}



undefined8
FUN_14001a284(int *param_1,undefined (*param_2) [16],ulonglong param_3,ushort param_4,
             __crt_locale_pointers *param_5)

{
  int iVar1;
  DWORD DVar2;
  ulong *puVar3;
  undefined8 uVar4;
  int local_res10 [2];
  ushort local_res20 [4];
  longlong local_28;
  longlong local_20;
  char local_10;
  
  if ((param_2 == (undefined (*) [16])0x0) && (param_3 != 0)) {
    if (param_1 != (int *)0x0) {
      *param_1 = 0;
    }
    return 0;
  }
  if (param_1 != (int *)0x0) {
    *param_1 = -1;
  }
  local_res20[0] = param_4;
  if (0x7fffffff < param_3) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
    return 0x16;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,param_5);
  if (*(longlong *)(local_20 + 0x138) == 0) {
    if (local_res20[0] < 0x100) {
      if (param_2 != (undefined (*) [16])0x0) {
        if (param_3 == 0) goto LAB_14001a3f1;
        (*param_2)[0] = (char)local_res20[0];
      }
      if (param_1 != (int *)0x0) {
        *param_1 = 1;
      }
LAB_14001a3c4:
      uVar4 = 0;
      goto LAB_14001a334;
    }
    if ((param_2 != (undefined (*) [16])0x0) && (param_3 != 0)) {
      FUN_14000ce30(param_2,0,param_3);
    }
  }
  else {
    local_res10[0] = 0;
    iVar1 = __acrt_WideCharToMultiByte
                      (*(uint *)(local_20 + 0xc),0,(char)local_res20,1,(char)param_2,(char)param_3,0
                       ,local_res10);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        if ((param_2 != (undefined (*) [16])0x0) && (param_3 != 0)) {
          FUN_14000ce30(param_2,0,param_3);
        }
LAB_14001a3f1:
        puVar3 = __doserrno();
        uVar4 = 0x22;
        *puVar3 = 0x22;
        FUN_140011e58();
        goto LAB_14001a334;
      }
    }
    else if (local_res10[0] == 0) {
      if (param_1 != (int *)0x0) {
        *param_1 = iVar1;
      }
      goto LAB_14001a3c4;
    }
  }
  puVar3 = __doserrno();
  uVar4 = 0x2a;
  *puVar3 = 0x2a;
LAB_14001a334:
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return uVar4;
}



void FUN_14001a408(longlong param_1,longlong *param_2)

{
  undefined **ppuVar1;
  
  if ((*param_2 != DAT_140039a48) && ((DAT_140038910 & *(uint *)(param_1 + 0x3a8)) == 0)) {
    ppuVar1 = FUN_14001c0e8();
    *param_2 = (longlong)ppuVar1;
  }
  return;
}



// Library Function - Single Match
//  __acrt_update_multibyte_info
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_update_multibyte_info(longlong param_1,longlong *param_2)

{
  longlong lVar1;
  
  if ((*param_2 != DAT_140039a08) && ((DAT_140038910 & *(uint *)(param_1 + 0x3a8)) == 0)) {
    lVar1 = __acrt_update_thread_multibyte_data();
    *param_2 = lVar1;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Single Match
//  __acrt_fp_format
// 
// Library: Visual Studio 2017 Release

ulonglong __acrt_fp_format(double *param_1,undefined8 *param_2,ulonglong param_3,char *param_4,
                          __uint64 param_5,int param_6,uint param_7,ulonglong param_8,
                          __crt_locale_pointers *param_9)

{
  double dVar1;
  uint uVar2;
  int iVar3;
  ulong uVar4;
  ulong *puVar5;
  ulonglong uVar6;
  undefined4 extraout_var;
  undefined4 extraout_var_00;
  undefined4 extraout_var_01;
  undefined4 extraout_var_02;
  bool bVar7;
  uint uVar8;
  undefined8 local_18;
  undefined8 local_10;
  
  if ((((param_2 == (undefined8 *)0x0) || (param_3 == 0)) || (param_4 == (char *)0x0)) ||
     (param_5 == 0)) {
    puVar5 = __doserrno();
    *puVar5 = 0x16;
    FUN_140011e58();
    return 0x16;
  }
  uVar8 = 1;
  if ((param_6 == 0x41) || (param_6 - 0x45U < 3)) {
    bVar7 = true;
  }
  else {
    bVar7 = false;
  }
  if ((param_8 & 8) == 0) {
    dVar1 = *param_1;
    uVar2 = (uint)((ulonglong)dVar1 >> 0x20);
    if ((uVar2 >> 0x14 & 0x7ff) == 0x7ff) {
      if (((ulonglong)dVar1 & 0xfffffffffffff) != 0) {
        if (((longlong)dVar1 < 0) && (((ulonglong)dVar1 & 0xfffffffffffff) == 0x8000000000000)) {
          uVar8 = 4;
        }
        else {
          uVar8 = ~(uVar2 >> 0x13) & 1 | 2;
        }
      }
      uVar6 = FUN_14001a6f8(uVar8,(byte)((ulonglong)dVar1 >> 0x3f),(char *)param_2,param_3,bVar7);
      return uVar6;
    }
  }
  uVar8 = (uint)(param_8 >> 4) & 1 | 2;
  if (param_6 == 0x41) {
LAB_14001a6aa:
    iVar3 = FUN_14001aae8(param_1,(char *)param_2,param_3,param_4,param_5,param_7,bVar7,uVar8,
                          param_9);
    uVar6 = CONCAT44(extraout_var_02,iVar3);
  }
  else {
    if (param_6 == 0x45) {
LAB_14001a671:
      iVar3 = fp_format_e(param_1,(char *)param_2,param_3,param_4,param_5,param_7,bVar7,uVar8,
                          param_9);
      return CONCAT44(extraout_var_01,iVar3);
    }
    if (param_6 == 0x46) {
LAB_14001a5e7:
      local_18 = 0;
      local_10 = 0;
      FUN_140022f78((ulonglong)*param_1,param_7,(undefined4 *)&local_18,param_4,param_5);
      uVar6 = param_3 - ((int)local_18 == 0x2d);
      if (param_3 == 0xffffffffffffffff) {
        uVar6 = param_3;
      }
      uVar4 = __acrt_fp_strflt_to_string
                        ((undefined8 *)((ulonglong)((int)local_18 == 0x2d) + (longlong)param_2),
                         uVar6,local_18._4_4_ + param_7,(longlong)&local_18);
      if (uVar4 != 0) {
        *(undefined *)param_2 = 0;
        return CONCAT44(extraout_var_00,uVar4);
      }
      uVar6 = FUN_14001ae50(param_2,param_3,param_7,(int *)&local_18,'\0',param_9);
      return uVar6;
    }
    if (param_6 != 0x47) {
      if (param_6 == 0x61) goto LAB_14001a6aa;
      if (param_6 == 0x65) goto LAB_14001a671;
      if (param_6 == 0x66) goto LAB_14001a5e7;
    }
    iVar3 = fp_format_g(param_1,(char *)param_2,param_3,param_4,param_5,param_7,bVar7,uVar8,param_9)
    ;
    uVar6 = CONCAT44(extraout_var,iVar3);
  }
  return uVar6;
}



void FUN_14001a6f8(int param_1,byte param_2,char *param_3,ulonglong param_4,byte param_5)

{
  code *pcVar1;
  uint uVar2;
  ulong uVar3;
  ulonglong uVar4;
  char *pcVar5;
  longlong lVar6;
  undefined auStackY_c8 [32];
  undefined *local_98 [4];
  undefined *local_78;
  undefined *local_70;
  undefined *local_68;
  undefined *local_60;
  char *local_58;
  undefined *local_50;
  char *local_48;
  undefined *local_40;
  char *local_38;
  undefined *local_30;
  char *local_28;
  undefined *local_20;
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStackY_c8;
  if (param_4 < (ulonglong)param_2 + 4) {
    *param_3 = '\0';
  }
  else {
    pcVar5 = param_3;
    if (param_2 != 0) {
      pcVar5 = param_3 + 1;
      *param_3 = '-';
      param_4 = param_4 - 1;
      *pcVar5 = '\0';
    }
    local_78 = &DAT_1400314a4;
    local_70 = &DAT_1400314a4;
    local_98[0] = &DAT_1400314c4;
    local_98[1] = &DAT_1400314c4;
    local_98[2] = &DAT_140031468;
    local_98[3] = &DAT_140031468;
    local_58 = "NAN(SNAN)";
    local_48 = "nan(snan)";
    local_50 = &DAT_1400314a4;
    local_30 = &DAT_1400314a4;
    local_38 = "NAN(IND)";
    lVar6 = (ulonglong)(param_1 - 1) * 4;
    local_28 = "nan(ind)";
    uVar2 = (param_5 ^ 1) * 2;
    local_68 = &DAT_14003143c;
    local_60 = &DAT_14003143c;
    uVar4 = 0xffffffffffffffff;
    local_40 = &DAT_14003143c;
    local_20 = &DAT_14003143c;
    do {
      uVar4 = uVar4 + 1;
    } while (local_98[(ulonglong)uVar2 + lVar6][uVar4] != '\0');
    uVar3 = FUN_140016cd4(pcVar5,param_4,
                          (longlong)local_98[(ulonglong)(uVar2 + (uVar4 < param_4 ^ 1)) + lVar6]);
    if (uVar3 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY_c8);
  return;
}



// Library Function - Single Match
//  int __cdecl fp_format_e_internal(char * __ptr64 const,unsigned __int64,int,bool,unsigned
// int,struct _strflt * __ptr64 const,bool,struct __crt_locale_pointers * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl
fp_format_e_internal
          (char *param_1,__uint64 param_2,int param_3,bool param_4,uint param_5,_strflt *param_6,
          bool param_7,__crt_locale_pointers *param_8)

{
  code *pcVar1;
  ulong uVar2;
  ulong *puVar3;
  undefined8 *puVar4;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  longlong lVar8;
  longlong local_28;
  longlong local_20;
  char local_10;
  longlong lVar9;
  
  iVar7 = 0;
  if (0 < param_3) {
    iVar7 = param_3;
  }
  if ((ulonglong)(longlong)(iVar7 + 9) < param_2) {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,param_8);
    if ((param_7) && (puVar4 = (undefined8 *)(param_1 + (*(int *)param_6 == 0x2d)), 0 < param_3)) {
      lVar8 = -1;
      do {
        lVar9 = lVar8;
        lVar8 = lVar9 + 1;
      } while (*(char *)((longlong)puVar4 + lVar8) != '\0');
      FUN_14001b140((undefined8 *)((longlong)puVar4 + 1),puVar4,lVar9 + 2);
    }
    pcVar5 = param_1;
    if (*(int *)param_6 == 0x2d) {
      *param_1 = '-';
      pcVar5 = param_1 + 1;
    }
    if (0 < param_3) {
      *pcVar5 = pcVar5[1];
      pcVar5 = pcVar5 + 1;
      *pcVar5 = ***(char ***)(local_20 + 0xf8);
    }
    pcVar5 = pcVar5 + ((ulonglong)param_7 ^ 1) + (longlong)param_3;
    pcVar6 = param_1 + (param_2 - (longlong)pcVar5);
    if (param_2 == 0xffffffffffffffff) {
      pcVar6 = (char *)param_2;
    }
    uVar2 = FUN_140016cd4(pcVar5,(longlong)pcVar6,(longlong)&DAT_140031528);
    if (uVar2 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar1 = (code *)swi(3);
      iVar7 = (*pcVar1)();
      return iVar7;
    }
    if (param_4) {
      *pcVar5 = 'E';
    }
    if (**(char **)(param_6 + 8) != '0') {
      iVar7 = *(int *)(param_6 + 4) + -1;
      if (iVar7 < 0) {
        iVar7 = -iVar7;
        pcVar5[1] = '-';
      }
      if (99 < iVar7) {
        pcVar5[2] = pcVar5[2] + (char)(iVar7 / 100);
        iVar7 = iVar7 % 100;
      }
      if (9 < iVar7) {
        pcVar5[3] = pcVar5[3] + (char)(iVar7 / 10);
        iVar7 = iVar7 % 10;
      }
      pcVar5[4] = pcVar5[4] + (char)iVar7;
    }
    if ((param_5 == 2) && (pcVar5[2] == '0')) {
      FUN_14001b140((undefined8 *)(pcVar5 + 2),(undefined8 *)(pcVar5 + 3),3);
    }
    if (local_10 != '\0') {
      *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
    }
    iVar7 = 0;
  }
  else {
    puVar3 = __doserrno();
    iVar7 = 0x22;
    *puVar3 = 0x22;
    FUN_140011e58();
  }
  return iVar7;
}



// Library Function - Single Match
//  int __cdecl fp_format_e(double const * __ptr64 const,char * __ptr64 const,unsigned __int64,char
// * __ptr64 const,unsigned __int64,int,bool,unsigned int,struct __crt_locale_pointers * __ptr64
// const)
// 
// Library: Visual Studio 2017 Release

int __cdecl
fp_format_e(double *param_1,char *param_2,__uint64 param_3,char *param_4,__uint64 param_5,
           int param_6,bool param_7,uint param_8,__crt_locale_pointers *param_9)

{
  ulong uVar1;
  ulonglong uVar2;
  int local_18 [4];
  
  uVar2 = (ulonglong)(param_6 + 2) + 1;
  if (uVar2 < param_5) {
    param_5 = uVar2;
  }
  FUN_140022f78((ulonglong)*param_1,param_6 + 1,local_18,param_4,param_5);
  uVar2 = (param_3 - (0 < param_6)) - (ulonglong)(local_18[0] == 0x2d);
  if (param_3 == 0xffffffffffffffff) {
    uVar2 = param_3;
  }
  uVar1 = __acrt_fp_strflt_to_string
                    ((undefined8 *)
                     (param_2 + (ulonglong)(local_18[0] == 0x2d) + (ulonglong)(0 < param_6)),uVar2,
                     param_6 + 1,(longlong)local_18);
  if (uVar1 == 0) {
    uVar1 = fp_format_e_internal
                      (param_2,param_3,param_6,param_7,param_8,(_strflt *)local_18,false,param_9);
  }
  else {
    *param_2 = '\0';
  }
  return uVar1;
}



int FUN_14001aae8(double *param_1,char *param_2,ulonglong param_3,char *param_4,__uint64 param_5,
                 uint param_6,byte param_7,uint param_8,__crt_locale_pointers *param_9)

{
  undefined (*pauVar1) [16];
  ushort uVar2;
  int iVar3;
  ulong *puVar4;
  char *pcVar5;
  double dVar6;
  undefined (*pauVar7) [16];
  longlong lVar8;
  longlong lVar9;
  char cVar10;
  short sVar11;
  ulonglong uVar12;
  undefined (*pauVar13) [16];
  uint uVar14;
  short sVar15;
  char *pcVar16;
  ulonglong uVar17;
  int iVar18;
  undefined (*pauVar19) [16];
  longlong local_48;
  longlong local_40;
  char local_30;
  
  *param_2 = '\0';
  iVar18 = 0;
  uVar14 = 0;
  if (-1 < (int)param_6) {
    uVar14 = param_6;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_48,param_9);
  if ((ulonglong)(longlong)(int)(uVar14 + 0xb) < param_3) {
    dVar6 = *param_1;
    if (((ulonglong)dVar6 >> 0x34 & 0x7ff) == 0x7ff) {
      iVar3 = fp_format_e(param_1,param_2,param_3,param_4,param_5,uVar14,false,param_8,
                          (__crt_locale_pointers *)0x0);
      if (iVar3 == 0) {
        pcVar5 = strrchr(param_2,0x65);
        if (pcVar5 != (char *)0x0) {
          *pcVar5 = (param_7 ^ 1) * ' ' + 'P';
          pcVar5[3] = '\0';
        }
      }
      else {
        *param_2 = '\0';
        iVar18 = iVar3;
      }
    }
    else {
      if ((longlong)dVar6 < 0) {
        *param_2 = '-';
        param_2 = param_2 + 1;
        dVar6 = *param_1;
      }
      pauVar19 = (undefined (*) [16])(param_2 + 1);
      uVar12 = 0x3ff;
      sVar11 = (ushort)(param_7 ^ 1) * 0x20 + 7;
      if (((ulonglong)dVar6 & 0x7ff0000000000000) == 0) {
        *param_2 = '0';
        uVar12 = (ulonglong)(-(uint)(((ulonglong)*param_1 & 0xfffffffffffff) != 0) & 0x3fe);
      }
      else {
        *param_2 = '1';
      }
      pauVar13 = (undefined (*) [16])(param_2 + 2);
      if (uVar14 == 0) {
        cVar10 = '\0';
      }
      else {
        cVar10 = ***(char ***)(local_40 + 0xf8);
      }
      (*pauVar19)[0] = cVar10;
      if (((ulonglong)*param_1 & 0xfffffffffffff) != 0) {
        sVar15 = 0x30;
        uVar17 = 0xf000000000000;
        do {
          if ((int)uVar14 < 1) break;
          uVar2 = (short)(((ulonglong)*param_1 & uVar17) >> ((byte)sVar15 & 0x3f)) + 0x30;
          if (0x39 < uVar2) {
            uVar2 = uVar2 + sVar11;
          }
          (*pauVar13)[0] = (char)uVar2;
          uVar14 = uVar14 - 1;
          pauVar13 = (undefined (*) [16])(*pauVar13 + 1);
          uVar17 = uVar17 >> 4;
          sVar15 = sVar15 + -4;
        } while (-1 < sVar15);
        if ((-1 < sVar15) &&
           (pauVar1 = pauVar13,
           8 < (ushort)(((ulonglong)*param_1 & uVar17) >> ((byte)sVar15 & 0x3f)))) {
          while (pauVar7 = (undefined (*) [16])(pauVar1[-1] + 0xf),
                ((*pauVar7)[0] + 0xba & 0xdf) == 0) {
            (*pauVar7)[0] = '0';
            pauVar1 = pauVar7;
          }
          if (pauVar7 == pauVar19) {
            pauVar1[-1][0xe] = pauVar1[-1][0xe] + '\x01';
          }
          else {
            if ((*pauVar7)[0] == '9') {
              cVar10 = (char)sVar11 + '9';
            }
            else {
              cVar10 = (*pauVar7)[0];
            }
            (*pauVar7)[0] = cVar10 + '\x01';
          }
        }
      }
      if (0 < (int)uVar14) {
        FUN_14000ce30(pauVar13,0x30,(ulonglong)uVar14);
        pauVar13 = (undefined (*) [16])(*pauVar13 + uVar14);
      }
      if ((*pauVar19)[0] != '\0') {
        pauVar19 = pauVar13;
      }
      (*pauVar19)[0] = (param_7 ^ 1) * ' ' + 'P';
      pcVar5 = *pauVar19 + 2;
      lVar8 = ((uint)((ulonglong)*param_1 >> 0x34) & 0x7ff) - uVar12;
      lVar9 = lVar8;
      if (lVar8 < 0) {
        lVar9 = -lVar8;
      }
      cVar10 = '+';
      if (lVar8 < 0) {
        cVar10 = '-';
      }
      (*pauVar19)[1] = cVar10;
      *pcVar5 = '0';
      pcVar16 = pcVar5;
      if (999 < lVar9) {
        pcVar16 = *pauVar19 + 3;
        *pcVar5 = (char)(lVar9 / 1000) + '0';
        lVar9 = lVar9 % 1000;
      }
      if ((pcVar16 != pcVar5) || (99 < lVar9)) {
        lVar8 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar9) >> 0x40,0) + lVar9;
        lVar8 = (lVar8 >> 6) - (lVar8 >> 0x3f);
        *pcVar16 = (char)lVar8 + '0';
        pcVar16 = pcVar16 + 1;
        lVar9 = lVar9 + lVar8 * -100;
      }
      if ((pcVar16 != pcVar5) || (9 < lVar9)) {
        *pcVar16 = (char)(lVar9 / 10) + '0';
        pcVar16 = pcVar16 + 1;
        lVar9 = lVar9 % 10;
      }
      *pcVar16 = (char)lVar9 + '0';
      pcVar16[1] = '\0';
    }
  }
  else {
    puVar4 = __doserrno();
    *puVar4 = 0x22;
    FUN_140011e58();
    iVar18 = 0x22;
  }
  if (local_30 != '\0') {
    *(uint *)(local_48 + 0x3a8) = *(uint *)(local_48 + 0x3a8) & 0xfffffffd;
  }
  return iVar18;
}



undefined8
FUN_14001ae50(undefined8 *param_1,undefined8 param_2,int param_3,int *param_4,char param_5,
             __crt_locale_pointers *param_6)

{
  undefined (*pauVar1) [16];
  int iVar2;
  undefined8 *puVar3;
  longlong lVar4;
  longlong lVar5;
  longlong local_28;
  longlong local_20;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,param_6);
  if ((param_5 != '\0') && (param_4[1] + -1 == param_3)) {
    *(undefined2 *)((longlong)param_1 + (longlong)(param_4[1] + -1) + (ulonglong)(*param_4 == 0x2d))
         = 0x30;
  }
  if (*param_4 == 0x2d) {
    *(undefined *)param_1 = 0x2d;
    param_1 = (undefined8 *)((longlong)param_1 + 1);
  }
  if (param_4[1] < 1) {
    lVar5 = -1;
    do {
      lVar4 = lVar5;
      lVar5 = lVar4 + 1;
    } while (*(char *)((longlong)param_1 + lVar5) != '\0');
    FUN_14001b140((undefined8 *)((longlong)param_1 + 1),param_1,lVar4 + 2);
    *(undefined *)param_1 = 0x30;
    puVar3 = (undefined8 *)((longlong)param_1 + 1);
  }
  else {
    puVar3 = (undefined8 *)((longlong)param_1 + (longlong)param_4[1]);
  }
  if (0 < param_3) {
    pauVar1 = (undefined (*) [16])((longlong)puVar3 + 1);
    lVar5 = -1;
    do {
      lVar4 = lVar5;
      lVar5 = lVar4 + 1;
    } while (*(char *)((longlong)puVar3 + lVar5) != '\0');
    FUN_14001b140((undefined8 *)pauVar1,puVar3,lVar4 + 2);
    *(undefined *)puVar3 = *(undefined *)**(undefined8 **)(local_20 + 0xf8);
    if (param_4[1] < 0) {
      iVar2 = -param_4[1];
      if ((param_5 != '\0') || (iVar2 < param_3)) {
        param_3 = iVar2;
      }
      lVar5 = -1;
      if (param_3 != 0) {
        do {
          lVar4 = lVar5;
          lVar5 = lVar4 + 1;
        } while ((*pauVar1)[lVar5] != '\0');
        FUN_14001b140((undefined8 *)(*pauVar1 + param_3),(undefined8 *)pauVar1,lVar4 + 2);
      }
      FUN_14000ce30(pauVar1,0x30,(longlong)param_3);
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Single Match
//  int __cdecl fp_format_g(double const * __ptr64 const,char * __ptr64 const,unsigned __int64,char
// * __ptr64 const,unsigned __int64,int,bool,unsigned int,struct __crt_locale_pointers * __ptr64
// const)
// 
// Library: Visual Studio 2017 Release

int __cdecl
fp_format_g(double *param_1,char *param_2,__uint64 param_3,char *param_4,__uint64 param_5,
           int param_6,bool param_7,uint param_8,__crt_locale_pointers *param_9)

{
  undefined8 *puVar1;
  ulong uVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  int iVar6;
  undefined8 local_18;
  undefined8 local_10;
  
  local_18 = 0;
  local_10 = 0;
  FUN_140022f78((ulonglong)*param_1,param_6,(undefined4 *)&local_18,param_4,param_5);
  iVar6 = local_18._4_4_ + -1;
  uVar4 = param_3 - ((int)local_18 == 0x2d);
  if (param_3 == 0xffffffffffffffff) {
    uVar4 = param_3;
  }
  uVar2 = __acrt_fp_strflt_to_string
                    ((undefined8 *)(param_2 + ((int)local_18 == 0x2d)),uVar4,param_6,
                     (longlong)&local_18);
  if (uVar2 == 0) {
    local_18._4_4_ = local_18._4_4_ + -1;
    if ((local_18._4_4_ < -4) || (param_6 <= local_18._4_4_)) {
      uVar2 = fp_format_e_internal
                        (param_2,param_3,param_6,param_7,param_8,(_strflt *)&local_18,true,param_9);
    }
    else {
      puVar1 = (undefined8 *)(param_2 + ((int)local_18 == 0x2d));
      if (iVar6 < local_18._4_4_) {
        do {
          puVar5 = puVar1;
          puVar1 = (undefined8 *)((longlong)puVar5 + 1);
        } while (*(char *)puVar5 != '\0');
        *(undefined *)((longlong)puVar5 + -1) = 0;
      }
      uVar3 = FUN_14001ae50((undefined8 *)param_2,param_3,param_6,(int *)&local_18,'\x01',param_9);
      uVar2 = (ulong)uVar3;
    }
  }
  else {
    *param_2 = '\0';
  }
  return uVar2;
}



// Library Function - Single Match
//  _fileno
// 
// Library: Visual Studio 2015 Release

int __cdecl _fileno(FILE *_File)

{
  int iVar1;
  ulong *puVar2;
  
  if (_File == (FILE *)0x0) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    iVar1 = -1;
  }
  else {
    iVar1 = _File->_flag;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _get_printf_count_output
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl _get_printf_count_output(void)

{
  return (uint)(_DAT_140039a68 == (DAT_140038010 | 1));
}



void FUN_14001b120(undefined *param_1,undefined8 param_2,longlong param_3)

{
  undefined *in_R10;
  
  for (; param_3 != 0; param_3 = param_3 + -1) {
    *param_1 = *in_R10;
    in_R10 = in_R10 + 1;
    param_1 = param_1 + 1;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 * FUN_14001b140(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  undefined uVar2;
  undefined2 uVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  longlong lVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined4 uVar19;
  
  if (param_3 < 0x11) {
    switch(param_3) {
    case 0:
      return param_1;
    case 1:
      *(undefined *)param_1 = *(undefined *)param_2;
      return param_1;
    case 2:
      *(undefined2 *)param_1 = *(undefined2 *)param_2;
      return param_1;
    case 3:
      uVar2 = *(undefined *)((longlong)param_2 + 2);
      *(undefined2 *)param_1 = *(undefined2 *)param_2;
      *(undefined *)((longlong)param_1 + 2) = uVar2;
      return param_1;
    case 4:
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      return param_1;
    case 5:
      uVar2 = *(undefined *)((longlong)param_2 + 4);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined *)((longlong)param_1 + 4) = uVar2;
      return param_1;
    case 6:
      uVar3 = *(undefined2 *)((longlong)param_2 + 4);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined2 *)((longlong)param_1 + 4) = uVar3;
      return param_1;
    case 7:
      uVar3 = *(undefined2 *)((longlong)param_2 + 4);
      uVar2 = *(undefined *)((longlong)param_2 + 6);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined2 *)((longlong)param_1 + 4) = uVar3;
      *(undefined *)((longlong)param_1 + 6) = uVar2;
      return param_1;
    case 8:
      *param_1 = *param_2;
      return param_1;
    case 9:
      uVar2 = *(undefined *)(param_2 + 1);
      *param_1 = *param_2;
      *(undefined *)(param_1 + 1) = uVar2;
      return param_1;
    case 10:
      uVar3 = *(undefined2 *)(param_2 + 1);
      *param_1 = *param_2;
      *(undefined2 *)(param_1 + 1) = uVar3;
      return param_1;
    case 0xb:
      uVar3 = *(undefined2 *)(param_2 + 1);
      uVar2 = *(undefined *)((longlong)param_2 + 10);
      *param_1 = *param_2;
      *(undefined2 *)(param_1 + 1) = uVar3;
      *(undefined *)((longlong)param_1 + 10) = uVar2;
      return param_1;
    case 0xc:
      uVar16 = *(undefined4 *)(param_2 + 1);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar16;
      return param_1;
    case 0xd:
      uVar16 = *(undefined4 *)(param_2 + 1);
      uVar2 = *(undefined *)((longlong)param_2 + 0xc);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar16;
      *(undefined *)((longlong)param_1 + 0xc) = uVar2;
      return param_1;
    case 0xe:
      uVar16 = *(undefined4 *)(param_2 + 1);
      uVar3 = *(undefined2 *)((longlong)param_2 + 0xc);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar16;
      *(undefined2 *)((longlong)param_1 + 0xc) = uVar3;
      return param_1;
    case 0xf:
      uVar16 = *(undefined4 *)(param_2 + 1);
      uVar3 = *(undefined2 *)((longlong)param_2 + 0xc);
      uVar2 = *(undefined *)((longlong)param_2 + 0xe);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar16;
      *(undefined2 *)((longlong)param_1 + 0xc) = uVar3;
      *(undefined *)((longlong)param_1 + 0xe) = uVar2;
      return param_1;
    case 0x10:
      uVar16 = *(undefined4 *)((longlong)param_2 + 4);
      uVar17 = *(undefined4 *)(param_2 + 1);
      uVar18 = *(undefined4 *)((longlong)param_2 + 0xc);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined4 *)((longlong)param_1 + 4) = uVar16;
      *(undefined4 *)(param_1 + 1) = uVar17;
      *(undefined4 *)((longlong)param_1 + 0xc) = uVar18;
      return param_1;
    }
  }
  if (0x20 < param_3) {
    lVar9 = (longlong)param_2 - (longlong)param_1;
    if ((param_2 < param_1) && (param_1 < (undefined8 *)(param_3 + (longlong)param_2))) {
      puVar8 = (undefined4 *)((longlong)param_1 + lVar9 + (param_3 - 0x10));
      uVar16 = puVar8[1];
      uVar17 = puVar8[2];
      uVar18 = puVar8[3];
      puVar6 = (undefined4 *)((longlong)param_1 + (param_3 - 0x10));
      uVar10 = param_3 - 0x10;
      puVar7 = puVar6;
      uVar19 = *puVar8;
      uVar12 = uVar16;
      uVar13 = uVar17;
      uVar14 = uVar18;
      if (((ulonglong)puVar6 & 0xf) != 0) {
        puVar7 = (undefined4 *)((ulonglong)puVar6 & 0xfffffffffffffff0);
        puVar1 = (undefined4 *)((longlong)puVar7 + lVar9);
        uVar19 = *puVar1;
        uVar12 = puVar1[1];
        uVar13 = puVar1[2];
        uVar14 = puVar1[3];
        *puVar6 = *puVar8;
        *(undefined4 *)((longlong)param_1 + (param_3 - 0xc)) = uVar16;
        *(undefined4 *)((longlong)param_1 + (param_3 - 8)) = uVar17;
        *(undefined4 *)((longlong)param_1 + (param_3 - 4)) = uVar18;
        uVar10 = (longlong)puVar7 - (longlong)param_1;
      }
      uVar11 = uVar10 >> 7;
      if (uVar11 != 0) {
        *puVar7 = uVar19;
        puVar7[1] = uVar12;
        puVar7[2] = uVar13;
        puVar7[3] = uVar14;
        puVar8 = puVar7;
        while( true ) {
          puVar6 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x10);
          uVar16 = puVar6[1];
          uVar17 = puVar6[2];
          uVar18 = puVar6[3];
          puVar7 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x20);
          uVar19 = *puVar7;
          uVar12 = puVar7[1];
          uVar13 = puVar7[2];
          uVar14 = puVar7[3];
          puVar7 = puVar8 + -0x20;
          puVar8[-4] = *puVar6;
          puVar8[-3] = uVar16;
          puVar8[-2] = uVar17;
          puVar8[-1] = uVar18;
          puVar8[-8] = uVar19;
          puVar8[-7] = uVar12;
          puVar8[-6] = uVar13;
          puVar8[-5] = uVar14;
          puVar6 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x30);
          uVar16 = puVar6[1];
          uVar17 = puVar6[2];
          uVar18 = puVar6[3];
          puVar1 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x40);
          uVar19 = *puVar1;
          uVar12 = puVar1[1];
          uVar13 = puVar1[2];
          uVar14 = puVar1[3];
          uVar11 = uVar11 - 1;
          puVar8[-0xc] = *puVar6;
          puVar8[-0xb] = uVar16;
          puVar8[-10] = uVar17;
          puVar8[-9] = uVar18;
          puVar8[-0x10] = uVar19;
          puVar8[-0xf] = uVar12;
          puVar8[-0xe] = uVar13;
          puVar8[-0xd] = uVar14;
          puVar6 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x50);
          uVar16 = puVar6[1];
          uVar17 = puVar6[2];
          uVar18 = puVar6[3];
          puVar1 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x60);
          uVar19 = *puVar1;
          uVar12 = puVar1[1];
          uVar13 = puVar1[2];
          uVar14 = puVar1[3];
          puVar8[-0x14] = *puVar6;
          puVar8[-0x13] = uVar16;
          puVar8[-0x12] = uVar17;
          puVar8[-0x11] = uVar18;
          puVar8[-0x18] = uVar19;
          puVar8[-0x17] = uVar12;
          puVar8[-0x16] = uVar13;
          puVar8[-0x15] = uVar14;
          puVar1 = (undefined4 *)((longlong)puVar8 + lVar9 + -0x70);
          uVar16 = puVar1[1];
          uVar17 = puVar1[2];
          uVar18 = puVar1[3];
          puVar6 = (undefined4 *)((longlong)puVar7 + lVar9);
          uVar19 = *puVar6;
          uVar12 = puVar6[1];
          uVar13 = puVar6[2];
          uVar14 = puVar6[3];
          if (uVar11 == 0) break;
          puVar8[-0x1c] = *puVar1;
          puVar8[-0x1b] = uVar16;
          puVar8[-0x1a] = uVar17;
          puVar8[-0x19] = uVar18;
          *puVar7 = uVar19;
          puVar8[-0x1f] = uVar12;
          puVar8[-0x1e] = uVar13;
          puVar8[-0x1d] = uVar14;
          puVar8 = puVar7;
        }
        puVar8[-0x1c] = *puVar1;
        puVar8[-0x1b] = uVar16;
        puVar8[-0x1a] = uVar17;
        puVar8[-0x19] = uVar18;
        uVar10 = uVar10 & 0x7f;
      }
      for (uVar11 = uVar10 >> 4; uVar11 != 0; uVar11 = uVar11 - 1) {
        *puVar7 = uVar19;
        puVar7[1] = uVar12;
        puVar7[2] = uVar13;
        puVar7[3] = uVar14;
        puVar7 = puVar7 + -4;
        puVar8 = (undefined4 *)((longlong)puVar7 + lVar9);
        uVar19 = *puVar8;
        uVar12 = puVar8[1];
        uVar13 = puVar8[2];
        uVar14 = puVar8[3];
      }
      if ((uVar10 & 0xf) != 0) {
        uVar16 = *(undefined4 *)((longlong)param_2 + 4);
        uVar17 = *(undefined4 *)(param_2 + 1);
        uVar18 = *(undefined4 *)((longlong)param_2 + 0xc);
        *(undefined4 *)param_1 = *(undefined4 *)param_2;
        *(undefined4 *)((longlong)param_1 + 4) = uVar16;
        *(undefined4 *)(param_1 + 1) = uVar17;
        *(undefined4 *)((longlong)param_1 + 0xc) = uVar18;
      }
      *puVar7 = uVar19;
      puVar7[1] = uVar12;
      puVar7[2] = uVar13;
      puVar7[3] = uVar14;
      return param_1;
    }
    if (param_3 < 0x81) {
      puVar8 = (undefined4 *)((longlong)param_1 + lVar9);
      uVar16 = *puVar8;
      uVar17 = puVar8[1];
      uVar18 = puVar8[2];
      uVar19 = puVar8[3];
      puVar4 = param_1 + 2;
      uVar10 = param_3 - 0x10;
    }
    else {
      if ((DAT_140038d70 >> 1 & 1) != 0) {
        puVar4 = (undefined8 *)FUN_14001b120((undefined *)param_1,lVar9,param_3);
        return puVar4;
      }
      puVar8 = (undefined4 *)((longlong)param_1 + lVar9);
      uVar12 = puVar8[1];
      uVar13 = puVar8[2];
      uVar14 = puVar8[3];
      puVar5 = param_1 + 2;
      uVar16 = *puVar8;
      uVar17 = uVar12;
      uVar18 = uVar13;
      uVar19 = uVar14;
      if (((ulonglong)param_1 & 0xf) != 0) {
        puVar7 = (undefined4 *)(((ulonglong)puVar5 & 0xfffffffffffffff0) + lVar9);
        uVar16 = *puVar7;
        uVar17 = puVar7[1];
        uVar18 = puVar7[2];
        uVar19 = puVar7[3];
        puVar5 = (undefined8 *)(((ulonglong)puVar5 & 0xfffffffffffffff0) + 0x10);
        *(undefined4 *)param_1 = *puVar8;
        *(undefined4 *)((longlong)param_1 + 4) = uVar12;
        *(undefined4 *)(param_1 + 1) = uVar13;
        *(undefined4 *)((longlong)param_1 + 0xc) = uVar14;
      }
      uVar10 = (longlong)param_1 + (param_3 - (longlong)puVar5);
      uVar11 = uVar10 >> 7;
      puVar4 = puVar5;
      if (uVar11 != 0) {
        *(undefined4 *)(puVar5 + -2) = uVar16;
        *(undefined4 *)((longlong)puVar5 + -0xc) = uVar17;
        *(undefined4 *)(puVar5 + -1) = uVar18;
        *(undefined4 *)((longlong)puVar5 + -4) = uVar19;
        if (_DAT_140038020 < uVar11) {
          while( true ) {
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9);
            uVar16 = puVar8[1];
            uVar17 = puVar8[2];
            uVar18 = puVar8[3];
            puVar7 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x10);
            uVar19 = *puVar7;
            uVar12 = puVar7[1];
            uVar13 = puVar7[2];
            uVar14 = puVar7[3];
            puVar4 = puVar5 + 0x10;
            *(undefined4 *)puVar5 = *puVar8;
            *(undefined4 *)((longlong)puVar5 + 4) = uVar16;
            *(undefined4 *)(puVar5 + 1) = uVar17;
            *(undefined4 *)((longlong)puVar5 + 0xc) = uVar18;
            *(undefined4 *)(puVar5 + 2) = uVar19;
            *(undefined4 *)((longlong)puVar5 + 0x14) = uVar12;
            *(undefined4 *)(puVar5 + 3) = uVar13;
            *(undefined4 *)((longlong)puVar5 + 0x1c) = uVar14;
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x20);
            uVar16 = puVar8[1];
            uVar17 = puVar8[2];
            uVar18 = puVar8[3];
            puVar7 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x30);
            uVar19 = *puVar7;
            uVar12 = puVar7[1];
            uVar13 = puVar7[2];
            uVar14 = puVar7[3];
            uVar11 = uVar11 - 1;
            *(undefined4 *)(puVar5 + 4) = *puVar8;
            *(undefined4 *)((longlong)puVar5 + 0x24) = uVar16;
            *(undefined4 *)(puVar5 + 5) = uVar17;
            *(undefined4 *)((longlong)puVar5 + 0x2c) = uVar18;
            *(undefined4 *)(puVar5 + 6) = uVar19;
            *(undefined4 *)((longlong)puVar5 + 0x34) = uVar12;
            *(undefined4 *)(puVar5 + 7) = uVar13;
            *(undefined4 *)((longlong)puVar5 + 0x3c) = uVar14;
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x40);
            uVar16 = puVar8[1];
            uVar17 = puVar8[2];
            uVar18 = puVar8[3];
            puVar7 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x50);
            uVar19 = *puVar7;
            uVar12 = puVar7[1];
            uVar13 = puVar7[2];
            uVar14 = puVar7[3];
            *(undefined4 *)(puVar5 + 8) = *puVar8;
            *(undefined4 *)((longlong)puVar5 + 0x44) = uVar16;
            *(undefined4 *)(puVar5 + 9) = uVar17;
            *(undefined4 *)((longlong)puVar5 + 0x4c) = uVar18;
            *(undefined4 *)(puVar5 + 10) = uVar19;
            *(undefined4 *)((longlong)puVar5 + 0x54) = uVar12;
            *(undefined4 *)(puVar5 + 0xb) = uVar13;
            *(undefined4 *)((longlong)puVar5 + 0x5c) = uVar14;
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x60);
            uVar12 = *puVar8;
            uVar13 = puVar8[1];
            uVar14 = puVar8[2];
            uVar15 = puVar8[3];
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x70);
            uVar16 = *puVar8;
            uVar17 = puVar8[1];
            uVar18 = puVar8[2];
            uVar19 = puVar8[3];
            if (uVar11 == 0) break;
            *(undefined4 *)(puVar5 + 0xc) = uVar12;
            *(undefined4 *)((longlong)puVar5 + 100) = uVar13;
            *(undefined4 *)(puVar5 + 0xd) = uVar14;
            *(undefined4 *)((longlong)puVar5 + 0x6c) = uVar15;
            *(undefined4 *)(puVar5 + 0xe) = uVar16;
            *(undefined4 *)((longlong)puVar5 + 0x74) = uVar17;
            *(undefined4 *)(puVar5 + 0xf) = uVar18;
            *(undefined4 *)((longlong)puVar5 + 0x7c) = uVar19;
            puVar5 = puVar4;
          }
        }
        else {
          while( true ) {
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9);
            uVar16 = puVar8[1];
            uVar17 = puVar8[2];
            uVar18 = puVar8[3];
            puVar7 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x10);
            uVar19 = *puVar7;
            uVar12 = puVar7[1];
            uVar13 = puVar7[2];
            uVar14 = puVar7[3];
            puVar4 = puVar5 + 0x10;
            *(undefined4 *)puVar5 = *puVar8;
            *(undefined4 *)((longlong)puVar5 + 4) = uVar16;
            *(undefined4 *)(puVar5 + 1) = uVar17;
            *(undefined4 *)((longlong)puVar5 + 0xc) = uVar18;
            *(undefined4 *)(puVar5 + 2) = uVar19;
            *(undefined4 *)((longlong)puVar5 + 0x14) = uVar12;
            *(undefined4 *)(puVar5 + 3) = uVar13;
            *(undefined4 *)((longlong)puVar5 + 0x1c) = uVar14;
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x20);
            uVar16 = puVar8[1];
            uVar17 = puVar8[2];
            uVar18 = puVar8[3];
            puVar7 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x30);
            uVar19 = *puVar7;
            uVar12 = puVar7[1];
            uVar13 = puVar7[2];
            uVar14 = puVar7[3];
            uVar11 = uVar11 - 1;
            *(undefined4 *)(puVar5 + 4) = *puVar8;
            *(undefined4 *)((longlong)puVar5 + 0x24) = uVar16;
            *(undefined4 *)(puVar5 + 5) = uVar17;
            *(undefined4 *)((longlong)puVar5 + 0x2c) = uVar18;
            *(undefined4 *)(puVar5 + 6) = uVar19;
            *(undefined4 *)((longlong)puVar5 + 0x34) = uVar12;
            *(undefined4 *)(puVar5 + 7) = uVar13;
            *(undefined4 *)((longlong)puVar5 + 0x3c) = uVar14;
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x40);
            uVar16 = puVar8[1];
            uVar17 = puVar8[2];
            uVar18 = puVar8[3];
            puVar7 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x50);
            uVar19 = *puVar7;
            uVar12 = puVar7[1];
            uVar13 = puVar7[2];
            uVar14 = puVar7[3];
            *(undefined4 *)(puVar5 + 8) = *puVar8;
            *(undefined4 *)((longlong)puVar5 + 0x44) = uVar16;
            *(undefined4 *)(puVar5 + 9) = uVar17;
            *(undefined4 *)((longlong)puVar5 + 0x4c) = uVar18;
            *(undefined4 *)(puVar5 + 10) = uVar19;
            *(undefined4 *)((longlong)puVar5 + 0x54) = uVar12;
            *(undefined4 *)(puVar5 + 0xb) = uVar13;
            *(undefined4 *)((longlong)puVar5 + 0x5c) = uVar14;
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x60);
            uVar12 = *puVar8;
            uVar13 = puVar8[1];
            uVar14 = puVar8[2];
            uVar15 = puVar8[3];
            puVar8 = (undefined4 *)((longlong)puVar5 + lVar9 + 0x70);
            uVar16 = *puVar8;
            uVar17 = puVar8[1];
            uVar18 = puVar8[2];
            uVar19 = puVar8[3];
            if (uVar11 == 0) break;
            *(undefined4 *)(puVar5 + 0xc) = uVar12;
            *(undefined4 *)((longlong)puVar5 + 100) = uVar13;
            *(undefined4 *)(puVar5 + 0xd) = uVar14;
            *(undefined4 *)((longlong)puVar5 + 0x6c) = uVar15;
            *(undefined4 *)(puVar5 + 0xe) = uVar16;
            *(undefined4 *)((longlong)puVar5 + 0x74) = uVar17;
            *(undefined4 *)(puVar5 + 0xf) = uVar18;
            *(undefined4 *)((longlong)puVar5 + 0x7c) = uVar19;
            puVar5 = puVar4;
          }
        }
        *(undefined4 *)(puVar4 + -4) = uVar12;
        *(undefined4 *)((longlong)puVar4 + -0x1c) = uVar13;
        *(undefined4 *)(puVar4 + -3) = uVar14;
        *(undefined4 *)((longlong)puVar4 + -0x14) = uVar15;
        uVar10 = uVar10 & 0x7f;
      }
    }
    for (uVar11 = uVar10 >> 4; uVar11 != 0; uVar11 = uVar11 - 1) {
      *(undefined4 *)(puVar4 + -2) = uVar16;
      *(undefined4 *)((longlong)puVar4 + -0xc) = uVar17;
      *(undefined4 *)(puVar4 + -1) = uVar18;
      *(undefined4 *)((longlong)puVar4 + -4) = uVar19;
      puVar8 = (undefined4 *)((longlong)puVar4 + lVar9);
      uVar16 = *puVar8;
      uVar17 = puVar8[1];
      uVar18 = puVar8[2];
      uVar19 = puVar8[3];
      puVar4 = puVar4 + 2;
    }
    uVar10 = uVar10 & 0xf;
    if (uVar10 != 0) {
      puVar8 = (undefined4 *)((longlong)puVar4 + lVar9 + (uVar10 - 0x10));
      uVar12 = puVar8[1];
      uVar13 = puVar8[2];
      uVar14 = puVar8[3];
      *(undefined4 *)((longlong)puVar4 + (uVar10 - 0x10)) = *puVar8;
      *(undefined4 *)((longlong)puVar4 + (uVar10 - 0xc)) = uVar12;
      *(undefined4 *)((longlong)puVar4 + (uVar10 - 8)) = uVar13;
      *(undefined4 *)((longlong)puVar4 + (uVar10 - 4)) = uVar14;
    }
    *(undefined4 *)(puVar4 + -2) = uVar16;
    *(undefined4 *)((longlong)puVar4 + -0xc) = uVar17;
    *(undefined4 *)(puVar4 + -1) = uVar18;
    *(undefined4 *)((longlong)puVar4 + -4) = uVar19;
    return param_1;
  }
  uVar16 = *(undefined4 *)((longlong)param_2 + 4);
  uVar17 = *(undefined4 *)(param_2 + 1);
  uVar18 = *(undefined4 *)((longlong)param_2 + 0xc);
  puVar8 = (undefined4 *)((longlong)param_2 + (param_3 - 0x10));
  uVar19 = *puVar8;
  uVar12 = puVar8[1];
  uVar13 = puVar8[2];
  uVar14 = puVar8[3];
  *(undefined4 *)param_1 = *(undefined4 *)param_2;
  *(undefined4 *)((longlong)param_1 + 4) = uVar16;
  *(undefined4 *)(param_1 + 1) = uVar17;
  *(undefined4 *)((longlong)param_1 + 0xc) = uVar18;
  puVar8 = (undefined4 *)((longlong)param_1 + (param_3 - 0x10));
  *puVar8 = uVar19;
  puVar8[1] = uVar12;
  puVar8[2] = uVar13;
  puVar8[3] = uVar14;
  return param_1;
}



// Library Function - Single Match
//  __acrt_get_process_end_policy
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 __acrt_get_process_end_policy(void)

{
  int local_res8 [8];
  
  local_res8[0] = 0;
  if ((-1 < *(int *)(*(longlong *)((longlong)ProcessEnvironmentBlock + 0x20) + 8)) &&
     (__acrt_AppPolicyGetProcessTerminationMethodInternal(local_res8), local_res8[0] == 1)) {
    return 0;
  }
  return 1;
}



undefined4 FUN_14001b5a4(void)

{
  __acrt_ptd *p_Var1;
  longlong local_res8 [4];
  
  p_Var1 = FUN_140017b04();
  local_res8[0] = *(longlong *)(p_Var1 + 0x90);
  FUN_14001a408((longlong)p_Var1,local_res8);
  return *(undefined4 *)(local_res8[0] + 0xc);
}



// Library Function - Single Match
//  __acrt_locale_free_monetary
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_locale_free_monetary(longlong param_1)

{
  if (param_1 != 0) {
    if (*(undefined **)(param_1 + 0x18) != PTR_DAT_140038888) {
      _free_base(*(undefined **)(param_1 + 0x18));
    }
    if (*(undefined **)(param_1 + 0x20) != PTR_DAT_140038890) {
      _free_base(*(undefined **)(param_1 + 0x20));
    }
    if (*(undefined **)(param_1 + 0x28) != PTR_DAT_140038898) {
      _free_base(*(undefined **)(param_1 + 0x28));
    }
    if (*(undefined **)(param_1 + 0x30) != PTR_DAT_1400388a0) {
      _free_base(*(undefined **)(param_1 + 0x30));
    }
    if (*(undefined **)(param_1 + 0x38) != PTR_DAT_1400388a8) {
      _free_base(*(undefined **)(param_1 + 0x38));
    }
    if (*(undefined **)(param_1 + 0x40) != PTR_DAT_1400388b0) {
      _free_base(*(undefined **)(param_1 + 0x40));
    }
    if (*(undefined **)(param_1 + 0x48) != PTR_DAT_1400388b8) {
      _free_base(*(undefined **)(param_1 + 0x48));
    }
    if (*(undefined **)(param_1 + 0x68) != PTR_DAT_1400388d8) {
      _free_base(*(undefined **)(param_1 + 0x68));
    }
    if (*(undefined **)(param_1 + 0x70) != PTR_DAT_1400388e0) {
      _free_base(*(undefined **)(param_1 + 0x70));
    }
    if (*(undefined **)(param_1 + 0x78) != PTR_DAT_1400388e8) {
      _free_base(*(undefined **)(param_1 + 0x78));
    }
    if (*(undefined **)(param_1 + 0x80) != PTR_DAT_1400388f0) {
      _free_base(*(undefined **)(param_1 + 0x80));
    }
    if (*(undefined **)(param_1 + 0x88) != PTR_DAT_1400388f8) {
      _free_base(*(undefined **)(param_1 + 0x88));
    }
    if (*(undefined **)(param_1 + 0x90) != PTR_DAT_140038900) {
      _free_base(*(undefined **)(param_1 + 0x90));
    }
  }
  return;
}



// Library Function - Single Match
//  __acrt_locale_free_numeric
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_locale_free_numeric(LPVOID *param_1)

{
  if (param_1 != (LPVOID *)0x0) {
    if ((undefined *)*param_1 != PTR_DAT_140038870) {
      _free_base(*param_1);
    }
    if ((undefined *)param_1[1] != PTR_DAT_140038878) {
      _free_base(param_1[1]);
    }
    if ((undefined *)param_1[2] != PTR_DAT_140038880) {
      _free_base(param_1[2]);
    }
    if ((undefined *)param_1[0xb] != PTR_DAT_1400388c8) {
      _free_base(param_1[0xb]);
    }
    if ((undefined *)param_1[0xc] != PTR_DAT_1400388d0) {
      _free_base(param_1[0xc]);
    }
  }
  return;
}



// Library Function - Single Match
//  __acrt_locale_free_time
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_locale_free_time(LPVOID *param_1)

{
  if (param_1 != (LPVOID *)0x0) {
    FUN_14001b854(param_1,7);
    FUN_14001b854(param_1 + 7,7);
    FUN_14001b854(param_1 + 0xe,0xc);
    FUN_14001b854(param_1 + 0x1a,0xc);
    FUN_14001b854(param_1 + 0x26,2);
    _free_base(param_1[0x28]);
    _free_base(param_1[0x29]);
    _free_base(param_1[0x2a]);
    FUN_14001b854(param_1 + 0x2c,7);
    FUN_14001b854(param_1 + 0x33,7);
    FUN_14001b854(param_1 + 0x3a,0xc);
    FUN_14001b854(param_1 + 0x46,0xc);
    FUN_14001b854(param_1 + 0x52,2);
    _free_base(param_1[0x54]);
    _free_base(param_1[0x55]);
    _free_base(param_1[0x56]);
    _free_base(param_1[0x57]);
  }
  return;
}



void FUN_14001b854(LPVOID *param_1,ulonglong param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = 0;
  uVar1 = param_2 & 0x1fffffffffffffff;
  if (param_1 + param_2 < param_1) {
    uVar1 = uVar2;
  }
  if (uVar1 != 0) {
    do {
      _free_base(*param_1);
      uVar2 = uVar2 + 1;
      param_1 = param_1 + 1;
    } while (uVar2 != uVar1);
  }
  return;
}



undefined8 FUN_14001b8a8(void)

{
  __acrt_ptd *p_Var1;
  undefined8 *local_res8 [4];
  
  p_Var1 = FUN_140017b04();
  local_res8[0] = *(undefined8 **)(p_Var1 + 0x90);
  FUN_14001a408((longlong)p_Var1,(longlong *)local_res8);
  return *local_res8[0];
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __report_gsfailure
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl __report_gsfailure(uintptr_t _StackCookie)

{
  code *pcVar1;
  BOOL BVar2;
  undefined *puVar3;
  undefined auStack_38 [8];
  undefined auStack_30 [48];
  
  puVar3 = auStack_38;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack_30;
  }
  *(undefined8 *)(puVar3 + -8) = 0x14001b90a;
  capture_previous_context((PCONTEXT)&DAT_140039b10);
  _DAT_140039a80 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_140039ba8 = puVar3 + 0x40;
  _DAT_140039b90 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_140039a70 = 0xc0000409;
  _DAT_140039a74 = 1;
  _DAT_140039a88 = 1;
  DAT_140039a90 = 2;
  *(undefined8 *)(puVar3 + 0x20) = DAT_140038010;
  *(undefined8 *)(puVar3 + 0x28) = DAT_140038008;
  *(undefined8 *)(puVar3 + -8) = 0x14001b9ac;
  DAT_140039c08 = _DAT_140039a80;
  __raise_securityfailure((_EXCEPTION_POINTERS *)&PTR_DAT_14002a588);
  return;
}



// Library Function - Single Match
//  capture_previous_context
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void capture_previous_context(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



// Library Function - Single Match
//  __raise_securityfailure
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __raise_securityfailure(_EXCEPTION_POINTERS *param_1)

{
  HANDLE hProcess;
  
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  UnhandledExceptionFilter(param_1);
  hProcess = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x00014001ba55. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(hProcess,0xc0000409);
  return;
}



ulong FUN_14001ba5c(short *param_1,longlong param_2,longlong param_3)

{
  short sVar1;
  ulong *puVar2;
  short *psVar3;
  longlong lVar4;
  longlong lVar5;
  ulong uVar6;
  
  if ((param_1 != (short *)0x0) && (param_2 != 0)) {
    if (param_3 != 0) {
      psVar3 = param_1;
      do {
        lVar5 = param_2;
        sVar1 = *(short *)((param_3 - (longlong)param_1) + (longlong)psVar3);
        *psVar3 = sVar1;
        psVar3 = psVar3 + 1;
        if (sVar1 == 0) break;
        param_2 = lVar5 + -1;
      } while (lVar5 + -1 != 0);
      lVar4 = lVar5 + -1;
      if (sVar1 == 0) {
        lVar4 = lVar5;
      }
      if (lVar4 != 0) {
        return 0;
      }
      *param_1 = 0;
      puVar2 = __doserrno();
      uVar6 = 0x22;
      goto LAB_14001ba80;
    }
    *param_1 = 0;
  }
  puVar2 = __doserrno();
  uVar6 = 0x16;
LAB_14001ba80:
  *puVar2 = uVar6;
  FUN_140011e58();
  return uVar6;
}



ulong FUN_14001bad4(short *param_1,longlong param_2,longlong param_3,longlong param_4)

{
  short sVar1;
  ulong *puVar2;
  longlong lVar3;
  ulong uVar4;
  longlong lVar5;
  short *psVar6;
  
  if (param_4 == 0) {
    if (param_1 == (short *)0x0) {
      if (param_2 == 0) {
        return 0;
      }
    }
    else {
LAB_14001bb1d:
      if (param_2 != 0) {
        if (param_4 == 0) {
          *param_1 = 0;
          return 0;
        }
        if (param_3 != 0) {
          lVar3 = param_2;
          lVar5 = param_4;
          psVar6 = param_1;
          if (param_4 == -1) {
            do {
              lVar5 = lVar3;
              sVar1 = *(short *)((param_3 - (longlong)param_1) + (longlong)psVar6);
              *psVar6 = sVar1;
              psVar6 = psVar6 + 1;
              if (sVar1 == 0) break;
              lVar3 = lVar5 + -1;
            } while (lVar5 + -1 != 0);
            lVar3 = lVar5 + -1;
            if (sVar1 == 0) {
              lVar3 = lVar5;
            }
          }
          else {
            do {
              sVar1 = *(short *)((param_3 - (longlong)param_1) + (longlong)psVar6);
              *psVar6 = sVar1;
              psVar6 = psVar6 + 1;
              if ((sVar1 == 0) || (lVar3 = lVar3 + -1, lVar3 == 0)) break;
              lVar5 = lVar5 + -1;
            } while (lVar5 != 0);
            if (lVar5 == 0) {
              *psVar6 = 0;
            }
          }
          if (lVar3 != 0) {
            return 0;
          }
          if (param_4 == -1) {
            param_1[param_2 + -1] = 0;
            return 0x50;
          }
          *param_1 = 0;
          puVar2 = __doserrno();
          uVar4 = 0x22;
          goto LAB_14001bb00;
        }
        *param_1 = 0;
      }
    }
  }
  else if (param_1 != (short *)0x0) goto LAB_14001bb1d;
  puVar2 = __doserrno();
  uVar4 = 0x16;
LAB_14001bb00:
  *puVar2 = uVar4;
  FUN_140011e58();
  return uVar4;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe
// Library Function - Single Match
//  __acrt_GetStringTypeA
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_GetStringTypeA
               (__crt_locale_pointers *param_1,DWORD param_2,LPCSTR param_3,int param_4,
               LPWORD param_5,UINT param_6,int param_7)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined (*lpSrcStr) [16];
  ulonglong uVar4;
  ulonglong uVar5;
  undefined *puVar6;
  undefined *puVar7;
  undefined8 uStackY_90;
  undefined auStackY_88 [32];
  longlong local_58;
  longlong local_50;
  char local_40;
  ulonglong local_38;
  
  puVar6 = auStackY_88;
  puVar7 = auStackY_88;
  local_38 = DAT_140038010 ^ (ulonglong)&local_58;
  uStackY_90 = 0x14001bc0a;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_58,param_1);
  if (param_6 == 0) {
    param_6 = *(UINT *)(local_50 + 0xc);
  }
  uStackY_90 = 0x14001bc40;
  iVar2 = __acrt_MultiByteToWideChar
                    (param_6,(-(uint)(param_7 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,0);
  if (iVar2 == 0) goto LAB_14001bd1c;
  uVar5 = (longlong)iVar2 * 2;
  uVar4 = -(ulonglong)(uVar5 < uVar5 + 0x10) & uVar5 + 0x10;
  if (uVar4 == 0) {
    lpSrcStr = (undefined (*) [16])0x0;
    puVar7 = auStackY_88;
LAB_14001bcb8:
    if (lpSrcStr != (undefined (*) [16])0x0) {
      *(undefined8 *)(puVar7 + -8) = 0x14001bcca;
      FUN_14000ce30(lpSrcStr,0,uVar5);
      *(int *)(puVar7 + 0x28) = iVar2;
      *(undefined (**) [16])(puVar7 + 0x20) = lpSrcStr;
      *(undefined8 *)(puVar7 + -8) = 0x14001bce6;
      iVar2 = __acrt_MultiByteToWideChar
                        (param_6,1,param_3,param_4,*(LPWSTR *)(puVar7 + 0x20),
                         *(int *)(puVar7 + 0x28));
      if (iVar2 != 0) {
        *(undefined8 *)(puVar7 + -8) = 0x14001bd00;
        GetStringTypeW(param_2,(LPCWSTR)lpSrcStr,iVar2,param_5);
      }
    }
  }
  else {
    if (0x400 < uVar4) {
      uStackY_90 = 0x14001bca2;
      lpSrcStr = (undefined (*) [16])_malloc_base(uVar4);
      puVar7 = auStackY_88;
      if (lpSrcStr != (undefined (*) [16])0x0) {
        *(undefined4 *)*lpSrcStr = 0xdddd;
        goto LAB_14001bcb0;
      }
      goto LAB_14001bcb8;
    }
    uVar3 = uVar4 + 0xf;
    if (uVar3 <= uVar4) {
      uVar3 = 0xffffffffffffff0;
    }
    uStackY_90 = 0x14001bc88;
    lVar1 = -(uVar3 & 0xfffffffffffffff0);
    puVar7 = auStackY_88 + lVar1 + -8;
    puVar6 = auStackY_88 + lVar1 + -8;
    lpSrcStr = (undefined (*) [16])(&stack0xffffffffffffffa0 + lVar1);
    if (lpSrcStr != (undefined (*) [16])0x0) {
      *(undefined4 *)*lpSrcStr = 0xcccc;
LAB_14001bcb0:
      lpSrcStr = lpSrcStr[1];
      puVar7 = puVar6;
      goto LAB_14001bcb8;
    }
  }
  if ((lpSrcStr != (undefined (*) [16])0x0) && (*(int *)lpSrcStr[-1] == 0xdddd)) {
    *(undefined8 *)(puVar7 + -8) = 0x14001bd1c;
    _free_base(lpSrcStr[-1]);
  }
LAB_14001bd1c:
  if (local_40 != '\0') {
    *(uint *)(local_58 + 0x3a8) = *(uint *)(local_58 + 0x3a8) & 0xfffffffd;
  }
  uVar5 = local_38 ^ (ulonglong)&local_58;
  *(undefined8 *)(puVar7 + -8) = 0x14001bd3b;
  __security_check_cookie(uVar5);
  return;
}



// Library Function - Single Match
//  __acrt_MultiByteToWideChar
// 
// Library: Visual Studio 2017 Release

void __acrt_MultiByteToWideChar
               (UINT param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWSTR param_5,int param_6)

{
  if (param_1 < 0xc436) {
    if (((9 < param_1 - 0xc42c) || ((0x2a7U >> (param_1 - 0xc42c & 0x1f) & 1) == 0)) &&
       (param_1 != 0x2a)) goto LAB_14001bdab;
LAB_14001bd7c:
    param_2 = 0;
  }
  else {
    if (param_1 != 0xd698) {
      if (param_1 < 0xdeaa) goto LAB_14001bdab;
      if ((param_1 < 0xdeb4) || (param_1 == 65000)) goto LAB_14001bd7c;
      if (param_1 != 0xfde9) goto LAB_14001bdab;
    }
    param_2 = param_2 & 8;
  }
LAB_14001bdab:
                    // WARNING: Could not recover jumptable at 0x00014001bdab. Too many branches
                    // WARNING: Treating indirect jump as call
  MultiByteToWideChar(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



// Library Function - Single Match
//  __acrt_add_locale_ref
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_add_locale_ref(longlong param_1)

{
  int *piVar1;
  int **ppiVar2;
  longlong lVar3;
  
  LOCK();
  *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 1;
  piVar1 = *(int **)(param_1 + 0xe0);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0xf0);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0xe8);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x100);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  ppiVar2 = (int **)(param_1 + 0x38);
  lVar3 = 6;
  do {
    if ((ppiVar2[-2] != (int *)&DAT_140038858) && (piVar1 = *ppiVar2, piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
    }
    if ((ppiVar2[-3] != (int *)0x0) && (piVar1 = ppiVar2[-1], piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
    }
    ppiVar2 = ppiVar2 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  __acrt_locale_add_lc_time_reference(*(undefined ***)(param_1 + 0x120));
  return;
}



// Library Function - Single Match
//  __acrt_release_locale_ref
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_release_locale_ref(longlong param_1)

{
  int *piVar1;
  int **ppiVar2;
  longlong lVar3;
  
  if (param_1 != 0) {
    LOCK();
    *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + -1;
    piVar1 = *(int **)(param_1 + 0xe0);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0xf0);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0xe8);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x100);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    ppiVar2 = (int **)(param_1 + 0x38);
    lVar3 = 6;
    do {
      if ((ppiVar2[-2] != (int *)&DAT_140038858) && (piVar1 = *ppiVar2, piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
      }
      if ((ppiVar2[-3] != (int *)0x0) && (piVar1 = ppiVar2[-1], piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
      }
      ppiVar2 = ppiVar2 + 4;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    __acrt_locale_release_lc_time_reference(*(undefined ***)(param_1 + 0x120));
  }
  return;
}



// Library Function - Single Match
//  __acrt_free_locale
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_free_locale(LPVOID param_1)

{
  int *piVar1;
  longlong lVar2;
  LPVOID *ppvVar3;
  int **ppiVar4;
  
  if ((((*(undefined ***)((longlong)param_1 + 0xf8) != (undefined **)0x0) &&
       (*(undefined ***)((longlong)param_1 + 0xf8) != &PTR_DAT_140038870)) &&
      (*(int **)((longlong)param_1 + 0xe0) != (int *)0x0)) &&
     (**(int **)((longlong)param_1 + 0xe0) == 0)) {
    piVar1 = *(int **)((longlong)param_1 + 0xf0);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      _free_base(piVar1);
      __acrt_locale_free_monetary(*(longlong *)((longlong)param_1 + 0xf8));
    }
    piVar1 = *(int **)((longlong)param_1 + 0xe8);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      _free_base(piVar1);
      __acrt_locale_free_numeric(*(LPVOID **)((longlong)param_1 + 0xf8));
    }
    _free_base(*(LPVOID *)((longlong)param_1 + 0xe0));
    _free_base(*(LPVOID *)((longlong)param_1 + 0xf8));
  }
  if ((*(int **)((longlong)param_1 + 0x100) != (int *)0x0) &&
     (**(int **)((longlong)param_1 + 0x100) == 0)) {
    _free_base((LPVOID)(*(longlong *)((longlong)param_1 + 0x108) + -0xfe));
    _free_base((LPVOID)(*(longlong *)((longlong)param_1 + 0x110) + -0x80));
    _free_base((LPVOID)(*(longlong *)((longlong)param_1 + 0x118) + -0x80));
    _free_base(*(LPVOID *)((longlong)param_1 + 0x100));
  }
  __acrt_locale_free_lc_time_if_unreferenced(*(undefined ***)((longlong)param_1 + 0x120));
  ppvVar3 = (LPVOID *)((longlong)param_1 + 0x128);
  lVar2 = 6;
  ppiVar4 = (int **)((longlong)param_1 + 0x38);
  do {
    if (((ppiVar4[-2] != (int *)&DAT_140038858) && (piVar1 = *ppiVar4, piVar1 != (int *)0x0)) &&
       (*piVar1 == 0)) {
      _free_base(piVar1);
      _free_base(*ppvVar3);
    }
    if (((ppiVar4[-3] != (int *)0x0) && (piVar1 = ppiVar4[-1], piVar1 != (int *)0x0)) &&
       (*piVar1 == 0)) {
      _free_base(piVar1);
    }
    ppvVar3 = ppvVar3 + 1;
    ppiVar4 = ppiVar4 + 4;
    lVar2 = lVar2 + -1;
  } while (lVar2 != 0);
  _free_base(param_1);
  return;
}



// Library Function - Single Match
//  __acrt_locale_add_lc_time_reference
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

int __acrt_locale_add_lc_time_reference(undefined **param_1)

{
  int *piVar1;
  int iVar2;
  
  if ((param_1 != (undefined **)0x0) && (param_1 != &PTR_DAT_140029ac0)) {
    LOCK();
    piVar1 = (int *)((longlong)param_1 + 0x15c);
    iVar2 = *piVar1;
    *piVar1 = *piVar1 + 1;
    return iVar2 + 1;
  }
  return 0x7fffffff;
}



// Library Function - Single Match
//  __acrt_locale_release_lc_time_reference
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

int __acrt_locale_release_lc_time_reference(undefined **param_1)

{
  int *piVar1;
  int iVar2;
  
  if ((param_1 != (undefined **)0x0) && (param_1 != &PTR_DAT_140029ac0)) {
    LOCK();
    piVar1 = (int *)((longlong)param_1 + 0x15c);
    iVar2 = *piVar1;
    *piVar1 = *piVar1 + -1;
    return iVar2 + -1;
  }
  return 0x7fffffff;
}



// Library Function - Single Match
//  __acrt_locale_free_lc_time_if_unreferenced
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_locale_free_lc_time_if_unreferenced(undefined **param_1)

{
  if (((param_1 != (undefined **)0x0) && (param_1 != &PTR_DAT_140029ac0)) &&
     (*(int *)((longlong)param_1 + 0x15c) == 0)) {
    __acrt_locale_free_time(param_1);
    _free_base(param_1);
  }
  return;
}



undefined ** FUN_14001c0e8(void)

{
  code *pcVar1;
  __acrt_ptd *p_Var2;
  undefined **ppuVar3;
  
  p_Var2 = FUN_140017b04();
  if (((DAT_140038910 & *(uint *)(p_Var2 + 0x3a8)) == 0) ||
     (ppuVar3 = *(undefined ***)(p_Var2 + 0x90), ppuVar3 == (undefined **)0x0)) {
    FID_conflict___acrt_lock(4);
    ppuVar3 = _updatetlocinfoEx_nolock((LPVOID *)(p_Var2 + 0x90),DAT_140039a48);
    FID_conflict___acrt_lock(4);
    if (ppuVar3 == (undefined **)0x0) {
      abort();
      pcVar1 = (code *)swi(3);
      ppuVar3 = (undefined **)(*pcVar1)();
      return ppuVar3;
    }
  }
  return ppuVar3;
}



// Library Function - Single Match
//  _updatetlocinfoEx_nolock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined ** _updatetlocinfoEx_nolock(LPVOID *param_1,undefined **param_2)

{
  undefined **ppuVar1;
  
  if ((param_2 == (undefined **)0x0) || (param_1 == (LPVOID *)0x0)) {
    param_2 = (undefined **)0x0;
  }
  else {
    ppuVar1 = (undefined **)*param_1;
    if (ppuVar1 != param_2) {
      *param_1 = param_2;
      __acrt_add_locale_ref((longlong)param_2);
      if (((ppuVar1 != (undefined **)0x0) &&
          (__acrt_release_locale_ref((longlong)ppuVar1), *(int *)(ppuVar1 + 2) == 0)) &&
         (ppuVar1 != &PTR_DAT_1400386f0)) {
        __acrt_free_locale(ppuVar1);
      }
    }
  }
  return param_2;
}



// WARNING: Could not reconcile some variable overlaps

void thunk_FUN_14001c1c8(LPCWSTR *param_1,LPVOID *param_2)

{
  code *pcVar1;
  int iVar2;
  ulong uVar3;
  ulong *puVar4;
  wchar_t *pwVar5;
  undefined8 uVar6;
  longlong lVar7;
  LPVOID pvVar8;
  ulonglong uVar9;
  short *psVar10;
  LPVOID *ppvVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  longlong lVar15;
  ulonglong uVar16;
  undefined auStackY_b8 [32];
  undefined auStack_80 [16];
  undefined8 uStack_70;
  longlong lStack_68;
  short *psStack_60;
  LPVOID *ppvStack_58;
  undefined8 uStack_50;
  ulonglong uStack_48;
  
  uStack_48 = DAT_140038010 ^ (ulonglong)auStackY_b8;
  uVar12 = 0;
  ppvStack_58 = param_2;
  if (param_2 == (LPVOID *)0x0) {
    puVar4 = __doserrno();
    *puVar4 = 0x16;
    FUN_140011e58();
  }
  else {
    *param_2 = (LPVOID)0x0;
    pwVar5 = *param_1;
    auStack_80 = ZEXT816(0);
    uStack_70 = 0;
    while (pwVar5 != (wchar_t *)0x0) {
      uStack_50 = CONCAT26(uStack_50._6_2_,0x3f002a);
      pwVar5 = wcspbrk(pwVar5,(wchar_t *)&uStack_50);
      if (pwVar5 == (wchar_t *)0x0) {
        uVar6 = FUN_14001c3f8((longlong)*param_1,0,0,(LPVOID *)auStack_80);
        iVar2 = (int)uVar6;
      }
      else {
        iVar2 = FUN_14001c598(*param_1,pwVar5,(LPVOID *)auStack_80);
      }
      if (iVar2 != 0) {
        goto LAB_14001c380;
      }
      param_1 = param_1 + 1;
      pwVar5 = *param_1;
    }
    uStack_50 = 0;
    uVar16 = ((longlong)auStack_80._8_8_ - (longlong)auStack_80._0_8_ >> 3) + 1;
    uVar9 = ((longlong)auStack_80._8_8_ - (longlong)auStack_80._0_8_) + 7U >> 3;
    if (auStack_80._8_8_ < auStack_80._0_8_) {
      uVar9 = uVar12;
    }
    ppvVar11 = auStack_80._0_8_;
    uVar13 = uVar12;
    uVar14 = uVar12;
    if (uVar9 != 0) {
      do {
        lVar7 = -1;
        do {
          lVar7 = lVar7 + 1;
        } while (*(short *)((longlong)*ppvVar11 + lVar7 * 2) != 0);
        ppvVar11 = ppvVar11 + 1;
        uVar14 = uVar14 + 1 + lVar7;
        uVar13 = uVar13 + 1;
        uStack_50 = uVar14;
      } while (uVar13 != uVar9);
    }
    pvVar8 = FUN_140011084(uVar16,uStack_50,2);
    if (pvVar8 != (LPVOID)0x0) {
      psVar10 = (short *)((longlong)pvVar8 + uVar16 * 8);
      psStack_60 = psVar10;
      if (auStack_80._0_8_ != auStack_80._8_8_) {
        lStack_68 = (longlong)pvVar8 - (longlong)auStack_80._0_8_;
        ppvVar11 = auStack_80._0_8_;
        do {
          lVar7 = -1;
          do {
            lVar15 = lVar7;
            lVar7 = lVar15 + 1;
          } while (*(short *)((longlong)*ppvVar11 + lVar7 * 2) != 0);
          lVar15 = lVar15 + 2;
          uVar3 = FUN_14001bad4(psVar10,uStack_50 - ((longlong)psVar10 - (longlong)psStack_60 >> 1),
                                (longlong)*ppvVar11,lVar15);
          if (uVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          *(short **)(lStack_68 + (longlong)ppvVar11) = psVar10;
          ppvVar11 = ppvVar11 + 1;
          psVar10 = psVar10 + lVar15;
        } while (ppvVar11 != auStack_80._8_8_);
      }
      *ppvStack_58 = pvVar8;
    }
    _free_base((LPVOID)0x0);
LAB_14001c380:
    uVar9 = (ulonglong)((longlong)auStack_80._8_8_ + (7 - (longlong)auStack_80._0_8_)) >> 3;
    if (auStack_80._8_8_ < auStack_80._0_8_) {
      uVar9 = uVar12;
    }
    ppvVar11 = auStack_80._0_8_;
    if (uVar9 != 0) {
      do {
        _free_base(*ppvVar11);
        uVar12 = uVar12 + 1;
        ppvVar11 = ppvVar11 + 1;
      } while (uVar12 != uVar9);
    }
    _free_base(auStack_80._0_8_);
  }
  __security_check_cookie(uStack_48 ^ (ulonglong)auStackY_b8);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_14001c1c8(LPCWSTR *param_1,LPVOID *param_2)

{
  code *pcVar1;
  int iVar2;
  ulong uVar3;
  ulong *puVar4;
  wchar_t *pwVar5;
  undefined8 uVar6;
  longlong lVar7;
  LPVOID pvVar8;
  ulonglong uVar9;
  short *psVar10;
  LPVOID *ppvVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  longlong lVar15;
  ulonglong uVar16;
  undefined auStackY_b8 [32];
  undefined local_80 [16];
  undefined8 local_70;
  longlong local_68;
  short *local_60;
  LPVOID *local_58;
  undefined8 local_50;
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStackY_b8;
  uVar12 = 0;
  local_58 = param_2;
  if (param_2 == (LPVOID *)0x0) {
    puVar4 = __doserrno();
    *puVar4 = 0x16;
    FUN_140011e58();
  }
  else {
    *param_2 = (LPVOID)0x0;
    pwVar5 = *param_1;
    local_80 = ZEXT816(0);
    local_70 = 0;
    while (pwVar5 != (wchar_t *)0x0) {
      local_50 = CONCAT26(local_50._6_2_,0x3f002a);
      pwVar5 = wcspbrk(pwVar5,(wchar_t *)&local_50);
      if (pwVar5 == (wchar_t *)0x0) {
        uVar6 = FUN_14001c3f8((longlong)*param_1,0,0,(LPVOID *)local_80);
        iVar2 = (int)uVar6;
      }
      else {
        iVar2 = FUN_14001c598(*param_1,pwVar5,(LPVOID *)local_80);
      }
      if (iVar2 != 0) {
        goto LAB_14001c380;
      }
      param_1 = param_1 + 1;
      pwVar5 = *param_1;
    }
    local_50 = 0;
    uVar16 = ((longlong)local_80._8_8_ - (longlong)local_80._0_8_ >> 3) + 1;
    uVar9 = ((longlong)local_80._8_8_ - (longlong)local_80._0_8_) + 7U >> 3;
    if (local_80._8_8_ < local_80._0_8_) {
      uVar9 = uVar12;
    }
    ppvVar11 = local_80._0_8_;
    uVar13 = uVar12;
    uVar14 = uVar12;
    if (uVar9 != 0) {
      do {
        lVar7 = -1;
        do {
          lVar7 = lVar7 + 1;
        } while (*(short *)((longlong)*ppvVar11 + lVar7 * 2) != 0);
        ppvVar11 = ppvVar11 + 1;
        uVar14 = uVar14 + 1 + lVar7;
        uVar13 = uVar13 + 1;
        local_50 = uVar14;
      } while (uVar13 != uVar9);
    }
    pvVar8 = FUN_140011084(uVar16,local_50,2);
    if (pvVar8 != (LPVOID)0x0) {
      psVar10 = (short *)((longlong)pvVar8 + uVar16 * 8);
      local_60 = psVar10;
      if (local_80._0_8_ != local_80._8_8_) {
        local_68 = (longlong)pvVar8 - (longlong)local_80._0_8_;
        ppvVar11 = local_80._0_8_;
        do {
          lVar7 = -1;
          do {
            lVar15 = lVar7;
            lVar7 = lVar15 + 1;
          } while (*(short *)((longlong)*ppvVar11 + lVar7 * 2) != 0);
          lVar15 = lVar15 + 2;
          uVar3 = FUN_14001bad4(psVar10,local_50 - ((longlong)psVar10 - (longlong)local_60 >> 1),
                                (longlong)*ppvVar11,lVar15);
          if (uVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          *(short **)(local_68 + (longlong)ppvVar11) = psVar10;
          ppvVar11 = ppvVar11 + 1;
          psVar10 = psVar10 + lVar15;
        } while (ppvVar11 != local_80._8_8_);
      }
      *local_58 = pvVar8;
    }
    _free_base((LPVOID)0x0);
LAB_14001c380:
    uVar9 = (ulonglong)((longlong)local_80._8_8_ + (7 - (longlong)local_80._0_8_)) >> 3;
    if (local_80._8_8_ < local_80._0_8_) {
      uVar9 = uVar12;
    }
    ppvVar11 = local_80._0_8_;
    if (uVar9 != 0) {
      do {
        _free_base(*ppvVar11);
        uVar12 = uVar12 + 1;
        ppvVar11 = ppvVar11 + 1;
      } while (uVar12 != uVar9);
    }
    _free_base(local_80._0_8_);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY_b8);
  return;
}



undefined8 FUN_14001c3f8(longlong param_1,longlong param_2,ulonglong param_3,LPVOID *param_4)

{
  code *pcVar1;
  ulong uVar2;
  short *psVar3;
  LPVOID pvVar4;
  short **ppsVar5;
  longlong lVar6;
  ulonglong uVar8;
  undefined8 uVar9;
  ulonglong uVar10;
  longlong lVar7;
  
  uVar9 = 0;
  lVar6 = -1;
  do {
    lVar7 = lVar6;
    lVar6 = lVar7 + 1;
  } while (*(short *)(param_1 + lVar6 * 2) != 0);
  uVar8 = lVar7 + 2;
  if (~param_3 < uVar8) {
    return 0xc;
  }
  uVar10 = param_3 + 1 + uVar8;
  psVar3 = (short *)_calloc_base(uVar10,2);
  if ((param_3 != 0) && (uVar2 = FUN_14001bad4(psVar3,uVar10,param_2,param_3), uVar2 != 0)) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar1 = (code *)swi(3);
    uVar9 = (*pcVar1)();
    return uVar9;
  }
  uVar2 = FUN_14001bad4(psVar3 + param_3,uVar10 - param_3,param_1,uVar8);
  if (uVar2 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar1 = (code *)swi(3);
    uVar9 = (*pcVar1)();
    return uVar9;
  }
  ppsVar5 = (short **)param_4[1];
  if (ppsVar5 == (short **)param_4[2]) {
    if (*param_4 == (LPVOID)0x0) {
      pvVar4 = _calloc_base(4,8);
      *param_4 = pvVar4;
      _free_base((LPVOID)0x0);
      ppsVar5 = (short **)*param_4;
      if (ppsVar5 != (short **)0x0) {
        param_4[1] = ppsVar5;
        param_4[2] = ppsVar5 + 4;
        goto LAB_14001c563;
      }
    }
    else {
      uVar8 = (longlong)param_4[2] - (longlong)*param_4 >> 3;
      if (uVar8 < 0x8000000000000000) {
        pvVar4 = _recalloc_base(*param_4,uVar8 * 2,8);
        if (pvVar4 != (LPVOID)0x0) {
          *param_4 = pvVar4;
          param_4[1] = (LPVOID)((longlong)pvVar4 + uVar8 * 8);
          param_4[2] = (LPVOID)((longlong)pvVar4 + uVar8 * 0x10);
          _free_base((LPVOID)0x0);
          ppsVar5 = (short **)param_4[1];
          goto LAB_14001c563;
        }
        _free_base((LPVOID)0x0);
      }
    }
    _free_base(psVar3);
    uVar9 = 0xc;
  }
  else {
LAB_14001c563:
    *ppsVar5 = psVar3;
    param_4[1] = (LPVOID)((longlong)param_4[1] + 8);
  }
  _free_base((LPVOID)0x0);
  return uVar9;
}



void FUN_14001c598(LPCWSTR param_1,LPCWSTR param_2,LPVOID *param_3)

{
  byte bVar1;
  BOOL BVar2;
  HANDLE hFindFile;
  undefined8 uVar3;
  ushort uVar4;
  longlong lVar5;
  longlong lVar6;
  undefined auStackY_2b8 [32];
  _WIN32_FIND_DATAW local_288;
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStackY_2b8;
  if (param_2 != param_1) {
    do {
      if (((ushort)(*param_2 + L'￑') < 0x2e) &&
         ((0x200000000801U >> ((ulonglong)(ushort)(*param_2 + L'￑') & 0x3f) & 1) != 0)) break;
      param_2 = param_2 + -1;
    } while (param_2 != param_1);
  }
  if ((*param_2 == L':') && (param_2 != param_1 + 1)) {
    FUN_14001c3f8((longlong)param_1,0,0,param_3);
  }
  else {
    uVar4 = *param_2 + L'￑';
    if ((0x2d < uVar4) || (bVar1 = 1, (0x200000000801U >> ((ulonglong)uVar4 & 0x3f) & 1) == 0)) {
      bVar1 = 0;
    }
    FUN_14000ce30((undefined (*) [16])&local_288,0,0x250);
    hFindFile = FindFirstFileExW(param_1,FindExInfoStandard,&local_288,FindExSearchNameMatch,
                                 (LPVOID)0x0,0);
    if (hFindFile == (HANDLE)0xffffffffffffffff) {
      FUN_14001c3f8((longlong)param_1,0,0,param_3);
    }
    else {
      lVar6 = (longlong)param_3[1] - (longlong)*param_3 >> 3;
      do {
        if (((local_288.cFileName[0] != L'.') ||
            ((local_288.cFileName[1] != L'\0' &&
             ((local_288.cFileName[1] != L'.' || (local_288.cFileName[2] != L'\0')))))) &&
           (uVar3 = FUN_14001c3f8((longlong)local_288.cFileName,(longlong)param_1,
                                  -(ulonglong)bVar1 &
                                  ((longlong)param_2 - (longlong)param_1 >> 1) + 1U,param_3),
           (int)uVar3 != 0)) goto LAB_14001c68c;
        BVar2 = FindNextFileW(hFindFile,&local_288);
      } while (BVar2 != 0);
      lVar5 = (longlong)param_3[1] - (longlong)*param_3 >> 3;
      if (lVar6 != lVar5) {
        FUN_1400246e0((undefined *)((longlong)*param_3 + lVar6 * 8),lVar5 - lVar6,8,FUN_14001c750);
      }
    }
LAB_14001c68c:
    if (hFindFile != (HANDLE)0xffffffffffffffff) {
      FindClose(hFindFile);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY_2b8);
  return;
}



ulonglong FUN_14001c750(ulonglong param_1,ulonglong param_2)

{
  if (param_1 < param_2) {
    return 0xffffffff;
  }
  return (ulonglong)(param_2 < param_1);
}



// Library Function - Single Match
//  _recalloc_base
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

LPVOID _recalloc_base(LPVOID param_1,ulonglong param_2,ulonglong param_3)

{
  ulong *puVar1;
  ulonglong uVar2;
  LPVOID pvVar3;
  ulonglong uVar4;
  
  if ((param_2 == 0) || (param_3 <= 0xffffffffffffffe0 / param_2)) {
    if (param_1 == (LPVOID)0x0) {
      uVar2 = 0;
    }
    else {
      uVar2 = _msize_base((longlong)param_1);
    }
    uVar4 = param_2 * param_3;
    pvVar3 = _realloc_base(param_1,uVar4);
    if ((pvVar3 != (LPVOID)0x0) && (uVar2 < uVar4)) {
      FUN_14000ce30((undefined (*) [16])((longlong)pvVar3 + uVar2),0,uVar4 - uVar2);
    }
  }
  else {
    puVar1 = __doserrno();
    *puVar1 = 0xc;
    pvVar3 = (LPVOID)0x0;
  }
  return pvVar3;
}



LPVOID _recalloc_base(LPVOID param_1,ulonglong param_2,ulonglong param_3)

{
  ulong *puVar1;
  ulonglong uVar2;
  LPVOID pvVar3;
  ulonglong uVar4;
  
  if ((param_2 == 0) || (param_3 <= 0xffffffffffffffe0 / param_2)) {
    if (param_1 == (LPVOID)0x0) {
      uVar2 = 0;
    }
    else {
      uVar2 = _msize_base((longlong)param_1);
    }
    uVar4 = param_2 * param_3;
    pvVar3 = _realloc_base(param_1,uVar4);
    if ((pvVar3 != (LPVOID)0x0) && (uVar2 < uVar4)) {
      FUN_14000ce30((undefined (*) [16])((longlong)pvVar3 + uVar2),0,uVar4 - uVar2);
    }
  }
  else {
    puVar1 = __doserrno();
    *puVar1 = 0xc;
    pvVar3 = (LPVOID)0x0;
  }
  return pvVar3;
}



// Library Function - Single Match
//  __acrt_WideCharToMultiByte
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_WideCharToMultiByte
               (uint param_1,uint param_2,undefined param_3,undefined param_4,undefined param_5,
               undefined param_6,undefined8 param_7,undefined8 param_8)

{
  uint uVar1;
  bool bVar2;
  
  uVar1 = 0;
  if (param_1 < 0xc436) {
    if ((param_1 - 0xc42c < 10) && ((0x2a7U >> (param_1 - 0xc42c & 0x1f) & 1) != 0))
    goto LAB_14001c870;
    bVar2 = param_1 == 0x2a;
LAB_14001c866:
    if (bVar2) goto LAB_14001c870;
  }
  else {
    if (param_1 == 0xd698) goto LAB_14001c870;
    if (0xdea9 < param_1) {
      if ((param_1 < 0xdeb4) || (param_1 == 65000)) goto LAB_14001c870;
      bVar2 = param_1 == 0xfde9;
      goto LAB_14001c866;
    }
  }
  uVar1 = param_2 & 0xffffff7f;
LAB_14001c870:
                    // WARNING: Could not recover jumptable at 0x00014001c893. Too many branches
                    // WARNING: Treating indirect jump as call
  WideCharToMultiByte(param_1,uVar1);
  return;
}



// Library Function - Single Match
//  __dcrt_get_narrow_environment_from_os
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

LPVOID __dcrt_get_narrow_environment_from_os(void)

{
  WCHAR WVar1;
  undefined uVar2;
  int iVar3;
  LPWCH pWVar4;
  longlong lVar5;
  LPVOID pvVar7;
  WCHAR *pWVar8;
  LPVOID pvVar9;
  LPVOID pvVar10;
  longlong lVar6;
  
  pWVar4 = GetEnvironmentStringsW();
  pvVar10 = (LPVOID)0x0;
  if (pWVar4 != (LPWCH)0x0) {
    WVar1 = *pWVar4;
    pWVar8 = pWVar4;
    while (WVar1 != L'\0') {
      lVar5 = -1;
      do {
        lVar6 = lVar5;
        lVar5 = lVar6 + 1;
      } while (pWVar8[lVar5] != L'\0');
      pWVar8 = pWVar8 + lVar6 + 2;
      WVar1 = *pWVar8;
    }
    uVar2 = (undefined)((longlong)pWVar8 + (2 - (longlong)pWVar4) >> 1);
    iVar3 = __acrt_WideCharToMultiByte(0,0,(char)pWVar4,uVar2,0,0,0,0);
    if (iVar3 != 0) {
      pvVar7 = _malloc_base((longlong)iVar3);
      pvVar9 = pvVar10;
      if ((pvVar7 != (LPVOID)0x0) &&
         (iVar3 = __acrt_WideCharToMultiByte(0,0,(char)pWVar4,uVar2,(char)pvVar7,(char)iVar3,0,0),
         iVar3 != 0)) {
        pvVar9 = pvVar7;
        pvVar7 = pvVar10;
      }
      _free_base(pvVar7);
      pvVar10 = pvVar9;
    }
  }
  if (pWVar4 != (LPWCH)0x0) {
    FreeEnvironmentStringsW(pWVar4);
  }
  return pvVar10;
}



// Library Function - Single Match
//  __dcrt_get_wide_environment_from_os
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 * __dcrt_get_wide_environment_from_os(void)

{
  short sVar1;
  ulonglong uVar2;
  undefined8 *puVar3;
  longlong lVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  
  puVar3 = (undefined8 *)GetEnvironmentStringsW();
  puVar6 = (undefined8 *)0x0;
  if (puVar3 != (undefined8 *)0x0) {
    sVar1 = *(short *)puVar3;
    puVar5 = puVar3;
    while (sVar1 != 0) {
      lVar4 = -1;
      do {
        lVar4 = lVar4 + 1;
      } while (*(short *)((longlong)puVar5 + lVar4 * 2) != 0);
      puVar5 = (undefined8 *)((longlong)puVar5 + lVar4 * 2 + 2);
      sVar1 = *(short *)puVar5;
    }
    uVar2 = ((longlong)puVar5 + (2 - (longlong)puVar3) >> 1) * 2;
    puVar5 = (undefined8 *)_malloc_base(uVar2);
    if (puVar5 != (undefined8 *)0x0) {
      FUN_14001b140(puVar5,puVar3,uVar2);
      puVar6 = puVar5;
    }
    _free_base((LPVOID)0x0);
    FreeEnvironmentStringsW((LPWCH)puVar3);
  }
  return puVar6;
}



int __cdecl common_set_variable_in_environment_nolock_char_(char *param_1,int param_2)

{
  ulonglong uVar1;
  char cVar2;
  code *pcVar3;
  int iVar4;
  ulong uVar5;
  int iVar6;
  ulong *puVar7;
  char *pcVar8;
  longlong lVar9;
  byte *pbVar10;
  byte **ppbVar11;
  char *pcVar12;
  LPCWSTR pWVar13;
  byte **ppbVar14;
  ulonglong uVar15;
  char *pcVar16;
  size_t sVar17;
  longlong lVar18;
  
  pcVar12 = (char *)0x0;
  iVar6 = 0;
  if (param_1 == (char *)0x0) {
    puVar7 = __doserrno();
    *puVar7 = 0x16;
    return -1;
  }
  pcVar8 = strchr(param_1,0x3d);
  pcVar16 = param_1;
  if ((pcVar8 != (char *)0x0) && (pcVar8 != param_1)) {
    cVar2 = pcVar8[1];
    if (DAT_140039070 == DAT_140039088) {
      DAT_140039070 = (byte **)FUN_14001d094((longlong *)DAT_140039070);
    }
    if (DAT_140039070 != (byte **)0x0) {
LAB_14001cb99:
      ppbVar11 = DAT_140039070;
      sVar17 = (longlong)pcVar8 - (longlong)param_1;
      pbVar10 = *DAT_140039070;
      ppbVar14 = DAT_140039070;
      while (pbVar10 != (byte *)0x0) {
        iVar4 = FUN_140025280((byte *)param_1,pbVar10,sVar17);
        if ((iVar4 == 0) && (((*ppbVar14)[sVar17] == 0x3d || ((*ppbVar14)[sVar17] == 0)))) {
          uVar15 = (longlong)ppbVar14 - (longlong)ppbVar11 >> 3;
          goto LAB_14001cbe8;
        }
        ppbVar14 = ppbVar14 + 1;
        pbVar10 = *ppbVar14;
      }
      uVar15 = -((longlong)ppbVar14 - (longlong)ppbVar11 >> 3);
LAB_14001cbe8:
      if (((longlong)uVar15 < 0) || (*ppbVar11 == (byte *)0x0)) {
        if (cVar2 == '\0') goto LAB_14001cd39;
        uVar1 = -uVar15 + 2;
        if ((-uVar15 <= uVar1) && (uVar1 < 0x1fffffffffffffff)) {
          ppbVar11 = (byte **)_recalloc_base(ppbVar11,uVar1,8);
          _free_base((LPVOID)0x0);
          if (ppbVar11 != (byte **)0x0) {
            ppbVar11[-uVar15] = (byte *)param_1;
            ppbVar11[1 - uVar15] = (byte *)0x0;
            DAT_140039070 = ppbVar11;
            goto LAB_14001cca1;
          }
        }
        iVar6 = -1;
      }
      else {
        _free_base(ppbVar11[uVar15]);
        if (cVar2 == '\0') {
          for (; ppbVar11[uVar15] != (byte *)0x0; uVar15 = uVar15 + 1) {
            ppbVar11[uVar15] = ppbVar11[uVar15 + 1];
          }
          ppbVar11 = (byte **)_recalloc_base(ppbVar11,uVar15,8);
          _free_base((LPVOID)0x0);
          pcVar12 = param_1;
          if (ppbVar11 != (byte **)0x0) {
            DAT_140039070 = ppbVar11;
          }
        }
        else {
          ppbVar11[uVar15] = (byte *)param_1;
        }
LAB_14001cca1:
        pcVar16 = pcVar12;
        if (param_2 != 0) {
          lVar9 = -1;
          do {
            lVar18 = lVar9;
            lVar9 = lVar18 + 1;
          } while (param_1[lVar18 + 1] != '\0');
          pcVar12 = (char *)_calloc_base(lVar18 + 3,1);
          iVar6 = 0;
          if (pcVar12 != (char *)0x0) {
            uVar5 = FUN_140016cd4(pcVar12,lVar18 + 3,(longlong)param_1);
            if (uVar5 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar3 = (code *)swi(3);
              iVar6 = (*pcVar3)();
              return iVar6;
            }
            (pcVar8 + (longlong)(pcVar12 + (1 - (longlong)param_1)))[-1] = '\0';
            pWVar13 = FUN_140025398((longlong)pcVar12,
                                    -(ulonglong)(cVar2 != '\0') &
                                    (ulonglong)
                                    (pcVar8 + (longlong)(pcVar12 + (1 - (longlong)param_1))));
            if ((int)pWVar13 == 0) {
              puVar7 = __doserrno();
              iVar6 = -1;
              *puVar7 = 0x2a;
            }
          }
          _free_base(pcVar12);
        }
      }
      goto LAB_14001cd39;
    }
    if ((param_2 == 0) || (DAT_140039078 == (LPVOID)0x0)) {
      if (cVar2 == '\0') goto LAB_14001cd39;
      DAT_140039070 = (byte **)_calloc_base(1,8);
      _free_base((LPVOID)0x0);
      if (DAT_140039070 != (byte **)0x0) {
        if (DAT_140039078 == (LPVOID)0x0) {
          DAT_140039078 = _calloc_base(1,8);
          _free_base((LPVOID)0x0);
          if (DAT_140039078 == (LPVOID)0x0) goto LAB_14001cb57;
        }
LAB_14001cb94:
        if (DAT_140039070 != (byte **)0x0) goto LAB_14001cb99;
      }
LAB_14001cb57:
      iVar6 = -1;
      goto LAB_14001cd39;
    }
    lVar9 = __dcrt_get_or_create_narrow_environment_nolock();
    if (lVar9 != 0) {
      if (DAT_140039070 == DAT_140039088) {
        DAT_140039070 = (byte **)FUN_14001d094((longlong *)DAT_140039070);
      }
      goto LAB_14001cb94;
    }
  }
  puVar7 = __doserrno();
  iVar6 = -1;
  *puVar7 = 0x16;
LAB_14001cd39:
  _free_base(pcVar16);
  return iVar6;
}



int __cdecl common_set_variable_in_environment_nolock_wchar_t_(wchar_t *param_1,int param_2)

{
  ulonglong uVar1;
  wchar_t wVar2;
  code *pcVar3;
  int iVar4;
  ulong uVar5;
  BOOL BVar6;
  int iVar7;
  ulong *puVar8;
  wchar_t *pwVar9;
  longlong lVar10;
  wchar_t **ppwVar11;
  LPCWSTR lpName;
  wchar_t **ppwVar12;
  ulonglong uVar13;
  wchar_t *pwVar14;
  wchar_t *pwVar15;
  ulonglong uVar16;
  longlong lVar17;
  
  pwVar14 = (wchar_t *)0x0;
  iVar7 = 0;
  if (param_1 == (wchar_t *)0x0) {
    puVar8 = __doserrno();
    *puVar8 = 0x16;
    return -1;
  }
  pwVar9 = wcschr((wchar_t *)param_1,L'=');
  pwVar15 = param_1;
  if ((pwVar9 == (wchar_t *)0x0) || (pwVar9 == (wchar_t *)param_1)) {
LAB_14001d03f:
    puVar8 = __doserrno();
    iVar7 = -1;
    *puVar8 = 0x16;
    goto LAB_14001d056;
  }
  wVar2 = pwVar9[1];
  if (DAT_140039078 == DAT_140039080) {
    DAT_140039078 = (wchar_t **)FUN_14001d180((longlong *)DAT_140039078);
  }
  if (DAT_140039078 == (wchar_t **)0x0) {
    if ((param_2 == 0) || (DAT_140039070 == (LPVOID)0x0)) {
      if (wVar2 == L'\0') goto LAB_14001d056;
      if (DAT_140039070 != (LPVOID)0x0) {
LAB_14001ce8b:
        DAT_140039078 = (wchar_t **)_calloc_base(1,8);
        _free_base((LPVOID)0x0);
        goto LAB_14001cead;
      }
      DAT_140039070 = _calloc_base(1,8);
      _free_base((LPVOID)0x0);
      if (DAT_140039070 != (LPVOID)0x0) {
        if (DAT_140039078 != (wchar_t **)0x0) goto LAB_14001ceb2;
        goto LAB_14001ce8b;
      }
    }
    else {
      lVar10 = __dcrt_get_or_create_wide_environment_nolock();
      if (lVar10 == 0) goto LAB_14001d03f;
      if (DAT_140039078 == DAT_140039080) {
        DAT_140039078 = (wchar_t **)FUN_14001d180((longlong *)DAT_140039078);
      }
LAB_14001cead:
      if (DAT_140039078 != (wchar_t **)0x0) goto LAB_14001ceb2;
    }
    iVar7 = -1;
    goto LAB_14001d056;
  }
LAB_14001ceb2:
  ppwVar11 = DAT_140039078;
  uVar16 = (longlong)pwVar9 - (longlong)param_1 >> 1;
  pwVar9 = *DAT_140039078;
  ppwVar12 = DAT_140039078;
  while (pwVar9 != (wchar_t *)0x0) {
    iVar4 = FUN_14002508c((wchar_t *)param_1,pwVar9,uVar16);
    if ((iVar4 == 0) && (((*ppwVar12)[uVar16] == L'=' || ((*ppwVar12)[uVar16] == L'\0')))) {
      uVar13 = (longlong)ppwVar12 - (longlong)ppwVar11 >> 3;
      goto LAB_14001cf07;
    }
    ppwVar12 = ppwVar12 + 1;
    pwVar9 = *ppwVar12;
  }
  uVar13 = -((longlong)ppwVar12 - (longlong)ppwVar11 >> 3);
LAB_14001cf07:
  if (((longlong)uVar13 < 0) || (*ppwVar11 == (wchar_t *)0x0)) {
    if (wVar2 == L'\0') goto LAB_14001d056;
    uVar1 = -uVar13 + 2;
    if ((-uVar13 <= uVar1) && (uVar1 < 0x1fffffffffffffff)) {
      ppwVar11 = (wchar_t **)_recalloc_base(ppwVar11,uVar1,8);
      _free_base((LPVOID)0x0);
      if (ppwVar11 != (wchar_t **)0x0) {
        ppwVar11[-uVar13] = (wchar_t *)param_1;
        ppwVar11[1 - uVar13] = (wchar_t *)0x0;
        DAT_140039078 = ppwVar11;
        goto LAB_14001cfc2;
      }
    }
    iVar7 = -1;
  }
  else {
    _free_base(ppwVar11[uVar13]);
    if (wVar2 == L'\0') {
      for (; ppwVar11[uVar13] != (wchar_t *)0x0; uVar13 = uVar13 + 1) {
        ppwVar11[uVar13] = ppwVar11[uVar13 + 1];
      }
      ppwVar11 = (wchar_t **)_recalloc_base(ppwVar11,uVar13,8);
      _free_base((LPVOID)0x0);
      pwVar14 = param_1;
      if (ppwVar11 != (wchar_t **)0x0) {
        DAT_140039078 = ppwVar11;
      }
    }
    else {
      ppwVar11[uVar13] = (wchar_t *)param_1;
    }
LAB_14001cfc2:
    pwVar15 = pwVar14;
    if (param_2 != 0) {
      lVar10 = -1;
      do {
        lVar17 = lVar10;
        lVar10 = lVar17 + 1;
      } while (*(short *)(param_1 + lVar10 * 2) != 0);
      uVar13 = lVar17 + 3;
      lpName = (LPCWSTR)_calloc_base(uVar13,2);
      iVar7 = 0;
      if (lpName != (LPCWSTR)0x0) {
        uVar5 = FUN_14001ba5c(lpName,uVar13,(longlong)param_1);
        if (uVar5 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar3 = (code *)swi(3);
          iVar7 = (*pcVar3)();
          return iVar7;
        }
        (lpName + uVar16 + 1)[-1] = L'\0';
        BVar6 = SetEnvironmentVariableW
                          (lpName,(LPCWSTR)(-(ulonglong)(wVar2 != L'\0') &
                                           (ulonglong)(lpName + uVar16 + 1)));
        if (BVar6 == 0) {
          puVar8 = __doserrno();
          iVar7 = -1;
          *puVar8 = 0x2a;
        }
      }
      _free_base(lpName);
    }
  }
LAB_14001d056:
  _free_base(pwVar15);
  return iVar7;
}



// Library Function - Single Match
//  int __cdecl common_set_variable_in_environment_nolock<char>(char * __ptr64 const,int)
// 
// Library: Visual Studio 2017 Release

int __cdecl common_set_variable_in_environment_nolock_char_(char *param_1,int param_2)

{
  ulonglong uVar1;
  char cVar2;
  code *pcVar3;
  int iVar4;
  ulong uVar5;
  int iVar6;
  ulong *puVar7;
  char *pcVar8;
  longlong lVar9;
  byte *pbVar10;
  byte **ppbVar11;
  char *pcVar12;
  LPCWSTR pWVar13;
  byte **ppbVar14;
  ulonglong uVar15;
  char *pcVar16;
  size_t sVar17;
  longlong lVar18;
  
  pcVar12 = (char *)0x0;
  iVar6 = 0;
  if (param_1 == (char *)0x0) {
    puVar7 = __doserrno();
    *puVar7 = 0x16;
    return -1;
  }
  pcVar8 = strchr(param_1,0x3d);
  pcVar16 = param_1;
  if ((pcVar8 != (char *)0x0) && (pcVar8 != param_1)) {
    cVar2 = pcVar8[1];
    if (DAT_140039070 == DAT_140039088) {
      DAT_140039070 = (byte **)FUN_14001d094((longlong *)DAT_140039070);
    }
    if (DAT_140039070 != (byte **)0x0) {
LAB_14001cb99:
      ppbVar11 = DAT_140039070;
      sVar17 = (longlong)pcVar8 - (longlong)param_1;
      pbVar10 = *DAT_140039070;
      ppbVar14 = DAT_140039070;
      while (pbVar10 != (byte *)0x0) {
        iVar4 = FUN_140025280((byte *)param_1,pbVar10,sVar17);
        if ((iVar4 == 0) && (((*ppbVar14)[sVar17] == 0x3d || ((*ppbVar14)[sVar17] == 0)))) {
          uVar15 = (longlong)ppbVar14 - (longlong)ppbVar11 >> 3;
          goto LAB_14001cbe8;
        }
        ppbVar14 = ppbVar14 + 1;
        pbVar10 = *ppbVar14;
      }
      uVar15 = -((longlong)ppbVar14 - (longlong)ppbVar11 >> 3);
LAB_14001cbe8:
      if (((longlong)uVar15 < 0) || (*ppbVar11 == (byte *)0x0)) {
        if (cVar2 == '\0') goto LAB_14001cd39;
        uVar1 = -uVar15 + 2;
        if ((-uVar15 <= uVar1) && (uVar1 < 0x1fffffffffffffff)) {
          ppbVar11 = (byte **)_recalloc_base(ppbVar11,uVar1,8);
          _free_base((LPVOID)0x0);
          if (ppbVar11 != (byte **)0x0) {
            ppbVar11[-uVar15] = (byte *)param_1;
            ppbVar11[1 - uVar15] = (byte *)0x0;
            DAT_140039070 = ppbVar11;
            goto LAB_14001cca1;
          }
        }
        iVar6 = -1;
      }
      else {
        _free_base(ppbVar11[uVar15]);
        if (cVar2 == '\0') {
          for (; ppbVar11[uVar15] != (byte *)0x0; uVar15 = uVar15 + 1) {
            ppbVar11[uVar15] = ppbVar11[uVar15 + 1];
          }
          ppbVar11 = (byte **)_recalloc_base(ppbVar11,uVar15,8);
          _free_base((LPVOID)0x0);
          pcVar12 = param_1;
          if (ppbVar11 != (byte **)0x0) {
            DAT_140039070 = ppbVar11;
          }
        }
        else {
          ppbVar11[uVar15] = (byte *)param_1;
        }
LAB_14001cca1:
        pcVar16 = pcVar12;
        if (param_2 != 0) {
          lVar9 = -1;
          do {
            lVar18 = lVar9;
            lVar9 = lVar18 + 1;
          } while (param_1[lVar18 + 1] != '\0');
          pcVar12 = (char *)_calloc_base(lVar18 + 3,1);
          iVar6 = 0;
          if (pcVar12 != (char *)0x0) {
            uVar5 = FUN_140016cd4(pcVar12,lVar18 + 3,(longlong)param_1);
            if (uVar5 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar3 = (code *)swi(3);
              iVar6 = (*pcVar3)();
              return iVar6;
            }
            (pcVar8 + (longlong)(pcVar12 + (1 - (longlong)param_1)))[-1] = '\0';
            pWVar13 = FUN_140025398((longlong)pcVar12,
                                    -(ulonglong)(cVar2 != '\0') &
                                    (ulonglong)
                                    (pcVar8 + (longlong)(pcVar12 + (1 - (longlong)param_1))));
            if ((int)pWVar13 == 0) {
              puVar7 = __doserrno();
              iVar6 = -1;
              *puVar7 = 0x2a;
            }
          }
          _free_base(pcVar12);
        }
      }
      goto LAB_14001cd39;
    }
    if ((param_2 == 0) || (DAT_140039078 == (LPVOID)0x0)) {
      if (cVar2 == '\0') goto LAB_14001cd39;
      DAT_140039070 = (byte **)_calloc_base(1,8);
      _free_base((LPVOID)0x0);
      if (DAT_140039070 != (byte **)0x0) {
        if (DAT_140039078 == (LPVOID)0x0) {
          DAT_140039078 = _calloc_base(1,8);
          _free_base((LPVOID)0x0);
          if (DAT_140039078 == (LPVOID)0x0) goto LAB_14001cb57;
        }
LAB_14001cb94:
        if (DAT_140039070 != (byte **)0x0) goto LAB_14001cb99;
      }
LAB_14001cb57:
      iVar6 = -1;
      goto LAB_14001cd39;
    }
    lVar9 = __dcrt_get_or_create_narrow_environment_nolock();
    if (lVar9 != 0) {
      if (DAT_140039070 == DAT_140039088) {
        DAT_140039070 = (byte **)FUN_14001d094((longlong *)DAT_140039070);
      }
      goto LAB_14001cb94;
    }
  }
  puVar7 = __doserrno();
  iVar6 = -1;
  *puVar7 = 0x16;
LAB_14001cd39:
  _free_base(pcVar16);
  return iVar6;
}



// Library Function - Single Match
//  int __cdecl common_set_variable_in_environment_nolock<wchar_t>(wchar_t * __ptr64 const,int)
// 
// Library: Visual Studio 2017 Release

int __cdecl common_set_variable_in_environment_nolock_wchar_t_(wchar_t *param_1,int param_2)

{
  ulonglong uVar1;
  wchar_t wVar2;
  code *pcVar3;
  int iVar4;
  ulong uVar5;
  BOOL BVar6;
  int iVar7;
  ulong *puVar8;
  wchar_t *pwVar9;
  longlong lVar10;
  wchar_t **ppwVar11;
  LPCWSTR lpName;
  wchar_t **ppwVar12;
  ulonglong uVar13;
  wchar_t *pwVar14;
  wchar_t *pwVar15;
  ulonglong uVar16;
  longlong lVar17;
  
  pwVar14 = (wchar_t *)0x0;
  iVar7 = 0;
  if (param_1 == (wchar_t *)0x0) {
    puVar8 = __doserrno();
    *puVar8 = 0x16;
    return -1;
  }
  pwVar9 = wcschr((wchar_t *)param_1,L'=');
  pwVar15 = param_1;
  if ((pwVar9 == (wchar_t *)0x0) || (pwVar9 == (wchar_t *)param_1)) {
LAB_14001d03f:
    puVar8 = __doserrno();
    iVar7 = -1;
    *puVar8 = 0x16;
    goto LAB_14001d056;
  }
  wVar2 = pwVar9[1];
  if (DAT_140039078 == DAT_140039080) {
    DAT_140039078 = (wchar_t **)FUN_14001d180((longlong *)DAT_140039078);
  }
  if (DAT_140039078 == (wchar_t **)0x0) {
    if ((param_2 == 0) || (DAT_140039070 == (LPVOID)0x0)) {
      if (wVar2 == L'\0') goto LAB_14001d056;
      if (DAT_140039070 != (LPVOID)0x0) {
LAB_14001ce8b:
        DAT_140039078 = (wchar_t **)_calloc_base(1,8);
        _free_base((LPVOID)0x0);
        goto LAB_14001cead;
      }
      DAT_140039070 = _calloc_base(1,8);
      _free_base((LPVOID)0x0);
      if (DAT_140039070 != (LPVOID)0x0) {
        if (DAT_140039078 != (wchar_t **)0x0) goto LAB_14001ceb2;
        goto LAB_14001ce8b;
      }
    }
    else {
      lVar10 = __dcrt_get_or_create_wide_environment_nolock();
      if (lVar10 == 0) goto LAB_14001d03f;
      if (DAT_140039078 == DAT_140039080) {
        DAT_140039078 = (wchar_t **)FUN_14001d180((longlong *)DAT_140039078);
      }
LAB_14001cead:
      if (DAT_140039078 != (wchar_t **)0x0) goto LAB_14001ceb2;
    }
    iVar7 = -1;
    goto LAB_14001d056;
  }
LAB_14001ceb2:
  ppwVar11 = DAT_140039078;
  uVar16 = (longlong)pwVar9 - (longlong)param_1 >> 1;
  pwVar9 = *DAT_140039078;
  ppwVar12 = DAT_140039078;
  while (pwVar9 != (wchar_t *)0x0) {
    iVar4 = FUN_14002508c((wchar_t *)param_1,pwVar9,uVar16);
    if ((iVar4 == 0) && (((*ppwVar12)[uVar16] == L'=' || ((*ppwVar12)[uVar16] == L'\0')))) {
      uVar13 = (longlong)ppwVar12 - (longlong)ppwVar11 >> 3;
      goto LAB_14001cf07;
    }
    ppwVar12 = ppwVar12 + 1;
    pwVar9 = *ppwVar12;
  }
  uVar13 = -((longlong)ppwVar12 - (longlong)ppwVar11 >> 3);
LAB_14001cf07:
  if (((longlong)uVar13 < 0) || (*ppwVar11 == (wchar_t *)0x0)) {
    if (wVar2 == L'\0') goto LAB_14001d056;
    uVar1 = -uVar13 + 2;
    if ((-uVar13 <= uVar1) && (uVar1 < 0x1fffffffffffffff)) {
      ppwVar11 = (wchar_t **)_recalloc_base(ppwVar11,uVar1,8);
      _free_base((LPVOID)0x0);
      if (ppwVar11 != (wchar_t **)0x0) {
        ppwVar11[-uVar13] = (wchar_t *)param_1;
        ppwVar11[1 - uVar13] = (wchar_t *)0x0;
        DAT_140039078 = ppwVar11;
        goto LAB_14001cfc2;
      }
    }
    iVar7 = -1;
  }
  else {
    _free_base(ppwVar11[uVar13]);
    if (wVar2 == L'\0') {
      for (; ppwVar11[uVar13] != (wchar_t *)0x0; uVar13 = uVar13 + 1) {
        ppwVar11[uVar13] = ppwVar11[uVar13 + 1];
      }
      ppwVar11 = (wchar_t **)_recalloc_base(ppwVar11,uVar13,8);
      _free_base((LPVOID)0x0);
      pwVar14 = param_1;
      if (ppwVar11 != (wchar_t **)0x0) {
        DAT_140039078 = ppwVar11;
      }
    }
    else {
      ppwVar11[uVar13] = (wchar_t *)param_1;
    }
LAB_14001cfc2:
    pwVar15 = pwVar14;
    if (param_2 != 0) {
      lVar10 = -1;
      do {
        lVar17 = lVar10;
        lVar10 = lVar17 + 1;
      } while (*(short *)(param_1 + lVar10 * 2) != 0);
      uVar13 = lVar17 + 3;
      lpName = (LPCWSTR)_calloc_base(uVar13,2);
      iVar7 = 0;
      if (lpName != (LPCWSTR)0x0) {
        uVar5 = FUN_14001ba5c(lpName,uVar13,(longlong)param_1);
        if (uVar5 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar3 = (code *)swi(3);
          iVar7 = (*pcVar3)();
          return iVar7;
        }
        (lpName + uVar16 + 1)[-1] = L'\0';
        BVar6 = SetEnvironmentVariableW
                          (lpName,(LPCWSTR)(-(ulonglong)(wVar2 != L'\0') &
                                           (ulonglong)(lpName + uVar16 + 1)));
        if (BVar6 == 0) {
          puVar8 = __doserrno();
          iVar7 = -1;
          *puVar8 = 0x2a;
        }
      }
      _free_base(lpName);
    }
  }
LAB_14001d056:
  _free_base(pwVar15);
  return iVar7;
}



LPVOID FUN_14001d094(longlong *param_1)

{
  char *pcVar1;
  code *pcVar2;
  longlong *plVar3;
  longlong lVar4;
  ulong uVar5;
  LPVOID pvVar6;
  longlong lVar7;
  LPVOID pvVar8;
  longlong lVar9;
  longlong lVar10;
  
  if (param_1 == (longlong *)0x0) {
    pvVar6 = (LPVOID)0x0;
  }
  else {
    lVar9 = 0;
    lVar7 = *param_1;
    plVar3 = param_1;
    while (lVar7 != 0) {
      lVar9 = lVar9 + 1;
      plVar3 = plVar3 + 1;
      lVar7 = *plVar3;
    }
    pvVar6 = _calloc_base(lVar9 + 1,8);
    if (pvVar6 == (LPVOID)0x0) {
      abort();
      pcVar2 = (code *)swi(3);
      pvVar6 = (LPVOID)(*pcVar2)();
      return pvVar6;
    }
    lVar7 = *param_1;
    if (lVar7 != 0) {
      lVar9 = (longlong)pvVar6 - (longlong)param_1;
      do {
        lVar4 = -1;
        do {
          lVar10 = lVar4;
          lVar4 = lVar10 + 1;
        } while (*(char *)(lVar7 + lVar10 + 1) != '\0');
        pvVar8 = _calloc_base(lVar10 + 2,1);
        *(LPVOID *)(lVar9 + (longlong)param_1) = pvVar8;
        _free_base((LPVOID)0x0);
        pcVar1 = *(char **)(lVar9 + (longlong)param_1);
        if (pcVar1 == (char *)0x0) {
          abort();
          pcVar2 = (code *)swi(3);
          pvVar6 = (LPVOID)(*pcVar2)();
          return pvVar6;
        }
        uVar5 = FUN_140016cd4(pcVar1,lVar10 + 2,*param_1);
        if (uVar5 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar2 = (code *)swi(3);
          pvVar6 = (LPVOID)(*pcVar2)();
          return pvVar6;
        }
        param_1 = param_1 + 1;
        lVar7 = *param_1;
      } while (lVar7 != 0);
    }
    _free_base((LPVOID)0x0);
  }
  return pvVar6;
}



LPVOID FUN_14001d180(longlong *param_1)

{
  short *psVar1;
  code *pcVar2;
  longlong *plVar3;
  longlong lVar4;
  ulong uVar5;
  LPVOID pvVar6;
  LPVOID pvVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  
  lVar8 = 0;
  if (param_1 == (longlong *)0x0) {
    pvVar6 = (LPVOID)0x0;
  }
  else {
    lVar10 = *param_1;
    plVar3 = param_1;
    while (lVar10 != 0) {
      lVar8 = lVar8 + 1;
      plVar3 = plVar3 + 1;
      lVar10 = *plVar3;
    }
    pvVar6 = _calloc_base(lVar8 + 1,8);
    if (pvVar6 == (LPVOID)0x0) {
      abort();
      pcVar2 = (code *)swi(3);
      pvVar6 = (LPVOID)(*pcVar2)();
      return pvVar6;
    }
    lVar8 = *param_1;
    if (lVar8 != 0) {
      lVar10 = (longlong)pvVar6 - (longlong)param_1;
      do {
        lVar4 = -1;
        do {
          lVar9 = lVar4;
          lVar4 = lVar9 + 1;
        } while (*(short *)(lVar8 + (lVar9 + 1) * 2) != 0);
        pvVar7 = _calloc_base(lVar9 + 2,2);
        *(LPVOID *)(lVar10 + (longlong)param_1) = pvVar7;
        _free_base((LPVOID)0x0);
        psVar1 = *(short **)(lVar10 + (longlong)param_1);
        if (psVar1 == (short *)0x0) {
          abort();
          pcVar2 = (code *)swi(3);
          pvVar6 = (LPVOID)(*pcVar2)();
          return pvVar6;
        }
        uVar5 = FUN_14001ba5c(psVar1,lVar9 + 2,*param_1);
        if (uVar5 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar2 = (code *)swi(3);
          pvVar6 = (LPVOID)(*pcVar2)();
          return pvVar6;
        }
        param_1 = param_1 + 1;
        lVar8 = *param_1;
      } while (lVar8 != 0);
    }
    _free_base((LPVOID)0x0);
  }
  return pvVar6;
}



undefined4 * FUN_14001d278(void)

{
  return &DAT_140039fec;
}



undefined4 * FUN_14001d280(void)

{
  return &DAT_140039ff0;
}



undefined4 * FUN_14001d288(void)

{
  return &DAT_140039fe8;
}



undefined8 FUN_14001d290(void)

{
  return DAT_140039ff8;
}



undefined8 FUN_14001d298(undefined4 *param_1)

{
  ulong *puVar1;
  undefined8 uVar2;
  
  if (param_1 == (undefined4 *)0x0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    uVar2 = 0x16;
  }
  else {
    *param_1 = DAT_140039fec;
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_14001d2c8(undefined4 *param_1)

{
  ulong *puVar1;
  undefined8 uVar2;
  
  if (param_1 == (undefined4 *)0x0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    uVar2 = 0x16;
  }
  else {
    *param_1 = DAT_140039ff0;
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_14001d2f8(undefined4 *param_1)

{
  ulong *puVar1;
  undefined8 uVar2;
  
  if (param_1 == (undefined4 *)0x0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    uVar2 = 0x16;
  }
  else {
    *param_1 = DAT_140039fe8;
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_14001d330(void)

{
  DAT_140039fe8 = 0x7080;
  DAT_140039fec = 1;
  DAT_140039ff0 = 0xfffff1f0;
  DAT_140039ff8 = &PTR_DAT_1400389a0;
  return 0;
}



int __cdecl common_gmtime_s___int64_(tm *param_1,__int64 *param_2)

{
  int iVar1;
  ulong *puVar2;
  longlong lVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  bool abStackX_8 [8];
  longlong alStackX_18 [2];
  
  if ((param_1 == (tm *)0x0) ||
     (FUN_14000ce30((undefined (*) [16])param_1,0xff,0x24), param_2 == (__int64 *)0x0)) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
  }
  else {
    alStackX_18[0] = *param_2;
    if ((-0xa8c1 < alStackX_18[0]) && (alStackX_18[0] < 0x79358e1d0)) {
      abStackX_8[0] = false;
      iVar1 = compute_year(alStackX_18,abStackX_8);
      piVar5 = (int *)&DAT_14002a598;
      param_1->tm_year = iVar1;
      iVar4 = 1;
      iVar1 = (int)(alStackX_18[0] / 0x15180);
      param_1->tm_yday = iVar1;
      alStackX_18[0] = alStackX_18[0] + (longlong)iVar1 * -0x15180;
      piVar6 = piVar5;
      if (abStackX_8[0] != false) {
        piVar5 = (int *)&DAT_14002a5d0;
        piVar6 = piVar5;
      }
      while (piVar5 = piVar5 + 1, *piVar5 < iVar1) {
        iVar4 = iVar4 + 1;
      }
      param_1->tm_mon = iVar4 + -1;
      param_1->tm_mday = iVar1 - piVar6[iVar4 + -1];
      lVar3 = *param_2;
      param_1->tm_isdst = 0;
      param_1->tm_wday = ((int)(lVar3 / 0x15180) + 4) % 7;
      iVar1 = (int)(alStackX_18[0] / 0xe10);
      param_1->tm_hour = iVar1;
      alStackX_18[0] = alStackX_18[0] + (longlong)iVar1 * -0xe10;
      lVar3 = SUB168(SEXT816(-0x7777777777777777) * SEXT816(alStackX_18[0]) >> 0x40,0) +
              alStackX_18[0];
      iVar1 = (int)(lVar3 >> 5) - (int)(lVar3 >> 0x3f);
      param_1->tm_min = iVar1;
      param_1->tm_sec = (int)alStackX_18[0] + iVar1 * -0x3c;
      return 0;
    }
    puVar2 = __doserrno();
    *puVar2 = 0x16;
  }
  return 0x16;
}



// Library Function - Single Match
//  __getgmtimebuf
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

tm * __cdecl __getgmtimebuf(void)

{
  __acrt_ptd *p_Var1;
  LPVOID pvVar2;
  ulong *puVar3;
  
  p_Var1 = FUN_140017c70();
  if (p_Var1 != (__acrt_ptd *)0x0) {
    if (*(tm **)(p_Var1 + 0x68) != (tm *)0x0) {
      return *(tm **)(p_Var1 + 0x68);
    }
    pvVar2 = _malloc_base(0x24);
    *(LPVOID *)(p_Var1 + 0x68) = pvVar2;
    _free_base((LPVOID)0x0);
    if (*(tm **)(p_Var1 + 0x68) != (tm *)0x0) {
      return *(tm **)(p_Var1 + 0x68);
    }
  }
  puVar3 = __doserrno();
  *puVar3 = 0xc;
  return (tm *)0x0;
}



// Library Function - Single Match
//  bool __cdecl __crt_time_is_leap_year<int>(int)
// 
// Library: Visual Studio 2015 Release

bool __cdecl __crt_time_is_leap_year_int_(int param_1)

{
  uint uVar1;
  
  uVar1 = param_1 & 0x80000003;
  if ((int)uVar1 < 0) {
    uVar1 = (uVar1 - 1 | 0xfffffffc) + 1;
  }
  if ((uVar1 == 0) && (param_1 != (param_1 / 100) * 100)) {
    return true;
  }
  return param_1 + 0x76c == ((param_1 + 0x76c) / 400) * 400;
}



// Library Function - Single Match
//  int __cdecl compute_year(__int64 & __ptr64,bool & __ptr64)
// 
// Library: Visual Studio 2019 Release

int __cdecl compute_year(__int64 *param_1,bool *param_2)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  bool bVar4;
  int iVar5;
  longlong lVar6;
  
  lVar6 = *param_1;
  lVar2 = lVar6 + SUB168(SEXT816(-0x77ceb70a34ed8f47) * SEXT816(lVar6) >> 0x40,0);
  iVar3 = (int)((ulonglong)lVar2 >> 0x18) - (int)(lVar2 >> 0x3f);
  iVar5 = iVar3 + 0x46;
  iVar1 = iVar3 + 0x45;
  lVar6 = lVar6 + ((longlong)
                   (((iVar3 + 0x171) / 400 - iVar1 / 100) +
                   ((int)(iVar1 + (iVar1 >> 0x1f & 3U)) >> 2) + -0x11) + (longlong)iVar3 * 0x16d) *
                  -0x15180;
  *param_1 = lVar6;
  if (lVar6 < 0) {
    *param_1 = lVar6 + 0x1e13380;
    bVar4 = __crt_time_is_leap_year_int_(iVar1);
    if (!bVar4) {
      return iVar1;
    }
    *param_1 = lVar6 + 0x1e28500;
    iVar5 = iVar1;
  }
  else {
    bVar4 = __crt_time_is_leap_year_int_(iVar5);
    if (!bVar4) {
      return iVar5;
    }
  }
  *param_2 = true;
  return iVar5;
}



// Library Function - Single Match
//  int __cdecl common_gmtime_s<__int64>(struct tm * __ptr64 const,__int64 const * __ptr64 const)
// 
// Library: Visual Studio 2015 Release

int __cdecl common_gmtime_s___int64_(tm *param_1,__int64 *param_2)

{
  int iVar1;
  ulong *puVar2;
  longlong lVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  bool local_res8 [8];
  longlong local_res18 [2];
  
  if ((param_1 == (tm *)0x0) ||
     (FUN_14000ce30((undefined (*) [16])param_1,0xff,0x24), param_2 == (__int64 *)0x0)) {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
  }
  else {
    local_res18[0] = *param_2;
    if ((-0xa8c1 < local_res18[0]) && (local_res18[0] < 0x79358e1d0)) {
      local_res8[0] = false;
      iVar1 = compute_year(local_res18,local_res8);
      piVar5 = (int *)&DAT_14002a598;
      param_1->tm_year = iVar1;
      iVar4 = 1;
      iVar1 = (int)(local_res18[0] / 0x15180);
      param_1->tm_yday = iVar1;
      local_res18[0] = local_res18[0] + (longlong)iVar1 * -0x15180;
      piVar6 = piVar5;
      if (local_res8[0] != false) {
        piVar5 = (int *)&DAT_14002a5d0;
        piVar6 = piVar5;
      }
      while (piVar5 = piVar5 + 1, *piVar5 < iVar1) {
        iVar4 = iVar4 + 1;
      }
      param_1->tm_mon = iVar4 + -1;
      param_1->tm_mday = iVar1 - piVar6[iVar4 + -1];
      lVar3 = *param_2;
      param_1->tm_isdst = 0;
      param_1->tm_wday = ((int)(lVar3 / 0x15180) + 4) % 7;
      iVar1 = (int)(local_res18[0] / 0xe10);
      param_1->tm_hour = iVar1;
      local_res18[0] = local_res18[0] + (longlong)iVar1 * -0xe10;
      lVar3 = SUB168(SEXT816(-0x7777777777777777) * SEXT816(local_res18[0]) >> 0x40,0) +
              local_res18[0];
      iVar1 = (int)(lVar3 >> 5) - (int)(lVar3 >> 0x3f);
      param_1->tm_min = iVar1;
      param_1->tm_sec = (int)local_res18[0] + iVar1 * -0x3c;
      return 0;
    }
    puVar2 = __doserrno();
    *puVar2 = 0x16;
  }
  return 0x16;
}



// Library Function - Single Match
//  _isindst
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl _isindst(tm *_Time)

{
  ulonglong uVar1;
  
  FID_conflict___acrt_lock(6);
  uVar1 = FUN_14001de58(&_Time->tm_sec);
  FID_conflict___acrt_lock(6);
  return (int)uVar1;
}



// Library Function - Single Match
//  __tzset
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl __tzset(void)

{
  if (DAT_14003a0c8 == 0) {
    FID_conflict___acrt_lock(6);
    if (DAT_14003a0c8 == 0) {
      tzset_nolock();
      LOCK();
      DAT_14003a0c8 = DAT_14003a0c8 + 1;
    }
    FID_conflict___acrt_lock(6);
    return;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14001d718(void)

{
  code *pcVar1;
  undefined4 uVar2;
  DWORD DVar3;
  uint uVar4;
  longlong *plVar5;
  undefined8 uVar6;
  int *piVar7;
  undefined4 *puVar8;
  int iVar9;
  int local_res8 [2];
  int local_res10 [2];
  undefined4 local_res18 [2];
  int local_res20 [2];
  
  plVar5 = (longlong *)FUN_14001d290();
  iVar9 = 0;
  local_res8[0] = 0;
  local_res18[0] = 0;
  local_res20[0] = 0;
  uVar6 = FUN_14001d2f8(local_res8);
  if ((int)uVar6 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  uVar6 = FUN_14001d298(local_res18);
  if ((int)uVar6 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  uVar6 = FUN_14001d2c8(local_res20);
  if ((int)uVar6 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  _free_base(DAT_14003a0c0);
  DAT_14003a0c0 = (LPVOID)0x0;
  DVar3 = GetTimeZoneInformation((LPTIME_ZONE_INFORMATION)&DAT_14003a010);
  if (DVar3 != 0xffffffff) {
    local_res8[0] = DAT_14003a010 * 0x3c;
    _DAT_14003a000 = 1;
    if (DAT_14003a056 != 0) {
      local_res8[0] = DAT_14003a064 * 0x3c + local_res8[0];
    }
    local_res18[0] = 0;
    if ((DAT_14003a0aa != 0) && (DAT_14003a0b8 != 0)) {
      iVar9 = (DAT_14003a0b8 - DAT_14003a064) * 0x3c;
      local_res18[0] = 1;
    }
    local_res20[0] = iVar9;
    uVar4 = FUN_14001b5a4();
    iVar9 = __acrt_WideCharToMultiByte(uVar4,0,0x14,0xff,(char)*plVar5,0x3f,0,local_res10);
    if ((iVar9 == 0) || (local_res10[0] != 0)) {
      *(undefined *)*plVar5 = 0;
    }
    else {
      *(undefined *)(*plVar5 + 0x3f) = 0;
    }
    iVar9 = __acrt_WideCharToMultiByte(uVar4,0,0x68,0xff,(char)plVar5[1],0x3f,0,local_res10);
    if ((iVar9 == 0) || (local_res10[0] != 0)) {
      *(undefined *)plVar5[1] = 0;
    }
    else {
      *(undefined *)(plVar5[1] + 0x3f) = 0;
    }
  }
  iVar9 = local_res8[0];
  piVar7 = FUN_14001d288();
  uVar2 = local_res18[0];
  *piVar7 = iVar9;
  puVar8 = FUN_14001d278();
  iVar9 = local_res20[0];
  *puVar8 = uVar2;
  piVar7 = FUN_14001d280();
  *piVar7 = iVar9;
  return;
}



void FUN_14001d8e8(byte *param_1)

{
  byte bVar1;
  byte bVar2;
  code *pcVar3;
  uint uVar4;
  ulong uVar5;
  int iVar6;
  char **ppcVar7;
  undefined8 uVar8;
  byte *pbVar9;
  int *piVar10;
  uint *puVar11;
  longlong lVar12;
  int local_res10 [2];
  uint local_res18 [2];
  longlong lVar13;
  
  ppcVar7 = (char **)FUN_14001d290();
  local_res10[0] = 0;
  local_res18[0] = 0;
  uVar8 = FUN_14001d2f8(local_res10);
  if ((int)uVar8 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar3 = (code *)swi(3);
    (*pcVar3)();
    return;
  }
  uVar8 = FUN_14001d298(local_res18);
  if ((int)uVar8 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar3 = (code *)swi(3);
    (*pcVar3)();
    return;
  }
  if (DAT_14003a0c0 != (char *)0x0) {
    pbVar9 = param_1;
    do {
      bVar1 = *pbVar9;
      bVar2 = pbVar9[(longlong)DAT_14003a0c0 - (longlong)param_1];
      if (bVar1 != bVar2) break;
      pbVar9 = pbVar9 + 1;
    } while (bVar2 != 0);
    if (bVar1 == bVar2) {
      return;
    }
  }
  _free_base(DAT_14003a0c0);
  lVar12 = -1;
  do {
    lVar13 = lVar12;
    lVar12 = lVar13 + 1;
  } while (param_1[lVar12] != 0);
  DAT_14003a0c0 = (char *)_malloc_base(lVar13 + 2);
  _free_base((LPVOID)0x0);
  lVar12 = -1;
  if (DAT_14003a0c0 != (char *)0x0) {
    do {
      lVar13 = lVar12;
      lVar12 = lVar13 + 1;
    } while (param_1[lVar12] != 0);
    uVar5 = FUN_140016cd4(DAT_14003a0c0,lVar13 + 2,(longlong)param_1);
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    lVar12 = 3;
    uVar5 = FUN_140024a90(*ppcVar7,0x40,(longlong)param_1,3);
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    do {
      if (*param_1 == 0) break;
      param_1 = param_1 + 1;
      lVar12 = lVar12 + -1;
    } while (lVar12 != 0);
    bVar1 = *param_1;
    pbVar9 = param_1 + 1;
    if (bVar1 != 0x2d) {
      pbVar9 = param_1;
    }
    local_res10[0] = FUN_1400223e8(pbVar9);
    local_res10[0] = local_res10[0] * 0xe10;
    for (; (*pbVar9 == 0x2b || ((byte)(*pbVar9 - 0x30) < 10)); pbVar9 = pbVar9 + 1) {
    }
    if (*pbVar9 == 0x3a) {
      pbVar9 = pbVar9 + 1;
      iVar6 = FUN_1400223e8(pbVar9);
      local_res10[0] = local_res10[0] + iVar6 * 0x3c;
      bVar2 = *pbVar9;
      while (('/' < (char)bVar2 && ((char)bVar2 < ':'))) {
        pbVar9 = pbVar9 + 1;
        bVar2 = *pbVar9;
      }
      if (bVar2 == 0x3a) {
        pbVar9 = pbVar9 + 1;
        iVar6 = FUN_1400223e8(pbVar9);
        local_res10[0] = local_res10[0] + iVar6;
        for (; ('/' < (char)*pbVar9 && ((char)*pbVar9 < ':')); pbVar9 = pbVar9 + 1) {
        }
      }
    }
    if (bVar1 == 0x2d) {
      local_res10[0] = -local_res10[0];
    }
    local_res18[0] = (uint)(*pbVar9 != 0);
    if (*pbVar9 == 0) {
      *ppcVar7[1] = '\0';
    }
    else {
      uVar5 = FUN_140024a90(ppcVar7[1],0x40,(longlong)pbVar9,3);
      if (uVar5 != 0) {
        _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
        pcVar3 = (code *)swi(3);
        (*pcVar3)();
        return;
      }
    }
    iVar6 = local_res10[0];
    piVar10 = FUN_14001d288();
    uVar4 = local_res18[0];
    *piVar10 = iVar6;
    puVar11 = FUN_14001d278();
    *puVar11 = uVar4;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  void __cdecl tzset_nolock(void)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl tzset_nolock(void)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  undefined auStack_148 [32];
  ulonglong local_128;
  __uint64 local_120;
  byte local_118 [256];
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStack_148;
  pbVar4 = (byte *)0x0;
  _DAT_1400389c0 = 0xffffffff;
  _DAT_14003a000 = 0;
  _DAT_1400389b0 = 0xffffffff;
  iVar1 = common_getenv_s_char_(&local_128,(char *)local_118,0x100,"TZ");
  if (iVar1 == 0) {
    pbVar2 = local_118;
  }
  else {
    pbVar2 = pbVar4;
    if (iVar1 == 0x22) {
      pbVar2 = (byte *)_malloc_base(local_128);
      if (pbVar2 == (byte *)0x0) {
        pbVar2 = (byte *)0x0;
      }
      else {
        iVar1 = common_getenv_s_char_(&local_120,(char *)pbVar2,local_128,"TZ");
        if (iVar1 == 0) {
          _free_base((LPVOID)0x0);
          goto LAB_14001dc04;
        }
      }
      _free_base(pbVar2);
      pbVar2 = pbVar4;
    }
  }
LAB_14001dc04:
  pbVar3 = pbVar2;
  if (pbVar2 == local_118) {
    pbVar3 = pbVar4;
  }
  if ((pbVar2 == (byte *)0x0) || (*pbVar2 == 0)) {
    FUN_14001d718();
  }
  else {
    FUN_14001d8e8(pbVar2);
  }
  _free_base(pbVar3);
  __security_check_cookie(local_18 ^ (ulonglong)auStack_148);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_14001dc5c(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,
                  int param_7,int param_8,int param_9,int param_10,int param_11)

{
  code *pcVar1;
  bool bVar2;
  undefined8 uVar3;
  int iVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  int local_res8 [2];
  
  local_res8[0] = 0;
  bVar2 = __crt_time_is_leap_year_int_(param_3);
  lVar5 = (longlong)(param_4 + -1);
  if (param_2 == 1) {
    if (bVar2) {
      iVar7 = *(int *)(&DAT_14002a5d0 + lVar5 * 4);
    }
    else {
      iVar7 = *(int *)(&DAT_14002a598 + lVar5 * 4);
    }
    iVar4 = param_3 + -1;
    iVar6 = (((int)((iVar4 >> 0x1f & 3U) + iVar4) >> 2) + iVar7 + 1 +
             ((param_3 + 299) / 400 - iVar4 / 100) + param_3 * 0x16d + -0x63db) % 7;
    iVar4 = (param_5 * 7 - iVar6) + iVar7 + 1 + param_6;
    iVar7 = iVar4 + -7;
    if (param_6 < iVar6) {
      iVar7 = iVar4;
    }
    if (bVar2) {
      iVar4 = *(int *)(&DAT_14002a5d0 + (longlong)param_4 * 4);
    }
    else {
      iVar4 = *(int *)(&DAT_14002a598 + (longlong)param_4 * 4);
    }
    if ((param_5 == 5) && (iVar4 < iVar7)) {
      iVar7 = iVar7 + -7;
    }
  }
  else {
    if (bVar2) {
      iVar7 = *(int *)(&DAT_14002a5d0 + lVar5 * 4);
    }
    else {
      iVar7 = *(int *)(&DAT_14002a598 + lVar5 * 4);
    }
    iVar7 = iVar7 + param_7;
  }
  iVar6 = ((param_8 * 0x3c + param_9) * 0x3c + param_10) * 1000 + param_11;
  iVar4 = param_3;
  if (param_1 != 0) {
    DAT_1400389c4 = iVar7;
    DAT_1400389c8 = iVar6;
    uVar3 = FUN_14001d2c8(local_res8);
    if ((int)uVar3 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    DAT_1400389c8 = DAT_1400389c8 + local_res8[0] * 1000;
    iVar7 = DAT_1400389b4;
    iVar4 = _DAT_1400389b0;
    iVar6 = _DAT_1400389b8;
    _DAT_1400389c0 = param_3;
    if (DAT_1400389c8 < 0) {
      DAT_1400389c8 = DAT_1400389c8 + 86400000;
      DAT_1400389c4 = DAT_1400389c4 + -1;
    }
    else if (86399999 < DAT_1400389c8) {
      DAT_1400389c8 = DAT_1400389c8 + -86400000;
      DAT_1400389c4 = DAT_1400389c4 + 1;
    }
  }
  _DAT_1400389b8 = iVar6;
  DAT_1400389b4 = iVar7;
  _DAT_1400389b0 = iVar4;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FUN_14001de58(int *param_1)

{
  int iVar1;
  bool bVar2;
  code *pcVar3;
  uint uVar4;
  int iVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  int local_res10 [2];
  uint uVar15;
  
  uVar4 = 0;
  local_res10[0] = 0;
  uVar6 = FUN_14001d298(local_res10);
  if ((int)uVar6 != 0) {
    _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    pcVar3 = (code *)swi(3);
    uVar7 = (*pcVar3)();
    return uVar7;
  }
  if (local_res10[0] != 0) {
    iVar1 = param_1[5];
    if ((iVar1 != _DAT_1400389b0) || (iVar1 != _DAT_1400389c0)) {
      if (_DAT_14003a000 == 0) {
        FUN_14001dc5c(0,1,iVar1,(iVar1 < 0x6b) + 3,(0x6a < iVar1) + 1,0,0,2,0,0,0);
        uVar9 = 0;
        uVar4 = 5;
        uVar10 = 0;
        uVar14 = 0;
        uVar13 = 2;
        if (0x6a < iVar1) {
          uVar4 = 1;
        }
        uVar11 = 0;
        uVar12 = (0x6a < iVar1) + 10;
        uVar15 = 0;
        uVar8 = 1;
      }
      else {
        uVar11 = 0;
        if (_DAT_14003a0a8 != 0) {
          uVar13 = (uint)DAT_14003a0ae;
          uVar9 = uVar4;
          uVar10 = uVar4;
        }
        else {
          uVar9 = (uint)DAT_14003a0ae;
          uVar10 = (uint)DAT_14003a0ac;
          uVar13 = uVar11;
        }
        FUN_14001dc5c(0,(uint)(_DAT_14003a0a8 == 0),iVar1,(uint)DAT_14003a0aa,uVar9,uVar10,uVar13,
                      (uint)DAT_14003a0b0,(uint)DAT_14003a0b2,(uint)DAT_14003a0b4,
                      (uint)DAT_14003a0b6);
        uVar12 = (uint)DAT_14003a056;
        uVar13 = (uint)DAT_14003a05c;
        uVar14 = (uint)DAT_14003a05e;
        uVar10 = (uint)DAT_14003a060;
        uVar9 = (uint)DAT_14003a062;
        if (_DAT_14003a054 != 0) {
          uVar11 = (uint)DAT_14003a05a;
          uVar15 = uVar4;
        }
        else {
          uVar4 = (uint)DAT_14003a05a;
          uVar15 = (uint)DAT_14003a058;
        }
        uVar8 = (uint)(_DAT_14003a054 == 0);
      }
      FUN_14001dc5c(1,uVar8,param_1[5],uVar12,uVar4,uVar15,uVar11,uVar13,uVar14,uVar10,uVar9);
    }
    iVar1 = param_1[7];
    if (DAT_1400389b4 < DAT_1400389c4) {
      if ((DAT_1400389b4 <= iVar1) && (iVar1 <= DAT_1400389c4)) {
        if ((DAT_1400389b4 < iVar1) && (iVar1 < DAT_1400389c4)) {
          return 1;
        }
LAB_14001e09e:
        iVar5 = ((param_1[2] * 0x3c + param_1[1]) * 0x3c + *param_1) * 1000;
        if (iVar1 == DAT_1400389b4) {
          bVar2 = _DAT_1400389b8 <= iVar5;
        }
        else {
          bVar2 = iVar5 < DAT_1400389c8;
        }
        return (ulonglong)bVar2;
      }
    }
    else {
      if (iVar1 < DAT_1400389c4) {
        return 1;
      }
      if (DAT_1400389b4 < iVar1) {
        return 1;
      }
      if ((iVar1 <= DAT_1400389c4) || (DAT_1400389b4 <= iVar1)) goto LAB_14001e09e;
    }
  }
  return 0;
}



// Library Function - Single Match
//  strchr
// 
// Library: Visual Studio 2017 Release

char * __cdecl strchr(char *_Str,int _Val)

{
  uint uVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  char cVar7;
  char cVar9;
  char cVar10;
  char cVar11;
  undefined in_XMM1 [16];
  undefined auVar8 [16];
  
  uVar3 = _Val & 0xff;
  pcVar5 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
  auVar8 = pshuflw(in_XMM1,ZEXT416(uVar3 << 8 | uVar3),0);
  cVar7 = SUB161(auVar8,0);
  cVar9 = SUB161(auVar8 >> 8,0);
  cVar10 = SUB161(auVar8 >> 0x10,0);
  cVar11 = SUB161(auVar8 >> 0x18,0);
  auVar8 = CONCAT115(-(cVar11 == pcVar5[0xf]),
                     CONCAT114(-(cVar10 == pcVar5[0xe]),
                               CONCAT113(-(cVar9 == pcVar5[0xd]),
                                         CONCAT112(-(cVar7 == pcVar5[0xc]),
                                                   CONCAT111(-(cVar11 == pcVar5[0xb]),
                                                             CONCAT110(-(cVar10 == pcVar5[10]),
                                                                       CONCAT19(-(cVar9 == pcVar5[9]
                                                                                 ),CONCAT18(-(cVar7 
                                                  == pcVar5[8]),
                                                  CONCAT17(-(cVar11 == pcVar5[7]),
                                                           CONCAT16(-(cVar10 == pcVar5[6]),
                                                                    CONCAT15(-(cVar9 == pcVar5[5]),
                                                                             CONCAT14(-(cVar7 == 
                                                  pcVar5[4]),
                                                  CONCAT13(-(cVar11 == pcVar5[3]),
                                                           CONCAT12(-(cVar10 == pcVar5[2]),
                                                                    CONCAT11(-(cVar9 == pcVar5[1]),
                                                                             -(cVar7 == *pcVar5)))))
                                                  ))))))))))) |
           CONCAT115(-(pcVar5[0xf] == '\0'),
                     CONCAT114(-(pcVar5[0xe] == '\0'),
                               CONCAT113(-(pcVar5[0xd] == '\0'),
                                         CONCAT112(-(pcVar5[0xc] == '\0'),
                                                   CONCAT111(-(pcVar5[0xb] == '\0'),
                                                             CONCAT110(-(pcVar5[10] == '\0'),
                                                                       CONCAT19(-(pcVar5[9] == '\0')
                                                                                ,CONCAT18(-(pcVar5[8
                                                  ] == '\0'),
                                                  CONCAT17(-(pcVar5[7] == '\0'),
                                                           CONCAT16(-(pcVar5[6] == '\0'),
                                                                    CONCAT15(-(pcVar5[5] == '\0'),
                                                                             CONCAT14(-(pcVar5[4] ==
                                                                                       '\0'),
                                                  CONCAT13(-(pcVar5[3] == '\0'),
                                                           CONCAT12(-(pcVar5[2] == '\0'),
                                                                    CONCAT11(-(pcVar5[1] == '\0'),
                                                                             -(*pcVar5 == '\0'))))))
                                                  ))))))))));
  uVar4 = (uint)(ushort)((ushort)(SUB161(auVar8 >> 7,0) & 1) |
                         (ushort)(SUB161(auVar8 >> 0xf,0) & 1) << 1 |
                         (ushort)(SUB161(auVar8 >> 0x17,0) & 1) << 2 |
                         (ushort)(SUB161(auVar8 >> 0x1f,0) & 1) << 3 |
                         (ushort)(SUB161(auVar8 >> 0x27,0) & 1) << 4 |
                         (ushort)(SUB161(auVar8 >> 0x2f,0) & 1) << 5 |
                         (ushort)(SUB161(auVar8 >> 0x37,0) & 1) << 6 |
                         (ushort)(SUB161(auVar8 >> 0x3f,0) & 1) << 7 |
                         (ushort)(SUB161(auVar8 >> 0x47,0) & 1) << 8 |
                         (ushort)(SUB161(auVar8 >> 0x4f,0) & 1) << 9 |
                         (ushort)(SUB161(auVar8 >> 0x57,0) & 1) << 10 |
                         (ushort)(SUB161(auVar8 >> 0x5f,0) & 1) << 0xb |
                         (ushort)(SUB161(auVar8 >> 0x67,0) & 1) << 0xc |
                         (ushort)(SUB161(auVar8 >> 0x6f,0) & 1) << 0xd |
                         (ushort)(SUB161(auVar8 >> 0x77,0) & 1) << 0xe |
                        (ushort)SUB161(auVar8 >> 0x7f,0) << 0xf) & -1 << ((byte)_Str & 0xf);
  pcVar6 = pcVar5;
  if (uVar4 == 0) {
    do {
      pcVar5 = pcVar6 + 0x10;
      auVar8 = CONCAT115(-(cVar11 == pcVar6[0x1f]),
                         CONCAT114(-(cVar10 == pcVar6[0x1e]),
                                   CONCAT113(-(cVar9 == pcVar6[0x1d]),
                                             CONCAT112(-(cVar7 == pcVar6[0x1c]),
                                                       CONCAT111(-(cVar11 == pcVar6[0x1b]),
                                                                 CONCAT110(-(cVar10 == pcVar6[0x1a])
                                                                           ,CONCAT19(-(cVar9 == 
                                                  pcVar6[0x19]),
                                                  CONCAT18(-(cVar7 == pcVar6[0x18]),
                                                           CONCAT17(-(cVar11 == pcVar6[0x17]),
                                                                    CONCAT16(-(cVar10 ==
                                                                              pcVar6[0x16]),
                                                                             CONCAT15(-(cVar9 == 
                                                  pcVar6[0x15]),
                                                  CONCAT14(-(cVar7 == pcVar6[0x14]),
                                                           CONCAT13(-(cVar11 == pcVar6[0x13]),
                                                                    CONCAT12(-(cVar10 ==
                                                                              pcVar6[0x12]),
                                                                             CONCAT11(-(cVar9 == 
                                                  pcVar6[0x11]),-(cVar7 == *pcVar5)))))))))))))))) |
               CONCAT115(-(pcVar6[0x1f] == '\0'),
                         CONCAT114(-(pcVar6[0x1e] == '\0'),
                                   CONCAT113(-(pcVar6[0x1d] == '\0'),
                                             CONCAT112(-(pcVar6[0x1c] == '\0'),
                                                       CONCAT111(-(pcVar6[0x1b] == '\0'),
                                                                 CONCAT110(-(pcVar6[0x1a] == '\0'),
                                                                           CONCAT19(-(pcVar6[0x19]
                                                                                     == '\0'),
                                                                                    CONCAT18(-(
                                                  pcVar6[0x18] == '\0'),
                                                  CONCAT17(-(pcVar6[0x17] == '\0'),
                                                           CONCAT16(-(pcVar6[0x16] == '\0'),
                                                                    CONCAT15(-(pcVar6[0x15] == '\0')
                                                                             ,CONCAT14(-(pcVar6[0x14
                                                  ] == '\0'),
                                                  CONCAT13(-(pcVar6[0x13] == '\0'),
                                                           CONCAT12(-(pcVar6[0x12] == '\0'),
                                                                    CONCAT11(-(pcVar6[0x11] == '\0')
                                                                             ,-(*pcVar5 == '\0')))))
                                                  )))))))))));
      uVar2 = (ushort)(SUB161(auVar8 >> 7,0) & 1) | (ushort)(SUB161(auVar8 >> 0xf,0) & 1) << 1 |
              (ushort)(SUB161(auVar8 >> 0x17,0) & 1) << 2 |
              (ushort)(SUB161(auVar8 >> 0x1f,0) & 1) << 3 |
              (ushort)(SUB161(auVar8 >> 0x27,0) & 1) << 4 |
              (ushort)(SUB161(auVar8 >> 0x2f,0) & 1) << 5 |
              (ushort)(SUB161(auVar8 >> 0x37,0) & 1) << 6 |
              (ushort)(SUB161(auVar8 >> 0x3f,0) & 1) << 7 |
              (ushort)(SUB161(auVar8 >> 0x47,0) & 1) << 8 |
              (ushort)(SUB161(auVar8 >> 0x4f,0) & 1) << 9 |
              (ushort)(SUB161(auVar8 >> 0x57,0) & 1) << 10 |
              (ushort)(SUB161(auVar8 >> 0x5f,0) & 1) << 0xb |
              (ushort)(SUB161(auVar8 >> 0x67,0) & 1) << 0xc |
              (ushort)(SUB161(auVar8 >> 0x6f,0) & 1) << 0xd |
              (ushort)(SUB161(auVar8 >> 0x77,0) & 1) << 0xe |
              (ushort)SUB161(auVar8 >> 0x7f,0) << 0xf;
      uVar4 = (uint)uVar2;
      pcVar6 = pcVar5;
    } while (uVar2 == 0);
  }
  uVar1 = 0;
  if (uVar4 != 0) {
    for (; (uVar4 >> uVar1 & 1) == 0; uVar1 = uVar1 + 1) {
    }
  }
  pcVar6 = (char *)0x0;
  if (pcVar5[uVar1] == (char)uVar3) {
    pcVar6 = pcVar5 + uVar1;
  }
  return pcVar6;
}



// Library Function - Single Match
//  _get_osfhandle
// 
// Library: Visual Studio 2015 Release

intptr_t __cdecl _get_osfhandle(int _FileHandle)

{
  ulong *puVar1;
  longlong lVar2;
  
  if (_FileHandle == -2) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    puVar1 = __doserrno();
    *puVar1 = 9;
  }
  else {
    if ((-1 < _FileHandle) && ((uint)_FileHandle < DAT_140039a00)) {
      lVar2 = (ulonglong)(_FileHandle & 0x3f) * 0x40;
      if ((*(byte *)((&DAT_140039600)[(longlong)_FileHandle >> 6] + 0x38 + lVar2) & 1) != 0) {
        return *(intptr_t *)((&DAT_140039600)[(longlong)_FileHandle >> 6] + 0x28 + lVar2);
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    puVar1 = __doserrno();
    *puVar1 = 9;
    FUN_140011e58();
  }
  return -1;
}



uint FUN_14001e1ec(void)

{
  LPCRITICAL_SECTION p_Var1;
  undefined8 *puVar2;
  longlong lVar3;
  uint uVar4;
  int iVar5;
  LPCRITICAL_SECTION lpCriticalSection;
  
  FID_conflict___acrt_lock(7);
  uVar4 = 0xffffffff;
  iVar5 = 0;
  do {
    if (0x7f < iVar5) {
LAB_14001e2e9:
      FID_conflict___acrt_lock(7);
      return uVar4;
    }
    p_Var1 = (LPCRITICAL_SECTION)(&DAT_140039600)[iVar5];
    if (p_Var1 == (LPCRITICAL_SECTION)0x0) {
      puVar2 = __acrt_lowio_create_handle_array();
      (&DAT_140039600)[iVar5] = puVar2;
      if (puVar2 != (undefined8 *)0x0) {
        DAT_140039a00 = DAT_140039a00 + 0x40;
        uVar4 = iVar5 << 6;
        FID_conflict___acrt_lowio_lock_fh(uVar4);
        *(undefined *)((&DAT_140039600)[(longlong)(int)uVar4 >> 6] + 0x38) = 1;
      }
      goto LAB_14001e2e9;
    }
    for (lpCriticalSection = p_Var1;
        lpCriticalSection != (LPCRITICAL_SECTION)&p_Var1[0x66].OwningThread;
        lpCriticalSection = (LPCRITICAL_SECTION)&lpCriticalSection[1].LockSemaphore) {
      if ((*(byte *)&lpCriticalSection[1].OwningThread & 1) == 0) {
        EnterCriticalSection(lpCriticalSection);
        if ((*(byte *)&lpCriticalSection[1].OwningThread & 1) == 0) {
          uVar4 = (int)((longlong)lpCriticalSection - (longlong)p_Var1 >> 6) + iVar5 * 0x40;
          lVar3 = (ulonglong)(uVar4 & 0x3f) * 0x40;
          *(undefined *)((&DAT_140039600)[(longlong)(int)uVar4 >> 6] + 0x38 + lVar3) = 1;
          *(undefined8 *)((&DAT_140039600)[(longlong)(int)uVar4 >> 6] + 0x28 + lVar3) =
               0xffffffffffffffff;
          goto LAB_14001e2e9;
        }
        LeaveCriticalSection(lpCriticalSection);
      }
    }
    iVar5 = iVar5 + 1;
  } while( true );
}



// Library Function - Single Match
//  _free_osfhnd
// 
// Library: Visual Studio 2015 Release

int __cdecl _free_osfhnd(int param_1)

{
  int iVar1;
  ulong *puVar2;
  DWORD nStdHandle;
  longlong lVar3;
  
  if ((-1 < param_1) && ((uint)param_1 < DAT_140039a00)) {
    lVar3 = (ulonglong)(param_1 & 0x3f) * 0x40;
    if (((*(byte *)((&DAT_140039600)[(longlong)param_1 >> 6] + 0x38 + lVar3) & 1) != 0) &&
       (*(longlong *)((&DAT_140039600)[(longlong)param_1 >> 6] + 0x28 + lVar3) != -1)) {
      iVar1 = FUN_140012d00();
      if (iVar1 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_14001e390;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_14001e390:
      *(undefined8 *)((&DAT_140039600)[(longlong)param_1 >> 6] + 0x28 + lVar3) = 0xffffffffffffffff;
      return 0;
    }
  }
  puVar2 = __doserrno();
  *puVar2 = 9;
  puVar2 = __doserrno();
  *puVar2 = 0;
  return -1;
}



// Library Function - Single Match
//  __acrt_lowio_set_os_handle
// 
// Library: Visual Studio 2015 Release

undefined8 __acrt_lowio_set_os_handle(uint param_1,HANDLE param_2)

{
  int iVar1;
  ulong *puVar2;
  DWORD nStdHandle;
  longlong lVar3;
  
  if ((-1 < (int)param_1) && (param_1 < DAT_140039a00)) {
    lVar3 = (ulonglong)(param_1 & 0x3f) * 0x40;
    if (*(longlong *)((&DAT_140039600)[(longlong)(int)param_1 >> 6] + 0x28 + lVar3) == -1) {
      iVar1 = FUN_140012d00();
      if (iVar1 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_14001e44d;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,param_2);
      }
LAB_14001e44d:
      *(HANDLE *)((&DAT_140039600)[(longlong)(int)param_1 >> 6] + 0x28 + lVar3) = param_2;
      return 0;
    }
  }
  puVar2 = __doserrno();
  *puVar2 = 9;
  puVar2 = __doserrno();
  *puVar2 = 0;
  return 0xffffffff;
}



// Library Function - Single Match
//  __acrt_lowio_create_handle_array
// 
// Library: Visual Studio 2015 Release

undefined8 * __acrt_lowio_create_handle_array(void)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  
  puVar2 = (undefined8 *)_calloc_base(0x40,0x40);
  puVar3 = (undefined8 *)0x0;
  if ((puVar2 != (undefined8 *)0x0) && (puVar3 = puVar2, puVar2 != puVar2 + 0x200)) {
    puVar2 = puVar2 + 6;
    do {
      __acrt_InitializeCriticalSectionEx((LPCRITICAL_SECTION)(puVar2 + -6),4000,0);
      puVar2[-1] = 0xffffffffffffffff;
      *puVar2 = 0;
      *(undefined4 *)(puVar2 + 1) = 0xa0a0000;
      *(undefined *)((longlong)puVar2 + 0xc) = 10;
      *(byte *)((longlong)puVar2 + 0xd) = *(byte *)((longlong)puVar2 + 0xd) & 0xf8;
      *(undefined *)((longlong)puVar2 + 0xe) = 0;
      puVar1 = puVar2 + 2;
      puVar2 = puVar2 + 8;
    } while (puVar1 != puVar2 + 0x200);
  }
  _free_base((LPVOID)0x0);
  return puVar3;
}



// Library Function - Single Match
//  __acrt_lowio_destroy_handle_array
// 
// Library: Visual Studio 2015 Release

void __acrt_lowio_destroy_handle_array(LPCRITICAL_SECTION param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  
  if (param_1 != (LPCRITICAL_SECTION)0x0) {
    lpCriticalSection = param_1;
    if (param_1 != (LPCRITICAL_SECTION)&param_1[0x66].OwningThread) {
      do {
        DeleteCriticalSection(lpCriticalSection);
        lpCriticalSection = (LPCRITICAL_SECTION)&lpCriticalSection[1].LockSemaphore;
      } while (lpCriticalSection != (LPCRITICAL_SECTION)&param_1[0x66].OwningThread);
    }
    _free_base(param_1);
  }
  return;
}



longlong FUN_14001e574(uint param_1)

{
  int iVar1;
  ulong *puVar2;
  longlong lVar3;
  undefined8 *puVar4;
  longlong lVar5;
  
  if (param_1 < 0x2000) {
    lVar3 = 0;
    FID_conflict___acrt_lock(7);
    lVar5 = lVar3;
    iVar1 = DAT_140039a00;
    while (iVar1 <= (int)param_1) {
      if ((&DAT_140039600)[lVar5] == 0) {
        puVar4 = __acrt_lowio_create_handle_array();
        (&DAT_140039600)[lVar5] = puVar4;
        if (puVar4 == (undefined8 *)0x0) {
          lVar3 = 0xc;
          break;
        }
        iVar1 = DAT_140039a00 + 0x40;
        DAT_140039a00 = iVar1;
      }
      lVar5 = lVar5 + 1;
    }
    FID_conflict___acrt_lock(7);
  }
  else {
    puVar2 = __doserrno();
    *puVar2 = 9;
    FUN_140011e58();
    lVar3 = 9;
  }
  return lVar3;
}



// Library Function - Multiple Matches With Different Base Names
//  __acrt_lowio_lock_fh
//  __acrt_lowio_unlock_fh
// 
// Library: Visual Studio 2015 Release

void FID_conflict___acrt_lowio_lock_fh(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x00014001e638. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x3f) * 0x40 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]));
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  __acrt_lowio_lock_fh
//  __acrt_lowio_unlock_fh
// 
// Library: Visual Studio 2015 Release

void FID_conflict___acrt_lowio_lock_fh(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x00014001e65c. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x3f) * 0x40 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]));
  return;
}



// Library Function - Single Match
//  _towlower_l
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release

wint_t __cdecl _towlower_l(wint_t _C,_locale_t _Locale)

{
  ushort uVar1;
  int iVar2;
  undefined6 extraout_var;
  WCHAR local_res8 [8];
  WCHAR local_res18 [8];
  longlong local_28;
  longlong local_20;
  char local_10;
  
  local_res8[0] = L'\xffff';
  if (_C != 0xffff) {
    local_res8[0] = _C;
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)_Locale);
    if (*(wchar_t **)(local_20 + 0x138) == (wchar_t *)0x0) {
      if ((ushort)(local_res8[0] + L'﾿') < 0x1a) {
        local_res8[0] = local_res8[0] + L' ';
      }
    }
    else if ((ushort)local_res8[0] < 0x100) {
      uVar1 = FUN_1400209d0(local_res8[0],1);
      if ((int)CONCAT62(extraout_var,uVar1) != 0) {
        local_res8[0] =
             (WCHAR)*(byte *)(*(longlong *)(local_20 + 0x110) + (ulonglong)(ushort)local_res8[0]);
      }
    }
    else {
      iVar2 = __acrt_LCMapStringW(*(wchar_t **)(local_20 + 0x138),0x100,local_res8,1,local_res18,1);
      if (iVar2 != 0) {
        local_res8[0] = local_res18[0];
      }
    }
    if (local_10 != '\0') {
      *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
    }
  }
  return local_res8[0];
}



// Library Function - Single Match
//  __acrt_LCMapStringW
// 
// Library: Visual Studio 2017 Release

void __acrt_LCMapStringW(wchar_t *param_1,DWORD param_2,wchar_t *param_3,int param_4,LPWSTR param_5,
                        int param_6)

{
  int iVar1;
  size_t sVar2;
  int iVar3;
  
  iVar3 = param_4;
  if (0 < param_4) {
    sVar2 = wcsnlen(param_3,(longlong)param_4);
    iVar1 = (int)sVar2;
    iVar3 = iVar1 + 1;
    if (param_4 <= iVar1) {
      iVar3 = iVar1;
    }
  }
  __acrt_LCMapStringEx(param_1,param_2,param_3,iVar3,param_5,param_6,0,0,0);
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  _alloca_probe
// 
// Libraries: Visual Studio 2015, Visual Studio 2017, Visual Studio 2019

void _alloca_probe(void)

{
  undefined *in_RAX;
  undefined *puVar1;
  undefined *puVar2;
  undefined local_res8 [32];
  
  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined *)0x0;
  }
  if (puVar1 < StackLimit) {
    puVar2 = (undefined *)StackLimit;
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



// Library Function - Single Match
//  class __crt_stdio_stream __cdecl __acrt_stdio_allocate_stream(void)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

__crt_stdio_stream __cdecl __acrt_stdio_allocate_stream(void)

{
  undefined8 *puVar1;
  __crt_stdio_stream _Var2;
  undefined7 extraout_var;
  undefined8 *in_RCX;
  
  *in_RCX = 0;
  FID_conflict___acrt_lock(8);
  _Var2 = find_or_allocate_unused_stream_nolock();
  puVar1 = *(undefined8 **)CONCAT71(extraout_var,_Var2);
  *in_RCX = puVar1;
  if (puVar1 != (undefined8 *)0x0) {
    *(undefined4 *)(puVar1 + 2) = 0;
    puVar1[5] = 0;
    *puVar1 = 0;
    puVar1[1] = 0;
    *(undefined4 *)(puVar1 + 3) = 0xffffffff;
  }
  FID_conflict___acrt_lock(8);
  return SUB81(in_RCX,0);
}



// Library Function - Single Match
//  void __cdecl __acrt_stdio_free_stream(class __crt_stdio_stream)
// 
// Library: Visual Studio 2017 Release

void __cdecl __acrt_stdio_free_stream(__crt_stdio_stream param_1)

{
  undefined7 in_register_00000009;
  
  *(undefined4 *)(CONCAT71(in_register_00000009,param_1) + 0x18) = 0xffffffff;
  *(undefined8 *)CONCAT71(in_register_00000009,param_1) = 0;
  *(undefined8 *)(CONCAT71(in_register_00000009,param_1) + 8) = 0;
  *(undefined4 *)(CONCAT71(in_register_00000009,param_1) + 0x10) = 0;
  *(undefined8 *)(CONCAT71(in_register_00000009,param_1) + 0x1c) = 0;
  *(undefined8 *)(CONCAT71(in_register_00000009,param_1) + 0x28) = 0;
  *(undefined4 *)(CONCAT71(in_register_00000009,param_1) + 0x14) = 0;
  return;
}



// Library Function - Single Match
//  class __crt_stdio_stream __cdecl find_or_allocate_unused_stream_nolock(void)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

__crt_stdio_stream __cdecl find_or_allocate_unused_stream_nolock(void)

{
  uint *puVar1;
  LPVOID *ppvVar2;
  uint uVar3;
  LPVOID pvVar4;
  LPVOID *in_RCX;
  LPVOID *ppvVar5;
  
  ppvVar5 = (LPVOID *)(DAT_140038dc0 + 0x18);
  ppvVar2 = ppvVar5 + (longlong)DAT_140038db8 + -3;
  do {
    if (ppvVar5 == ppvVar2) {
LAB_14001e956:
      *in_RCX = (LPVOID)0x0;
LAB_14001e95a:
      return SUB81(in_RCX,0);
    }
    pvVar4 = *ppvVar5;
    if (pvVar4 == (LPVOID)0x0) {
      pvVar4 = _calloc_base(1,0x58);
      *ppvVar5 = pvVar4;
      _free_base((LPVOID)0x0);
      if (*ppvVar5 != (LPVOID)0x0) {
        *(undefined4 *)((longlong)*ppvVar5 + 0x18) = 0xffffffff;
        __acrt_InitializeCriticalSectionEx((LPCRITICAL_SECTION)((longlong)*ppvVar5 + 0x30),4000,0);
        pvVar4 = *ppvVar5;
        LOCK();
        *(uint *)((longlong)pvVar4 + 0x14) = *(uint *)((longlong)pvVar4 + 0x14) | 0x2000;
        FUN_14000d45c((longlong)pvVar4);
LAB_14001e951:
        *in_RCX = pvVar4;
        goto LAB_14001e95a;
      }
      goto LAB_14001e956;
    }
    if ((*(uint *)((longlong)pvVar4 + 0x14) >> 0xd & 1) == 0) {
      FUN_14000d45c((longlong)pvVar4);
      uVar3 = *(uint *)((longlong)pvVar4 + 0x14);
      while( true ) {
        LOCK();
        puVar1 = (uint *)((longlong)pvVar4 + 0x14);
        if (uVar3 == *puVar1) break;
        uVar3 = *puVar1;
      }
      *puVar1 = uVar3 | 0x2000;
      if ((~(byte)(uVar3 >> 0xd) & 1) != 0) goto LAB_14001e951;
      FUN_14000d468((longlong)pvVar4);
    }
    ppvVar5 = ppvVar5 + 1;
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Multiple Matches With Different Base Names
//  _openfile
//  _wopenfile
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

FILE * __cdecl FID_conflict__wopenfile(wchar_t *_Filename,wchar_t *_Mode,int _ShFlag,FILE *_File)

{
  uint *puVar1;
  undefined8 uVar2;
  errno_t eVar3;
  undefined8 *puVar4;
  FILE *pFVar5;
  int local_res18 [2];
  int local_28;
  uint uStack_24;
  undefined8 local_18 [2];
  
  puVar4 = FUN_14001ea10(local_18,_Mode);
  uVar2 = *puVar4;
  pFVar5 = (FILE *)0x0;
  if ((char)*(undefined4 *)(puVar4 + 1) != '\0') {
    local_28 = (int)uVar2;
    eVar3 = FID_conflict__sopen_s(local_res18,(char *)_Filename,local_28,_ShFlag,0x180);
    if (eVar3 == 0) {
      _DAT_140038dc8 = _DAT_140038dc8 + 1;
      uStack_24 = (uint)((ulonglong)uVar2 >> 0x20);
      LOCK();
      puVar1 = (uint *)((longlong)&_File->_base + 4);
      *puVar1 = *puVar1 | uStack_24;
      *(undefined4 *)&_File->_base = 0;
      _File->_tmpfname = (char *)0x0;
      *(undefined8 *)&_File->_cnt = 0;
      _File->_ptr = (char *)0x0;
      _File->_flag = local_res18[0];
      pFVar5 = _File;
    }
  }
  return pFVar5;
}



undefined8 * FUN_14001ea10(undefined8 *param_1,short *param_2)

{
  wchar_t wVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  short sVar8;
  uint uVar9;
  int iVar10;
  ulong *puVar11;
  wchar_t *pwVar12;
  longlong lVar13;
  wchar_t *pwVar14;
  
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  *(undefined4 *)((longlong)param_1 + 4) = DAT_140038df8;
  sVar8 = *param_2;
  while (sVar8 == 0x20) {
    param_2 = param_2 + 1;
    sVar8 = *param_2;
  }
  if (sVar8 == 0x61) {
    *(undefined4 *)param_1 = 0x109;
LAB_14001ea8a:
    *(undefined4 *)((longlong)param_1 + 4) = 2;
  }
  else {
    if (sVar8 != 0x72) {
      if (sVar8 != 0x77) goto LAB_14001ece5;
      *(undefined4 *)param_1 = 0x301;
      goto LAB_14001ea8a;
    }
    *(undefined4 *)param_1 = 0;
    *(undefined4 *)((longlong)param_1 + 4) = 1;
  }
  pwVar14 = param_2 + 1;
  bVar3 = false;
  bVar7 = true;
  lVar13 = 10;
  bVar2 = bVar3;
  bVar4 = bVar3;
  bVar5 = bVar3;
  bVar6 = bVar3;
  do {
    if (*pwVar14 == L'\0') break;
    wVar1 = *pwVar14;
    if ((ushort)wVar1 < 0x54) {
      if (wVar1 == L'S') {
        bVar7 = bVar3;
        if (!bVar2) {
          *(uint *)param_1 = *(uint *)param_1 | 0x20;
LAB_14001eb56:
          bVar2 = true;
          bVar7 = true;
        }
      }
      else if (wVar1 != L' ') {
        if (wVar1 == L'+') {
          bVar7 = bVar3;
          if (!bVar6) {
            bVar6 = true;
            if ((*(uint *)param_1 & 2) == 0) {
              *(uint *)param_1 = *(uint *)param_1 & 0xfffffffe | 2;
              *(uint *)((longlong)param_1 + 4) = *(uint *)((longlong)param_1 + 4) & 0xfffffffc | 4;
LAB_14001ebe0:
              bVar7 = true;
            }
          }
        }
        else if (wVar1 == L',') {
          bVar5 = true;
          bVar7 = bVar3;
        }
        else if (wVar1 == L'D') {
          bVar7 = bVar3;
          if ((*(uint *)param_1 & 0x40) == 0) {
            uVar9 = *(uint *)param_1 | 0x40;
            goto LAB_14001ebde;
          }
        }
        else {
          if (wVar1 == L'N') {
            *(uint *)param_1 = *(uint *)param_1 | 0x80;
            goto LAB_14001ebe0;
          }
          if (wVar1 != L'R') goto LAB_14001ece5;
          bVar7 = bVar3;
          if (!bVar2) {
            *(uint *)param_1 = *(uint *)param_1 | 0x10;
            goto LAB_14001eb56;
          }
        }
      }
    }
    else if (wVar1 == L'T') {
      bVar7 = bVar3;
      if ((*(uint *)param_1 >> 0xc & 1) == 0) {
        uVar9 = *(uint *)param_1 | 0x1000;
        goto LAB_14001ebde;
      }
    }
    else if (wVar1 == L'b') {
      bVar7 = bVar3;
      if ((*(uint *)param_1 & 0xc000) == 0) {
        uVar9 = *(uint *)param_1 | 0x8000;
        goto LAB_14001ebde;
      }
    }
    else if (wVar1 == L'c') {
      bVar7 = bVar3;
      if (!bVar4) {
        *(uint *)((longlong)param_1 + 4) = *(uint *)((longlong)param_1 + 4) | 0x800;
LAB_14001ebb6:
        bVar4 = true;
        bVar7 = true;
      }
    }
    else if (wVar1 == L'n') {
      bVar7 = bVar3;
      if (!bVar4) {
        *(uint *)((longlong)param_1 + 4) = *(uint *)((longlong)param_1 + 4) & 0xfffff7ff;
        goto LAB_14001ebb6;
      }
    }
    else if (wVar1 == L't') {
      bVar7 = bVar3;
      if ((*(uint *)param_1 & 0xc000) == 0) {
        uVar9 = *(uint *)param_1 | 0x4000;
        goto LAB_14001ebde;
      }
    }
    else {
      if (wVar1 != L'x') goto LAB_14001ece5;
      bVar7 = bVar3;
      if ((*(uint *)param_1 >> 9 & 1) != 0) {
        uVar9 = *(uint *)param_1 | 0x400;
LAB_14001ebde:
        *(uint *)param_1 = uVar9;
        goto LAB_14001ebe0;
      }
    }
    pwVar14 = (wchar_t *)((longlong)pwVar14 + (ulonglong)(-(uint)bVar7 & 2));
  } while (bVar7);
  pwVar12 = pwVar14 + 1;
  if (!bVar5) {
    pwVar12 = pwVar14;
  }
  for (; *pwVar12 == L' '; pwVar12 = pwVar12 + 1) {
  }
  if (bVar5) {
    iVar10 = wcsncmp(pwVar12,L"ccs",3);
    if (iVar10 != 0) goto LAB_14001ece5;
    for (pwVar12 = pwVar12 + 3; *pwVar12 == L' '; pwVar12 = pwVar12 + 1) {
    }
    if (*pwVar12 != L'=') goto LAB_14001ece5;
    do {
      pwVar12 = pwVar12 + 1;
    } while (*pwVar12 == L' ');
    iVar10 = FUN_140013348((wint_t *)pwVar12,(wint_t *)L"UTF-8",5);
    if (iVar10 == 0) {
      *(uint *)param_1 = *(uint *)param_1 | 0x40000;
    }
    else {
      iVar10 = FUN_140013348((wint_t *)pwVar12,(wint_t *)L"UTF-16LEUNICODE",8);
      if (iVar10 == 0) {
        *(uint *)param_1 = *(uint *)param_1 | 0x20000;
        lVar13 = 0x10;
      }
      else {
        iVar10 = FUN_140013348((wint_t *)pwVar12,(wint_t *)L"UNICODE",7);
        if (iVar10 != 0) goto LAB_14001ece5;
        *(uint *)param_1 = *(uint *)param_1 | 0x10000;
        lVar13 = 0xe;
      }
    }
    for (pwVar12 = (wchar_t *)((longlong)pwVar12 + lVar13); wVar1 = *pwVar12, wVar1 == L' ';
        pwVar12 = pwVar12 + 1) {
    }
  }
  else {
    wVar1 = *pwVar12;
  }
  if (wVar1 == L'\0') {
    *(undefined *)(param_1 + 1) = 1;
    return param_1;
  }
LAB_14001ece5:
  puVar11 = __doserrno();
  *puVar11 = 0x16;
  FUN_140011e58();
  return param_1;
}



// Library Function - Single Match
//  _close
// 
// Library: Visual Studio 2015 Release

int __cdecl _close(int _FileHandle)

{
  int iVar1;
  ulong *puVar2;
  int local_res8 [2];
  __crt_seh_guarded_call_int_ local_res10 [8];
  int local_res18 [2];
  int local_res20 [2];
  int *local_18 [3];
  
  local_res8[0] = _FileHandle;
  if (_FileHandle == -2) {
    puVar2 = __doserrno();
    *puVar2 = 0;
    puVar2 = __doserrno();
    *puVar2 = 9;
  }
  else {
    if (((-1 < _FileHandle) && ((uint)_FileHandle < DAT_140039a00)) &&
       ((*(byte *)((&DAT_140039600)[(longlong)_FileHandle >> 6] + 0x38 +
                  (ulonglong)(_FileHandle & 0x3f) * 0x40) & 1) != 0)) {
      local_18[0] = local_res8;
      local_res18[0] = _FileHandle;
      local_res20[0] = _FileHandle;
      iVar1 = __crt_seh_guarded_call<int>::
              operator___class__lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0__class__lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_____ptr64_class__lambda_237c231691f317818eb88cc1d5d642d6___
                        (local_res10,(_lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0_ *)local_res20,
                         (_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ *)local_18,
                         (_lambda_237c231691f317818eb88cc1d5d642d6_ *)local_res18);
      return iVar1;
    }
    puVar2 = __doserrno();
    *puVar2 = 0;
    puVar2 = __doserrno();
    *puVar2 = 9;
    FUN_140011e58();
  }
  return -1;
}



// Library Function - Single Match
//  _close_nolock
// 
// Library: Visual Studio 2015 Release

int __cdecl _close_nolock(int _FileHandle)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  intptr_t iVar4;
  intptr_t iVar5;
  HANDLE hObject;
  
  iVar4 = _get_osfhandle(_FileHandle);
  if (iVar4 != -1) {
    if (((_FileHandle == 1) && ((*(byte *)(DAT_140039600 + 0xb8) & 1) != 0)) ||
       ((_FileHandle == 2 && ((*(byte *)(DAT_140039600 + 0x78) & 1) != 0)))) {
      iVar4 = _get_osfhandle(2);
      iVar5 = _get_osfhandle(1);
      if (iVar5 == iVar4) goto LAB_14001edd2;
    }
    hObject = (HANDLE)_get_osfhandle(_FileHandle);
    BVar1 = CloseHandle(hObject);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      goto LAB_14001ee2d;
    }
  }
LAB_14001edd2:
  DVar2 = 0;
LAB_14001ee2d:
  _free_osfhnd(_FileHandle);
  *(undefined *)
   ((&DAT_140039600)[(longlong)_FileHandle >> 6] + 0x38 + (ulonglong)(_FileHandle & 0x3f) * 0x40) =
       0;
  if (DVar2 == 0) {
    iVar3 = 0;
  }
  else {
    __acrt_errno_map_os_error(DVar2);
    iVar3 = -1;
  }
  return iVar3;
}



// Library Function - Single Match
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0>,class <lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec> &
// __ptr64,class <lambda_237c231691f317818eb88cc1d5d642d6> >(class
// <lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0> && __ptr64,class
// <lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec> & __ptr64,class
// <lambda_237c231691f317818eb88cc1d5d642d6> && __ptr64) __ptr64
// 
// Library: Visual Studio 2015 Release

int __thiscall
__crt_seh_guarded_call<int>::
operator___class__lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0__class__lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_____ptr64_class__lambda_237c231691f317818eb88cc1d5d642d6___
          (__crt_seh_guarded_call_int_ *this,_lambda_bfedae4ebbf01fab1bb6dcc6a9e276e0_ *param_1,
          _lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ *param_2,
          _lambda_237c231691f317818eb88cc1d5d642d6_ *param_3)

{
  uint _FileHandle;
  int iVar1;
  ulong *puVar2;
  
  FID_conflict___acrt_lowio_lock_fh(*(uint *)param_1);
  _FileHandle = **(uint **)param_2;
  if ((*(byte *)((&DAT_140039600)[(longlong)(int)_FileHandle >> 6] + 0x38 +
                (ulonglong)(_FileHandle & 0x3f) * 0x40) & 1) == 0) {
    puVar2 = __doserrno();
    *puVar2 = 9;
    iVar1 = -1;
  }
  else {
    iVar1 = _close_nolock(_FileHandle);
  }
  FID_conflict___acrt_lowio_lock_fh(*(uint *)param_3);
  return iVar1;
}



// Library Function - Single Match
//  _commit
// 
// Library: Visual Studio 2015 Release

int __cdecl _commit(int _FileHandle)

{
  int iVar1;
  ulong *puVar2;
  int local_res8 [2];
  __crt_seh_guarded_call_int_ local_res10 [8];
  int local_res18 [2];
  int local_res20 [2];
  int *local_18 [3];
  
  local_res8[0] = _FileHandle;
  if (_FileHandle == -2) {
    puVar2 = __doserrno();
    *puVar2 = 9;
  }
  else {
    if (((-1 < _FileHandle) && ((uint)_FileHandle < DAT_140039a00)) &&
       ((*(byte *)((&DAT_140039600)[(longlong)_FileHandle >> 6] + 0x38 +
                  (ulonglong)(_FileHandle & 0x3f) * 0x40) & 1) != 0)) {
      local_18[0] = local_res8;
      local_res18[0] = _FileHandle;
      local_res20[0] = _FileHandle;
      iVar1 = __crt_seh_guarded_call<int>::
              operator___class__lambda_b521505b218e5242e90febf6bfebc422__class__lambda_6978c1fb23f02e42e1d9e99668cc68aa_____ptr64_class__lambda_314360699dd331753a4119843814e9a7___
                        (local_res10,(_lambda_b521505b218e5242e90febf6bfebc422_ *)local_res20,
                         (_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ *)local_18,
                         (_lambda_314360699dd331753a4119843814e9a7_ *)local_res18);
      return iVar1;
    }
    puVar2 = __doserrno();
    *puVar2 = 9;
    FUN_140011e58();
  }
  return -1;
}



// Library Function - Single Match
//  public: int __cdecl __crt_seh_guarded_call<int>::operator()<class
// <lambda_b521505b218e5242e90febf6bfebc422>,class <lambda_6978c1fb23f02e42e1d9e99668cc68aa> &
// __ptr64,class <lambda_314360699dd331753a4119843814e9a7> >(class
// <lambda_b521505b218e5242e90febf6bfebc422> && __ptr64,class
// <lambda_6978c1fb23f02e42e1d9e99668cc68aa> & __ptr64,class
// <lambda_314360699dd331753a4119843814e9a7> && __ptr64) __ptr64
// 
// Library: Visual Studio 2015 Release

int __thiscall
__crt_seh_guarded_call<int>::
operator___class__lambda_b521505b218e5242e90febf6bfebc422__class__lambda_6978c1fb23f02e42e1d9e99668cc68aa_____ptr64_class__lambda_314360699dd331753a4119843814e9a7___
          (__crt_seh_guarded_call_int_ *this,_lambda_b521505b218e5242e90febf6bfebc422_ *param_1,
          _lambda_6978c1fb23f02e42e1d9e99668cc68aa_ *param_2,
          _lambda_314360699dd331753a4119843814e9a7_ *param_3)

{
  uint _FileHandle;
  BOOL BVar1;
  DWORD DVar2;
  HANDLE hFile;
  ulong *puVar3;
  int iVar4;
  
  FID_conflict___acrt_lowio_lock_fh(*(uint *)param_1);
  _FileHandle = **(uint **)param_2;
  if ((*(byte *)((&DAT_140039600)[(longlong)(int)_FileHandle >> 6] + 0x38 +
                (ulonglong)(_FileHandle & 0x3f) * 0x40) & 1) != 0) {
    hFile = (HANDLE)_get_osfhandle(_FileHandle);
    BVar1 = FlushFileBuffers(hFile);
    iVar4 = 0;
    if (BVar1 != 0) goto LAB_14001eff4;
    puVar3 = __doserrno();
    DVar2 = GetLastError();
    *puVar3 = DVar2;
  }
  puVar3 = __doserrno();
  *puVar3 = 9;
  iVar4 = -1;
LAB_14001eff4:
  FID_conflict___acrt_lowio_lock_fh(*(uint *)param_3);
  return iVar4;
}



int FUN_14001f008(uint param_1,short *param_2,uint param_3)

{
  int iVar1;
  ulong *puVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    puVar2 = __doserrno();
    *puVar2 = 0;
    puVar2 = __doserrno();
    *puVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_140039a00)) {
      lVar3 = (ulonglong)(param_1 & 0x3f) * 0x40;
      if ((*(byte *)(lVar3 + 0x38 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]) & 1) != 0) {
        FID_conflict___acrt_lowio_lock_fh(param_1);
        iVar1 = -1;
        if ((*(byte *)(lVar3 + 0x38 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]) & 1) == 0) {
          puVar2 = __doserrno();
          *puVar2 = 9;
          puVar2 = __doserrno();
          *puVar2 = 0;
        }
        else {
          iVar1 = FUN_14001f0f4(param_1,param_2,param_3);
        }
        FID_conflict___acrt_lowio_lock_fh(param_1);
        return iVar1;
      }
    }
    puVar2 = __doserrno();
    *puVar2 = 0;
    puVar2 = __doserrno();
    *puVar2 = 9;
    FUN_140011e58();
  }
  return -1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_14001f0f4(uint param_1,short *param_2,uint param_3)

{
  char cVar1;
  uint uVar2;
  ulonglong uVar3;
  short sVar4;
  int iVar5;
  BOOL BVar6;
  DWORD DVar7;
  ulong *puVar8;
  __acrt_ptd *p_Var9;
  ulonglong *puVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  ulonglong uVar14;
  short *psVar15;
  undefined8 local_68;
  int local_60;
  ulonglong local_58;
  short local_48;
  
  uVar14 = (ulonglong)param_3;
  if (param_3 == 0) {
    return 0;
  }
  if (param_2 == (short *)0x0) {
LAB_14001f125:
    puVar8 = __doserrno();
    *puVar8 = 0;
    puVar8 = __doserrno();
    *puVar8 = 0x16;
    FUN_140011e58();
    return -1;
  }
  lVar12 = (longlong)(int)param_1 >> 6;
  lVar11 = (ulonglong)(param_1 & 0x3f) * 0x40;
  cVar1 = *(char *)(lVar11 + 0x39 + (&DAT_140039600)[lVar12]);
  if (((byte)(cVar1 - 1U) < 2) && ((~param_3 & 1) == 0)) goto LAB_14001f125;
  if ((*(byte *)(lVar11 + 0x38 + (&DAT_140039600)[lVar12]) & 0x20) != 0) {
    common_lseek_nolock___int64_(param_1,0,2);
  }
  local_58 = 0;
  iVar5 = _isatty(param_1);
  iVar13 = 0;
  if ((((iVar5 == 0) || (-1 < *(char *)(lVar11 + 0x38 + (&DAT_140039600)[lVar12]))) ||
      ((p_Var9 = FUN_140017b04(), *(longlong *)(*(longlong *)(p_Var9 + 0x90) + 0x138) == 0 &&
       (*(char *)(lVar11 + 0x39 + (&DAT_140039600)[lVar12]) == '\0')))) ||
     (BVar6 = GetConsoleMode(*(HANDLE *)(lVar11 + 0x28 + (&DAT_140039600)[lVar12]),
                             (LPDWORD)&local_48), BVar6 == 0)) {
    if (-1 < *(char *)(lVar11 + 0x38 + (&DAT_140039600)[lVar12])) {
      local_68 = 0;
      local_60 = 0;
      BVar6 = WriteFile(*(HANDLE *)(lVar11 + 0x28 + (&DAT_140039600)[lVar12]),param_2,param_3,
                        (LPDWORD)((longlong)&local_68 + 4),(LPOVERLAPPED)0x0);
      iVar13 = local_60;
      uVar3 = local_68;
      if (BVar6 == 0) {
        DVar7 = GetLastError();
        local_68 = local_68 & 0xffffffff00000000 | (ulonglong)DVar7;
        iVar13 = local_60;
        uVar3 = local_68;
      }
      goto LAB_14001f347;
    }
    if (cVar1 == '\0') {
      puVar10 = (ulonglong *)FUN_14001f5ec(&local_68,param_1,(char *)param_2,uVar14);
    }
    else if (cVar1 == '\x01') {
      puVar10 = (ulonglong *)FUN_14001f80c(&local_68,param_1,param_2,param_3);
    }
    else {
      uVar3 = local_58;
      if (cVar1 != '\x02') goto LAB_14001f347;
      puVar10 = (ulonglong *)FUN_14001f6f0(&local_68,param_1,param_2,uVar14);
    }
  }
  else {
    if (cVar1 != '\0') {
      uVar3 = local_58;
      if ((byte)(cVar1 - 1U) < 2) {
        iVar13 = 0;
        local_68 = 0;
        uVar3 = local_68;
        if (param_2 < (short *)((longlong)param_2 + uVar14)) {
          local_68._4_4_ = 0;
          psVar15 = param_2;
          do {
            local_48 = *psVar15;
            sVar4 = FUN_1400261f0(local_48);
            if (sVar4 != local_48) {
LAB_14001f27b:
              DVar7 = GetLastError();
              local_68 = local_68 & 0xffffffff00000000 | (ulonglong)DVar7;
              uVar3 = local_68;
              break;
            }
            local_68 = local_68 & 0xffffffff | (ulonglong)(local_68._4_4_ + 2) << 0x20;
            uVar2 = local_68._4_4_ + 2;
            if (local_48 == 10) {
              sVar4 = FUN_1400261f0(0xd);
              if (sVar4 != 0xd) goto LAB_14001f27b;
              local_68 = local_68 & 0xffffffff | (ulonglong)(local_68._4_4_ + 3) << 0x20;
              iVar13 = iVar13 + 1;
              uVar2 = local_68._4_4_ + 3;
            }
            local_68._4_4_ = uVar2;
            psVar15 = psVar15 + 1;
            uVar3 = local_68;
          } while (psVar15 < (short *)((longlong)param_2 + uVar14));
        }
      }
      goto LAB_14001f347;
    }
    puVar10 = (ulonglong *)FUN_14001f3d4(&local_68,param_1,(byte *)param_2,uVar14);
  }
  iVar13 = *(int *)(puVar10 + 1);
  uVar3 = *puVar10;
LAB_14001f347:
  local_58 = uVar3;
  iVar5 = (int)(local_58 >> 0x20);
  if (iVar5 != 0) {
    return iVar5 - iVar13;
  }
  if ((int)local_58 != 0) {
    if ((int)local_58 == 5) {
      puVar8 = __doserrno();
      *puVar8 = 9;
      puVar8 = __doserrno();
      *puVar8 = 5;
      return -1;
    }
    __acrt_errno_map_os_error((int)local_58);
    return -1;
  }
  if (((*(byte *)(lVar11 + 0x38 + (&DAT_140039600)[lVar12]) & 0x40) != 0) &&
     (*(char *)param_2 == '\x1a')) {
    return 0;
  }
  puVar8 = __doserrno();
  *puVar8 = 0x1c;
  puVar8 = __doserrno();
  *puVar8 = 0;
  return -1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_14001f3d4(undefined8 *param_1,uint param_2,byte *param_3,ulonglong param_4)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  uint nNumberOfBytesToWrite;
  BOOL BVar4;
  DWORD DVar5;
  longlong lVar6;
  byte *pbVar7;
  longlong lVar8;
  size_t sVar9;
  byte *pbVar10;
  longlong lVar11;
  undefined auStackY_b8 [32];
  wchar_t local_78 [2];
  undefined2 local_74 [2];
  uint local_70;
  uint local_6c;
  HANDLE local_68;
  byte *local_60;
  byte local_58;
  byte local_57;
  undefined local_50 [8];
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStackY_b8;
  lVar11 = (longlong)(int)param_2 >> 6;
  lVar8 = (ulonglong)(param_2 & 0x3f) * 0x40;
  pbVar10 = param_3 + (param_4 & 0xffffffff);
  local_68 = *(HANDLE *)((&DAT_140039600)[lVar11] + 0x28 + lVar8);
  local_60 = param_3;
  local_6c = GetConsoleCP();
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  if (param_3 < pbVar10) {
    do {
      bVar1 = *param_3;
      lVar6 = (&DAT_140039600)[lVar11];
      local_78[0] = L'\0';
      bVar2 = *(byte *)(lVar8 + 0x3d + lVar6);
      if ((bVar2 & 4) == 0) {
        lVar6 = FUN_14001b8a8();
        if (-1 < *(short *)(lVar6 + (ulonglong)*param_3 * 2)) {
          sVar9 = 1;
          pbVar7 = param_3;
          goto LAB_14001f4d3;
        }
        if (pbVar10 <= param_3 + 1) {
          *(byte *)((&DAT_140039600)[lVar11] + 0x3e + lVar8) = *param_3;
          pbVar10 = (byte *)((&DAT_140039600)[lVar11] + 0x3d + lVar8);
          *pbVar10 = *pbVar10 | 4;
          *(int *)((longlong)param_1 + 4) = *(int *)((longlong)param_1 + 4) + 1;
          break;
        }
        iVar3 = FUN_14001a0ec(local_78,(char *)param_3,2);
        param_3 = param_3 + 1;
      }
      else {
        local_58 = *(byte *)(lVar6 + 0x3e + lVar8);
        *(byte *)(lVar8 + 0x3d + lVar6) = bVar2 & 0xfb;
        sVar9 = 2;
        pbVar7 = &local_58;
        local_57 = bVar1;
LAB_14001f4d3:
        iVar3 = FUN_14001a0ec(local_78,(char *)pbVar7,sVar9);
      }
      if (iVar3 == -1) break;
      param_3 = param_3 + 1;
      nNumberOfBytesToWrite =
           __acrt_WideCharToMultiByte(local_6c,0,(char)local_78,1,(char)local_50,5,0,0);
      if (nNumberOfBytesToWrite == 0) break;
      BVar4 = WriteFile(local_68,local_50,nNumberOfBytesToWrite,&local_70,(LPOVERLAPPED)0x0);
      if (BVar4 == 0) {
LAB_14001f5b7:
        DVar5 = GetLastError();
        *(DWORD *)param_1 = DVar5;
        break;
      }
      *(int *)((longlong)param_1 + 4) = (*(int *)(param_1 + 1) - (int)local_60) + (int)param_3;
      if (local_70 < nNumberOfBytesToWrite) break;
      if (bVar1 == 10) {
        local_74[0] = 0xd;
        BVar4 = WriteFile(local_68,local_74,1,&local_70,(LPOVERLAPPED)0x0);
        if (BVar4 == 0) goto LAB_14001f5b7;
        if (local_70 == 0) break;
        *(int *)(param_1 + 1) = *(int *)(param_1 + 1) + 1;
        *(int *)((longlong)param_1 + 4) = *(int *)((longlong)param_1 + 4) + 1;
      }
    } while (param_3 < pbVar10);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY_b8);
  return;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

void FUN_14001f5ec(undefined8 *param_1,uint param_2,char *param_3,ulonglong param_4)

{
  char cVar1;
  HANDLE hFile;
  BOOL BVar2;
  DWORD DVar3;
  uint nNumberOfBytesToWrite;
  char *pcVar4;
  char *pcVar5;
  undefined auStackY_1470 [32];
  uint local_1440 [4];
  char local_1430 [5120];
  ulonglong local_30;
  undefined8 local_20;
  
  local_20 = 0x14001f604;
  local_30 = DAT_140038010 ^ (ulonglong)auStackY_1470;
  pcVar5 = param_3 + (param_4 & 0xffffffff);
  hFile = *(HANDLE *)
           ((&DAT_140039600)[(longlong)(int)param_2 >> 6] + 0x28 +
           (ulonglong)(param_2 & 0x3f) * 0x40);
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  if (pcVar5 <= param_3) {
LAB_14001f6c3:
    __security_check_cookie(local_30 ^ (ulonglong)auStackY_1470);
    return;
  }
  do {
    pcVar4 = local_1430;
    do {
      if (pcVar5 <= param_3) break;
      cVar1 = *param_3;
      param_3 = param_3 + 1;
      if (cVar1 == '\n') {
        *(int *)(param_1 + 1) = *(int *)(param_1 + 1) + 1;
        *pcVar4 = '\r';
        pcVar4 = pcVar4 + 1;
      }
      *pcVar4 = cVar1;
      pcVar4 = pcVar4 + 1;
    } while (pcVar4 < local_1430 + 0x13ff);
    nNumberOfBytesToWrite = (int)pcVar4 - (int)local_1430;
    BVar2 = WriteFile(hFile,local_1430,nNumberOfBytesToWrite,local_1440,(LPOVERLAPPED)0x0);
    if (BVar2 == 0) {
      DVar3 = GetLastError();
      *(DWORD *)param_1 = DVar3;
      goto LAB_14001f6c3;
    }
    *(int *)((longlong)param_1 + 4) = *(int *)((longlong)param_1 + 4) + local_1440[0];
    if ((local_1440[0] < nNumberOfBytesToWrite) || (pcVar5 <= param_3)) goto LAB_14001f6c3;
  } while( true );
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

void FUN_14001f6f0(undefined8 *param_1,uint param_2,short *param_3,ulonglong param_4)

{
  short sVar1;
  HANDLE hFile;
  uint nNumberOfBytesToWrite;
  BOOL BVar2;
  DWORD DVar3;
  short *psVar4;
  short *psVar5;
  undefined auStackY_1470 [32];
  uint local_1440 [4];
  short local_1430 [2560];
  ulonglong local_30;
  undefined8 local_20;
  
  local_20 = 0x14001f708;
  local_30 = DAT_140038010 ^ (ulonglong)auStackY_1470;
  psVar5 = (short *)((param_4 & 0xffffffff) + (longlong)param_3);
  hFile = *(HANDLE *)
           ((&DAT_140039600)[(longlong)(int)param_2 >> 6] + 0x28 +
           (ulonglong)(param_2 & 0x3f) * 0x40);
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  if (psVar5 <= param_3) {
LAB_14001f7de:
    __security_check_cookie(local_30 ^ (ulonglong)auStackY_1470);
    return;
  }
  do {
    psVar4 = local_1430;
    do {
      if (psVar5 <= param_3) break;
      sVar1 = *param_3;
      param_3 = param_3 + 1;
      if (sVar1 == 10) {
        *(int *)(param_1 + 1) = *(int *)(param_1 + 1) + 2;
        *psVar4 = 0xd;
        psVar4 = psVar4 + 1;
      }
      *psVar4 = sVar1;
      psVar4 = psVar4 + 1;
    } while (psVar4 < local_1430 + 0x9ff);
    nNumberOfBytesToWrite = (int)((longlong)psVar4 - (longlong)local_1430 >> 1) * 2;
    BVar2 = WriteFile(hFile,local_1430,nNumberOfBytesToWrite,local_1440,(LPOVERLAPPED)0x0);
    if (BVar2 == 0) {
      DVar3 = GetLastError();
      *(DWORD *)param_1 = DVar3;
      goto LAB_14001f7de;
    }
    *(int *)((longlong)param_1 + 4) = *(int *)((longlong)param_1 + 4) + local_1440[0];
    if ((local_1440[0] < nNumberOfBytesToWrite) || (psVar5 <= param_3)) goto LAB_14001f7de;
  } while( true );
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

void FUN_14001f80c(undefined8 *param_1,uint param_2,short *param_3,uint param_4)

{
  short sVar1;
  HANDLE hFile;
  uint uVar2;
  BOOL BVar3;
  DWORD DVar4;
  short *psVar5;
  uint uVar6;
  ulonglong uVar7;
  short *psVar8;
  short *psVar9;
  bool bVar10;
  undefined auStackY_14a0 [32];
  DWORD local_1460 [4];
  short local_1450 [856];
  undefined local_da0 [3424];
  ulonglong local_40;
  undefined8 local_30;
  
  local_30 = 0x14001f828;
  local_40 = DAT_140038010 ^ (ulonglong)auStackY_14a0;
  psVar9 = (short *)((ulonglong)param_4 + (longlong)param_3);
  hFile = *(HANDLE *)
           ((&DAT_140039600)[(longlong)(int)param_2 >> 6] + 0x28 +
           (ulonglong)(param_2 & 0x3f) * 0x40);
  *param_1 = 0;
  bVar10 = param_3 < psVar9;
  *(undefined4 *)(param_1 + 1) = 0;
  psVar8 = param_3;
  do {
    if (!bVar10) {
LAB_14001f94d:
      __security_check_cookie(local_40 ^ (ulonglong)auStackY_14a0);
      return;
    }
    psVar5 = local_1450;
    do {
      if (psVar9 <= psVar8) break;
      sVar1 = *psVar8;
      psVar8 = psVar8 + 1;
      if (sVar1 == 10) {
        *psVar5 = 0xd;
        psVar5 = psVar5 + 1;
      }
      *psVar5 = sVar1;
      psVar5 = psVar5 + 1;
    } while (psVar5 < local_1450 + 0x354);
    uVar2 = __acrt_WideCharToMultiByte
                      (0xfde9,0,(char)local_1450,
                       (char)((longlong)psVar5 - (longlong)local_1450 >> 1),(char)local_da0,0x55,0,0
                      );
    if (uVar2 == 0) {
LAB_14001f945:
      DVar4 = GetLastError();
      *(DWORD *)param_1 = DVar4;
      goto LAB_14001f94d;
    }
    uVar7 = 0;
    if (uVar2 != 0) {
      do {
        BVar3 = WriteFile(hFile,local_da0 + uVar7,uVar2 - (int)uVar7,local_1460,(LPOVERLAPPED)0x0);
        if (BVar3 == 0) goto LAB_14001f945;
        uVar6 = (int)uVar7 + local_1460[0];
        uVar7 = (ulonglong)uVar6;
      } while (uVar6 < uVar2);
    }
    *(int *)((longlong)param_1 + 4) = (int)psVar8 - (int)param_3;
    bVar10 = psVar8 < psVar9;
  } while( true );
}



// Library Function - Single Match
//  __acrt_stdio_flush_and_write_narrow_nolock
// 
// Library: Visual Studio 2015 Release

ulonglong __acrt_stdio_flush_and_write_narrow_nolock(byte param_1,FILE *param_2)

{
  uint *puVar1;
  bool bVar2;
  int iVar3;
  ulong *puVar4;
  FILE *pFVar5;
  
  iVar3 = _fileno(param_2);
  if ((*(uint *)((longlong)&param_2->_base + 4) & 6) == 0) {
    puVar4 = __doserrno();
    *puVar4 = 9;
  }
  else if ((*(uint *)((longlong)&param_2->_base + 4) >> 0xc & 1) == 0) {
    if ((*(uint *)((longlong)&param_2->_base + 4) & 1) != 0) {
      *(undefined4 *)&param_2->_base = 0;
      if ((*(uint *)((longlong)&param_2->_base + 4) >> 3 & 1) == 0) goto LAB_14001f9af;
      param_2->_ptr = *(char **)&param_2->_cnt;
      LOCK();
      puVar1 = (uint *)((longlong)&param_2->_base + 4);
      *puVar1 = *puVar1 & 0xfffffffe;
    }
    LOCK();
    puVar1 = (uint *)((longlong)&param_2->_base + 4);
    *puVar1 = *puVar1 | 2;
    LOCK();
    puVar1 = (uint *)((longlong)&param_2->_base + 4);
    *puVar1 = *puVar1 & 0xfffffff7;
    *(undefined4 *)&param_2->_base = 0;
    if (((*(uint *)((longlong)&param_2->_base + 4) & 0x4c0) == 0) &&
       (((pFVar5 = (FILE *)__acrt_iob_func(1), param_2 != pFVar5 &&
         (pFVar5 = (FILE *)__acrt_iob_func(2), param_2 != pFVar5)) ||
        (iVar3 = _isatty(iVar3), iVar3 == 0)))) {
      __acrt_stdio_allocate_buffer_nolock(&param_2->_ptr);
    }
    bVar2 = FUN_14001fa64(param_1,param_2);
    if (bVar2) {
      return (ulonglong)param_1;
    }
  }
  else {
    puVar4 = __doserrno();
    *puVar4 = 0x22;
  }
LAB_14001f9af:
  LOCK();
  puVar1 = (uint *)((longlong)&param_2->_base + 4);
  *puVar1 = *puVar1 | 0x10;
  return 0xffffffff;
}



bool FUN_14001fa64(undefined param_1,FILE *param_2)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  __int64 _Var5;
  undefined *puVar6;
  uint uVar7;
  bool bVar8;
  undefined local_res8;
  
  local_res8 = param_1;
  uVar2 = _fileno(param_2);
  if ((*(uint *)((longlong)&param_2->_base + 4) & 0xc0) == 0) {
    iVar4 = FUN_14001f008(uVar2,(short *)&local_res8,1);
    bVar8 = iVar4 == 1;
  }
  else {
    uVar3 = 0;
    uVar7 = *(int *)&param_2->_ptr - param_2->_cnt;
    param_2->_ptr = (char *)((longlong)*(short **)&param_2->_cnt + 1);
    *(int *)&param_2->_base = param_2->_charbuf + -1;
    if ((int)uVar7 < 1) {
      if (uVar2 + 2 < 2) {
        puVar6 = &DAT_140038170;
      }
      else {
        puVar6 = (undefined *)
                 ((ulonglong)(uVar2 & 0x3f) * 0x40 + (&DAT_140039600)[(longlong)(int)uVar2 >> 6]);
      }
      if (((puVar6[0x38] & 0x20) != 0) && (_Var5 = thunk_FUN_140020844(uVar2,0,2), _Var5 == -1)) {
        LOCK();
        puVar1 = (uint *)((longlong)&param_2->_base + 4);
        *puVar1 = *puVar1 | 0x10;
        return true;
      }
    }
    else {
      uVar3 = FUN_14001f008(uVar2,*(short **)&param_2->_cnt,uVar7);
    }
    bVar8 = uVar3 == uVar7;
    **(undefined **)&param_2->_cnt = local_res8;
  }
  return bVar8;
}



void FUN_14001fb44(PVOID param_1,PVOID param_2)

{
  RtlUnwind(param_1,param_2,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



int FUN_14001fb70(uint param_1,LPWSTR param_2,uint param_3)

{
  int iVar1;
  ulong *puVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    puVar2 = __doserrno();
    *puVar2 = 0;
    puVar2 = __doserrno();
    *puVar2 = 9;
    return -1;
  }
  if ((-1 < (int)param_1) && (param_1 < DAT_140039a00)) {
    lVar3 = (ulonglong)(param_1 & 0x3f) * 0x40;
    if ((*(byte *)((&DAT_140039600)[(longlong)(int)param_1 >> 6] + 0x38 + lVar3) & 1) != 0) {
      if (param_3 < 0x80000000) {
        FID_conflict___acrt_lowio_lock_fh(param_1);
        iVar1 = -1;
        if ((*(byte *)((&DAT_140039600)[(longlong)(int)param_1 >> 6] + 0x38 + lVar3) & 1) == 0) {
          puVar2 = __doserrno();
          *puVar2 = 9;
          puVar2 = __doserrno();
          *puVar2 = 0;
        }
        else {
          iVar1 = FUN_14001fc8c(param_1,param_2,param_3);
        }
        FID_conflict___acrt_lowio_lock_fh(param_1);
        return iVar1;
      }
      puVar2 = __doserrno();
      *puVar2 = 0;
      puVar2 = __doserrno();
      *puVar2 = 0x16;
      goto LAB_14001fc68;
    }
  }
  puVar2 = __doserrno();
  *puVar2 = 0;
  puVar2 = __doserrno();
  *puVar2 = 9;
LAB_14001fc68:
  FUN_140011e58();
  return -1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_14001fc8c(uint param_1,LPWSTR param_2,uint param_3)

{
  WCHAR *pWVar1;
  byte *pbVar2;
  byte bVar3;
  char cVar4;
  char cVar5;
  int iVar6;
  BOOL BVar7;
  DWORD DVar8;
  ulong *puVar9;
  LPWSTR pWVar10;
  __int64 _Var11;
  WCHAR WVar12;
  longlong lVar13;
  int iVar14;
  ulonglong uVar15;
  longlong lVar16;
  uint uVar17;
  uint nNumberOfBytesToRead;
  LPWSTR pWVar18;
  LPWSTR pWVar19;
  uint local_res20 [2];
  DWORD local_68 [2];
  HANDLE local_60;
  longlong local_58;
  ulonglong local_50;
  LPWSTR local_48;
  
  if (param_1 == 0xfffffffe) {
    puVar9 = __doserrno();
    *puVar9 = 0;
    puVar9 = __doserrno();
    *puVar9 = 9;
    return -1;
  }
  pWVar10 = (LPWSTR)0x0;
  iVar14 = 0;
  if ((-1 < (int)param_1) && (param_1 < DAT_140039a00)) {
    lVar13 = (ulonglong)(param_1 & 0x3f) * 0x40;
    local_58 = (longlong)(int)param_1 >> 6;
    local_50 = 1;
    lVar16 = (&DAT_140039600)[local_58];
    bVar3 = *(byte *)(lVar16 + 0x38 + lVar13);
    if ((bVar3 & 1) != 0) {
      if (param_3 < 0x80000000) {
        if ((param_3 == 0) || ((bVar3 & 2) != 0)) {
          return 0;
        }
        if (param_2 != (LPWSTR)0x0) {
          cVar5 = *(char *)(lVar16 + 0x39 + lVar13);
          local_60 = *(HANDLE *)(lVar16 + 0x28 + lVar13);
          if (cVar5 == '\x01') {
            if ((~(byte)param_3 & 1) == 0) goto LAB_14001fd88;
            uVar17 = param_3 >> 1;
            if (uVar17 < 4) {
              uVar17 = 4;
            }
            pWVar10 = (LPWSTR)_malloc_base((ulonglong)uVar17);
            _free_base((LPVOID)0x0);
            _free_base((LPVOID)0x0);
            if (pWVar10 != (LPWSTR)0x0) {
              _Var11 = common_lseek_nolock___int64_(param_1,0,1);
              *(__int64 *)((&DAT_140039600)[local_58] + 0x30 + lVar13) = _Var11;
              lVar16 = (&DAT_140039600)[local_58];
              pWVar18 = pWVar10;
              goto LAB_14001fe3e;
            }
            puVar9 = __doserrno();
            *puVar9 = 0xc;
            puVar9 = __doserrno();
            *puVar9 = 8;
          }
          else {
            pWVar18 = param_2;
            uVar17 = param_3;
            if ((cVar5 == '\x02') && ((~(byte)param_3 & 1) == 0)) {
LAB_14001fd88:
              puVar9 = __doserrno();
              *puVar9 = 0;
              puVar9 = __doserrno();
              *puVar9 = 0x16;
              FUN_140011e58();
            }
            else {
LAB_14001fe3e:
              pWVar19 = pWVar18;
              nNumberOfBytesToRead = uVar17;
              if (((*(byte *)(lVar16 + 0x38 + lVar13) & 0x48) != 0) &&
                 ((cVar4 = *(char *)(lVar16 + 0x3a + lVar13), cVar4 != '\n' && (uVar17 != 0)))) {
                *(char *)pWVar18 = cVar4;
                nNumberOfBytesToRead = uVar17 - 1;
                pWVar19 = (LPWSTR)((longlong)pWVar18 + 1);
                iVar14 = 1;
                *(undefined *)((&DAT_140039600)[local_58] + 0x3a + lVar13) = 10;
                if ((cVar5 != '\0') &&
                   ((cVar4 = *(char *)((&DAT_140039600)[local_58] + 0x3b + lVar13), cVar4 != '\n' &&
                    (nNumberOfBytesToRead != 0)))) {
                  *(char *)pWVar19 = cVar4;
                  pWVar19 = pWVar18 + 1;
                  nNumberOfBytesToRead = uVar17 - 2;
                  *(undefined *)((&DAT_140039600)[local_58] + 0x3b + lVar13) = 10;
                  iVar14 = 2;
                  if ((cVar5 == '\x01') &&
                     ((cVar4 = *(char *)((&DAT_140039600)[local_58] + 0x3c + lVar13), cVar4 != '\n'
                      && (iVar14 = 2, nNumberOfBytesToRead != 0)))) {
                    *(char *)pWVar19 = cVar4;
                    iVar14 = 3;
                    pWVar19 = (LPWSTR)((longlong)pWVar18 + 3);
                    nNumberOfBytesToRead = uVar17 - 3;
                    *(undefined *)((&DAT_140039600)[local_58] + 0x3c + lVar13) = 10;
                  }
                }
              }
              local_48 = pWVar18;
              iVar6 = _isatty(param_1);
              if (((iVar6 == 0) || (-1 < *(char *)((&DAT_140039600)[local_58] + 0x38 + lVar13))) ||
                 (BVar7 = GetConsoleMode(local_60,local_68), BVar7 == 0)) {
                local_50 = local_50 & 0xffffffffffffff00;
LAB_14001ff69:
                BVar7 = ReadFile(local_60,pWVar19,nNumberOfBytesToRead,local_res20,(LPOVERLAPPED)0x0
                                );
                if ((BVar7 != 0) && (local_res20[0] <= param_3)) {
LAB_14001ffa4:
                  iVar14 = iVar14 + local_res20[0];
                  if (*(char *)((&DAT_140039600)[local_58] + 0x38 + lVar13) < '\0') {
                    uVar15 = (ulonglong)iVar14;
                    if (cVar5 == '\x02') {
                      if ((char)local_50 == '\0') {
                        iVar14 = FUN_140020444(param_1,local_48,uVar15 >> 1);
                      }
                      else {
                        pWVar18 = (LPWSTR)((longlong)local_48 + (uVar15 & 0xfffffffffffffffe));
                        pWVar1 = local_48;
                        for (pWVar19 = local_48; pWVar19 < pWVar18;
                            pWVar19 = (LPWSTR)((longlong)pWVar19 + lVar16)) {
                          WVar12 = *pWVar19;
                          if (WVar12 == L'\x1a') {
                            pbVar2 = (byte *)((&DAT_140039600)[local_58] + 0x38 + lVar13);
                            *pbVar2 = *pbVar2 | 2;
                            break;
                          }
                          if (((WVar12 == L'\r') && (pWVar19 + 1 < pWVar18)) &&
                             (pWVar19[1] == L'\n')) {
                            WVar12 = L'\n';
                            lVar16 = 4;
                          }
                          else {
                            lVar16 = 2;
                          }
                          *pWVar1 = WVar12;
                          pWVar1 = pWVar1 + 1;
                        }
                        iVar14 = (int)((longlong)pWVar1 - (longlong)local_48 >> 1) * 2;
                      }
                    }
                    else {
                      iVar14 = FUN_1400200e8(param_1,(byte *)pWVar19,uVar15,param_2,param_3 >> 1);
                    }
                  }
                  goto LAB_14001ff49;
                }
                DVar8 = GetLastError();
                if (DVar8 != 5) {
                  if (DVar8 == 0x6d) {
                    iVar14 = 0;
                    goto LAB_14001ff49;
                  }
                  goto LAB_14001ff3f;
                }
                puVar9 = __doserrno();
                *puVar9 = 9;
                puVar9 = __doserrno();
                *puVar9 = 5;
              }
              else {
                if (cVar5 != '\x02') goto LAB_14001ff69;
                BVar7 = ReadConsoleW(local_60,pWVar19,nNumberOfBytesToRead >> 1,local_res20,
                                     (PCONSOLE_READCONSOLE_CONTROL)0x0);
                if (BVar7 != 0) {
                  local_res20[0] = local_res20[0] * 2;
                  goto LAB_14001ffa4;
                }
                DVar8 = GetLastError();
LAB_14001ff3f:
                __acrt_errno_map_os_error(DVar8);
              }
            }
          }
          iVar14 = -1;
LAB_14001ff49:
          _free_base(pWVar10);
          return iVar14;
        }
      }
      puVar9 = __doserrno();
      *puVar9 = 0;
      puVar9 = __doserrno();
      *puVar9 = 0x16;
      goto LAB_1400200c7;
    }
  }
  puVar9 = __doserrno();
  *puVar9 = 0;
  puVar9 = __doserrno();
  *puVar9 = 9;
LAB_1400200c7:
  FUN_140011e58();
  return -1;
}



int FUN_1400200e8(uint param_1,byte *param_2,longlong param_3,LPWSTR param_4,int param_5)

{
  byte bVar1;
  longlong lVar2;
  int iVar3;
  DWORD DVar4;
  ulong *puVar5;
  byte *pbVar6;
  uint uVar7;
  ulonglong uVar8;
  int iVar9;
  byte *pbVar10;
  longlong lVar11;
  longlong lVar12;
  
  iVar3 = FUN_140020284(param_1,(char *)param_2,param_3);
  if (iVar3 == 0) {
    return 0;
  }
  lVar11 = (longlong)(int)param_1 >> 6;
  lVar12 = (ulonglong)(param_1 & 0x3f) * 0x40;
  lVar2 = (&DAT_140039600)[lVar11];
  if (*(char *)(lVar2 + 0x39 + lVar12) != '\0') {
    pbVar6 = param_2 + iVar3;
    if ((char)pbVar6[-1] < '\0') {
      uVar8 = 1;
      for (pbVar6 = pbVar6 + -1;
          ((uVar7 = (uint)uVar8, (&DAT_1400389d0)[*pbVar6] == '\0' && (uVar7 < 5)) &&
          (param_2 <= pbVar6)); pbVar6 = pbVar6 + -1) {
        uVar8 = (ulonglong)(uVar7 + 1);
      }
      if ((&DAT_1400389d0)[*pbVar6] == '\0') {
        puVar5 = __doserrno();
        *puVar5 = 0x2a;
        return -1;
      }
      if ((int)(char)(&DAT_1400389d0)[*pbVar6] + 1U == uVar7) {
        pbVar6 = pbVar6 + uVar8;
      }
      else if ((*(byte *)(lVar2 + 0x38 + lVar12) & 0x48) == 0) {
        common_lseek_nolock___int64_(param_1,(longlong)(int)-uVar7,1);
      }
      else {
        pbVar10 = pbVar6 + 1;
        *(byte *)(lVar2 + 0x3a + lVar12) = *pbVar6;
        if (1 < uVar7) {
          bVar1 = *pbVar10;
          pbVar10 = pbVar6 + 2;
          *(byte *)((&DAT_140039600)[lVar11] + 0x3b + lVar12) = bVar1;
        }
        if (uVar7 == 3) {
          bVar1 = *pbVar10;
          pbVar10 = pbVar10 + 1;
          *(byte *)((&DAT_140039600)[lVar11] + 0x3c + lVar12) = bVar1;
        }
        pbVar6 = pbVar10 + -uVar8;
      }
    }
    iVar9 = (int)pbVar6 - (int)param_2;
    iVar3 = __acrt_MultiByteToWideChar(0xfde9,0,(LPCSTR)param_2,iVar9,param_4,param_5);
    if (iVar3 == 0) {
      DVar4 = GetLastError();
      __acrt_errno_map_os_error(DVar4);
      return -1;
    }
    lVar2 = (&DAT_140039600)[lVar11];
    pbVar6 = (byte *)(lVar2 + 0x3d + lVar12);
    *pbVar6 = *pbVar6 & 0xfd;
    pbVar6 = (byte *)(lVar2 + 0x3d + lVar12);
    *pbVar6 = *pbVar6 | -(iVar3 != iVar9) & 2U;
    return iVar3 * 2;
  }
  return iVar3;
}



int FUN_140020284(uint param_1,char *param_2,longlong param_3)

{
  char *pcVar1;
  byte *pbVar2;
  char cVar3;
  byte bVar4;
  BOOL BVar5;
  char *pcVar6;
  char cVar7;
  longlong lVar8;
  HANDLE hFile;
  char *pcVar9;
  longlong lVar10;
  char *pcVar11;
  longlong lVar12;
  char local_res8 [8];
  DWORD local_res10 [2];
  HANDLE local_res18;
  
  lVar12 = (longlong)(int)param_1 >> 6;
  lVar10 = (ulonglong)(param_1 & 0x3f) * 0x40;
  lVar8 = (&DAT_140039600)[lVar12];
  hFile = *(HANDLE *)(lVar10 + 0x28 + lVar8);
  if ((param_3 == 0) || (*param_2 != '\n')) {
    pbVar2 = (byte *)(lVar10 + 0x38 + lVar8);
    *pbVar2 = *pbVar2 & 0xfb;
  }
  else {
    pbVar2 = (byte *)(lVar10 + 0x38 + lVar8);
    *pbVar2 = *pbVar2 | 4;
  }
  pcVar1 = param_2 + param_3;
  pcVar9 = param_2;
  pcVar11 = param_2;
  local_res18 = hFile;
  if (param_2 < pcVar1) {
    do {
      cVar7 = *pcVar11;
      if (cVar7 == '\x1a') {
        bVar4 = *(byte *)(lVar10 + 0x38 + (&DAT_140039600)[lVar12]);
        if ((bVar4 & 0x40) == 0) {
          *(byte *)(lVar10 + 0x38 + (&DAT_140039600)[lVar12]) = bVar4 | 2;
        }
        else {
          *pcVar9 = '\x1a';
          pcVar9 = pcVar9 + 1;
        }
        break;
      }
      pcVar6 = pcVar11 + 1;
      if (cVar7 == '\r') {
        if (pcVar6 < pcVar1) {
          if (*pcVar6 == '\n') {
            cVar7 = '\n';
          }
          cVar3 = *pcVar6;
          *pcVar9 = cVar7;
          pcVar6 = pcVar11 + (ulonglong)(cVar3 == '\n') + 1;
        }
        else {
          BVar5 = ReadFile(hFile,local_res8,1,local_res10,(LPOVERLAPPED)0x0);
          if ((BVar5 == 0) || (local_res10[0] == 0)) {
LAB_1400203f2:
            *pcVar9 = '\r';
          }
          else {
            lVar8 = (ulonglong)(param_1 & 0x3f) * 0x40;
            if ((*(byte *)((&DAT_140039600)[lVar12] + 0x38 + lVar8) & 0x48) == 0) {
              if ((local_res8[0] != '\n') || (pcVar9 != param_2)) {
                common_lseek_nolock___int64_(param_1,-1,1);
                hFile = local_res18;
                if (local_res8[0] == '\n') goto LAB_140020400;
                goto LAB_1400203f2;
              }
            }
            else if (local_res8[0] != '\n') {
              *pcVar9 = '\r';
              *(char *)((&DAT_140039600)[lVar12] + 0x3a + lVar8) = local_res8[0];
              goto LAB_1400203f5;
            }
            *pcVar9 = '\n';
          }
        }
LAB_1400203f5:
        pcVar9 = pcVar9 + 1;
        hFile = local_res18;
      }
      else {
        *pcVar9 = cVar7;
        pcVar9 = pcVar9 + 1;
      }
LAB_140020400:
      pcVar11 = pcVar6;
    } while (pcVar6 < pcVar1);
  }
  return (int)pcVar9 - (int)param_2;
}



int FUN_140020444(uint param_1,short *param_2,longlong param_3)

{
  short *psVar1;
  longlong lVar2;
  byte *pbVar3;
  undefined *puVar4;
  byte bVar5;
  short sVar6;
  BOOL BVar7;
  short sVar8;
  short *psVar9;
  short *psVar10;
  longlong lVar11;
  longlong lVar12;
  longlong lVar13;
  HANDLE pvVar14;
  short *psVar15;
  short *psVar16;
  longlong lVar17;
  short local_res8 [4];
  short local_res10;
  DWORD local_res18 [2];
  HANDLE local_res20;
  
  lVar17 = (longlong)(int)param_1 >> 6;
  lVar11 = (ulonglong)(param_1 & 0x3f) * 0x40;
  lVar13 = (&DAT_140039600)[lVar17];
  pvVar14 = *(HANDLE *)(lVar11 + 0x28 + lVar13);
  if ((param_3 == 0) || (*param_2 != 10)) {
    pbVar3 = (byte *)(lVar11 + 0x38 + lVar13);
    *pbVar3 = *pbVar3 & 0xfb;
  }
  else {
    pbVar3 = (byte *)(lVar11 + 0x38 + lVar13);
    *pbVar3 = *pbVar3 | 4;
  }
  psVar1 = param_2 + param_3;
  psVar9 = param_2;
  psVar10 = param_2;
  psVar15 = param_2;
  local_res20 = pvVar14;
  if (param_2 < psVar1) {
    do {
      sVar8 = *psVar15;
      psVar10 = psVar9;
      if (sVar8 == 0x1a) {
        bVar5 = *(byte *)(lVar11 + 0x38 + (&DAT_140039600)[lVar17]);
        if ((bVar5 & 0x40) == 0) {
          *(byte *)(lVar11 + 0x38 + (&DAT_140039600)[lVar17]) = bVar5 | 2;
        }
        else {
          *psVar9 = 0x1a;
          psVar10 = psVar9 + 1;
        }
        break;
      }
      psVar16 = psVar15 + 1;
      if (sVar8 == 0xd) {
        if (psVar16 < psVar1) {
          sVar6 = *psVar16;
          if (sVar6 == 10) {
            sVar8 = 10;
          }
          *psVar9 = sVar8;
          lVar13 = 4;
          if (sVar6 != 10) {
            lVar13 = 2;
          }
          psVar16 = (short *)((longlong)psVar15 + lVar13);
          psVar10 = psVar9 + 1;
        }
        else {
          BVar7 = ReadFile(pvVar14,local_res8,2,local_res18,(LPOVERLAPPED)0x0);
          pvVar14 = local_res20;
          if ((BVar7 == 0) || (local_res18[0] == 0)) {
            *psVar9 = 0xd;
            psVar10 = psVar9 + 1;
          }
          else {
            lVar13 = (ulonglong)(param_1 & 0x3f) * 0x40;
            if ((*(byte *)(lVar13 + 0x38 + (&DAT_140039600)[lVar17]) & 0x48) == 0) {
              if ((local_res8[0] == 10) && (psVar9 == param_2)) {
                *psVar9 = 10;
                psVar10 = psVar9 + 1;
              }
              else {
                common_lseek_nolock___int64_(param_1,-2,1);
                pvVar14 = local_res20;
                if (local_res8[0] != 10) {
                  *psVar9 = 0xd;
                  psVar10 = psVar9 + 1;
                }
              }
            }
            else {
              psVar10 = psVar9 + 1;
              if (local_res8[0] == 10) {
                *psVar9 = 10;
              }
              else {
                local_res10 = local_res8[0];
                *psVar9 = 0xd;
                lVar12 = 0;
                do {
                  puVar4 = (undefined *)((longlong)&local_res10 + lVar12);
                  lVar2 = lVar13 + lVar12;
                  lVar12 = lVar12 + 1;
                  *(undefined *)(lVar2 + 0x3a + (&DAT_140039600)[lVar17]) = *puVar4;
                } while (lVar12 < 2);
                *(undefined *)(lVar13 + 0x3c + (&DAT_140039600)[lVar17]) = 10;
              }
            }
          }
        }
      }
      else {
        *psVar9 = sVar8;
        psVar10 = psVar9 + 1;
      }
      psVar9 = psVar10;
      psVar15 = psVar16;
    } while (psVar16 < psVar1);
  }
  return (int)((longlong)psVar10 - (longlong)param_2 >> 1) * 2;
}



ulonglong FUN_1400206c8(FILE *param_1)

{
  uint *puVar1;
  byte bVar2;
  LPWSTR pWVar3;
  uint uVar4;
  int iVar5;
  ulong *puVar6;
  undefined *puVar7;
  
  if (param_1 == (FILE *)0x0) {
    puVar6 = __doserrno();
    *puVar6 = 0x16;
    FUN_140011e58();
  }
  else if (((*(uint *)((longlong)&param_1->_base + 4) >> 0xd & 1) != 0) &&
          ((*(uint *)((longlong)&param_1->_base + 4) >> 0xc & 1) == 0)) {
    if ((*(uint *)((longlong)&param_1->_base + 4) >> 1 & 1) == 0) {
      LOCK();
      puVar1 = (uint *)((longlong)&param_1->_base + 4);
      *puVar1 = *puVar1 | 1;
      if ((*(uint *)((longlong)&param_1->_base + 4) & 0x4c0) == 0) {
        __acrt_stdio_allocate_buffer_nolock(&param_1->_ptr);
      }
      pWVar3 = *(LPWSTR *)&param_1->_cnt;
      param_1->_ptr = (char *)pWVar3;
      uVar4 = _fileno(param_1);
      iVar5 = FUN_14001fb70(uVar4,pWVar3,param_1->_charbuf);
      *(int *)&param_1->_base = iVar5;
      if (1 < iVar5 + 1U) {
        if ((*(uint *)((longlong)&param_1->_base + 4) & 6) == 0) {
          iVar5 = _fileno(param_1);
          if ((iVar5 == -1) || (iVar5 = _fileno(param_1), iVar5 == -2)) {
            puVar7 = &DAT_140038170;
          }
          else {
            iVar5 = _fileno(param_1);
            uVar4 = _fileno(param_1);
            puVar7 = (undefined *)
                     ((&DAT_140039600)[(longlong)iVar5 >> 6] + (ulonglong)(uVar4 & 0x3f) * 0x40);
          }
          if ((puVar7[0x38] & 0x82) == 0x82) {
            LOCK();
            puVar1 = (uint *)((longlong)&param_1->_base + 4);
            *puVar1 = *puVar1 | 0x20;
          }
        }
        if (((param_1->_charbuf == 0x200) &&
            ((*(uint *)((longlong)&param_1->_base + 4) >> 6 & 1) != 0)) &&
           ((*(uint *)((longlong)&param_1->_base + 4) >> 8 & 1) == 0)) {
          param_1->_charbuf = 0x1000;
        }
        *(int *)&param_1->_base = *(int *)&param_1->_base + -1;
        bVar2 = *param_1->_ptr;
        param_1->_ptr = param_1->_ptr + 1;
        return (ulonglong)bVar2;
      }
      LOCK();
      puVar1 = (uint *)((longlong)&param_1->_base + 4);
      *puVar1 = *puVar1 | (-(uint)(iVar5 != 0) & 8) + 8;
      *(undefined4 *)&param_1->_base = 0;
    }
    else {
      LOCK();
      puVar1 = (uint *)((longlong)&param_1->_base + 4);
      *puVar1 = *puVar1 | 0x10;
    }
  }
  return 0xffffffff;
}



__int64 thunk_FUN_140020844(uint param_1,__int64 param_2,int param_3)

{
  ulong *puVar1;
  longlong lVar2;
  __int64 _Var3;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    puVar1 = __doserrno();
    *puVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_140039a00)) {
      lVar2 = (ulonglong)(param_1 & 0x3f) * 0x40;
      if ((*(byte *)(lVar2 + 0x38 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]) & 1) != 0) {
        FID_conflict___acrt_lowio_lock_fh(param_1);
        _Var3 = -1;
        if ((*(byte *)(lVar2 + 0x38 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]) & 1) == 0) {
          puVar1 = __doserrno();
          *puVar1 = 9;
          puVar1 = __doserrno();
          *puVar1 = 0;
        }
        else {
          _Var3 = common_lseek_nolock___int64_(param_1,param_2,param_3);
        }
        FID_conflict___acrt_lowio_lock_fh(param_1);
        return _Var3;
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    puVar1 = __doserrno();
    *puVar1 = 9;
    FUN_140011e58();
  }
  return -1;
}



__int64 __cdecl common_lseek_nolock___int64_(int param_1,__int64 param_2,int param_3)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  ulong *puVar4;
  LARGE_INTEGER LStackX_20;
  
  hFile = (HANDLE)_get_osfhandle(param_1);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    puVar4 = __doserrno();
    *puVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,(LARGE_INTEGER)param_2,&LStackX_20,param_3);
    if (BVar2 == 0) {
      DVar3 = GetLastError();
      __acrt_errno_map_os_error(DVar3);
    }
    else if (LStackX_20.QuadPart != -1) {
      pbVar1 = (byte *)((&DAT_140039600)[(longlong)param_1 >> 6] + 0x38 +
                       (ulonglong)(param_1 & 0x3f) * 0x40);
      *pbVar1 = *pbVar1 & 0xfd;
      return (__int64)LStackX_20.s;
    }
  }
  return -1;
}



__int64 FUN_140020844(uint param_1,__int64 param_2,int param_3)

{
  ulong *puVar1;
  longlong lVar2;
  __int64 _Var3;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    puVar1 = __doserrno();
    *puVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_140039a00)) {
      lVar2 = (ulonglong)(param_1 & 0x3f) * 0x40;
      if ((*(byte *)(lVar2 + 0x38 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]) & 1) != 0) {
        FID_conflict___acrt_lowio_lock_fh(param_1);
        _Var3 = -1;
        if ((*(byte *)(lVar2 + 0x38 + (&DAT_140039600)[(longlong)(int)param_1 >> 6]) & 1) == 0) {
          puVar1 = __doserrno();
          *puVar1 = 9;
          puVar1 = __doserrno();
          *puVar1 = 0;
        }
        else {
          _Var3 = common_lseek_nolock___int64_(param_1,param_2,param_3);
        }
        FID_conflict___acrt_lowio_lock_fh(param_1);
        return _Var3;
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    puVar1 = __doserrno();
    *puVar1 = 9;
    FUN_140011e58();
  }
  return -1;
}



// Library Function - Single Match
//  __int64 __cdecl common_lseek_nolock<__int64>(int,__int64,int)
// 
// Library: Visual Studio 2015 Release

__int64 __cdecl common_lseek_nolock___int64_(int param_1,__int64 param_2,int param_3)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  ulong *puVar4;
  LARGE_INTEGER local_res20;
  
  hFile = (HANDLE)_get_osfhandle(param_1);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    puVar4 = __doserrno();
    *puVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,(LARGE_INTEGER)param_2,&local_res20,param_3);
    if (BVar2 == 0) {
      DVar3 = GetLastError();
      __acrt_errno_map_os_error(DVar3);
    }
    else if (local_res20.QuadPart != -1) {
      pbVar1 = (byte *)((&DAT_140039600)[(longlong)param_1 >> 6] + 0x38 +
                       (ulonglong)(param_1 & 0x3f) * 0x40);
      *pbVar1 = *pbVar1 & 0xfd;
      return (__int64)local_res20.s;
    }
  }
  return -1;
}



ushort FUN_1400209d0(WCHAR param_1,ushort param_2)

{
  BOOL BVar1;
  ushort local_res8 [4];
  WCHAR local_res18 [8];
  
  if (param_1 == L'\xffff') {
LAB_1400209e7:
    local_res8[0] = 0;
  }
  else {
    if ((ushort)param_1 < 0x100) {
      local_res8[0] = *(ushort *)(PTR_DAT_140038860 + (ulonglong)(ushort)param_1 * 2);
    }
    else {
      local_res8[0] = 0;
      local_res18[0] = param_1;
      BVar1 = GetStringTypeW(1,local_res18,1,local_res8);
      if (BVar1 == 0) goto LAB_1400209e7;
    }
    local_res8[0] = local_res8[0] & param_2;
  }
  return local_res8[0];
}



longlong FUN_140020a40(WCHAR *param_1,__uint64 param_2,WCHAR *param_3,uint *param_4,
                      __lc_time_data *param_5,__crt_locale_pointers *param_6)

{
  bool bVar1;
  ulong *puVar2;
  undefined8 uVar3;
  WCHAR WVar4;
  longlong lVar5;
  WCHAR *pWVar6;
  WCHAR *pWVar7;
  __uint64 local_res8;
  WCHAR *local_58;
  longlong local_50;
  localeinfo_struct local_48;
  char local_38;
  
  lVar5 = 0;
  if (((param_1 == (WCHAR *)0x0) || (param_2 == 0)) || (*param_1 = L'\0', param_3 == (WCHAR *)0x0))
  {
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
    return 0;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_50,param_6);
  if (param_5 == (__lc_time_data *)0x0) {
    param_5 = (local_48.locinfo)->lc_time_curr;
  }
  bVar1 = false;
  local_res8 = param_2;
  local_58 = param_1;
  if (param_2 != 0) {
    do {
      WVar4 = *param_3;
      if (WVar4 == L'\0') break;
      if (WVar4 == L'%') {
        if (param_4 == (uint *)0x0) goto LAB_140020bab;
        pWVar6 = param_3 + 1;
        WVar4 = *pWVar6;
        if (WVar4 == L'#') {
          WVar4 = param_3[2];
        }
        pWVar7 = pWVar6;
        if (*pWVar6 != L'#') {
          pWVar7 = param_3;
        }
        param_3 = pWVar7 + 1;
        if ((WVar4 == L'E') || (WVar4 == L'O')) {
          param_3 = pWVar7 + 2;
          WVar4 = *param_3;
        }
        uVar3 = FUN_140020e24(&local_48,WVar4,param_4,&local_58,&local_res8,param_5->wday_abbr,
                              *pWVar6 == L'#');
        if ((char)uVar3 == '\0') {
          if (local_res8 != 0) {
            bVar1 = true;
          }
          goto LAB_140020b90;
        }
      }
      else {
        *local_58 = WVar4;
        local_58 = local_58 + 1;
        local_res8 = local_res8 - 1;
      }
      param_3 = param_3 + 1;
    } while (local_res8 != 0);
    if (local_res8 != 0) {
      *local_58 = L'\0';
      lVar5 = param_2 - local_res8;
      goto LAB_140020bbe;
    }
  }
LAB_140020b90:
  *param_1 = L'\0';
  if ((bVar1) || (local_res8 != 0)) {
LAB_140020bab:
    puVar2 = __doserrno();
    *puVar2 = 0x16;
    FUN_140011e58();
  }
  else {
    puVar2 = __doserrno();
    *puVar2 = 0x22;
  }
LAB_140020bbe:
  if (local_38 != '\0') {
    *(uint *)(local_50 + 0x3a8) = *(uint *)(local_50 + 0x3a8) & 0xfffffffd;
  }
  return lVar5;
}



// Library Function - Single Match
//  void __cdecl store_number(int,int,wchar_t * __ptr64 * __ptr64 const,unsigned __int64 * __ptr64
// const,wchar_t)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl
store_number(int param_1,int param_2,wchar_t **param_3,__uint64 *param_4,wchar_t param_5)

{
  __uint64 _Var1;
  short sVar2;
  short *psVar3;
  longlong lVar4;
  int iVar5;
  short *psVar6;
  int iVar7;
  bool bVar8;
  undefined in_stack_00000029;
  
  if (_param_5 == 0) {
    psVar3 = (short *)*param_3;
    if (1 < *param_4) {
      do {
        psVar6 = psVar3;
        iVar7 = param_1 / 10;
        *psVar6 = (short)param_1 + (short)iVar7 * -10 + 0x30;
        _Var1 = *param_4;
        *param_4 = _Var1 - 1;
        if (iVar7 < 1) break;
        psVar3 = psVar6 + 1;
        param_1 = iVar7;
      } while (1 < _Var1 - 1);
      psVar3 = (short *)*param_3;
      *param_3 = (wchar_t *)(psVar6 + 1);
      for (; psVar3 < psVar6; psVar3 = psVar3 + 1) {
        sVar2 = *psVar6;
        *psVar6 = *psVar3;
        psVar6 = psVar6 + -1;
        *psVar3 = sVar2;
      }
      return;
    }
    *param_3 = (wchar_t *)((longlong)*param_3 + -*param_4 * 2);
  }
  else if ((ulonglong)(longlong)param_2 < *param_4) {
    iVar7 = 0;
    if (param_2 != 0) {
      lVar4 = (longlong)(param_2 + -1) * 2;
      iVar5 = param_2 + -1;
      iVar7 = 0;
      do {
        sVar2 = _param_5;
        if (param_1 != 0) {
          sVar2 = (short)param_1 + (short)(param_1 / 10) * -10 + 0x30;
        }
        *(short *)(*param_3 + lVar4) = sVar2;
        iVar7 = iVar7 + 1;
        lVar4 = lVar4 + -2;
        bVar8 = iVar5 != 0;
        param_1 = param_1 / 10;
        iVar5 = iVar5 + -1;
      } while (bVar8);
    }
    *param_3 = *param_3 + (longlong)iVar7 * 2;
    *param_4 = *param_4 - (longlong)iVar7;
    return;
  }
  *param_4 = 0;
  return;
}



// Library Function - Single Match
//  int __cdecl compute_iso_week_internal(int,int,int)
// 
// Library: Visual Studio 2015 Release

int __cdecl compute_iso_week_internal(int param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar2 = ((param_3 - (param_2 + 6) % 7) + 7) / 7;
  bVar1 = __crt_time_is_leap_year_int_(param_1);
  iVar5 = param_3 - (uint)bVar1;
  iVar4 = ((param_2 - param_3) + 0x173) % 7;
  iVar3 = (int)(bVar1 + 0x16d + iVar4) % 7;
  if ((((iVar5 < 0x16c) || (iVar3 != 2)) && ((iVar5 < 0x16b || (iVar3 != 3)))) &&
     ((iVar5 < 0x16a || (iVar3 != 4)))) {
    if (iVar4 - 2U < 3) {
      iVar2 = iVar2 + 1;
    }
  }
  else {
    iVar2 = -1;
  }
  return iVar2;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

undefined8
FUN_140020e24(_locale_t param_1,ushort param_2,uint *param_3,WCHAR **param_4,__uint64 *param_5,
             undefined **param_6,byte param_7)

{
  WCHAR WVar1;
  __uint64 _Var2;
  code *pcVar3;
  wchar_t wVar4;
  char cVar5;
  int iVar6;
  uint uVar7;
  errno_t eVar8;
  undefined **in_RAX;
  undefined8 uVar9;
  ulong *puVar10;
  undefined **extraout_RAX;
  longlong lVar11;
  uint uVar12;
  uint uVar13;
  ushort uVar14;
  short *psVar15;
  WCHAR *pWVar16;
  bool bVar17;
  bool bVar18;
  uint local_res10 [2];
  uint local_28 [2];
  ulonglong local_20;
  
  if (0x5a < param_2) {
LAB_140020e55:
    if (0x6e < param_2) goto LAB_1400212d2;
    if (param_2 == 0x6e) {
      _Var2 = *param_5;
      param_6 = in_RAX;
      for (psVar15 = &DAT_14003178c; (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
        param_6 = (undefined **)*param_4;
        *(short *)param_6 = *psVar15;
        *param_4 = *param_4 + 1;
        *param_5 = *param_5 - 1;
        _Var2 = *param_5;
      }
      goto LAB_14002129b;
    }
    if (param_2 == 0x61) {
      if (param_3[6] < 7) {
        _Var2 = *param_5;
        for (psVar15 = (short *)param_6[(longlong)(int)param_3[6] + 0x2c];
            (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
          param_6 = (undefined **)*param_4;
          *(short *)param_6 = *psVar15;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        goto LAB_14002129b;
      }
      goto LAB_14002123f;
    }
    if (param_2 == 0x62) {
      if (param_3[4] < 0xc) {
        _Var2 = *param_5;
        for (psVar15 = (short *)param_6[(longlong)(int)param_3[4] + 0x3a];
            (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
          param_6 = (undefined **)*param_4;
          *(short *)param_6 = *psVar15;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        goto LAB_14002129b;
      }
      goto LAB_14002123f;
    }
    if (param_2 != 99) {
      if (param_2 == 100) {
        uVar12 = param_3[3];
        bVar17 = uVar12 - 1 < 0x1e;
        bVar18 = uVar12 - 1 == 0x1e;
        goto LAB_140020f91;
      }
      if (param_2 == 0x65) {
        uVar12 = param_3[3];
        if (0x1e < uVar12 - 1) goto LAB_14002123f;
        wVar4 = (wchar_t)((param_7 ^ 1) << 5);
        goto LAB_14002196b;
      }
      if (param_2 != 0x67) {
        if (param_2 == 0x68) goto code_r0x000140020e9b;
        if (param_2 == 0x6a) {
          if (0x16d < param_3[7]) goto LAB_14002123f;
          wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
          uVar12 = param_3[7] + 1;
          iVar6 = 3;
          goto LAB_140021970;
        }
        if (param_2 != 0x6d) goto LAB_14002124f;
        if (0xb < param_3[4]) goto LAB_14002123f;
        uVar12 = param_3[4] + 1;
        goto LAB_140020fa6;
      }
      uVar12 = param_3[5];
      local_res10[0] = uVar12;
      if (9999 < uVar12 + 0x76c) goto LAB_14002123f;
      iVar6 = compute_iso_week_internal(uVar12,param_3[6],param_3[7]);
      if (iVar6 == 0) {
        uVar12 = uVar12 - 1;
      }
      else if (iVar6 < 1) {
        uVar12 = uVar12 + 1;
      }
      wVar4 = (wchar_t)0x30;
      uVar12 = (int)(uVar12 + 0x76c) % 100;
      goto LAB_14002196b;
    }
    if ((param_6 != &PTR_DAT_140029ac0) || (param_7 != 0)) {
      cVar5 = FUN_140021db8(param_1,(uint)param_7,(WORD *)param_3,param_4,(longlong *)param_5,
                            (longlong)param_6);
      if (cVar5 != '\0') {
        _Var2 = *param_5;
        for (pWVar16 = L" "; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
          **param_4 = *pWVar16;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        uVar12 = 2;
        goto LAB_1400211e6;
      }
      goto LAB_140020ff3;
    }
    uVar9 = FUN_140020e24(param_1,0x61,param_3,param_4,param_5,&PTR_DAT_140029ac0,0);
    if ((char)uVar9 == '\0') goto LAB_140020ff3;
    _Var2 = *param_5;
    for (pWVar16 = L" "; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
      **param_4 = *pWVar16;
      *param_4 = *param_4 + 1;
      *param_5 = *param_5 - 1;
      _Var2 = *param_5;
    }
    uVar9 = FUN_140020e24(param_1,0x62,param_3,param_4,param_5,&PTR_DAT_140029ac0,0);
    if ((char)uVar9 == '\0') goto LAB_140020ff3;
    _Var2 = *param_5;
    for (pWVar16 = L" "; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
      **param_4 = *pWVar16;
      *param_4 = *param_4 + 1;
      *param_5 = *param_5 - 1;
      _Var2 = *param_5;
    }
    uVar9 = FUN_140020e24(param_1,0x65,param_3,param_4,param_5,&PTR_DAT_140029ac0,0);
    if ((char)uVar9 == '\0') goto LAB_140020ff3;
    _Var2 = *param_5;
    for (pWVar16 = L" "; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
      **param_4 = *pWVar16;
      *param_4 = *param_4 + 1;
      *param_5 = *param_5 - 1;
      _Var2 = *param_5;
    }
    uVar9 = FUN_140020e24(param_1,0x54,param_3,param_4,param_5,&PTR_DAT_140029ac0,0);
    if ((char)uVar9 == '\0') goto LAB_140020ff3;
    if (*param_5 != 0) {
      pWVar16 = L" ";
      do {
        WVar1 = *pWVar16;
        if (WVar1 == L'\0') break;
        pWVar16 = pWVar16 + 1;
        **param_4 = WVar1;
        *param_4 = *param_4 + 1;
        *param_5 = *param_5 - 1;
      } while (*param_5 != 0);
    }
    uVar14 = 0x59;
    param_7 = 0;
    goto LAB_140021163;
  }
  if (param_2 == 0x5a) {
    __tzset();
    local_20 = 0;
    lVar11 = FUN_14001d290();
    eVar8 = _mbstowcs_s_l(&local_20,*param_4,*param_5,
                          *(char **)(lVar11 + (ulonglong)(-(uint)(param_3[8] != 0) & 8)),
                          0xffffffffffffffff,param_1);
    if ((eVar8 == 0x16) || (eVar8 == 0x22)) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      uVar9 = (*pcVar3)();
      return uVar9;
    }
    if (eVar8 == 0x50) {
      param_6 = (undefined **)(*param_5 * 2);
      *param_4 = *param_4 + *param_5;
      *param_5 = 0;
    }
    else {
      *param_5 = *param_5 + (1 - local_20);
      param_6 = (undefined **)(local_20 * 2 + -2);
      *param_4 = *param_4 + (local_20 - 1);
    }
    goto LAB_14002129b;
  }
  if (0x4d < param_2) {
    if (param_2 == 0x52) {
      uVar9 = FUN_140020e24(param_1,0x48,param_3,param_4,param_5,param_6,param_7);
      if ((char)uVar9 != '\0') {
        _Var2 = *param_5;
        for (pWVar16 = L":"; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
          **param_4 = *pWVar16;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        uVar14 = 0x4d;
        goto LAB_140021163;
      }
    }
    else {
      if (param_2 == 0x53) {
        uVar12 = *param_3;
        bVar17 = uVar12 < 0x3c;
        bVar18 = uVar12 == 0x3c;
        goto LAB_140021a63;
      }
      if (param_2 != 0x54) {
        if (param_2 != 0x55) {
          if (param_2 == 0x56) {
            uVar12 = param_3[6];
            local_28[0] = param_3[5];
            local_20 = local_20 & 0xffffffff00000000 | (ulonglong)param_3[7];
            local_res10[0] = uVar12;
            uVar7 = compute_iso_week_internal(local_28[0],uVar12,param_3[7]);
            uVar13 = local_28[0];
            if (uVar7 == 0) {
              bVar17 = __crt_time_is_leap_year_int_(local_28[0] - 1);
              uVar12 = compute_iso_week_internal
                                 (uVar13 - 1,(uVar12 - (int)local_20) + 7,bVar17 + 0x16d);
            }
            else {
              uVar12 = 1;
              if (0 < (int)uVar7) {
                uVar12 = uVar7;
              }
            }
            wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
            goto LAB_14002196b;
          }
          if (param_2 != 0x57) {
            if (param_2 == 0x58) {
              uVar12 = 2;
              goto LAB_1400211e6;
            }
            if (param_2 != 0x59) goto LAB_14002124f;
            uVar12 = param_3[5] + 0x76c;
            if (uVar12 < 10000) {
              wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
              goto LAB_140021780;
            }
            goto LAB_14002123f;
          }
        }
        uVar13 = param_3[6];
        if (uVar13 < 7) {
          uVar12 = 0;
          if (param_2 == 0x57) {
            if (uVar13 == 0) {
              uVar13 = 6;
            }
            else {
              uVar13 = uVar13 - 1;
            }
          }
          uVar7 = param_3[7];
          if (uVar7 < 0x16e) {
            if (((int)uVar13 <= (int)uVar7) &&
               (uVar12 = (int)uVar7 / 7, (int)uVar13 <= (int)uVar7 % 7)) {
              uVar12 = uVar12 + 1;
            }
            wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
            goto LAB_14002196b;
          }
        }
        goto LAB_14002123f;
      }
      uVar9 = FUN_140020e24(param_1,0x48,param_3,param_4,param_5,param_6,param_7);
      if ((char)uVar9 != '\0') {
        _Var2 = *param_5;
        for (pWVar16 = L":"; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
          **param_4 = *pWVar16;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        uVar9 = FUN_140020e24(param_1,0x4d,param_3,param_4,param_5,param_6,param_7);
        if ((char)uVar9 != '\0') {
          if (*param_5 != 0) {
            pWVar16 = L":";
            do {
              WVar1 = *pWVar16;
              if (WVar1 == L'\0') break;
              pWVar16 = pWVar16 + 1;
              **param_4 = WVar1;
              *param_4 = *param_4 + 1;
              *param_5 = *param_5 - 1;
            } while (*param_5 != 0);
          }
          uVar14 = 0x53;
          goto LAB_140021163;
        }
      }
    }
    goto LAB_140020ff3;
  }
  if (param_2 == 0x4d) {
    uVar12 = param_3[1];
    bVar17 = uVar12 < 0x3b;
    bVar18 = uVar12 == 0x3b;
LAB_140021a63:
    if (!bVar17 && !bVar18) goto LAB_14002123f;
LAB_140020fa6:
    wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
LAB_14002196b:
    iVar6 = 2;
    goto LAB_140021970;
  }
  if (param_2 == 0x25) {
    _Var2 = *param_5;
    param_6 = in_RAX;
    for (psVar15 = &DAT_140031784; (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
      param_6 = (undefined **)*param_4;
      *(short *)param_6 = *psVar15;
      *param_4 = *param_4 + 1;
      *param_5 = *param_5 - 1;
      _Var2 = *param_5;
    }
    goto LAB_14002129b;
  }
  if (param_2 == 0x41) {
    if (param_3[6] < 7) {
      _Var2 = *param_5;
      for (psVar15 = (short *)param_6[(longlong)(int)param_3[6] + 0x33];
          (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
        param_6 = (undefined **)*param_4;
        *(short *)param_6 = *psVar15;
        *param_4 = *param_4 + 1;
        *param_5 = *param_5 - 1;
        _Var2 = *param_5;
      }
      goto LAB_14002129b;
    }
  }
  else if (param_2 == 0x42) {
    if (param_3[4] < 0xc) {
      _Var2 = *param_5;
      for (psVar15 = (short *)param_6[(longlong)(int)param_3[4] + 0x46];
          (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
        param_6 = (undefined **)*param_4;
        *(short *)param_6 = *psVar15;
        *param_4 = *param_4 + 1;
        *param_5 = *param_5 - 1;
        _Var2 = *param_5;
      }
      goto LAB_14002129b;
    }
  }
  else {
    if (param_2 != 0x43) {
      if (param_2 == 0x44) {
        uVar9 = FUN_140020e24(param_1,0x6d,param_3,param_4,param_5,param_6,param_7);
        if ((char)uVar9 != '\0') {
          _Var2 = *param_5;
          for (pWVar16 = L"/"; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
            **param_4 = *pWVar16;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 - 1;
            _Var2 = *param_5;
          }
          uVar9 = FUN_140020e24(param_1,100,param_3,param_4,param_5,param_6,param_7);
          if ((char)uVar9 != '\0') {
            if (*param_5 != 0) {
              pWVar16 = L"/";
              do {
                WVar1 = *pWVar16;
                if (WVar1 == L'\0') break;
                pWVar16 = pWVar16 + 1;
                **param_4 = WVar1;
                *param_4 = *param_4 + 1;
                *param_5 = *param_5 - 1;
              } while (*param_5 != 0);
            }
            uVar14 = 0x79;
            goto LAB_140021163;
          }
        }
      }
      else {
        if (param_2 != 0x46) {
          if (param_2 == 0x47) {
            uVar12 = param_3[5];
            local_res10[0] = uVar12;
            if (uVar12 + 0x76c < 10000) {
              iVar6 = compute_iso_week_internal(uVar12,param_3[6],param_3[7]);
              if (iVar6 == 0) {
                local_res10[0] = uVar12 - 1;
              }
              else if (iVar6 < 1) {
                local_res10[0] = uVar12 + 1;
              }
              uVar12 = local_res10[0] + 0x76c;
              wVar4 = (wchar_t)0x30;
LAB_140021780:
              iVar6 = 4;
              goto LAB_140021970;
            }
          }
          else if (param_2 == 0x48) {
            uVar12 = param_3[2];
            bVar17 = uVar12 < 0x17;
            bVar18 = uVar12 == 0x17;
LAB_140020f91:
            if (bVar17 || bVar18) goto LAB_140020fa6;
          }
          else {
            if (param_2 != 0x49) goto LAB_14002124f;
            if (param_3[2] < 0x18) {
              uVar12 = (int)param_3[2] % 0xc;
              if (uVar12 == 0) {
                uVar12 = 0xc;
              }
              goto LAB_140020fa6;
            }
          }
          goto LAB_14002123f;
        }
        uVar9 = FUN_140020e24(param_1,0x59,param_3,param_4,param_5,param_6,param_7);
        if ((char)uVar9 != '\0') {
          _Var2 = *param_5;
          for (pWVar16 = L"-"; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
            **param_4 = *pWVar16;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 - 1;
            _Var2 = *param_5;
          }
          uVar9 = FUN_140020e24(param_1,0x6d,param_3,param_4,param_5,param_6,param_7);
          if ((char)uVar9 != '\0') {
            if (*param_5 != 0) {
              pWVar16 = L"-";
              do {
                WVar1 = *pWVar16;
                if (WVar1 == L'\0') break;
                pWVar16 = pWVar16 + 1;
                **param_4 = WVar1;
                *param_4 = *param_4 + 1;
                *param_5 = *param_5 - 1;
              } while (*param_5 != 0);
            }
            uVar14 = 100;
            goto LAB_140021163;
          }
        }
      }
LAB_140020ff3:
      in_RAX = (undefined **)__doserrno();
      *(ulong *)in_RAX = 0x16;
      goto LAB_14002124f;
    }
    if (param_3[5] + 0x76c < 10000) {
      uVar12 = (int)(param_3[5] + 0x76c) / 100;
      goto LAB_140021961;
    }
  }
LAB_14002123f:
  puVar10 = __doserrno();
  *puVar10 = 0x16;
  in_RAX = (undefined **)FUN_140011e58();
LAB_14002124f:
  return (ulonglong)in_RAX & 0xffffffffffffff00;
code_r0x000140020e9b:
  param_2 = 0x62;
  goto LAB_140020e55;
LAB_1400212d2:
  if (param_2 == 0x70) {
    if (param_3[2] < 0x18) {
      if ((int)param_3[2] < 0xc) {
        psVar15 = (short *)param_6[0x52];
      }
      else {
        psVar15 = (short *)param_6[0x53];
      }
      _Var2 = *param_5;
      for (; (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
        param_6 = (undefined **)*param_4;
        *(short *)param_6 = *psVar15;
        *param_4 = *param_4 + 1;
        *param_5 = *param_5 - 1;
        _Var2 = *param_5;
      }
      goto LAB_14002129b;
    }
    goto LAB_14002123f;
  }
  if (param_2 == 0x72) {
    if (param_6 == &PTR_DAT_140029ac0) {
      uVar9 = FUN_140020e24(param_1,0x49,param_3,param_4,param_5,&PTR_DAT_140029ac0,param_7);
      if ((char)uVar9 != '\0') {
        _Var2 = *param_5;
        for (pWVar16 = L":"; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
          **param_4 = *pWVar16;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        uVar9 = FUN_140020e24(param_1,0x4d,param_3,param_4,param_5,&PTR_DAT_140029ac0,param_7);
        if ((char)uVar9 != '\0') {
          if (*param_5 != 0) {
            pWVar16 = L":";
            do {
              WVar1 = *pWVar16;
              if (WVar1 == L'\0') break;
              pWVar16 = pWVar16 + 1;
              **param_4 = WVar1;
              *param_4 = *param_4 + 1;
              *param_5 = *param_5 - 1;
            } while (*param_5 != 0);
          }
          uVar9 = FUN_140020e24(param_1,0x53,param_3,param_4,param_5,&PTR_DAT_140029ac0,param_7);
          if ((char)uVar9 != '\0') {
            _Var2 = *param_5;
            for (pWVar16 = L" "; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
              **param_4 = *pWVar16;
              *param_4 = *param_4 + 1;
              *param_5 = *param_5 - 1;
              _Var2 = *param_5;
            }
            uVar14 = 0x70;
            goto LAB_140021163;
          }
        }
      }
      goto LAB_140020ff3;
    }
    uVar14 = 0x58;
LAB_140021163:
    param_6 = (undefined **)FUN_140020e24(param_1,uVar14,param_3,param_4,param_5,param_6,param_7);
LAB_14002116b:
    if ((char)param_6 != '\0') goto LAB_14002129b;
    goto LAB_140020ff3;
  }
  if (param_2 == 0x74) {
    _Var2 = *param_5;
    param_6 = in_RAX;
    for (psVar15 = &DAT_140031790; (_Var2 != 0 && (*psVar15 != 0)); psVar15 = psVar15 + 1) {
      param_6 = (undefined **)*param_4;
      *(short *)param_6 = *psVar15;
      *param_4 = *param_4 + 1;
      *param_5 = *param_5 - 1;
      _Var2 = *param_5;
    }
    goto LAB_14002129b;
  }
  if ((param_2 != 0x75) && (param_2 != 0x77)) {
    if (param_2 == 0x78) {
      uVar12 = (uint)param_7;
LAB_1400211e6:
      param_6 = (undefined **)
                FUN_140021db8(param_1,uVar12,(WORD *)param_3,param_4,(longlong *)param_5,
                              (longlong)param_6);
      goto LAB_14002116b;
    }
    if (param_2 == 0x79) {
      if (param_3[5] + 0x76c < 10000) {
        uVar12 = (int)(param_3[5] + 0x76c) % 100;
LAB_140021961:
        wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
        goto LAB_14002196b;
      }
    }
    else {
      if (param_2 != 0x7a) goto LAB_14002124f;
      __tzset();
      local_res10[0] = 0;
      uVar9 = FUN_14001d2f8(local_res10);
      if ((int)uVar9 == 0) {
        if (param_3[8] != 0) {
          local_28[0] = 0;
          uVar9 = FUN_14001d2c8(local_28);
          if ((int)uVar9 != 0) goto LAB_14002123f;
          local_res10[0] = local_res10[0] + local_28[0];
        }
        iVar6 = (int)((local_res10[0] ^ (int)local_res10[0] >> 0x1f) - ((int)local_res10[0] >> 0x1f)
                     ) / 0x3c;
        pWVar16 = L"-";
        local_28[0] = iVar6 % 0x3c;
        if ((int)local_res10[0] < 0) {
          pWVar16 = L"+";
        }
        _Var2 = *param_5;
        for (; (_Var2 != 0 && (*pWVar16 != L'\0')); pWVar16 = pWVar16 + 1) {
          **param_4 = *pWVar16;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Var2 = *param_5;
        }
        store_number(iVar6 / 0x3c,2,(wchar_t **)param_4,param_5,(wchar_t)0x30);
        wVar4 = (wchar_t)0x30;
        uVar12 = local_28[0];
        goto LAB_14002196b;
      }
    }
    goto LAB_14002123f;
  }
  uVar12 = param_3[6];
  if (6 < uVar12) goto LAB_14002123f;
  if ((uVar12 == 0) && (param_2 == 0x75)) {
    uVar12 = 7;
  }
  wVar4 = (wchar_t)(~-(param_7 != 0) & 0x30);
  iVar6 = 1;
LAB_140021970:
  store_number(uVar12,iVar6,(wchar_t **)param_4,param_5,wVar4);
  param_6 = extraout_RAX;
LAB_14002129b:
  return CONCAT71((int7)((ulonglong)param_6 >> 8),1);
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

void FUN_140021db8(_locale_t param_1,int param_2,WORD *param_3,WCHAR **param_4,longlong *param_5,
                  longlong param_6)

{
  wchar_t *pwVar1;
  uint *puVar2;
  _locale_t plVar3;
  undefined *puVar4;
  ushort uVar5;
  int iVar6;
  ulonglong uVar7;
  undefined4 *puVar8;
  longlong lVar9;
  undefined8 uVar10;
  ulong *puVar11;
  WCHAR WVar12;
  uint uVar13;
  ulonglong uVar14;
  WCHAR *pWVar15;
  undefined uVar16;
  undefined *puVar17;
  undefined *puVar18;
  WCHAR *pWVar19;
  LPCWSTR pWVar20;
  undefined4 *puVar21;
  undefined8 uStackY_b0;
  undefined auStackY_a8 [32];
  undefined4 local_70 [2];
  uint *local_68;
  _locale_t local_60;
  SYSTEMTIME local_58;
  ulonglong local_48;
  
  puVar17 = auStackY_a8;
  puVar18 = auStackY_a8;
  local_48 = DAT_140038010 ^ (ulonglong)&local_68;
  local_68 = (uint *)param_3;
  local_60 = param_1;
  if (param_2 == 0) {
    pWVar20 = *(LPCWSTR *)(param_6 + 0x2a0);
  }
  else if (param_2 == 1) {
    pWVar20 = *(LPCWSTR *)(param_6 + 0x2a8);
  }
  else {
    pWVar20 = *(LPCWSTR *)(param_6 + 0x2b0);
  }
  puVar4 = auStackY_a8;
  if (*(int *)(param_6 + 0x158) != 1) {
    local_58.wYear = param_3[10] + 0x76c;
    local_58.wMilliseconds = 0;
    local_58.wMonth = param_3[8] + 1;
    local_58.wDay = param_3[6];
    local_58.wHour = param_3[4];
    local_58.wMinute = param_3[2];
    local_58.wSecond = *param_3;
    if (param_2 == 2) {
      uStackY_b0 = 0x140021e9f;
      iVar6 = __acrt_GetTimeFormatEx
                        (*(wchar_t **)(param_6 + 0x2b8),0,&local_58,pWVar20,(LPWSTR)0x0,0);
    }
    else {
      uStackY_b0 = 0x140021eb5;
      iVar6 = __acrt_GetDateFormatEx
                        (*(wchar_t **)(param_6 + 0x2b8),0,&local_58,pWVar20,(LPWSTR)0x0,0,0);
    }
    puVar8 = (undefined4 *)0x0;
    puVar4 = auStackY_a8;
    if (iVar6 != 0) {
      uVar14 = (longlong)iVar6 * 2 + 0x10;
      uVar14 = -(ulonglong)((ulonglong)((longlong)iVar6 * 2) < uVar14) & uVar14;
      if (uVar14 != 0) {
        if (uVar14 < 0x401) {
          uVar7 = uVar14 + 0xf;
          if (uVar7 <= uVar14) {
            uVar7 = 0xffffffffffffff0;
          }
          uStackY_b0 = 0x140021efb;
          lVar9 = -(uVar7 & 0xfffffffffffffff0);
          puVar17 = auStackY_a8 + lVar9 + -8;
          puVar8 = (undefined4 *)((longlong)local_70 + lVar9);
          puVar4 = auStackY_a8 + lVar9 + -8;
          if (puVar8 == (undefined4 *)0x0) goto LAB_140021fcf;
          *puVar8 = 0xcccc;
        }
        else {
          uStackY_b0 = 0x140021f1f;
          puVar8 = (undefined4 *)_malloc_base(uVar14);
          puVar18 = auStackY_a8;
          if (puVar8 == (undefined4 *)0x0) goto LAB_140021f39;
          *puVar8 = 0xdddd;
        }
        puVar8 = puVar8 + 4;
        puVar18 = puVar17;
      }
LAB_140021f39:
      puVar4 = puVar18;
      if (puVar8 != (undefined4 *)0x0) {
        pwVar1 = *(wchar_t **)(param_6 + 0x2b8);
        if (param_2 == 2) {
          *(int *)(puVar18 + 0x28) = iVar6;
          *(undefined4 **)(puVar18 + 0x20) = puVar8;
          *(undefined8 *)(puVar18 + -8) = 0x140021f66;
          iVar6 = __acrt_GetTimeFormatEx
                            (pwVar1,0,&local_58,pWVar20,*(LPWSTR *)(puVar18 + 0x20),
                             *(int *)(puVar18 + 0x28));
        }
        else {
          *(undefined8 *)(puVar18 + 0x30) = 0;
          *(int *)(puVar18 + 0x28) = iVar6;
          *(undefined4 **)(puVar18 + 0x20) = puVar8;
          *(undefined8 *)(puVar18 + -8) = 0x140021f7b;
          iVar6 = __acrt_GetDateFormatEx
                            (pwVar1,0,&local_58,pWVar20,*(LPWSTR *)(puVar18 + 0x20),
                             *(int *)(puVar18 + 0x28),*(undefined8 *)(puVar18 + 0x30));
        }
        iVar6 = iVar6 + -1;
        if (0 < iVar6) {
          lVar9 = *param_5;
          puVar21 = puVar8;
          do {
            if (lVar9 == 0) break;
            WVar12 = *(WCHAR *)puVar21;
            iVar6 = iVar6 + -1;
            puVar21 = (undefined4 *)((longlong)puVar21 + 2);
            **param_4 = WVar12;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 + -1;
            lVar9 = *param_5;
          } while (0 < iVar6);
        }
        if (puVar8[-4] == 0xdddd) {
          *(undefined8 *)(puVar18 + -8) = 0x140021fbf;
          _free_base(puVar8 + -4);
        }
        goto LAB_1400222b0;
      }
    }
  }
LAB_140021fcf:
  puVar18 = puVar4;
  plVar3 = local_60;
  WVar12 = *pWVar20;
  while (WVar12 != L'\0') {
    uVar14 = 0;
    lVar9 = *param_5;
    if (lVar9 == 0) break;
    uVar16 = 0;
    uVar7 = uVar14;
    pWVar19 = pWVar20;
    do {
      pWVar19 = pWVar19 + 1;
      iVar6 = (int)uVar7;
      uVar13 = iVar6 + 1;
      uVar7 = (ulonglong)uVar13;
      uVar14 = uVar14 + 1;
    } while (*pWVar19 == WVar12);
    if ((ushort)WVar12 < 0x65) {
      if (WVar12 == L'd') {
        if (iVar6 == 0) {
          uVar16 = 1;
        }
        else if (iVar6 != 1) {
          if (uVar13 == 3) {
            uVar5 = 0x61;
          }
          else {
            if (uVar13 != 4) goto LAB_140022250;
            uVar5 = 0x41;
          }
          goto LAB_14002226d;
        }
        uVar5 = 100;
        goto LAB_14002226d;
      }
      if (WVar12 != L'\'') {
        if (WVar12 != L'A') {
          if (WVar12 == L'H') {
            if (uVar13 == 1) {
              uVar16 = 1;
            }
            else if (uVar13 != 2) goto LAB_140022250;
            uVar5 = 0x48;
            goto LAB_14002226d;
          }
          if (WVar12 == L'M') {
            if (iVar6 == 0) {
              uVar16 = 1;
            }
            else if (iVar6 != 1) {
              if (uVar13 == 3) {
                uVar5 = 0x62;
              }
              else {
                if (uVar13 != 4) goto LAB_140022250;
                uVar5 = 0x42;
              }
              goto LAB_14002226d;
            }
            uVar5 = 0x6d;
            goto LAB_14002226d;
          }
          if (WVar12 != L'a') goto LAB_140022250;
        }
        *(undefined8 *)(puVar18 + -8) = 0x140022067;
        iVar6 = FUN_140012f6c((wint_t *)pWVar20,(wint_t *)L"am/pm");
        if (iVar6 == 0) {
          pWVar19 = pWVar20 + 5;
        }
        else {
          *(undefined8 *)(puVar18 + -8) = 0x1400220d0;
          iVar6 = FUN_140012f6c((wint_t *)pWVar20,(wint_t *)&DAT_140032540);
          if (iVar6 == 0) {
            pWVar19 = pWVar20 + 3;
          }
        }
        uVar5 = 0x70;
        goto LAB_14002226d;
      }
      if ((uVar13 & 1) == 0) {
        pWVar19 = pWVar20 + (int)uVar13;
      }
      else {
        pWVar19 = pWVar20 + uVar14;
        WVar12 = *pWVar19;
        if (WVar12 == L'\0') break;
        do {
          if ((lVar9 == 0) || (pWVar19 = pWVar19 + 1, WVar12 == L'\'')) break;
          **param_4 = WVar12;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 + -1;
          WVar12 = *pWVar19;
          lVar9 = *param_5;
        } while (WVar12 != L'\0');
      }
    }
    else {
      if (WVar12 == L'h') {
        if (uVar13 == 1) {
          uVar16 = 1;
        }
        else if (uVar13 != 2) goto LAB_140022250;
        uVar5 = 0x49;
      }
      else if (WVar12 == L'm') {
        if (uVar13 == 1) {
          uVar16 = 1;
        }
        else if (uVar13 != 2) goto LAB_140022250;
        uVar5 = 0x4d;
      }
      else if (WVar12 == L's') {
        if (uVar13 == 1) {
          uVar16 = 1;
        }
        else if (uVar13 != 2) goto LAB_140022250;
        uVar5 = 0x53;
      }
      else {
        if (WVar12 == L't') {
          if ((int)local_68[2] < 0xc) {
            pWVar15 = *(WCHAR **)(param_6 + 0x290);
          }
          else {
            pWVar15 = *(WCHAR **)(param_6 + 0x298);
          }
          if ((uVar13 == 1) && (lVar9 != 0)) {
            **param_4 = *pWVar15;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 + -1;
          }
          else {
            while ((WVar12 = *pWVar15, WVar12 != L'\0' && (lVar9 != 0))) {
              pWVar15 = pWVar15 + 1;
              **param_4 = WVar12;
              *param_4 = *param_4 + 1;
              *param_5 = *param_5 + -1;
              lVar9 = *param_5;
            }
          }
          goto LAB_14002229c;
        }
        if (WVar12 != L'y') {
LAB_140022250:
          pWVar19 = pWVar20 + 1;
          **param_4 = WVar12;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 + -1;
          goto LAB_14002229c;
        }
        if (uVar13 == 2) {
          uVar5 = 0x79;
        }
        else {
          if (uVar13 != 4) goto LAB_140022250;
          uVar5 = 0x59;
        }
      }
LAB_14002226d:
      puVar2 = local_68;
      puVar18[0x30] = uVar16;
      *(longlong *)(puVar18 + 0x28) = param_6;
      *(longlong **)(puVar18 + 0x20) = param_5;
      *(undefined8 *)(puVar18 + -8) = 0x14002228d;
      uVar10 = FUN_140020e24(plVar3,uVar5,puVar2,param_4,*(__uint64 **)(puVar18 + 0x20),
                             *(undefined ***)(puVar18 + 0x28),puVar18[0x30]);
      if ((char)uVar10 == '\0') {
        *(undefined8 *)(puVar18 + -8) = 0x1400222d5;
        puVar11 = __doserrno();
        *puVar11 = 0x16;
        break;
      }
    }
LAB_14002229c:
    pWVar20 = pWVar19;
    WVar12 = *pWVar19;
  }
LAB_1400222b0:
  uVar14 = local_48 ^ (ulonglong)&local_68;
  *(undefined8 *)(puVar18 + -8) = 0x1400222bc;
  __security_check_cookie(uVar14);
  return;
}



// Library Function - Single Match
//  abort
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl abort(void)

{
  code *pcVar1;
  BOOL BVar2;
  longlong lVar3;
  undefined *puVar4;
  undefined auStack_28 [8];
  undefined auStack_20 [32];
  
  puVar4 = auStack_28;
  lVar3 = __acrt_get_sigabrt_handler();
  if (lVar3 != 0) {
    FUN_140018ed0(0x16);
  }
  if ((DAT_140038ad0 & 2) != 0) {
    BVar2 = IsProcessorFeaturePresent(0x17);
    puVar4 = auStack_28;
    if (BVar2 != 0) {
      pcVar1 = (code *)swi(0x29);
      (*pcVar1)(7);
      puVar4 = auStack_20;
    }
    *(undefined8 *)(puVar4 + -8) = 0x14002232b;
    __acrt_call_reportfault(3,0x40000015,1);
  }
  *(undefined8 *)(puVar4 + -8) = 0x140022335;
  FUN_140010a7c(3);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



LPVOID _calloc_base(ulonglong param_1,ulonglong param_2)

{
  int iVar1;
  LPVOID pvVar2;
  ulong *puVar3;
  size_t dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_1 * param_2;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar2 = HeapAlloc(DAT_1400395f8,8,dwBytes);
      if (pvVar2 != (LPVOID)0x0) {
        return pvVar2;
      }
      iVar1 = FUN_140012e60();
    } while ((iVar1 != 0) && (iVar1 = _callnewh(dwBytes), iVar1 != 0));
  }
  puVar3 = __doserrno();
  *puVar3 = 0xc;
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  _CallSettingFrame
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void _CallSettingFrame(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)_NLG_Notify();
  (*pcVar1)();
  FUN_140015510();
  _NLG_Notify();
  return;
}



// Library Function - Single Match
//  _CallSettingFrameEncoded
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void _CallSettingFrameEncoded(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)_NLG_Notify();
  (*pcVar1)(param_3);
  FUN_140015510();
  _NLG_Notify();
  return;
}



void FUN_1400223e8(byte *param_1)

{
  byte *local_18;
  undefined8 local_10;
  
  local_10 = 0;
  local_18 = param_1;
  FUN_1400196fc((__crt_locale_pointers *)0x0,&local_18,10,1);
  return;
}



// Library Function - Single Match
//  strncmp
// 
// Libraries: Visual Studio 2012, Visual Studio 2015, Visual Studio 2017, Visual Studio 2019

int __cdecl strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  bool bVar4;
  
  lVar3 = (longlong)_Str2 - (longlong)_Str1;
  if (_MaxCount != 0) {
    uVar2 = (ulonglong)_Str1 & 7;
    while( true ) {
      if (uVar2 == 0) {
        while ((((int)lVar3 + (int)_Str1 & 0xfffU) < 0xff9 &&
               (uVar2 = *(ulonglong *)_Str1, uVar2 == *(ulonglong *)(lVar3 + (longlong)_Str1)))) {
          _Str1 = (char *)((longlong)_Str1 + 8);
          bVar4 = _MaxCount < 8;
          _MaxCount = _MaxCount - 8;
          if (bVar4 || _MaxCount == 0) {
            return 0;
          }
          if ((~uVar2 & uVar2 + 0xfefefefefefefeff & 0x8080808080808080) != 0) {
            return 0;
          }
        }
      }
      bVar1 = *_Str1;
      if (bVar1 != *(byte *)(lVar3 + (longlong)_Str1)) {
        return -(uint)(bVar1 < *(byte *)(lVar3 + (longlong)_Str1)) | 1;
      }
      _Str1 = (char *)((longlong)_Str1 + 1);
      _MaxCount = _MaxCount - 1;
      if ((_MaxCount == 0) || (bVar1 == 0)) break;
      uVar2 = (ulonglong)_Str1 & 7;
    }
  }
  return 0;
}



// Library Function - Single Match
//  __acrt_DownlevelLocaleNameToLCID
// 
// Library: Visual Studio 2017 Release

undefined4 __acrt_DownlevelLocaleNameToLCID(wchar_t *param_1)

{
  uint uVar1;
  
  if (((param_1 != (wchar_t *)0x0) &&
      (uVar1 = GetTableIndexFromLocaleName(param_1), -1 < (int)uVar1)) && (uVar1 < 0xe4)) {
    return *(undefined4 *)(&DAT_14002a640 + (longlong)(int)uVar1 * 0x10);
  }
  return 0;
}



// Library Function - Single Match
//  int __cdecl GetTableIndexFromLocaleName(wchar_t const * __ptr64)
// 
// Library: Visual Studio 2017 Release

int __cdecl GetTableIndexFromLocaleName(wchar_t *param_1)

{
  int iVar1;
  int iVar2;
  ushort uVar3;
  ushort *puVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  ushort uVar9;
  bool bVar10;
  
  iVar7 = 0;
  iVar8 = 0xe3;
  while( true ) {
    lVar5 = 0x55;
    iVar2 = (iVar8 + iVar7) / 2;
    puVar4 = *(ushort **)(&DAT_14002b480 + (longlong)iVar2 * 0x10);
    lVar6 = (longlong)param_1 - (longlong)puVar4;
    do {
      uVar3 = *(short *)(lVar6 + (longlong)puVar4) + 0x20;
      if (0x19 < (ushort)(*(short *)(lVar6 + (longlong)puVar4) - 0x41U)) {
        uVar3 = *(ushort *)(lVar6 + (longlong)puVar4);
      }
      uVar9 = *puVar4 + 0x20;
      if (0x19 < (ushort)(*puVar4 - 0x41)) {
        uVar9 = *puVar4;
      }
      puVar4 = puVar4 + 1;
      lVar5 = lVar5 + -1;
    } while (((lVar5 != 0) && (uVar3 != 0)) && (uVar3 == uVar9));
    if ((uint)uVar3 == (uint)uVar9) break;
    bVar10 = -1 < (int)((uint)uVar3 - (uint)uVar9);
    iVar1 = iVar2 + -1;
    if (bVar10) {
      iVar1 = iVar8;
    }
    iVar8 = iVar1;
    if (bVar10) {
      iVar7 = iVar2 + 1;
    }
    if (iVar8 < iVar7) {
      return -1;
    }
  }
  return *(int *)(&UNK_14002b488 + (longlong)iVar2 * 0x10);
}



// Library Function - Single Match
//  __acrt_LCMapStringA
// 
// Library: Visual Studio 2017 Release

void __acrt_LCMapStringA(__crt_locale_pointers *param_1,wchar_t *param_2,ulong param_3,char *param_4
                        ,int param_5,char *param_6,int param_7,int param_8,int param_9)

{
  longlong local_28;
  __crt_locale_pointers local_20 [16];
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,param_1);
  __acrt_LCMapStringA_stat(local_20,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9)
  ;
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe
// Library Function - Single Match
//  int __cdecl __acrt_LCMapStringA_stat(struct __crt_locale_pointers * __ptr64,wchar_t const *
// __ptr64,unsigned long,char const * __ptr64,int,char * __ptr64,int,int,int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl
__acrt_LCMapStringA_stat
          (__crt_locale_pointers *param_1,wchar_t *param_2,ulong param_3,char *param_4,int param_5,
          char *param_6,int param_7,int param_8,int param_9)

{
  longlong lVar1;
  wchar_t *pwVar2;
  int iVar3;
  int iVar4;
  int extraout_EAX;
  size_t sVar5;
  ulonglong uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  ulonglong uVar9;
  undefined *puVar10;
  undefined *puVar11;
  undefined *puVar12;
  undefined *puVar13;
  undefined8 uStackY_90;
  undefined auStackY_88 [32];
  undefined4 local_40 [2];
  wchar_t *local_38;
  ulonglong local_30;
  
  puVar10 = auStackY_88;
  puVar12 = auStackY_88;
  local_30 = DAT_140038010 ^ (ulonglong)&local_38;
  iVar4 = param_5;
  local_38 = param_2;
  if (0 < param_5) {
    uStackY_90 = 0x1400226b1;
    sVar5 = __strncnt(param_4,(longlong)param_5);
    iVar3 = (int)sVar5;
    iVar4 = iVar3 + 1;
    if (param_5 <= iVar3) {
      iVar4 = iVar3;
    }
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*(longlong *)param_1 + 0xc);
  }
  uStackY_90 = 0x1400226f0;
  iVar3 = __acrt_MultiByteToWideChar
                    (param_8,(-(uint)(param_9 != 0) & 8) + 1,param_4,iVar4,(LPWSTR)0x0,0);
  puVar13 = auStackY_88;
  if (iVar3 == 0) goto LAB_140022931;
  uVar9 = (longlong)iVar3 * 2 + 0x10;
  uVar9 = -(ulonglong)((ulonglong)((longlong)iVar3 * 2) < uVar9) & uVar9;
  if (uVar9 == 0) {
    puVar7 = (undefined4 *)0x0;
LAB_14002276f:
    if (puVar7 != (undefined4 *)0x0) {
      *(int *)(puVar12 + 0x28) = iVar3;
      *(undefined4 **)(puVar12 + 0x20) = puVar7;
      *(undefined8 *)(puVar12 + -8) = 0x140022795;
      iVar4 = __acrt_MultiByteToWideChar
                        (param_8,1,param_4,iVar4,*(LPWSTR *)(puVar12 + 0x20),
                         *(int *)(puVar12 + 0x28));
      if (iVar4 != 0) {
        *(undefined8 *)(puVar12 + 0x40) = 0;
        *(undefined8 *)(puVar12 + 0x38) = 0;
        *(undefined8 *)(puVar12 + 0x30) = 0;
        pwVar2 = local_38;
        *(undefined4 *)(puVar12 + 0x28) = 0;
        *(undefined8 *)(puVar12 + 0x20) = 0;
        *(undefined8 *)(puVar12 + -8) = 0x1400227cf;
        iVar4 = __acrt_LCMapStringEx
                          (pwVar2,param_3,(LPCWSTR)puVar7,iVar3,*(LPWSTR *)(puVar12 + 0x20),
                           *(int *)(puVar12 + 0x28),*(undefined8 *)(puVar12 + 0x30),
                           *(undefined8 *)(puVar12 + 0x38),*(undefined8 *)(puVar12 + 0x40));
        if (iVar4 != 0) {
          if ((param_3 & 0x400) == 0) {
            uVar9 = (longlong)iVar4 * 2 + 0x10;
            uVar9 = -(ulonglong)((ulonglong)((longlong)iVar4 * 2) < uVar9) & uVar9;
            if (uVar9 == 0) {
              puVar8 = (undefined4 *)0x0;
            }
            else {
              if (uVar9 < 0x401) {
                uVar6 = uVar9 + 0xf;
                if (uVar6 <= uVar9) {
                  uVar6 = 0xffffffffffffff0;
                }
                *(undefined8 *)(puVar12 + -8) = 0x14002286c;
                lVar1 = -(uVar6 & 0xfffffffffffffff0);
                puVar11 = puVar12 + lVar1 + -8;
                puVar8 = (undefined4 *)(puVar12 + lVar1 + 0x48);
                puVar12 = puVar12 + lVar1 + -8;
                if (puVar8 == (undefined4 *)0x0) goto LAB_140022919;
                *puVar8 = 0xcccc;
                puVar12 = puVar11;
              }
              else {
                *(undefined8 *)(puVar12 + -8) = 0x14002288a;
                puVar8 = (undefined4 *)_malloc_base(uVar9);
                if (puVar8 == (undefined4 *)0x0) goto LAB_1400228a0;
                *puVar8 = 0xdddd;
              }
              puVar8 = puVar8 + 4;
            }
LAB_1400228a0:
            if (puVar8 != (undefined4 *)0x0) {
              *(undefined8 *)(puVar12 + 0x40) = 0;
              *(undefined8 *)(puVar12 + 0x38) = 0;
              *(undefined8 *)(puVar12 + 0x30) = 0;
              *(int *)(puVar12 + 0x28) = iVar4;
              *(undefined4 **)(puVar12 + 0x20) = puVar8;
              *(undefined8 *)(puVar12 + -8) = 0x1400228d1;
              iVar3 = __acrt_LCMapStringEx
                                (pwVar2,param_3,(LPCWSTR)puVar7,iVar3,*(LPWSTR *)(puVar12 + 0x20),
                                 *(int *)(puVar12 + 0x28),*(undefined8 *)(puVar12 + 0x30),
                                 *(undefined8 *)(puVar12 + 0x38),*(undefined8 *)(puVar12 + 0x40));
              if (iVar3 != 0) {
                *(undefined8 *)(puVar12 + 0x38) = 0;
                *(undefined8 *)(puVar12 + 0x30) = 0;
                if (param_7 == 0) {
                  *(undefined4 *)(puVar12 + 0x28) = 0;
                  *(undefined8 *)(puVar12 + 0x20) = 0;
                }
                else {
                  *(int *)(puVar12 + 0x28) = param_7;
                  *(char **)(puVar12 + 0x20) = param_6;
                }
                *(undefined8 *)(puVar12 + -8) = 0x140022900;
                iVar4 = __acrt_WideCharToMultiByte
                                  (param_8,0,(char)puVar8,(char)iVar4,puVar12[0x20],puVar12[0x28],
                                   *(undefined8 *)(puVar12 + 0x30),*(undefined8 *)(puVar12 + 0x38));
                if (iVar4 != 0) {
                  if (puVar8[-4] == 0xdddd) {
                    *(undefined8 *)(puVar12 + -8) = 0x140022977;
                    _free_base(puVar8 + -4);
                  }
                  goto LAB_140022919;
                }
              }
              if (puVar8[-4] == 0xdddd) {
                *(undefined8 *)(puVar12 + -8) = 0x140022917;
                _free_base(puVar8 + -4);
              }
            }
          }
          else if ((param_7 != 0) && (iVar4 <= param_7)) {
            *(undefined8 *)(puVar12 + 0x40) = 0;
            *(undefined8 *)(puVar12 + 0x38) = 0;
            *(undefined8 *)(puVar12 + 0x30) = 0;
            *(int *)(puVar12 + 0x28) = param_7;
            *(char **)(puVar12 + 0x20) = param_6;
            *(undefined8 *)(puVar12 + -8) = 0x140022827;
            __acrt_LCMapStringEx
                      (pwVar2,param_3,(LPCWSTR)puVar7,iVar3,*(LPWSTR *)(puVar12 + 0x20),
                       *(int *)(puVar12 + 0x28),*(undefined8 *)(puVar12 + 0x30),
                       *(undefined8 *)(puVar12 + 0x38),*(undefined8 *)(puVar12 + 0x40));
          }
        }
      }
    }
  }
  else {
    if (0x400 < uVar9) {
      uStackY_90 = 0x140022759;
      puVar7 = (undefined4 *)_malloc_base(uVar9);
      puVar12 = auStackY_88;
      if (puVar7 != (undefined4 *)0x0) {
        *puVar7 = 0xdddd;
        goto LAB_140022767;
      }
      goto LAB_14002276f;
    }
    uVar6 = uVar9 + 0xf;
    if (uVar6 <= uVar9) {
      uVar6 = 0xffffffffffffff0;
    }
    uStackY_90 = 0x140022738;
    lVar1 = -(uVar6 & 0xfffffffffffffff0);
    puVar10 = auStackY_88 + lVar1 + -8;
    puVar7 = (undefined4 *)((longlong)local_40 + lVar1);
    puVar12 = auStackY_88 + lVar1 + -8;
    if (puVar7 != (undefined4 *)0x0) {
      *puVar7 = 0xcccc;
LAB_140022767:
      puVar7 = puVar7 + 4;
      puVar12 = puVar10;
      goto LAB_14002276f;
    }
  }
LAB_140022919:
  puVar13 = puVar12;
  if ((puVar7 != (undefined4 *)0x0) && (puVar7[-4] == 0xdddd)) {
    *(undefined8 *)(puVar12 + -8) = 0x14002292f;
    _free_base(puVar7 + -4);
  }
LAB_140022931:
  uVar9 = local_30 ^ (ulonglong)&local_38;
  *(undefined8 *)(puVar13 + -8) = 0x14002293d;
  __security_check_cookie(uVar9);
  return extraout_EAX;
}



bool FUN_140022980(void)

{
  undefined8 uVar1;
  
  uVar1 = __acrt_initialize_multibyte();
  return (char)uVar1 == '\0';
}



// Library Function - Single Match
//  _isatty
// 
// Library: Visual Studio 2015 Release

int __cdecl _isatty(int _FileHandle)

{
  ulong *puVar1;
  
  if (_FileHandle == -2) {
    puVar1 = __doserrno();
    *puVar1 = 9;
  }
  else {
    if ((-1 < _FileHandle) && ((uint)_FileHandle < DAT_140039a00)) {
      return *(byte *)((&DAT_140039600)[(longlong)_FileHandle >> 6] + 0x38 +
                      (ulonglong)(_FileHandle & 0x3f) * 0x40) & 0x40;
    }
    puVar1 = __doserrno();
    *puVar1 = 9;
    FUN_140011e58();
  }
  return 0;
}



void FUN_1400229f8(int param_1,undefined8 param_2,__crt_locale_pointers *param_3)

{
  int iVar1;
  int iVar2;
  undefined auStackY_88 [32];
  CHAR local_48;
  CHAR local_47;
  undefined local_46;
  longlong local_40;
  localeinfo_struct local_38;
  char local_28;
  undefined4 local_20;
  undefined2 local_1c;
  ulonglong local_18;
  
  local_18 = DAT_140038010 ^ (ulonglong)auStackY_88;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_40,param_3);
  if ((param_1 < -1) || (0xff < param_1)) {
    iVar1 = _isleadbyte_l(param_1 >> 8 & 0xff,&local_38);
    iVar2 = 1;
    if (iVar1 == 0) {
      local_47 = '\0';
      local_48 = (CHAR)param_1;
    }
    else {
      iVar2 = 2;
      local_46 = 0;
      local_48 = (CHAR)((uint)param_1 >> 8);
      local_47 = (CHAR)param_1;
    }
    local_20 = 0;
    local_1c = 0;
    iVar1 = __acrt_GetStringTypeA
                      ((__crt_locale_pointers *)&local_38,1,&local_48,iVar2,(LPWORD)&local_20,
                       (local_38.locinfo)->lc_time_cp,1);
    if (iVar1 == 0) {
      if (local_28 != '\0') {
        *(uint *)(local_40 + 0x3a8) = *(uint *)(local_40 + 0x3a8) & 0xfffffffd;
      }
      goto LAB_140022aea;
    }
  }
  if (local_28 != '\0') {
    *(uint *)(local_40 + 0x3a8) = *(uint *)(local_40 + 0x3a8) & 0xfffffffd;
  }
LAB_140022aea:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY_88);
  return;
}



// Library Function - Single Match
//  unsigned __int64 __cdecl __crt_mbstring::__mbrtowc_utf8(wchar_t * __ptr64,char const *
// __ptr64,unsigned __int64,struct _Mbstatet * __ptr64)
// 
// Library: Visual Studio 2017 Release

__uint64 __cdecl
__crt_mbstring::__mbrtowc_utf8(wchar_t *param_1,char *param_2,__uint64 param_3,_Mbstatet *param_4)

{
  __uint64 _Var1;
  uint local_18 [4];
  
  _Var1 = FUN_1400262b4((ulonglong)local_18,(byte *)param_2,param_3,(undefined8 *)param_4);
  if (_Var1 < 5) {
    if (0xffff < local_18[0]) {
      local_18[0] = 0xfffd;
    }
    if (param_1 != (wchar_t *)0x0) {
      *(short *)param_1 = (short)local_18[0];
    }
  }
  return _Var1;
}



// Library Function - Single Match
//  unsigned __int64 __cdecl __crt_mbstring::__mbsrtowcs_utf8(wchar_t * __ptr64,char const * __ptr64
// * __ptr64,unsigned __int64,struct _Mbstatet * __ptr64)
// 
// Library: Visual Studio 2017 Release

__uint64 __cdecl
__crt_mbstring::__mbsrtowcs_utf8
          (wchar_t *param_1,char **param_2,__uint64 param_3,_Mbstatet *param_4)

{
  longlong lVar1;
  ulong *puVar2;
  uint uVar3;
  ushort *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  ulonglong uVar7;
  uint local_res8 [2];
  
  pbVar6 = (byte *)*param_2;
  pbVar5 = (byte *)0x0;
  if (param_1 == (wchar_t *)0x0) {
    while( true ) {
      if (*pbVar6 == 0) {
        uVar7 = 1;
      }
      else if (pbVar6[1] == 0) {
        uVar7 = 2;
      }
      else {
        uVar7 = (ulonglong)(pbVar6[2] != 0) + 3;
      }
      lVar1 = FUN_1400262b4(0,pbVar6,uVar7,(undefined8 *)param_4);
      if (lVar1 == -1) goto LAB_140022c41;
      if (lVar1 == 0) break;
      if (lVar1 == 4) {
        pbVar5 = pbVar5 + 1;
      }
      pbVar6 = pbVar6 + lVar1;
      pbVar5 = pbVar5 + 1;
    }
  }
  else {
    puVar4 = (ushort *)param_1;
    if (param_3 != 0) {
      do {
        if (*pbVar6 == 0) {
          uVar7 = 1;
        }
        else if (pbVar6[1] == 0) {
          uVar7 = 2;
        }
        else {
          uVar7 = (ulonglong)(pbVar6[2] != 0) + 3;
        }
        lVar1 = FUN_1400262b4((ulonglong)local_res8,pbVar6,uVar7,(undefined8 *)param_4);
        if (lVar1 == -1) {
          *param_2 = (char *)pbVar6;
LAB_140022c41:
          puVar2 = __doserrno();
          *puVar2 = 0x2a;
          return 0xffffffffffffffff;
        }
        if (lVar1 == 0) {
          *puVar4 = 0;
          pbVar6 = pbVar5;
          break;
        }
        uVar3 = local_res8[0];
        if (0xffff < local_res8[0]) {
          if (param_3 < 2) break;
          local_res8[0] = local_res8[0] - 0x10000;
          param_3 = param_3 - 1;
          *puVar4 = (ushort)(local_res8[0] >> 10) | 0xd800;
          puVar4 = puVar4 + 1;
          uVar3 = (uint)((ushort)local_res8[0] & 0x3ff | 0xdc00);
        }
        *puVar4 = (ushort)uVar3;
        pbVar6 = pbVar6 + lVar1;
        puVar4 = puVar4 + 1;
        param_3 = param_3 - 1;
      } while (param_3 != 0);
    }
    *param_2 = (char *)pbVar6;
    pbVar5 = (byte *)((longlong)puVar4 - (longlong)param_1 >> 1);
  }
  return (__uint64)pbVar5;
}



// Library Function - Single Match
//  strrchr
// 
// Library: Visual Studio 2017 Release

char * __cdecl strrchr(char *_Str,int _Ch)

{
  ushort uVar1;
  uint uVar2;
  undefined (*pauVar3) [16];
  int iVar4;
  undefined (*pauVar5) [16];
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  bool bVar9;
  bool bVar10;
  char cVar11;
  char cVar13;
  char cVar14;
  char cVar15;
  undefined auVar12 [16];
  undefined in_XMM1 [16];
  undefined auVar16 [16];
  
  pauVar3 = (undefined (*) [16])0x0;
  if (_Ch == 0) {
    pcVar7 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
    auVar12 = ZEXT1216(ZEXT812(0));
    cVar11 = SUB161(auVar12 >> 0x40,0);
    cVar13 = SUB161(auVar12 >> 0x48,0);
    cVar14 = SUB161(auVar12 >> 0x50,0);
    cVar15 = SUB161(auVar12 >> 0x58,0);
    auVar12 = CONCAT115(-(pcVar7[0xf] == '\0'),
                        CONCAT114(-(pcVar7[0xe] == '\0'),
                                  CONCAT113(-(pcVar7[0xd] == '\0'),
                                            CONCAT112(-(pcVar7[0xc] == '\0'),
                                                      CONCAT111(-(pcVar7[0xb] == cVar15),
                                                                CONCAT110(-(pcVar7[10] == cVar14),
                                                                          CONCAT19(-(pcVar7[9] ==
                                                                                    cVar13),CONCAT18
                                                  (-(pcVar7[8] == cVar11),
                                                   CONCAT17(-(pcVar7[7] == '\0'),
                                                            CONCAT16(-(pcVar7[6] == '\0'),
                                                                     CONCAT15(-(pcVar7[5] == '\0'),
                                                                              CONCAT14(-(pcVar7[4]
                                                                                        == '\0'),
                                                                                       CONCAT13(-(
                                                  pcVar7[3] == '\0'),
                                                  CONCAT12(-(pcVar7[2] == '\0'),
                                                           CONCAT11(-(pcVar7[1] == '\0'),
                                                                    -(*pcVar7 == '\0')))))))))))))))
                       );
    uVar2 = (uint)(ushort)((ushort)(SUB161(auVar12 >> 7,0) & 1) |
                           (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                           (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                           (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                           (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                           (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                           (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                           (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                           (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                           (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                           (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                           (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                           (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                           (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                           (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                          (ushort)((byte)-(pcVar7[0xf] == '\0') >> 7) << 0xf) &
            -1 << ((byte)_Str & 0xf);
    pcVar8 = pcVar7;
    if (uVar2 == 0) {
      do {
        pcVar7 = pcVar8 + 0x10;
        auVar12 = CONCAT115(-(pcVar8[0x1f] == '\0'),
                            CONCAT114(-(pcVar8[0x1e] == '\0'),
                                      CONCAT113(-(pcVar8[0x1d] == '\0'),
                                                CONCAT112(-(pcVar8[0x1c] == '\0'),
                                                          CONCAT111(-(pcVar8[0x1b] == cVar15),
                                                                    CONCAT110(-(pcVar8[0x1a] ==
                                                                               cVar14),CONCAT19(-(
                                                  pcVar8[0x19] == cVar13),
                                                  CONCAT18(-(pcVar8[0x18] == cVar11),
                                                           CONCAT17(-(pcVar8[0x17] == '\0'),
                                                                    CONCAT16(-(pcVar8[0x16] == '\0')
                                                                             ,CONCAT15(-(pcVar8[0x15
                                                  ] == '\0'),
                                                  CONCAT14(-(pcVar8[0x14] == '\0'),
                                                           CONCAT13(-(pcVar8[0x13] == '\0'),
                                                                    CONCAT12(-(pcVar8[0x12] == '\0')
                                                                             ,CONCAT11(-(pcVar8[0x11
                                                  ] == '\0'),-(*pcVar7 == '\0'))))))))))))))));
        uVar1 = (ushort)(SUB161(auVar12 >> 7,0) & 1) | (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                (ushort)((byte)-(pcVar8[0x1f] == '\0') >> 7) << 0xf;
        uVar2 = (uint)uVar1;
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = 0;
    if (uVar2 != 0) {
      for (; (uVar2 >> uVar6 & 1) == 0; uVar6 = uVar6 + 1) {
      }
    }
    pauVar3 = (undefined (*) [16])(pcVar7 + uVar6);
  }
  else if (DAT_140038018 < 2) {
    pcVar7 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
    auVar16 = pshuflw(in_XMM1,ZEXT416((_Ch & 0xffU) << 8 | _Ch & 0xffU),0);
    uVar2 = -1 << ((byte)_Str & 0xf);
    auVar12 = CONCAT115(-(pcVar7[0xf] == '\0'),
                        CONCAT114(-(pcVar7[0xe] == '\0'),
                                  CONCAT113(-(pcVar7[0xd] == '\0'),
                                            CONCAT112(-(pcVar7[0xc] == '\0'),
                                                      CONCAT111(-(pcVar7[0xb] == '\0'),
                                                                CONCAT110(-(pcVar7[10] == '\0'),
                                                                          CONCAT19(-(pcVar7[9] ==
                                                                                    '\0'),CONCAT18(-
                                                  (pcVar7[8] == '\0'),
                                                  CONCAT17(-(pcVar7[7] == '\0'),
                                                           CONCAT16(-(pcVar7[6] == '\0'),
                                                                    CONCAT15(-(pcVar7[5] == '\0'),
                                                                             CONCAT14(-(pcVar7[4] ==
                                                                                       '\0'),
                                                  CONCAT13(-(pcVar7[3] == '\0'),
                                                           CONCAT12(-(pcVar7[2] == '\0'),
                                                                    CONCAT11(-(pcVar7[1] == '\0'),
                                                                             -(*pcVar7 == '\0'))))))
                                                  ))))))))));
    cVar11 = SUB161(auVar16,0);
    cVar13 = SUB161(auVar16 >> 8,0);
    cVar14 = SUB161(auVar16 >> 0x10,0);
    cVar15 = SUB161(auVar16 >> 0x18,0);
    auVar16 = CONCAT115(-(cVar15 == pcVar7[0xf]),
                        CONCAT114(-(cVar14 == pcVar7[0xe]),
                                  CONCAT113(-(cVar13 == pcVar7[0xd]),
                                            CONCAT112(-(cVar11 == pcVar7[0xc]),
                                                      CONCAT111(-(cVar15 == pcVar7[0xb]),
                                                                CONCAT110(-(cVar14 == pcVar7[10]),
                                                                          CONCAT19(-(cVar13 ==
                                                                                    pcVar7[9]),
                                                                                   CONCAT18(-(cVar11
                                                                                             == 
                                                  pcVar7[8]),
                                                  CONCAT17(-(cVar15 == pcVar7[7]),
                                                           CONCAT16(-(cVar14 == pcVar7[6]),
                                                                    CONCAT15(-(cVar13 == pcVar7[5]),
                                                                             CONCAT14(-(cVar11 ==
                                                                                       pcVar7[4]),
                                                                                      CONCAT13(-(
                                                  cVar15 == pcVar7[3]),
                                                  CONCAT12(-(cVar14 == pcVar7[2]),
                                                           CONCAT11(-(cVar13 == pcVar7[1]),
                                                                    -(cVar11 == *pcVar7)))))))))))))
                                           )));
    uVar6 = (ushort)((ushort)(SUB161(auVar16 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar16 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar16 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar16 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar16 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar16 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar16 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar16 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar16 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar16 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar16 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar16 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar16 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar16 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar16 >> 0x77,0) & 1) << 0xe |
                    (ushort)((byte)-(cVar15 == pcVar7[0xf]) >> 7) << 0xf) & uVar2;
    uVar2 = (ushort)((ushort)(SUB161(auVar12 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                    (ushort)((byte)-(pcVar7[0xf] == '\0') >> 7) << 0xf) & uVar2;
    pcVar8 = pcVar7;
    if (uVar2 == 0) {
      do {
        uVar2 = 0x1f;
        if (uVar6 != 0) {
          for (; uVar6 >> uVar2 == 0; uVar2 = uVar2 - 1) {
          }
        }
        if (uVar6 != 0) {
          pauVar3 = (undefined (*) [16])(pcVar8 + uVar2);
        }
        pcVar7 = pcVar8 + 0x10;
        auVar16 = CONCAT115(-(pcVar8[0x1f] == '\0'),
                            CONCAT114(-(pcVar8[0x1e] == '\0'),
                                      CONCAT113(-(pcVar8[0x1d] == '\0'),
                                                CONCAT112(-(pcVar8[0x1c] == '\0'),
                                                          CONCAT111(-(pcVar8[0x1b] == '\0'),
                                                                    CONCAT110(-(pcVar8[0x1a] == '\0'
                                                                               ),CONCAT19(-(pcVar8[
                                                  0x19] == '\0'),
                                                  CONCAT18(-(pcVar8[0x18] == '\0'),
                                                           CONCAT17(-(pcVar8[0x17] == '\0'),
                                                                    CONCAT16(-(pcVar8[0x16] == '\0')
                                                                             ,CONCAT15(-(pcVar8[0x15
                                                  ] == '\0'),
                                                  CONCAT14(-(pcVar8[0x14] == '\0'),
                                                           CONCAT13(-(pcVar8[0x13] == '\0'),
                                                                    CONCAT12(-(pcVar8[0x12] == '\0')
                                                                             ,CONCAT11(-(pcVar8[0x11
                                                  ] == '\0'),-(*pcVar7 == '\0'))))))))))))))));
        auVar12 = CONCAT115(-(cVar15 == pcVar8[0x1f]),
                            CONCAT114(-(cVar14 == pcVar8[0x1e]),
                                      CONCAT113(-(cVar13 == pcVar8[0x1d]),
                                                CONCAT112(-(cVar11 == pcVar8[0x1c]),
                                                          CONCAT111(-(cVar15 == pcVar8[0x1b]),
                                                                    CONCAT110(-(cVar14 ==
                                                                               pcVar8[0x1a]),
                                                                              CONCAT19(-(cVar13 ==
                                                                                        pcVar8[0x19]
                                                                                        ),CONCAT18(-
                                                  (cVar11 == pcVar8[0x18]),
                                                  CONCAT17(-(cVar15 == pcVar8[0x17]),
                                                           CONCAT16(-(cVar14 == pcVar8[0x16]),
                                                                    CONCAT15(-(cVar13 ==
                                                                              pcVar8[0x15]),
                                                                             CONCAT14(-(cVar11 ==
                                                                                       pcVar8[0x14])
                                                                                      ,CONCAT13(-(
                                                  cVar15 == pcVar8[0x13]),
                                                  CONCAT12(-(cVar14 == pcVar8[0x12]),
                                                           CONCAT11(-(cVar13 == pcVar8[0x11]),
                                                                    -(cVar11 == *pcVar7)))))))))))))
                                               )));
        uVar1 = (ushort)(SUB161(auVar16 >> 7,0) & 1) | (ushort)(SUB161(auVar16 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar16 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar16 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar16 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar16 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar16 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar16 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar16 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar16 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar16 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar16 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar16 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar16 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar16 >> 0x77,0) & 1) << 0xe |
                (ushort)((byte)-(pcVar8[0x1f] == '\0') >> 7) << 0xf;
        uVar2 = (uint)uVar1;
        uVar6 = (uint)(ushort)((ushort)(SUB161(auVar12 >> 7,0) & 1) |
                               (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                               (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                               (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                               (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                               (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                               (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                               (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                               (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                               (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                               (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                               (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                               (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                               (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                               (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                              (ushort)((byte)-(cVar15 == pcVar8[0x1f]) >> 7) << 0xf);
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = uVar6 & (-uVar2 & uVar2) - 1;
    uVar2 = 0x1f;
    if (uVar6 != 0) {
      for (; uVar6 >> uVar2 == 0; uVar2 = uVar2 - 1) {
      }
    }
    if (uVar6 != 0) {
      pauVar3 = (undefined (*) [16])(pcVar7 + uVar2);
    }
  }
  else {
    while( true ) {
      bVar9 = false;
      bVar10 = ((ulonglong)_Str & 0xf) == 0;
      if (bVar10) break;
      pauVar5 = (undefined (*) [16])_Str;
      if (*_Str != _Ch) {
        pauVar5 = pauVar3;
      }
      if (*_Str == '\0') {
        return (char *)pauVar5;
      }
      _Str = _Str + 1;
      pauVar3 = pauVar5;
    }
    while( true ) {
      iVar4 = pcmpistri(ZEXT416(_Ch & 0xff),*(undefined (*) [16])_Str,0x40);
      if (bVar9) {
        pauVar3 = (undefined (*) [16])(_Str + iVar4);
        bVar10 = pauVar3 == (undefined (*) [16])0x0;
        pcmpistri(ZEXT416(_Ch & 0xff),*(undefined (*) [16])_Str,0x40);
      }
      if (bVar10) break;
      bVar9 = (undefined (*) [16])0xffffffffffffffef < _Str;
      _Str = (char *)((longlong)_Str + 0x10);
      bVar10 = (undefined (*) [16])_Str == (undefined (*) [16])0x0;
    }
  }
  return (char *)pauVar3;
}



// Library Function - Single Match
//  __acrt_fp_strflt_to_string
// 
// Library: Visual Studio 2017 Release

ulong __acrt_fp_strflt_to_string(undefined8 *param_1,ulonglong param_2,int param_3,longlong param_4)

{
  char cVar1;
  longlong lVar2;
  int iVar3;
  ulong *puVar4;
  char *pcVar5;
  ulong uVar6;
  char *pcVar7;
  char *pcVar8;
  longlong lVar9;
  
  if ((param_1 != (undefined8 *)0x0) && (param_2 != 0)) {
    *(undefined *)param_1 = 0;
    iVar3 = 0;
    if (0 < param_3) {
      iVar3 = param_3;
    }
    if (param_2 <= (ulonglong)(longlong)(iVar3 + 1)) {
      puVar4 = __doserrno();
      uVar6 = 0x22;
      goto LAB_140022e2b;
    }
    if (param_4 != 0) {
      pcVar7 = *(char **)(param_4 + 8);
      pcVar8 = (char *)((longlong)param_1 + 1);
      *(undefined *)param_1 = 0x30;
      for (; 0 < param_3; param_3 = param_3 + -1) {
        cVar1 = *pcVar7;
        pcVar5 = pcVar7 + 1;
        if (cVar1 == '\0') {
          pcVar5 = pcVar7;
          cVar1 = '0';
        }
        *pcVar8 = cVar1;
        pcVar8 = pcVar8 + 1;
        pcVar7 = pcVar5;
      }
      *pcVar8 = '\0';
      if ((-1 < param_3) && ('4' < *pcVar7)) {
        while( true ) {
          pcVar8 = pcVar8 + -1;
          if (*pcVar8 != '9') break;
          *pcVar8 = '0';
        }
        *pcVar8 = *pcVar8 + '\x01';
      }
      if (*(char *)param_1 == '1') {
        *(int *)(param_4 + 4) = *(int *)(param_4 + 4) + 1;
      }
      else {
        lVar2 = -1;
        do {
          lVar9 = lVar2;
          lVar2 = lVar9 + 1;
        } while (*(char *)((longlong)param_1 + lVar9 + 2) != '\0');
        FUN_14001b140(param_1,(undefined8 *)((longlong)param_1 + 1),lVar9 + 2);
      }
      return 0;
    }
  }
  puVar4 = __doserrno();
  uVar6 = 0x16;
LAB_140022e2b:
  *puVar4 = uVar6;
  FUN_140011e58();
  return uVar6;
}



// Library Function - Single Match
//  memcpy_s
// 
// Libraries: Visual Studio 2015, Visual Studio 2017, Visual Studio 2019

errno_t __cdecl memcpy_s(void *_Dst,rsize_t _DstSize,void *_Src,rsize_t _MaxCount)

{
  ulong *puVar1;
  ulong uVar2;
  
  if (_MaxCount == 0) {
LAB_140022f0d:
    uVar2 = 0;
  }
  else {
    if (_Dst == (void *)0x0) {
LAB_140022f16:
      puVar1 = __doserrno();
      uVar2 = 0x16;
    }
    else {
      if ((_Src != (void *)0x0) && (_MaxCount <= _DstSize)) {
        FUN_14001b140((undefined8 *)_Dst,(undefined8 *)_Src,_MaxCount);
        goto LAB_140022f0d;
      }
      FUN_14000ce30((undefined (*) [16])_Dst,0,_DstSize);
      if (_Src == (void *)0x0) goto LAB_140022f16;
      if (_MaxCount <= _DstSize) {
        return 0x16;
      }
      puVar1 = __doserrno();
      uVar2 = 0x22;
    }
    *puVar1 = uVar2;
    FUN_140011e58();
  }
  return uVar2;
}



void FUN_140022f78(ulonglong param_1,int param_2,undefined4 *param_3,char *param_4,longlong param_5)

{
  void *pvVar1;
  uint *puVar2;
  code *pcVar3;
  uint uVar4;
  ulong uVar5;
  uint uVar6;
  uint uVar7;
  undefined8 *_X;
  ulong *puVar8;
  longlong lVar9;
  byte bVar10;
  undefined4 uVar11;
  undefined8 *puVar12;
  uint uVar13;
  ulonglong uVar14;
  char *pcVar15;
  uint uVar16;
  undefined8 *puVar17;
  uint uVar18;
  uint uVar19;
  char *pcVar20;
  uint uVar21;
  int iVar22;
  uint uVar24;
  undefined8 *puVar25;
  undefined8 *puVar26;
  uint uVar27;
  uint uVar28;
  uint uVar29;
  ulonglong uVar30;
  int iVar31;
  bool bVar32;
  double dVar33;
  undefined auStackY_818 [32];
  undefined8 in_stack_fffffffffffff808;
  undefined8 in_stack_fffffffffffff810;
  undefined uVar34;
  uint in_stack_fffffffffffff828;
  byte local_7b8;
  char local_7b0;
  undefined8 *puStack_7a8;
  undefined4 *local_7a0;
  uint local_798;
  undefined8 local_794;
  undefined8 in_stack_fffffffffffffa00;
  uint uStack_5c8;
  uint uStack_5c4;
  undefined4 in_stack_fffffffffffffa40;
  undefined8 in_stack_fffffffffffffa48;
  undefined4 in_stack_fffffffffffffa50;
  undefined4 in_stack_fffffffffffffa58;
  undefined8 local_3f4;
  uint uStack_228;
  undefined8 auStack_224 [57];
  ulonglong local_58;
  undefined8 *puVar23;
  ulonglong uVar35;
  
  local_58 = DAT_140038010 ^ (ulonglong)auStackY_818;
  local_7a0 = param_3;
  fegetenv((uint *)&local_7b8);
  uVar30 = 0;
  local_7b0 = (local_7b8 & 0x1f) != 0x1f;
  if ((bool)local_7b0) {
    feholdexcept((undefined8 *)&local_7b8);
  }
  *(char **)(param_3 + 2) = param_4;
  puVar25 = (undefined8 *)0x7ff;
  uVar11 = 0x20;
  if ((longlong)param_1 < 0) {
    uVar11 = 0x2d;
  }
  *param_3 = uVar11;
  uVar14 = param_1 >> 0x34 & 0x7ff;
  uVar6 = 0;
  if ((uVar14 == 0) && ((param_1 & 0xfffffffffffff) == 0)) {
    param_3[1] = 0;
    uVar5 = FUN_140016cd4(param_4,param_5,(longlong)&DAT_14003152c);
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    goto LAB_1400241b2;
  }
  uVar7 = uVar6;
  if (uVar14 == 0x7ff) {
    if ((param_1 & 0xfffffffffffff) == 0) {
      uVar7 = 1;
    }
    else if (((longlong)param_1 < 0) && ((param_1 & 0xfffffffffffff) == 0x8000000000000)) {
      uVar7 = 4;
    }
    else {
      uVar7 = ~(uint)(param_1 >> 0x33) & 1 | 2;
    }
    param_3[1] = 1;
  }
  if (uVar7 == 1) {
    uVar5 = FUN_140016cd4(param_4,param_5,(longlong)"1#INF");
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    goto LAB_1400241b2;
  }
  if (uVar7 == 2) {
    uVar5 = FUN_140016cd4(param_4,param_5,(longlong)"1#QNAN");
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    goto LAB_1400241b2;
  }
  if (uVar7 == 3) {
    uVar5 = FUN_140016cd4(param_4,param_5,(longlong)"1#SNAN");
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    goto LAB_1400241b2;
  }
  if (uVar7 == 4) {
    uVar5 = FUN_140016cd4(param_4,param_5,(longlong)"1#IND");
    if (uVar5 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    goto LAB_1400241b2;
  }
  _X = (undefined8 *)(param_1 & 0x7fffffffffffffff);
  uVar18 = param_2 + 1;
  local_794 = (-(ulonglong)((ulonglong)_X >> 0x34 != 0) & 0x10000000000000) +
              (param_1 & 0xfffffffffffff);
  iVar31 = (-0x432 - (uint)((ulonglong)_X >> 0x34 != 0)) + (uint)((ulonglong)_X >> 0x34);
  dVar33 = log10((double)_X);
  dVar33 = ceil(dVar33);
  uVar28 = -(uint)(((int)dVar33 + 0x80000001U & 0xfffffffe) != 0) & (int)dVar33;
  uVar21 = (uint)(local_794 >> 0x20);
  uVar7 = (uint)(uVar21 != 0);
  uVar13 = uVar7 + 1;
  uVar16 = uVar28;
  if (iVar31 < 0) {
    if (iVar31 == -0x3fe) {
LAB_14002351e:
      puVar2 = (uint *)((longlong)&local_794 + (ulonglong)uVar7 * 4);
      iVar22 = 0x1f;
      bVar32 = *puVar2 != 0;
      if (bVar32) {
        for (; *puVar2 >> iVar22 == 0; iVar22 = iVar22 + -1) {
        }
      }
      uVar21 = uVar13;
      if (bVar32) {
        uVar6 = iVar22 + 1;
      }
      do {
        uVar19 = uVar21 - 1;
        if (uVar21 < uVar13) {
          puVar25 = (undefined8 *)(ulonglong)*(uint *)((longlong)&local_794 + (ulonglong)uVar21 * 4)
          ;
        }
        else {
          puVar25 = (undefined8 *)0x0;
        }
        if (uVar19 < uVar13) {
          uVar27 = *(uint *)((longlong)&local_794 + (ulonglong)uVar19 * 4);
        }
        else {
          uVar27 = 0;
        }
        *(uint *)((longlong)&local_794 + (ulonglong)uVar21 * 4) = uVar27 >> 0x1f | (int)puVar25 * 2;
        uVar21 = uVar19;
      } while (uVar19 != 0xffffffff);
      if (uVar6 == 0x20) {
        uVar13 = uVar7 + 2;
      }
      uVar6 = 1U - iVar31 >> 5;
      local_798 = uVar13;
      FUN_14000ce30((undefined (*) [16])&local_3f4,0,(ulonglong)uVar6 * 4);
      *(int *)((longlong)&local_3f4 + (ulonglong)uVar6 * 4) = 1 << ((byte)(1U - iVar31) & 0x1f);
    }
    else {
      local_3f4._4_4_ = 0x100000;
      local_3f4._0_4_ = 0;
      if (uVar21 == 0) goto LAB_14002351e;
      do {
        if (*(int *)((longlong)&local_3f4 + uVar30 * 4) !=
            *(int *)((longlong)&local_794 + uVar30 * 4)) goto LAB_14002351e;
        uVar19 = (int)uVar30 + 1;
        uVar30 = (ulonglong)uVar19;
      } while (uVar19 != 2);
      iVar22 = 0x1f;
      if (uVar21 != 0) {
        for (; uVar21 >> iVar22 == 0; iVar22 = iVar22 + -1) {
        }
      }
      if (uVar21 != 0) {
        uVar6 = iVar22 + 1;
      }
      uVar21 = uVar13;
      do {
        uVar19 = uVar21 - 1;
        if (uVar21 < uVar13) {
          puVar25 = (undefined8 *)(ulonglong)*(uint *)((longlong)&local_794 + (ulonglong)uVar21 * 4)
          ;
        }
        else {
          puVar25 = (undefined8 *)0x0;
        }
        if (uVar19 < uVar13) {
          uVar27 = *(uint *)((longlong)&local_794 + (ulonglong)uVar19 * 4);
        }
        else {
          uVar27 = 0;
        }
        *(uint *)((longlong)&local_794 + (ulonglong)uVar21 * 4) = uVar27 >> 0x1e | (int)puVar25 << 2
        ;
        uVar21 = uVar19;
      } while (uVar19 != 0xffffffff);
      if (0x20 - uVar6 < 2) {
        uVar13 = uVar7 + 2;
      }
      uVar6 = 2U - iVar31 >> 5;
      local_798 = uVar13;
      FUN_14000ce30((undefined (*) [16])&local_3f4,0,(ulonglong)uVar6 * 4);
      *(int *)((longlong)&local_3f4 + (ulonglong)uVar6 * 4) = 1 << ((byte)(2U - iVar31) & 0x1f);
    }
    uVar14 = (ulonglong)(uVar6 + 1);
    uVar30 = (ulonglong)uVar13;
    puVar17 = (undefined8 *)(uVar14 << 2);
    uStack_5c8 = uVar6 + 1;
    if (uVar14 != 0) {
      if (puVar17 < (undefined8 *)0x1cd) {
        FUN_14001b140((undefined8 *)(undefined (*) [16])&uStack_5c4,&local_3f4,(ulonglong)puVar17);
      }
      else {
        puVar17 = (undefined8 *)0x1cc;
        FUN_14000ce30((undefined (*) [16])&uStack_5c4,0,0x1cc);
        puVar8 = __doserrno();
        *puVar8 = 0x22;
        FUN_140011e58();
      }
      uVar14 = (ulonglong)uStack_5c8;
    }
  }
  else {
    local_3f4._4_4_ = 0x100000;
    local_3f4._0_4_ = 0;
    if (uVar21 == 0) {
LAB_1400232c9:
      uVar27 = iVar31 + 1U & 0x1f;
      uVar21 = iVar31 + 1U >> 5;
      puVar17 = (undefined8 *)(ulonglong)uVar21;
      bVar10 = 0x20 - (sbyte)uVar27;
      uVar19 = (int)(1L << (bVar10 & 0x3f)) - 1;
      puVar2 = (uint *)((longlong)&local_794 + (ulonglong)uVar7 * 4);
      iVar31 = 0x1f;
      bVar32 = *puVar2 != 0;
      if (bVar32) {
        for (; *puVar2 >> iVar31 == 0; iVar31 = iVar31 + -1) {
        }
      }
      if (bVar32) {
        uVar6 = iVar31 + 1;
      }
      uVar7 = uVar13 + uVar21;
      if ((uVar7 != 0x73) || (bVar32 = true, uVar27 <= 0x20 - uVar6)) {
        bVar32 = false;
      }
      if ((0x73 < uVar7) || (bVar32)) {
        uVar30 = 0;
      }
      else {
        uVar4 = 0x72;
        uVar29 = 0x72;
        if (uVar7 < 0x72) {
          uVar4 = uVar7;
          uVar29 = uVar7;
        }
        for (; (uVar4 != 0xffffffff && (uVar21 <= uVar4)); uVar4 = uVar4 - 1) {
          uVar7 = uVar4 - uVar21;
          if (uVar7 < uVar13) {
            uVar24 = *(uint *)((longlong)&local_794 + (ulonglong)uVar7 * 4);
          }
          else {
            uVar24 = 0;
          }
          if (uVar7 - 1 < uVar13) {
            uVar7 = *(uint *)((longlong)&local_794 + (ulonglong)(uVar7 - 1) * 4);
          }
          else {
            uVar7 = 0;
          }
          uVar24 = (uVar24 & uVar19) << (sbyte)uVar27;
          puVar25 = (undefined8 *)(ulonglong)uVar24;
          *(uint *)((longlong)&local_794 + (ulonglong)uVar4 * 4) =
               (uVar7 & ~uVar19) >> (bVar10 & 0x1f) | uVar24;
        }
        uVar30 = 0;
        if (uVar21 != 0) {
          do {
            *(undefined4 *)((longlong)&local_794 + uVar30 * 4) = 0;
            uVar7 = (int)uVar30 + 1;
            uVar30 = (ulonglong)uVar7;
          } while (uVar7 != uVar21);
        }
        if (0x20 - uVar6 < uVar27) {
          uVar29 = uVar29 + 1;
        }
        uVar30 = (ulonglong)uVar29;
      }
      local_3f4._4_4_ = 0;
      uVar14 = 1;
      uStack_5c8 = 1;
      local_798 = (uint)uVar30;
      uStack_5c4 = 2;
    }
    else {
      do {
        if (*(int *)((longlong)&local_3f4 + uVar30 * 4) !=
            *(int *)((longlong)&local_794 + uVar30 * 4)) goto LAB_1400232c9;
        uVar21 = (int)uVar30 + 1;
        uVar30 = (ulonglong)uVar21;
      } while (uVar21 != 2);
      uVar27 = iVar31 + 2U & 0x1f;
      uVar21 = iVar31 + 2U >> 5;
      puVar17 = (undefined8 *)(ulonglong)uVar21;
      bVar10 = 0x20 - (sbyte)uVar27;
      uVar19 = (int)(1L << (bVar10 & 0x3f)) - 1;
      puVar2 = (uint *)((longlong)&local_794 + (ulonglong)uVar7 * 4);
      iVar31 = 0x1f;
      bVar32 = *puVar2 != 0;
      if (bVar32) {
        for (; *puVar2 >> iVar31 == 0; iVar31 = iVar31 + -1) {
        }
      }
      if (bVar32) {
        uVar6 = iVar31 + 1;
      }
      uVar7 = uVar13 + uVar21;
      if ((uVar7 != 0x73) || (bVar32 = true, uVar27 <= 0x20 - uVar6)) {
        bVar32 = false;
      }
      if ((0x73 < uVar7) || (bVar32)) {
        uVar30 = 0;
      }
      else {
        uVar4 = 0x72;
        uVar29 = 0x72;
        if (uVar7 < 0x72) {
          uVar4 = uVar7;
          uVar29 = uVar7;
        }
        for (; (uVar4 != 0xffffffff && (uVar21 <= uVar4)); uVar4 = uVar4 - 1) {
          uVar7 = uVar4 - uVar21;
          if (uVar7 < uVar13) {
            uVar24 = *(uint *)((longlong)&local_794 + (ulonglong)uVar7 * 4);
          }
          else {
            uVar24 = 0;
          }
          if (uVar7 - 1 < uVar13) {
            uVar7 = *(uint *)((longlong)&local_794 + (ulonglong)(uVar7 - 1) * 4);
          }
          else {
            uVar7 = 0;
          }
          uVar24 = (uVar24 & uVar19) << (sbyte)uVar27;
          puVar25 = (undefined8 *)(ulonglong)uVar24;
          *(uint *)((longlong)&local_794 + (ulonglong)uVar4 * 4) =
               (uVar7 & ~uVar19) >> (bVar10 & 0x1f) | uVar24;
        }
        uVar30 = 0;
        if (uVar21 != 0) {
          do {
            *(undefined4 *)((longlong)&local_794 + uVar30 * 4) = 0;
            uVar7 = (int)uVar30 + 1;
            uVar30 = (ulonglong)uVar7;
          } while (uVar7 != uVar21);
        }
        if (0x20 - uVar6 < uVar27) {
          uVar29 = uVar29 + 1;
        }
        uVar30 = (ulonglong)uVar29;
      }
      local_3f4._4_4_ = 0;
      uVar14 = 1;
      uStack_5c8 = 1;
      local_798 = (uint)uVar30;
      uStack_5c4 = 4;
    }
  }
  uVar35 = 0;
  uVar7 = (uint)uVar14;
  uVar6 = (uint)uVar30;
  if ((int)uVar28 < 0) {
    uVar14 = (ulonglong)-uVar28 / 10;
    uVar13 = (uint)uVar14;
    in_stack_fffffffffffff828 = uVar13;
    while (uVar13 != 0) {
      uVar28 = (uint)uVar14;
      uVar21 = uVar28;
      if (0x26 < uVar28) {
        uVar21 = 0x26;
      }
      uVar35 = (ulonglong)uVar21;
      uVar34 = (undefined)uVar21;
      uVar19 = uVar21 - 1;
      bVar10 = (&DAT_14002cbd3)[(ulonglong)uVar19 * 4];
      uVar14 = (ulonglong)(byte)(&DAT_14002cbd2)[(ulonglong)uVar19 * 4] * 4;
      uVar6 = (uint)bVar10 + (uint)(byte)(&DAT_14002cbd2)[(ulonglong)uVar19 * 4];
      FUN_14000ce30((undefined (*) [16])&local_3f4,0,uVar14);
      puVar17 = (undefined8 *)((ulonglong)bVar10 << 2);
      FUN_14001b140((undefined8 *)((longlong)&local_3f4 + uVar14),
                    (undefined8 *)
                    (&DAT_14002c2c0 +
                    (ulonglong)*(ushort *)(&DAT_14002cbd0 + (ulonglong)uVar19 * 4) * 4),
                    (ulonglong)puVar17);
      uVar19 = (uint)uVar30;
      if (uVar6 < 2) {
        uVar14 = (ulonglong)(uint)local_3f4;
        if ((uint)local_3f4 == 0) {
LAB_140023b53:
          uVar30 = 0;
LAB_140023b56:
          local_798 = (uint)uVar30;
          goto LAB_140023e28;
        }
        if (((uint)local_3f4 == 1) || (uVar19 == 0)) goto LAB_140023e28;
        puVar17 = (undefined8 *)0x0;
        puVar25 = (undefined8 *)0x0;
        do {
          puVar17 = (undefined8 *)
                    (*(uint *)((longlong)&local_794 + (longlong)puVar25 * 4) * uVar14 +
                    (longlong)puVar17);
          *(int *)((longlong)&local_794 + (longlong)puVar25 * 4) = (int)puVar17;
          puVar17 = (undefined8 *)((ulonglong)puVar17 >> 0x20);
          uVar6 = (int)puVar25 + 1;
          puVar25 = (undefined8 *)(ulonglong)uVar6;
        } while (uVar6 != uVar19);
LAB_140023b9d:
        if ((int)puVar17 == 0) {
          uVar30 = (ulonglong)local_798;
          goto LAB_140023e28;
        }
        if (local_798 < 0x73) {
          *(int *)((longlong)&local_794 + (ulonglong)local_798 * 4) = (int)puVar17;
          uVar30 = (ulonglong)(local_798 + 1);
          goto LAB_140023b56;
        }
        uVar30 = 0;
        local_798 = 0;
        bVar32 = false;
      }
      else {
        if (uVar19 < 2) {
          uVar14 = local_794 & 0xffffffff;
          puVar17 = (undefined8 *)((ulonglong)uVar6 << 2);
          local_798 = uVar6;
          if ((ulonglong)uVar6 != 0) {
            if (puVar17 < (undefined8 *)0x1cd) {
              FUN_14001b140((undefined8 *)(undefined (*) [16])&local_794,&local_3f4,
                            (ulonglong)puVar17);
            }
            else {
              puVar17 = (undefined8 *)0x1cc;
              FUN_14000ce30((undefined (*) [16])&local_794,0,0x1cc);
              puVar8 = __doserrno();
              *puVar8 = 0x22;
              FUN_140011e58();
            }
          }
          uVar30 = (ulonglong)local_798;
          if ((int)local_794 == 0) goto LAB_140023b53;
          if (((int)local_794 != 1) && (local_798 != 0)) {
            puVar17 = (undefined8 *)0x0;
            puVar25 = (undefined8 *)0x0;
            do {
              puVar17 = (undefined8 *)
                        (*(uint *)((longlong)&local_794 + (longlong)puVar25 * 4) * uVar14 +
                        (longlong)puVar17);
              *(int *)((longlong)&local_794 + (longlong)puVar25 * 4) = (int)puVar17;
              puVar17 = (undefined8 *)((ulonglong)puVar17 >> 0x20);
              uVar6 = (int)puVar25 + 1;
              puVar25 = (undefined8 *)(ulonglong)uVar6;
            } while (uVar6 != local_798);
            goto LAB_140023b9d;
          }
        }
        else {
          bVar32 = uVar6 < uVar19;
          puStack_7a8 = &local_3f4;
          if (!bVar32) {
            puStack_7a8 = &local_794;
          }
          _X = &local_3f4;
          uVar28 = uVar19;
          if (bVar32) {
            uVar28 = uVar6;
          }
          if (bVar32) {
            uVar6 = uVar19;
            _X = &local_794;
          }
          uVar30 = 0;
          puVar25 = (undefined8 *)0x0;
          uStack_228 = 0;
          if (uVar28 != 0) {
            do {
              uVar19 = *(uint *)((longlong)puStack_7a8 + (longlong)puVar25 * 4);
              iVar31 = (int)puVar25;
              if (uVar19 == 0) {
                if (iVar31 == (int)uVar30) {
                  *(undefined4 *)((longlong)auStack_224 + (longlong)puVar25 * 4) = 0;
                  uVar30 = (ulonglong)(iVar31 + 1U);
                  uStack_228 = iVar31 + 1U;
                }
              }
              else {
                uVar14 = 0;
                puVar17 = puVar25;
                if (uVar6 != 0) {
                  puVar12 = puVar25;
                  do {
                    iVar22 = (int)puVar12;
                    puVar17 = puVar12;
                    if (iVar22 == 0x73) break;
                    if (iVar22 == (int)uVar30) {
                      *(undefined4 *)((longlong)auStack_224 + (longlong)puVar12 * 4) = 0;
                      uStack_228 = iVar22 + 1;
                    }
                    puVar17 = (undefined8 *)(ulonglong)(iVar22 + 1U);
                    uVar14 = uVar14 + (ulonglong)
                                      *(uint *)((longlong)_X +
                                               (ulonglong)(uint)(-iVar31 + iVar22) * 4) *
                                      (ulonglong)uVar19 +
                                      (ulonglong)
                                      *(uint *)((longlong)auStack_224 + (longlong)puVar12 * 4);
                    *(int *)((longlong)auStack_224 + (longlong)puVar12 * 4) = (int)uVar14;
                    uVar30 = (ulonglong)uStack_228;
                    uVar14 = uVar14 >> 0x20;
                    puVar12 = puVar17;
                  } while (-iVar31 + iVar22 + 1U != uVar6);
                  uVar19 = (uint)uVar14;
                  while (uVar19 != 0) {
                    iVar22 = (int)puVar17;
                    if (iVar22 == 0x73) goto LAB_140023ec8;
                    if (iVar22 == (int)uVar30) {
                      *(undefined4 *)((longlong)auStack_224 + (longlong)puVar17 * 4) = 0;
                      uStack_228 = iVar22 + 1;
                    }
                    lVar9 = *(uint *)((longlong)auStack_224 + (longlong)puVar17 * 4) + uVar14;
                    *(int *)((longlong)auStack_224 + (longlong)puVar17 * 4) = (int)lVar9;
                    uVar30 = (ulonglong)uStack_228;
                    uVar19 = (uint)((ulonglong)lVar9 >> 0x20);
                    uVar14 = (ulonglong)uVar19;
                    puVar17 = (undefined8 *)(ulonglong)(iVar22 + 1);
                  }
                }
                if ((int)puVar17 == 0x73) goto LAB_140023ec8;
              }
              puVar25 = (undefined8 *)(ulonglong)(iVar31 + 1U);
            } while (iVar31 + 1U != uVar28);
          }
          local_798 = (uint)uVar30;
          puVar17 = (undefined8 *)(uVar30 << 2);
          uVar28 = uVar13;
          if (uVar30 != 0) {
            if (puVar17 < (undefined8 *)0x1cd) {
              FUN_14001b140((undefined8 *)(undefined (*) [16])&local_794,auStack_224,
                            (ulonglong)puVar17);
              uVar28 = uVar13;
            }
            else {
              puVar17 = (undefined8 *)0x1cc;
              FUN_14000ce30((undefined (*) [16])&local_794,0,0x1cc);
              puVar8 = __doserrno();
              *puVar8 = 0x22;
              FUN_140011e58();
              uVar28 = uVar13;
            }
            uVar30 = (ulonglong)local_798;
            uVar13 = uVar28;
          }
        }
LAB_140023e28:
        bVar32 = true;
      }
      uVar6 = (uint)uVar30;
      if (!bVar32) goto LAB_140023ec8;
      uVar13 = uVar28 - uVar21;
      uVar14 = (ulonglong)uVar13;
    }
    uVar34 = (undefined)uVar35;
    iVar31 = -uVar28 + in_stack_fffffffffffff828 * -10;
    if (iVar31 == 0) goto LAB_140023ee1;
    uVar21 = *(uint *)(&DAT_14002cc68 + (ulonglong)(iVar31 - 1) * 4);
    if (uVar21 != 0) {
      if ((uVar21 != 1) && (uVar6 != 0)) {
        puVar17 = (undefined8 *)0x0;
        puVar25 = (undefined8 *)0x0;
        do {
          puVar12 = (undefined8 *)
                    ((ulonglong)*(uint *)((longlong)&local_794 + (longlong)puVar25 * 4) *
                     (ulonglong)uVar21 + (longlong)puVar17);
          *(int *)((longlong)&local_794 + (longlong)puVar25 * 4) = (int)puVar12;
          puVar17 = (undefined8 *)((ulonglong)puVar12 >> 0x20);
          uVar28 = (int)puVar25 + 1;
          puVar25 = (undefined8 *)(ulonglong)uVar28;
        } while (uVar28 != uVar6);
        iVar31 = (int)((ulonglong)puVar12 >> 0x20);
        uVar6 = local_798;
        if (iVar31 != 0) {
          if (0x72 < local_798) goto LAB_140023ec8;
          *(int *)((longlong)&local_794 + (ulonglong)local_798 * 4) = iVar31;
          local_798 = local_798 + 1;
          uVar6 = local_798;
        }
      }
      goto LAB_140023ee1;
    }
LAB_140023ec8:
    local_798 = 0;
    uVar21 = uVar16;
  }
  else {
    uVar35 = (ulonglong)uVar28 / 10;
    uVar13 = (uint)uVar35;
    uVar30 = uVar35;
    while (uVar13 != 0) {
      uVar21 = (uint)uVar30;
      uVar28 = uVar21;
      if (0x26 < uVar21) {
        uVar28 = 0x26;
      }
      uVar7 = uVar28 - 1;
      bVar10 = (&DAT_14002cbd3)[(ulonglong)uVar7 * 4];
      uVar30 = (ulonglong)(byte)(&DAT_14002cbd2)[(ulonglong)uVar7 * 4] * 4;
      uVar19 = (uint)bVar10 + (uint)(byte)(&DAT_14002cbd2)[(ulonglong)uVar7 * 4];
      in_stack_fffffffffffff828 = uVar28;
      FUN_14000ce30((undefined (*) [16])&local_3f4,0,uVar30);
      puVar17 = (undefined8 *)((ulonglong)bVar10 << 2);
      FUN_14001b140((undefined8 *)((longlong)&local_3f4 + uVar30),
                    (undefined8 *)
                    (&DAT_14002c2c0 +
                    (ulonglong)*(ushort *)(&DAT_14002cbd0 + (ulonglong)uVar7 * 4) * 4),
                    (ulonglong)puVar17);
      uVar7 = uStack_5c4;
      uVar27 = (uint)uVar14;
      if (uVar19 < 2) {
        uVar30 = (ulonglong)(uint)local_3f4;
        if ((uint)local_3f4 == 0) {
LAB_1400236b3:
          uVar14 = 0;
LAB_1400236b6:
          uStack_5c8 = (uint)uVar14;
          goto LAB_1400239c0;
        }
        if (((uint)local_3f4 == 1) || (uVar27 == 0)) goto LAB_1400239c0;
        puVar17 = (undefined8 *)0x0;
        puVar25 = (undefined8 *)0x0;
        do {
          puVar17 = (undefined8 *)((&uStack_5c4)[(longlong)puVar25] * uVar30 + (longlong)puVar17);
          (&uStack_5c4)[(longlong)puVar25] = (uint)puVar17;
          puVar17 = (undefined8 *)((ulonglong)puVar17 >> 0x20);
          uVar7 = (int)puVar25 + 1;
          puVar25 = (undefined8 *)(ulonglong)uVar7;
        } while (uVar7 != uVar27);
LAB_140023706:
        if ((uint)puVar17 == 0) {
          uVar14 = (ulonglong)uStack_5c8;
          goto LAB_1400239c0;
        }
        if (uStack_5c8 < 0x73) {
          (&uStack_5c4)[uStack_5c8] = (uint)puVar17;
          uVar14 = (ulonglong)(uStack_5c8 + 1);
          goto LAB_1400236b6;
        }
        uVar14 = 0;
        uStack_5c8 = 0;
        bVar32 = false;
      }
      else {
        if (uVar27 < 2) {
          uVar30 = (ulonglong)uStack_5c4;
          puVar17 = (undefined8 *)((ulonglong)uVar19 << 2);
          uStack_5c8 = uVar19;
          if ((ulonglong)uVar19 != 0) {
            if (puVar17 < (undefined8 *)0x1cd) {
              FUN_14001b140((undefined8 *)(undefined (*) [16])&uStack_5c4,&local_3f4,
                            (ulonglong)puVar17);
            }
            else {
              puVar17 = (undefined8 *)0x1cc;
              FUN_14000ce30((undefined (*) [16])&uStack_5c4,0,0x1cc);
              puVar8 = __doserrno();
              *puVar8 = 0x22;
              FUN_140011e58();
            }
          }
          uVar14 = (ulonglong)uStack_5c8;
          if (uVar7 == 0) goto LAB_1400236b3;
          if ((uVar7 != 1) && (uStack_5c8 != 0)) {
            puVar17 = (undefined8 *)0x0;
            puVar25 = (undefined8 *)0x0;
            do {
              puVar17 = (undefined8 *)
                        ((&uStack_5c4)[(longlong)puVar25] * uVar30 + (longlong)puVar17);
              (&uStack_5c4)[(longlong)puVar25] = (uint)puVar17;
              puVar17 = (undefined8 *)((ulonglong)puVar17 >> 0x20);
              uVar7 = (int)puVar25 + 1;
              puVar25 = (undefined8 *)(ulonglong)uVar7;
            } while (uVar7 != uStack_5c8);
            goto LAB_140023706;
          }
        }
        else {
          bVar32 = uVar19 < uVar27;
          puVar12 = &local_3f4;
          if (!bVar32) {
            puVar12 = (undefined8 *)&uStack_5c4;
          }
          uVar7 = uVar27;
          if (bVar32) {
            uVar7 = uVar19;
          }
          _X = &local_3f4;
          if (bVar32) {
            uVar19 = uVar27;
            _X = (undefined8 *)&uStack_5c4;
          }
          uVar14 = 0;
          puVar25 = (undefined8 *)0x0;
          uStack_228 = 0;
          if (uVar7 != 0) {
            do {
              uVar21 = *(uint *)((longlong)puVar12 + (longlong)puVar25 * 4);
              iVar31 = (int)puVar25;
              if (uVar21 == 0) {
                if (iVar31 == (int)uVar14) {
                  *(undefined4 *)((longlong)auStack_224 + (longlong)puVar25 * 4) = 0;
                  uVar14 = (ulonglong)(iVar31 + 1U);
                  uStack_228 = iVar31 + 1U;
                }
              }
              else {
                uVar30 = 0;
                puVar17 = puVar25;
                if (uVar19 != 0) {
                  puVar23 = puVar25;
                  do {
                    iVar22 = (int)puVar23;
                    puVar17 = puVar23;
                    if (iVar22 == 0x73) break;
                    if (iVar22 == (int)uVar14) {
                      *(undefined4 *)((longlong)auStack_224 + (longlong)puVar23 * 4) = 0;
                      uStack_228 = iVar22 + 1;
                    }
                    puVar17 = (undefined8 *)(ulonglong)(iVar22 + 1U);
                    uVar30 = uVar30 + (ulonglong)
                                      *(uint *)((longlong)_X +
                                               (ulonglong)(uint)(iVar22 + -iVar31) * 4) *
                                      (ulonglong)uVar21 +
                             (ulonglong)*(uint *)((longlong)auStack_224 + (longlong)puVar23 * 4);
                    *(int *)((longlong)auStack_224 + (longlong)puVar23 * 4) = (int)uVar30;
                    uVar14 = (ulonglong)uStack_228;
                    uVar30 = uVar30 >> 0x20;
                    puVar23 = puVar17;
                  } while (iVar22 + 1U + -iVar31 != uVar19);
                  uVar21 = (uint)uVar30;
                  while (uVar21 != 0) {
                    iVar22 = (int)puVar17;
                    if (iVar22 == 0x73) goto LAB_140023a70;
                    if (iVar22 == (int)uVar14) {
                      *(undefined4 *)((longlong)auStack_224 + (longlong)puVar17 * 4) = 0;
                      uStack_228 = iVar22 + 1;
                    }
                    lVar9 = uVar30 + *(uint *)((longlong)auStack_224 + (longlong)puVar17 * 4);
                    *(int *)((longlong)auStack_224 + (longlong)puVar17 * 4) = (int)lVar9;
                    uVar14 = (ulonglong)uStack_228;
                    uVar21 = (uint)((ulonglong)lVar9 >> 0x20);
                    uVar30 = (ulonglong)uVar21;
                    puVar17 = (undefined8 *)(ulonglong)(iVar22 + 1);
                  }
                }
                if ((int)puVar17 == 0x73) goto LAB_140023a70;
              }
              puVar25 = (undefined8 *)(ulonglong)(iVar31 + 1U);
            } while (iVar31 + 1U != uVar7);
          }
          puVar17 = (undefined8 *)(uVar14 << 2);
          uStack_5c8 = (uint)uVar14;
          uVar21 = uVar13;
          uVar28 = in_stack_fffffffffffff828;
          if (uVar14 != 0) {
            if (puVar17 < (undefined8 *)0x1cd) {
              FUN_14001b140((undefined8 *)(undefined (*) [16])&uStack_5c4,auStack_224,
                            (ulonglong)puVar17);
              uVar21 = uVar13;
              uVar28 = in_stack_fffffffffffff828;
            }
            else {
              puVar17 = (undefined8 *)0x1cc;
              FUN_14000ce30((undefined (*) [16])&uStack_5c4,0,0x1cc);
              puVar8 = __doserrno();
              *puVar8 = 0x22;
              FUN_140011e58();
              uVar21 = uVar13;
              uVar28 = in_stack_fffffffffffff828;
            }
            uVar14 = (ulonglong)uStack_5c8;
            uVar13 = uVar21;
            in_stack_fffffffffffff828 = uVar28;
          }
        }
LAB_1400239c0:
        bVar32 = true;
      }
      uVar7 = (uint)uVar14;
      if (!bVar32) {
LAB_140023a70:
        uStack_5c8 = 0;
        uVar7 = 0;
        goto LAB_140023ee1;
      }
      uVar13 = uVar21 - uVar28;
      uVar30 = (ulonglong)uVar13;
    }
    iVar31 = uVar16 + (uint)uVar35 * -10;
    if (iVar31 != 0) {
      uVar21 = *(uint *)(&DAT_14002cc68 + (ulonglong)(iVar31 - 1) * 4);
      if (uVar21 == 0) {
LAB_140023a7f:
        uStack_5c8 = 0;
LAB_140023a82:
        uVar7 = uStack_5c8;
      }
      else if ((uVar21 != 1) && (uVar7 != 0)) {
        puVar17 = (undefined8 *)0x0;
        puVar25 = (undefined8 *)0x0;
        do {
          puVar12 = (undefined8 *)
                    ((ulonglong)(&uStack_5c4)[(longlong)puVar25] * (ulonglong)uVar21 +
                    (longlong)puVar17);
          (&uStack_5c4)[(longlong)puVar25] = (uint)puVar12;
          puVar17 = (undefined8 *)((ulonglong)puVar12 >> 0x20);
          uVar28 = (int)puVar25 + 1;
          puVar25 = (undefined8 *)(ulonglong)uVar28;
        } while (uVar28 != uVar7);
        uVar21 = (uint)((ulonglong)puVar12 >> 0x20);
        uVar7 = uStack_5c8;
        if (uVar21 != 0) {
          if (0x72 < uStack_5c8) goto LAB_140023a7f;
          (&uStack_5c4)[uStack_5c8] = uVar21;
          uStack_5c8 = uStack_5c8 + 1;
          goto LAB_140023a82;
        }
      }
    }
LAB_140023ee1:
    uVar34 = (undefined)uVar35;
    puVar12 = (undefined8 *)0x0;
    puVar23 = puVar12;
    uVar21 = uVar16;
    if (uVar6 != 0) {
      do {
        uVar28 = (int)puVar23 + 1;
        puVar25 = (undefined8 *)(ulonglong)uVar28;
        pvVar1 = (void *)((longlong)puVar12 +
                         (ulonglong)*(uint *)((longlong)&local_794 + (longlong)puVar23 * 4) * 10);
        *(int *)((longlong)&local_794 + (longlong)puVar23 * 4) = (int)pvVar1;
        puVar17 = (undefined8 *)((ulonglong)pvVar1 >> 0x20);
        puVar12 = puVar17;
        puVar23 = puVar25;
      } while (uVar28 != uVar6);
      iVar31 = (int)((ulonglong)pvVar1 >> 0x20);
      if (iVar31 != 0) {
        if (local_798 < 0x73) {
          *(int *)((longlong)&local_794 + (ulonglong)local_798 * 4) = iVar31;
          local_798 = local_798 + 1;
        }
        else {
          puVar25 = (undefined8 *)0x0;
          puVar17 = &local_3f4;
          local_798 = 0;
          memcpy_s(&local_794,0x1cc,puVar17,0);
        }
      }
    }
  }
  puVar12 = (undefined8 *)0x0;
  uVar30 = FUN_140024250(&local_798,&uStack_5c8,(char)puVar17,(char)puVar25,
                         in_stack_fffffffffffff808,in_stack_fffffffffffff810,CONCAT44(uVar13,uVar21)
                         ,uVar34,(char)in_stack_fffffffffffff828,(char)_X,in_stack_fffffffffffffa00,
                         in_stack_fffffffffffffa40,in_stack_fffffffffffffa48,
                         in_stack_fffffffffffffa50,in_stack_fffffffffffffa58);
  if ((int)uVar30 == 10) {
    uVar16 = uVar16 + 1;
    *param_4 = '1';
    pcVar15 = param_4 + 1;
    puVar25 = puVar12;
    puVar17 = puVar12;
    if (uVar7 != 0) {
      do {
        uVar6 = (int)puVar17 + 1;
        pvVar1 = (void *)((longlong)puVar25 + (ulonglong)(&uStack_5c4)[(longlong)puVar17] * 10);
        (&uStack_5c4)[(longlong)puVar17] = (uint)pvVar1;
        puVar25 = (undefined8 *)((ulonglong)pvVar1 >> 0x20);
        puVar17 = (undefined8 *)(ulonglong)uVar6;
      } while (uVar6 != uVar7);
      uVar6 = (uint)((ulonglong)pvVar1 >> 0x20);
      if (uVar6 != 0) {
        if (uStack_5c8 < 0x73) {
          (&uStack_5c4)[uStack_5c8] = uVar6;
          uStack_5c8 = uStack_5c8 + 1;
        }
        else {
          uStack_5c8 = 0;
          memcpy_s(&uStack_5c4,0x1cc,&local_3f4,0);
        }
      }
    }
  }
  else if ((int)uVar30 == 0) {
    uVar16 = uVar16 - 1;
    pcVar15 = param_4;
  }
  else {
    pcVar15 = param_4 + 1;
    *param_4 = (char)uVar30 + '0';
  }
  local_7a0[1] = uVar16;
  if ((-1 < (int)uVar16) && (uVar18 < 0x80000000)) {
    uVar18 = uVar18 + uVar16;
  }
  uVar30 = (ulonglong)uVar18;
  if (param_5 - 1U < (ulonglong)uVar18) {
    uVar30 = param_5 - 1U;
  }
  pcVar20 = param_4 + uVar30;
  while ((pcVar15 != pcVar20 && (puVar25 = puVar12, puVar17 = puVar12, local_798 != 0))) {
    do {
      uVar6 = (int)puVar17 + 1;
      puVar26 = (undefined8 *)(ulonglong)uVar6;
      puVar23 = puVar25 + (ulonglong)*(uint *)((longlong)&local_794 + (longlong)puVar17 * 4) *
                          125000000;
      *(int *)((longlong)&local_794 + (longlong)puVar17 * 4) = (int)puVar23;
      puVar25 = (undefined8 *)((ulonglong)puVar23 >> 0x20);
      puVar17 = puVar26;
    } while (uVar6 != local_798);
    iVar31 = (int)((ulonglong)puVar23 >> 0x20);
    if (iVar31 != 0) {
      if (local_798 < 0x73) {
        *(int *)((longlong)&local_794 + (ulonglong)local_798 * 4) = iVar31;
        local_798 = local_798 + 1;
      }
      else {
        puVar26 = (undefined8 *)0x0;
        puVar25 = &local_3f4;
        local_798 = 0;
        memcpy_s(&local_794,0x1cc,puVar25,0);
      }
    }
    uVar30 = FUN_140024250(&local_798,&uStack_5c8,(char)puVar25,(char)puVar26,
                           in_stack_fffffffffffff808,in_stack_fffffffffffff810,
                           CONCAT44(uVar13,uVar21),uVar34,(char)in_stack_fffffffffffff828,(char)_X,
                           in_stack_fffffffffffffa00,in_stack_fffffffffffffa40,
                           in_stack_fffffffffffffa48,in_stack_fffffffffffffa50,
                           in_stack_fffffffffffffa58);
    uVar6 = 8;
    do {
      uVar14 = (uVar30 & 0xffffffff) / 10;
      if (uVar6 <= (uint)((int)pcVar20 - (int)pcVar15)) {
        pcVar15[uVar6] = (char)uVar30 + (char)uVar14 * -10 + '0';
      }
      uVar6 = uVar6 - 1;
      uVar30 = uVar14;
    } while (uVar6 != 0xffffffff);
    lVar9 = (longlong)pcVar20 - (longlong)pcVar15;
    if (9 < lVar9) {
      lVar9 = 9;
    }
    pcVar15 = pcVar15 + lVar9;
  }
  *pcVar15 = '\0';
LAB_1400241b2:
  if (local_7b0 != '\0') {
    fesetenv((int *)&local_7b8);
  }
  __security_check_cookie(local_58 ^ (ulonglong)auStackY_818);
  return;
}



ulonglong FUN_140024250(uint *param_1,uint *param_2,undefined param_3,undefined param_4,
                       undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined param_8,
                       undefined param_9,undefined param_10,undefined8 param_11,undefined4 param_12,
                       undefined8 param_13,undefined4 param_14,undefined4 param_15)

{
  byte bVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  byte bVar6;
  uint uVar7;
  uint *puVar8;
  uint uVar9;
  uint uVar10;
  ulonglong uVar11;
  longlong lVar12;
  longlong lVar13;
  int iVar14;
  uint uVar15;
  ulonglong uVar16;
  int iVar17;
  uint uVar18;
  int iVar19;
  uint uVar20;
  uint uVar21;
  uint uStackX_8;
  ulonglong uStack_230;
  undefined local_214 [468];
  
  if (*param_1 == 0) {
    return 0;
  }
  uVar7 = *param_2;
  if (uVar7 == 0) {
    return 0;
  }
  uVar9 = uVar7 - 1;
  uVar18 = *param_1 - 1;
  uVar16 = (ulonglong)uVar18;
  if (uVar9 == 0) {
    uVar7 = param_2[1];
    uVar11 = 0;
    if (uVar7 == 1) {
      uVar7 = param_1[1];
      *param_1 = 0;
      memcpy_s(param_1 + 1,0x1cc,local_214,0);
      uVar3 = (ulonglong)uVar7;
    }
    else {
      uVar3 = uVar11;
      if (uVar18 == 0) {
        uVar9 = param_1[1];
        *param_1 = 0;
        memcpy_s(param_1 + 1,0x1cc,local_214,0);
        uVar3 = (ulonglong)uVar9 / (ulonglong)uVar7;
        uVar9 = uVar9 % uVar7;
        param_1[1] = uVar9;
        *param_1 = (uint)(uVar9 != 0);
      }
      else {
        while (uVar18 != 0xffffffff) {
          lVar12 = uVar16 + 1;
          uVar18 = (int)uVar16 - 1;
          uVar16 = (ulonglong)uVar18;
          uVar2 = (ulonglong)param_1[lVar12] | uVar11 << 0x20;
          uVar11 = uVar2 % (ulonglong)uVar7;
          uVar3 = (uVar3 << 0x20) + (ulonglong)SUB164(ZEXT816(uVar2) / ZEXT416(uVar7),0);
        }
        *param_1 = 0;
        memcpy_s(param_1 + 1,0x1cc,local_214,0);
        param_1[1] = (uint)uVar11;
        param_1[2] = 0;
        *param_1 = 1;
      }
    }
  }
  else {
    if (uVar9 <= uVar18) {
      lVar12 = (longlong)(int)uVar18;
      iVar14 = uVar18 - uVar9;
      lVar13 = (longlong)iVar14;
      if (lVar13 <= lVar12) {
        puVar8 = param_1 + lVar12 + 1;
        uVar3 = uVar16;
        do {
          iVar17 = (int)uVar3;
          if (*(uint *)((longlong)param_2 + (lVar13 * -4 - (longlong)param_1) + (longlong)puVar8) !=
              *puVar8) {
            if (param_1[(longlong)iVar17 + 1] <= param_2[(longlong)(iVar17 - iVar14) + 1])
            goto LAB_140024416;
            break;
          }
          uVar3 = (ulonglong)(iVar17 - 1);
          lVar12 = lVar12 + -1;
          puVar8 = puVar8 + -1;
        } while (lVar13 <= lVar12);
      }
      iVar14 = iVar14 + 1;
LAB_140024416:
      if (iVar14 != 0) {
        uVar9 = param_2[(ulonglong)(uVar7 - 1) + 1];
        uStackX_8 = param_2[(ulonglong)(uVar7 - 2) + 1];
        iVar17 = 0x1f;
        if (uVar9 != 0) {
          for (; uVar9 >> iVar17 == 0; iVar17 = iVar17 + -1) {
          }
        }
        iVar19 = 0x20;
        if (uVar9 != 0) {
          iVar19 = 0x1f - iVar17;
        }
        bVar1 = (byte)iVar19;
        bVar6 = 0x20 - bVar1;
        if (iVar19 != 0) {
          uVar10 = uStackX_8 >> (bVar6 & 0x1f);
          uStackX_8 = uStackX_8 << (bVar1 & 0x1f);
          uVar9 = uVar10 | uVar9 << (bVar1 & 0x1f);
          if (2 < uVar7) {
            uStackX_8 = uStackX_8 | param_2[(ulonglong)(uVar7 - 3) + 1] >> (bVar6 & 0x1f);
          }
        }
        uVar10 = 0;
        iVar14 = iVar14 + -1;
        uVar3 = 0;
        if (-1 < iVar14) {
          uVar21 = iVar14 + uVar7;
          uVar11 = (ulonglong)uVar9;
          do {
            uVar9 = uVar10;
            if (uVar21 <= (uint)uVar16) {
              uVar9 = param_1[(ulonglong)uVar21 + 1];
            }
            uVar18 = param_1[(ulonglong)(uVar21 - 2) + 1];
            uVar2 = (ulonglong)uVar18;
            uStack_230 = CONCAT44(uVar9,param_1[(ulonglong)(uVar21 - 1) + 1]);
            if (iVar19 != 0) {
              uStack_230 = (ulonglong)(uVar18 >> (bVar6 & 0x3f)) | uStack_230 << (bVar1 & 0x3f);
              uVar18 = uVar18 << (bVar1 & 0x1f);
              uVar2 = (ulonglong)uVar18;
              if (2 < uVar21) {
                uVar2 = (ulonglong)(uVar18 | param_1[(ulonglong)(uVar21 - 3) + 1] >> (bVar6 & 0x1f))
                ;
              }
            }
            uVar4 = uStack_230 / uVar11;
            uStack_230 = uStack_230 % uVar11;
            if (0xffffffff < uVar4) {
              lVar12 = uVar4 - 0xffffffff;
              uVar4 = 0xffffffff;
              uStack_230 = uStack_230 + lVar12 * uVar11;
            }
            if (uStack_230 < 0x100000000) {
              uVar5 = uStackX_8 * uVar4;
              do {
                if (uVar5 <= (uStack_230 << 0x20 | uVar2)) break;
                uVar4 = uVar4 - 1;
                uVar5 = uVar5 - uStackX_8;
                uStack_230 = uStack_230 + uVar11;
              } while (uStack_230 < 0x100000000);
            }
            if (uVar4 != 0) {
              uVar16 = 0;
              uVar18 = uVar10;
              puVar8 = param_2;
              if (uVar7 != 0) {
                do {
                  uVar16 = uVar16 + puVar8[1] * uVar4;
                  uVar2 = uVar16 >> 0x20;
                  uVar15 = (uint)uVar16;
                  uVar16 = uVar2 + 1;
                  if (uVar15 <= param_1[(ulonglong)(uVar18 + iVar14) + 1]) {
                    uVar16 = uVar2;
                  }
                  uVar20 = uVar18 + 1;
                  param_1[(ulonglong)(uVar18 + iVar14) + 1] =
                       param_1[(ulonglong)(uVar18 + iVar14) + 1] - uVar15;
                  uVar18 = uVar20;
                  puVar8 = puVar8 + 1;
                } while (uVar20 < uVar7);
              }
              if (uVar9 < uVar16) {
                uVar16 = 0;
                uVar9 = uVar10;
                puVar8 = param_2;
                if (uVar7 != 0) {
                  do {
                    uVar18 = uVar9 + 1;
                    uVar16 = puVar8[1] + uVar16 +
                             (ulonglong)param_1[(ulonglong)(uVar9 + iVar14) + 1];
                    param_1[(ulonglong)(uVar9 + iVar14) + 1] = (uint)uVar16;
                    uVar16 = uVar16 >> 0x20;
                    uVar9 = uVar18;
                    puVar8 = puVar8 + 1;
                  } while (uVar18 < uVar7);
                }
                uVar4 = uVar4 - 1;
              }
              uVar16 = (ulonglong)(uVar21 - 1);
            }
            uVar18 = (uint)uVar16;
            uVar21 = uVar21 - 1;
            uVar3 = (uVar3 << 0x20) + (uVar4 & 0xffffffff);
            iVar14 = iVar14 + -1;
          } while (-1 < iVar14);
        }
        uVar18 = uVar18 + 1;
        uVar16 = (ulonglong)uVar18;
        uVar11 = uVar16;
        if (uVar18 < *param_1) {
          do {
            uVar7 = (int)uVar11 + 1;
            param_1[uVar11 + 1] = 0;
            uVar11 = (ulonglong)uVar7;
          } while (uVar7 < *param_1);
        }
        *param_1 = uVar18;
        while( true ) {
          if (uVar18 == 0) {
            return uVar3;
          }
          uVar18 = (int)uVar16 - 1;
          uVar16 = (ulonglong)uVar18;
          if (param_1[uVar16 + 1] != 0) break;
          *param_1 = uVar18;
        }
        return uVar3;
      }
    }
    uVar3 = 0;
  }
  return uVar3;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_1400246e0(undefined *param_1,ulonglong param_2,ulonglong param_3,undefined *param_4)

{
  undefined uVar1;
  int iVar2;
  ulong *puVar3;
  undefined *puVar4;
  longlong lVar5;
  undefined *puVar6;
  undefined *puVar7;
  ulonglong uVar8;
  undefined *puVar9;
  undefined *puVar10;
  undefined auStack_468 [32];
  longlong local_448;
  undefined8 auStack_438 [62];
  undefined8 auStack_248 [62];
  ulonglong local_58;
  
  local_58 = DAT_140038010 ^ (ulonglong)auStack_468;
  if ((((param_1 == (undefined *)0x0) && (param_2 != 0)) || (param_3 == 0)) ||
     (param_4 == (undefined *)0x0)) {
    puVar3 = __doserrno();
    *puVar3 = 0x16;
    FUN_140011e58();
  }
  else if (1 < param_2) {
    local_448 = 0;
    puVar10 = param_1 + (param_2 - 1) * param_3;
LAB_140024780:
    while (uVar8 = (ulonglong)((longlong)puVar10 - (longlong)param_1) / param_3 + 1, 8 < uVar8) {
      lVar5 = (uVar8 >> 1) * param_3;
      puVar6 = param_1 + lVar5;
      iVar2 = (*(code *)param_4)(param_1,puVar6);
      if ((0 < iVar2) && (puVar9 = puVar6, uVar8 = param_3, param_1 != puVar6)) {
        do {
          uVar1 = puVar9[-lVar5];
          puVar9[-lVar5] = *puVar9;
          *puVar9 = uVar1;
          puVar9 = puVar9 + 1;
          uVar8 = uVar8 - 1;
        } while (uVar8 != 0);
      }
      iVar2 = (*(code *)param_4)(param_1,puVar10);
      if ((0 < iVar2) && (param_1 != puVar10)) {
        puVar9 = puVar10;
        uVar8 = param_3;
        do {
          uVar1 = puVar9[(longlong)param_1 - (longlong)puVar10];
          puVar9[(longlong)param_1 - (longlong)puVar10] = *puVar9;
          *puVar9 = uVar1;
          puVar9 = puVar9 + 1;
          uVar8 = uVar8 - 1;
        } while (uVar8 != 0);
      }
      iVar2 = (*(code *)param_4)(puVar6);
      puVar9 = param_1;
      puVar7 = puVar10;
      if ((0 < iVar2) && (puVar6 != puVar10)) {
        puVar4 = puVar10;
        uVar8 = param_3;
        do {
          uVar1 = puVar4[(longlong)puVar6 - (longlong)puVar10];
          puVar4[(longlong)puVar6 - (longlong)puVar10] = *puVar4;
          *puVar4 = uVar1;
          puVar4 = puVar4 + 1;
          uVar8 = uVar8 - 1;
        } while (uVar8 != 0);
      }
LAB_1400248f0:
      puVar4 = puVar6;
      if (puVar9 < puVar4) {
        do {
          puVar9 = puVar9 + param_3;
          if (puVar4 <= puVar9) goto LAB_140024915;
          iVar2 = (*(code *)param_4)(puVar9);
        } while (iVar2 < 1);
        if (puVar4 <= puVar9) goto LAB_140024915;
      }
      else {
LAB_140024915:
        do {
          puVar9 = puVar9 + param_3;
          if (puVar10 < puVar9) break;
          iVar2 = (*(code *)param_4)(puVar9);
        } while (iVar2 < 1);
      }
      do {
        puVar6 = puVar7;
        puVar7 = puVar6 + -param_3;
        if (puVar7 <= puVar4) break;
        iVar2 = (*(code *)param_4)(puVar7);
      } while (0 < iVar2);
      if (puVar9 <= puVar7) {
        if (puVar9 != puVar7) {
          puVar6 = puVar7;
          uVar8 = param_3;
          do {
            uVar1 = puVar6[(longlong)puVar9 - (longlong)puVar7];
            puVar6[(longlong)puVar9 - (longlong)puVar7] = *puVar6;
            *puVar6 = uVar1;
            puVar6 = puVar6 + 1;
            uVar8 = uVar8 - 1;
          } while (uVar8 != 0);
        }
        puVar6 = puVar9;
        if (puVar4 != puVar7) {
          puVar6 = puVar4;
        }
        goto LAB_1400248f0;
      }
      if (puVar4 < puVar6) {
        do {
          puVar6 = puVar6 + -param_3;
          if (puVar6 <= puVar4) goto LAB_1400249c0;
          iVar2 = (*(code *)param_4)(puVar6);
        } while (iVar2 == 0);
        if (puVar6 <= puVar4) goto LAB_1400249c0;
      }
      else {
LAB_1400249c0:
        do {
          puVar6 = puVar6 + -param_3;
          if (puVar6 <= param_1) break;
          iVar2 = (*(code *)param_4)(puVar6);
        } while (iVar2 == 0);
      }
      if ((longlong)puVar6 - (longlong)param_1 < (longlong)puVar10 - (longlong)puVar9)
      goto LAB_140024a1c;
      if (param_1 < puVar6) {
        auStack_438[local_448] = param_1;
        auStack_248[local_448] = puVar6;
        local_448 = local_448 + 1;
      }
      param_1 = puVar9;
      if (puVar10 <= puVar9) goto LAB_140024803;
    }
    for (; puVar9 = param_1, puVar6 = param_1, param_1 < puVar10; puVar10 = puVar10 + -param_3) {
      while (puVar6 = puVar6 + param_3, puVar6 <= puVar10) {
        iVar2 = (*(code *)param_4)(puVar6,puVar9);
        if (0 < iVar2) {
          puVar9 = puVar6;
        }
      }
      if (puVar9 != puVar10) {
        puVar6 = puVar10;
        uVar8 = param_3;
        do {
          uVar1 = puVar6[(longlong)puVar9 - (longlong)puVar10];
          puVar6[(longlong)puVar9 - (longlong)puVar10] = *puVar6;
          *puVar6 = uVar1;
          puVar6 = puVar6 + 1;
          uVar8 = uVar8 - 1;
        } while (uVar8 != 0);
      }
    }
    goto LAB_140024803;
  }
LAB_140024a6f:
  __security_check_cookie(local_58 ^ (ulonglong)auStack_468);
  return;
LAB_140024a1c:
  if (puVar9 < puVar10) {
    auStack_438[local_448] = puVar9;
    auStack_248[local_448] = puVar10;
    local_448 = local_448 + 1;
  }
  puVar10 = puVar6;
  if (puVar6 <= param_1) {
LAB_140024803:
    local_448 = local_448 + -1;
    if (-1 < local_448) {
      param_1 = (undefined *)auStack_438[local_448];
      puVar10 = (undefined *)auStack_248[local_448];
      goto LAB_140024780;
    }
    goto LAB_140024a6f;
  }
  goto LAB_140024780;
}



ulong FUN_140024a90(char *param_1,longlong param_2,longlong param_3,longlong param_4)

{
  char cVar1;
  ulong *puVar2;
  longlong lVar3;
  ulong uVar4;
  longlong lVar5;
  char *pcVar6;
  
  if (param_4 == 0) {
    if (param_1 == (char *)0x0) {
      if (param_2 == 0) {
        return 0;
      }
    }
    else {
LAB_140024ad9:
      if (param_2 != 0) {
        if (param_4 == 0) {
          *param_1 = '\0';
          return 0;
        }
        if (param_3 != 0) {
          lVar3 = param_2;
          lVar5 = param_4;
          pcVar6 = param_1;
          if (param_4 == -1) {
            do {
              lVar5 = lVar3;
              cVar1 = pcVar6[param_3 - (longlong)param_1];
              *pcVar6 = cVar1;
              pcVar6 = pcVar6 + 1;
              if (cVar1 == '\0') break;
              lVar3 = lVar5 + -1;
            } while (lVar5 + -1 != 0);
            lVar3 = lVar5 + -1;
            if (cVar1 == '\0') {
              lVar3 = lVar5;
            }
          }
          else {
            do {
              cVar1 = pcVar6[param_3 - (longlong)param_1];
              *pcVar6 = cVar1;
              pcVar6 = pcVar6 + 1;
              if ((cVar1 == '\0') || (lVar3 = lVar3 + -1, lVar3 == 0)) break;
              lVar5 = lVar5 + -1;
            } while (lVar5 != 0);
            if (lVar5 == 0) {
              *pcVar6 = '\0';
            }
          }
          if (lVar3 != 0) {
            return 0;
          }
          if (param_4 == -1) {
            param_1[param_2 + -1] = '\0';
            return 0x50;
          }
          *param_1 = '\0';
          puVar2 = __doserrno();
          uVar4 = 0x22;
          goto LAB_140024abc;
        }
        *param_1 = '\0';
      }
    }
  }
  else if (param_1 != (char *)0x0) goto LAB_140024ad9;
  puVar2 = __doserrno();
  uVar4 = 0x16;
LAB_140024abc:
  *puVar2 = uVar4;
  FUN_140011e58();
  return uVar4;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulong FUN_140024b78(longlong param_1,longlong param_2,undefined *param_3,undefined8 param_4)

{
  ulonglong uVar1;
  uint uVar2;
  ulong uVar3;
  longlong lVar4;
  LPVOID pvVar5;
  ulong *puVar6;
  ulonglong uVar7;
  
  if (param_1 == 0) {
    if (*(char *)(param_2 + 0x28) != '\0') {
      _free_base(*(LPVOID *)(param_2 + 0x10));
      *(undefined *)(param_2 + 0x28) = 0;
    }
    *(undefined8 *)(param_2 + 0x10) = 0;
    *(undefined8 *)(param_2 + 0x18) = 0;
    *(undefined8 *)(param_2 + 0x20) = 0;
LAB_140024bc3:
    uVar3 = 0;
  }
  else {
    lVar4 = (*(code *)param_3)(0,param_1,0);
    if (lVar4 != -1) {
      uVar7 = *(ulonglong *)(param_2 + 0x18);
      uVar1 = lVar4 + 1;
      if (uVar7 < uVar1) {
        if (*(char *)(param_2 + 0x28) != '\0') {
          _free_base(*(LPVOID *)(param_2 + 0x10));
          *(undefined *)(param_2 + 0x28) = 0;
        }
        pvVar5 = _malloc_base(uVar1 * 2);
        *(LPVOID *)(param_2 + 0x10) = pvVar5;
        uVar2 = ~-(uint)(pvVar5 != (LPVOID)0x0) & 0xc;
        uVar7 = 0;
        if (uVar2 == 0) {
          uVar7 = uVar1;
        }
        *(bool *)(param_2 + 0x28) = uVar2 == 0;
        *(ulonglong *)(param_2 + 0x18) = uVar7;
        if (uVar2 != 0) {
          return uVar2;
        }
      }
      lVar4 = (*(code *)param_3)(*(undefined8 *)(param_2 + 0x10),param_1,uVar7,param_4);
      if ((lVar4 != -1) && (lVar4 != *(longlong *)(param_2 + 0x18))) {
        *(longlong *)(param_2 + 0x20) = lVar4 + 1;
        goto LAB_140024bc3;
      }
    }
    puVar6 = __doserrno();
    uVar3 = *puVar6;
  }
  return uVar3;
}



// Library Function - Single Match
//  _mbstowcs_s_l
// 
// Library: Visual Studio 2017 Release

errno_t __cdecl
_mbstowcs_s_l(size_t *_PtNumOfCharConverted,wchar_t *_DstBuf,size_t _SizeInWords,char *_SrcBuf,
             size_t _MaxCount,_locale_t _Locale)

{
  ulong *puVar1;
  __uint64 _Var2;
  ulonglong uVar3;
  ulong uVar4;
  size_t sVar5;
  longlong local_38;
  __crt_locale_pointers local_30 [16];
  char local_20;
  
  uVar4 = 0;
  if (_DstBuf == (wchar_t *)0x0) {
    if (_SizeInWords != 0) {
LAB_140024d01:
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      FUN_140011e58();
      return 0x16;
    }
  }
  else if (_SizeInWords == 0) goto LAB_140024d01;
  if (_DstBuf != (wchar_t *)0x0) {
    *_DstBuf = L'\0';
  }
  if (_PtNumOfCharConverted != (size_t *)0x0) {
    *_PtNumOfCharConverted = 0;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_38,(__crt_locale_pointers *)_Locale);
  sVar5 = _MaxCount;
  if (_SizeInWords < _MaxCount) {
    sVar5 = _SizeInWords;
  }
  if (sVar5 < 0x80000000) {
    _Var2 = _mbstowcs_l_helper((wchar_t *)_DstBuf,_SrcBuf,sVar5,local_30);
    if (_Var2 == 0xffffffffffffffff) {
      if (_DstBuf != (wchar_t *)0x0) {
        *_DstBuf = L'\0';
      }
      puVar1 = __doserrno();
      uVar4 = *puVar1;
      goto LAB_140024d84;
    }
    uVar3 = _Var2 + 1;
    if (_DstBuf != (wchar_t *)0x0) {
      if (_SizeInWords < uVar3) {
        if (_MaxCount != 0xffffffffffffffff) {
          *_DstBuf = L'\0';
          puVar1 = __doserrno();
          uVar4 = 0x22;
          goto LAB_140024d65;
        }
        uVar4 = 0x50;
        uVar3 = _SizeInWords;
      }
      _DstBuf[uVar3 - 1] = L'\0';
    }
    if (_PtNumOfCharConverted != (size_t *)0x0) {
      *_PtNumOfCharConverted = uVar3;
    }
  }
  else {
    puVar1 = __doserrno();
    uVar4 = 0x16;
LAB_140024d65:
    *puVar1 = uVar4;
    FUN_140011e58();
  }
LAB_140024d84:
  if (local_20 != '\0') {
    *(uint *)(local_38 + 0x3a8) = *(uint *)(local_38 + 0x3a8) & 0xfffffffd;
  }
  return uVar4;
}



__uint64 __cdecl
_mbstowcs_l_helper(wchar_t *param_1,char *param_2,__uint64 param_3,__crt_locale_pointers *param_4)

{
  UINT UVar1;
  int iVar2;
  DWORD DVar3;
  ulong *puVar4;
  __uint64 _Var5;
  byte *pbVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  undefined8 uStackX_8;
  byte *pbStackX_10;
  longlong lStack_48;
  localeinfo_struct lStack_40;
  char cStack_30;
  
  _Var5 = 0;
  if (param_1 != (wchar_t *)0x0) {
    if (param_3 == 0) {
      return 0;
    }
    *(undefined2 *)param_1 = 0;
  }
  pbStackX_10 = (byte *)param_2;
  if (param_2 == (char *)0x0) {
    puVar4 = __doserrno();
    *puVar4 = 0x16;
    FUN_140011e58();
    return 0xffffffffffffffff;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&lStack_48,param_4);
  UVar1 = (lStack_40.locinfo)->lc_time_cp;
  if (UVar1 == 0xfde9) {
    uStackX_8 = 0;
    _Var5 = __crt_mbstring::__mbsrtowcs_utf8
                      (param_1,(char **)&pbStackX_10,param_3,(_Mbstatet *)&uStackX_8);
    goto LAB_140024f9d;
  }
  if (param_1 == (wchar_t *)0x0) {
    _Var5 = 0xffffffffffffffff;
    if ((lStack_40.locinfo)->locale_name[2] == (wchar_t *)0x0) {
      do {
        _Var5 = _Var5 + 1;
      } while (pbStackX_10[_Var5] != 0);
      goto LAB_140024f9d;
    }
    iVar2 = __acrt_MultiByteToWideChar(UVar1,9,(LPCSTR)pbStackX_10,-1,(LPWSTR)0x0,0);
    if (iVar2 == 0) {
      puVar4 = __doserrno();
      *puVar4 = 0x2a;
      goto LAB_140024f9d;
    }
  }
  else {
    if ((lStack_40.locinfo)->locale_name[2] == (wchar_t *)0x0) {
      if (param_3 != 0) {
        do {
          *(ushort *)param_1 = (ushort)pbStackX_10[_Var5];
          if (pbStackX_10[_Var5] == 0) break;
          _Var5 = _Var5 + 1;
          param_1 = (wchar_t *)((longlong)param_1 + 2);
        } while (_Var5 < param_3);
      }
      goto LAB_140024f9d;
    }
    uVar7 = (uint)param_3;
    iVar2 = __acrt_MultiByteToWideChar(UVar1,9,(LPCSTR)pbStackX_10,-1,(LPWSTR)param_1,uVar7);
    if (iVar2 == 0) {
      DVar3 = GetLastError();
      if (DVar3 == 0x7a) {
        uVar9 = param_3 & 0xffffffff;
        pbVar6 = pbStackX_10;
        uVar8 = uVar7;
        while (uVar8 != 0) {
          uVar8 = (int)uVar9 - 1;
          uVar9 = (ulonglong)uVar8;
          if (*pbVar6 == 0) break;
          iVar2 = _isleadbyte_l((uint)*pbVar6,&lStack_40);
          if ((iVar2 != 0) && (pbVar6 = pbVar6 + 1, *pbVar6 == 0)) goto LAB_140024f38;
          pbVar6 = pbVar6 + 1;
        }
        iVar2 = __acrt_MultiByteToWideChar
                          ((lStack_40.locinfo)->lc_time_cp,1,(LPCSTR)pbStackX_10,
                           (int)pbVar6 - (int)pbStackX_10,(LPWSTR)param_1,uVar7);
        _Var5 = (__uint64)iVar2;
        if (iVar2 != 0) goto LAB_140024f9d;
      }
LAB_140024f38:
      puVar4 = __doserrno();
      *puVar4 = 0x2a;
      *(undefined2 *)param_1 = 0;
      _Var5 = 0xffffffffffffffff;
      goto LAB_140024f9d;
    }
  }
  _Var5 = (longlong)iVar2 - 1;
LAB_140024f9d:
  if (cStack_30 != '\0') {
    *(uint *)(lStack_48 + 0x3a8) = *(uint *)(lStack_48 + 0x3a8) & 0xfffffffd;
  }
  return _Var5;
}



// Library Function - Single Match
//  unsigned __int64 __cdecl _mbstowcs_l_helper(wchar_t * __ptr64,char const * __ptr64,unsigned
// __int64,struct __crt_locale_pointers * __ptr64)
// 
// Library: Visual Studio 2017 Release

__uint64 __cdecl
_mbstowcs_l_helper(wchar_t *param_1,char *param_2,__uint64 param_3,__crt_locale_pointers *param_4)

{
  UINT UVar1;
  int iVar2;
  DWORD DVar3;
  ulong *puVar4;
  __uint64 _Var5;
  byte *pbVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  undefined8 local_res8;
  byte *local_res10;
  longlong local_48;
  localeinfo_struct local_40;
  char local_30;
  
  _Var5 = 0;
  if (param_1 != (wchar_t *)0x0) {
    if (param_3 == 0) {
      return 0;
    }
    *(undefined2 *)param_1 = 0;
  }
  local_res10 = (byte *)param_2;
  if (param_2 == (char *)0x0) {
    puVar4 = __doserrno();
    *puVar4 = 0x16;
    FUN_140011e58();
    return 0xffffffffffffffff;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_48,param_4);
  UVar1 = (local_40.locinfo)->lc_time_cp;
  if (UVar1 == 0xfde9) {
    local_res8 = 0;
    _Var5 = __crt_mbstring::__mbsrtowcs_utf8
                      (param_1,(char **)&local_res10,param_3,(_Mbstatet *)&local_res8);
    goto LAB_140024f9d;
  }
  if (param_1 == (wchar_t *)0x0) {
    _Var5 = 0xffffffffffffffff;
    if ((local_40.locinfo)->locale_name[2] == (wchar_t *)0x0) {
      do {
        _Var5 = _Var5 + 1;
      } while (local_res10[_Var5] != 0);
      goto LAB_140024f9d;
    }
    iVar2 = __acrt_MultiByteToWideChar(UVar1,9,(LPCSTR)local_res10,-1,(LPWSTR)0x0,0);
    if (iVar2 == 0) {
      puVar4 = __doserrno();
      *puVar4 = 0x2a;
      goto LAB_140024f9d;
    }
  }
  else {
    if ((local_40.locinfo)->locale_name[2] == (wchar_t *)0x0) {
      if (param_3 != 0) {
        do {
          *(ushort *)param_1 = (ushort)local_res10[_Var5];
          if (local_res10[_Var5] == 0) break;
          _Var5 = _Var5 + 1;
          param_1 = (wchar_t *)((longlong)param_1 + 2);
        } while (_Var5 < param_3);
      }
      goto LAB_140024f9d;
    }
    uVar7 = (uint)param_3;
    iVar2 = __acrt_MultiByteToWideChar(UVar1,9,(LPCSTR)local_res10,-1,(LPWSTR)param_1,uVar7);
    if (iVar2 == 0) {
      DVar3 = GetLastError();
      if (DVar3 == 0x7a) {
        uVar9 = param_3 & 0xffffffff;
        pbVar6 = local_res10;
        uVar8 = uVar7;
        while (uVar8 != 0) {
          uVar8 = (int)uVar9 - 1;
          uVar9 = (ulonglong)uVar8;
          if (*pbVar6 == 0) break;
          iVar2 = _isleadbyte_l((uint)*pbVar6,&local_40);
          if ((iVar2 != 0) && (pbVar6 = pbVar6 + 1, *pbVar6 == 0)) goto LAB_140024f38;
          pbVar6 = pbVar6 + 1;
        }
        iVar2 = __acrt_MultiByteToWideChar
                          ((local_40.locinfo)->lc_time_cp,1,(LPCSTR)local_res10,
                           (int)pbVar6 - (int)local_res10,(LPWSTR)param_1,uVar7);
        _Var5 = (__uint64)iVar2;
        if (iVar2 != 0) goto LAB_140024f9d;
      }
LAB_140024f38:
      puVar4 = __doserrno();
      *puVar4 = 0x2a;
      *(undefined2 *)param_1 = 0;
      _Var5 = 0xffffffffffffffff;
      goto LAB_140024f9d;
    }
  }
  _Var5 = (longlong)iVar2 - 1;
LAB_140024f9d:
  if (local_30 != '\0') {
    *(uint *)(local_48 + 0x3a8) = *(uint *)(local_48 + 0x3a8) & 0xfffffffd;
  }
  return _Var5;
}



// Library Function - Single Match
//  _msize_base
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 _msize_base(longlong param_1)

{
  ulong *puVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x000140024ffe. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar2 = HeapSize(DAT_1400395f8,0,param_1);
  return uVar2;
}



undefined8 _msize_base(longlong param_1)

{
  ulong *puVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    puVar1 = __doserrno();
    *puVar1 = 0x16;
    FUN_140011e58();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x000140024ffe. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar2 = HeapSize(DAT_1400395f8,0,param_1);
  return uVar2;
}



// Library Function - Single Match
//  _realloc_base
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

LPVOID _realloc_base(LPVOID param_1,ulonglong param_2)

{
  int iVar1;
  LPVOID pvVar2;
  ulong *puVar3;
  
  if (param_1 == (LPVOID)0x0) {
    pvVar2 = _malloc_base(param_2);
  }
  else {
    if (param_2 == 0) {
      _free_base(param_1);
    }
    else {
      if (param_2 < 0xffffffffffffffe1) {
        do {
          pvVar2 = HeapReAlloc(DAT_1400395f8,0,param_1,param_2);
          if (pvVar2 != (LPVOID)0x0) {
            return pvVar2;
          }
          iVar1 = FUN_140012e60();
        } while ((iVar1 != 0) && (iVar1 = _callnewh(param_2), iVar1 != 0));
      }
      puVar3 = __doserrno();
      *puVar3 = 0xc;
    }
    pvVar2 = (LPVOID)0x0;
  }
  return pvVar2;
}



int FUN_14002508c(wchar_t *param_1,wchar_t *param_2,ulonglong param_3)

{
  ulong *puVar1;
  ulonglong uVar2;
  longlong lVar3;
  int iVar4;
  wchar_t wVar5;
  wchar_t wVar6;
  longlong local_28;
  longlong local_20;
  char local_10;
  
  if (DAT_140038e20 != 0) {
    if (param_3 == 0) {
      iVar4 = 0;
    }
    else if ((param_1 == (wchar_t *)0x0) || (param_2 == (wchar_t *)0x0)) {
      puVar1 = __doserrno();
      *puVar1 = 0x16;
      FUN_140011e58();
      iVar4 = 0x7fffffff;
    }
    else {
      iVar4 = 0x7fffffff;
      if (param_3 < 0x80000000) {
        _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)0x0);
        if (*(wchar_t **)(local_20 + 0x130) == (wchar_t *)0x0) {
          lVar3 = (longlong)param_1 - (longlong)param_2;
          do {
            wVar5 = *(short *)(lVar3 + (longlong)param_2) + L' ';
            if (0x19 < (ushort)(*(short *)(lVar3 + (longlong)param_2) - 0x41U)) {
              wVar5 = *(wchar_t *)(lVar3 + (longlong)param_2);
            }
            wVar6 = *param_2 + L' ';
            if (0x19 < (ushort)(*param_2 + L'﾿')) {
              wVar6 = *param_2;
            }
            param_2 = param_2 + 1;
            param_3 = param_3 - 1;
          } while (((param_3 != 0) && (wVar5 != L'\0')) && (wVar5 == wVar6));
          iVar4 = (uint)(ushort)wVar5 - (uint)(ushort)wVar6;
        }
        else {
          uVar2 = __acrt_CompareStringW
                            (*(wchar_t **)(local_20 + 0x130),0x1001,param_1,(int)param_3,param_2,
                             (int)param_3);
          if ((int)uVar2 == 0) {
            puVar1 = __doserrno();
            *puVar1 = 0x16;
          }
          else {
            iVar4 = (int)uVar2 + -2;
          }
        }
        if (local_10 != '\0') {
          *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
        }
      }
      else {
        puVar1 = __doserrno();
        *puVar1 = 0x16;
        FUN_140011e58();
      }
    }
    return iVar4;
  }
  if (((param_1 != (wchar_t *)0x0) && (param_2 != (wchar_t *)0x0)) && (param_3 < 0x80000000)) {
    lVar3 = (longlong)param_1 - (longlong)param_2;
    do {
      wVar5 = *(short *)(lVar3 + (longlong)param_2) + L' ';
      if (0x19 < (ushort)(*(short *)(lVar3 + (longlong)param_2) - 0x41U)) {
        wVar5 = *(wchar_t *)(lVar3 + (longlong)param_2);
      }
      wVar6 = *param_2 + L' ';
      if (0x19 < (ushort)(*param_2 + L'﾿')) {
        wVar6 = *param_2;
      }
      param_2 = param_2 + 1;
      param_3 = param_3 - 1;
    } while (((param_3 != 0) && (wVar5 != L'\0')) && (wVar5 == wVar6));
    return (uint)(ushort)wVar5 - (uint)(ushort)wVar6;
  }
  puVar1 = __doserrno();
  *puVar1 = 0x16;
  FUN_140011e58();
  return 0x7fffffff;
}



// WARNING: Removing unreachable block (ram,0x000140025667)

int FUN_140025280(byte *param_1,byte *param_2,size_t param_3)

{
  int iVar1;
  int iVar2;
  ulong *puVar3;
  longlong local_28;
  localeinfo_struct local_20;
  char local_10;
  
  if (DAT_140038e20 != 0) {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)0x0);
    if (param_3 == 0) {
      iVar1 = 0;
    }
    else if ((param_1 == (byte *)0x0) || (param_2 == (byte *)0x0)) {
      puVar3 = __doserrno();
      *puVar3 = 0x16;
      FUN_140011e58();
      iVar1 = 0x7fffffff;
    }
    else {
      iVar1 = 0x7fffffff;
      if (param_3 < 0x80000000) {
        if ((local_20.locinfo)->locale_name[1] == (wchar_t *)0x0) {
          iVar1 = _strnicmp_l((char *)param_1,(char *)param_2,param_3,&local_20);
        }
        else {
          iVar2 = __acrt_CompareStringA
                            ((__crt_locale_pointers *)&local_20,
                             (wchar_t *)(local_20.locinfo)->locale_name[1],0x1001,param_1,
                             (int)param_3,param_2,(int)param_3,
                             *(UINT *)((longlong)&(local_20.locinfo)->lc_category[0].locale + 4));
          if (iVar2 == 0) {
            puVar3 = __doserrno();
            *puVar3 = 0x16;
          }
          else {
            iVar1 = iVar2 + -2;
          }
        }
      }
      else {
        puVar3 = __doserrno();
        *puVar3 = 0x16;
        FUN_140011e58();
      }
    }
    if (local_10 != '\0') {
      *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
    }
    return iVar1;
  }
  if (((param_1 != (byte *)0x0) && (param_2 != (byte *)0x0)) && (param_3 < 0x80000000)) {
    iVar1 = __ascii_strnicmp((char *)param_1,(char *)param_2,param_3);
    return iVar1;
  }
  puVar3 = __doserrno();
  *puVar3 = 0x16;
  FUN_140011e58();
  return 0x7fffffff;
}



LPCWSTR FUN_140025398(longlong param_1,longlong param_2)

{
  ulong uVar1;
  uint uVar2;
  LPCWSTR pWVar3;
  LPCWSTR pWVar4;
  longlong local_88 [3];
  char local_70;
  undefined8 local_68;
  undefined8 local_60;
  LPCWSTR local_58;
  undefined8 local_50;
  undefined8 local_48;
  char local_40;
  undefined8 local_38;
  undefined8 local_30;
  LPCWSTR local_28;
  undefined8 local_20;
  undefined8 local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_88,(__crt_locale_pointers *)0x0);
  pWVar3 = (LPCWSTR)0x0;
  local_38 = 0;
  local_30 = 0;
  local_28 = (LPCWSTR)0x0;
  local_20 = 0;
  local_18 = 0;
  local_10 = '\0';
  local_68 = 0;
  local_60 = 0;
  local_58 = (LPCWSTR)0x0;
  local_50 = 0;
  local_48 = 0;
  local_40 = '\0';
  uVar1 = FUN_140024b78(param_1,(longlong)&local_38,_mbstowcs_l_helper,0);
  pWVar4 = pWVar3;
  if ((uVar1 == 0) &&
     (uVar1 = FUN_140024b78(param_2,(longlong)&local_68,_mbstowcs_l_helper,0), pWVar4 = local_58,
     uVar1 == 0)) {
    uVar2 = SetEnvironmentVariableW(local_28,local_58);
    pWVar3 = (LPCWSTR)(ulonglong)uVar2;
  }
  if (local_40 != '\0') {
    _free_base(pWVar4);
  }
  if (local_10 != '\0') {
    _free_base(local_28);
  }
  if (local_70 != '\0') {
    *(uint *)(local_88[0] + 0x3a8) = *(uint *)(local_88[0] + 0x3a8) & 0xfffffffd;
  }
  return pWVar3;
}



int __cdecl common_getenv_s_char_(__uint64 *param_1,char *param_2,__uint64 param_3,char *param_4)

{
  code *pcVar1;
  bool bVar2;
  ulong uVar3;
  int iVar4;
  ulong *puVar5;
  char *pcVar6;
  longlong lVar7;
  ulonglong uVar9;
  longlong lVar8;
  
  FID_conflict___acrt_lock(0xb);
  iVar4 = 0;
  if (param_1 != (__uint64 *)0x0) {
    *param_1 = 0;
    if (param_2 == (char *)0x0) {
LAB_1400254fc:
      if (param_3 == 0) goto LAB_140025501;
LAB_140025508:
      bVar2 = false;
    }
    else {
      if (param_3 == 0) {
        if (param_2 == (char *)0x0) goto LAB_1400254fc;
        goto LAB_140025508;
      }
LAB_140025501:
      bVar2 = true;
    }
    if (bVar2) {
      if (param_2 != (char *)0x0) {
        *param_2 = '\0';
      }
      pcVar6 = common_getenv_nolock_char_(param_4);
      if (pcVar6 != (char *)0x0) {
        lVar7 = -1;
        do {
          lVar8 = lVar7;
          lVar7 = lVar8 + 1;
        } while (pcVar6[lVar7] != '\0');
        uVar9 = lVar8 + 2;
        *param_1 = uVar9;
        if (param_3 != 0) {
          if (param_3 < uVar9) {
            iVar4 = 0x22;
          }
          else {
            uVar3 = FUN_140016cd4(param_2,param_3,(longlong)pcVar6);
            if (uVar3 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar1 = (code *)swi(3);
              iVar4 = (*pcVar1)();
              return iVar4;
            }
          }
        }
      }
      goto LAB_140025558;
    }
  }
  puVar5 = __doserrno();
  iVar4 = 0x16;
  *puVar5 = 0x16;
  FUN_140011e58();
LAB_140025558:
  FID_conflict___acrt_lock(0xb);
  return iVar4;
}



// Library Function - Single Match
//  int __cdecl common_getenv_s<char>(unsigned __int64 * __ptr64 const,char * __ptr64 const,unsigned
// __int64,char const * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

int __cdecl common_getenv_s_char_(__uint64 *param_1,char *param_2,__uint64 param_3,char *param_4)

{
  code *pcVar1;
  bool bVar2;
  ulong uVar3;
  int iVar4;
  ulong *puVar5;
  char *pcVar6;
  longlong lVar7;
  ulonglong uVar9;
  longlong lVar8;
  
  FID_conflict___acrt_lock(0xb);
  iVar4 = 0;
  if (param_1 != (__uint64 *)0x0) {
    *param_1 = 0;
    if (param_2 == (char *)0x0) {
LAB_1400254fc:
      if (param_3 == 0) goto LAB_140025501;
LAB_140025508:
      bVar2 = false;
    }
    else {
      if (param_3 == 0) {
        if (param_2 == (char *)0x0) goto LAB_1400254fc;
        goto LAB_140025508;
      }
LAB_140025501:
      bVar2 = true;
    }
    if (bVar2) {
      if (param_2 != (char *)0x0) {
        *param_2 = '\0';
      }
      pcVar6 = common_getenv_nolock_char_(param_4);
      if (pcVar6 != (char *)0x0) {
        lVar7 = -1;
        do {
          lVar8 = lVar7;
          lVar7 = lVar8 + 1;
        } while (pcVar6[lVar7] != '\0');
        uVar9 = lVar8 + 2;
        *param_1 = uVar9;
        if (param_3 != 0) {
          if (param_3 < uVar9) {
            iVar4 = 0x22;
          }
          else {
            uVar3 = FUN_140016cd4(param_2,param_3,(longlong)pcVar6);
            if (uVar3 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar1 = (code *)swi(3);
              iVar4 = (*pcVar1)();
              return iVar4;
            }
          }
        }
      }
      goto LAB_140025558;
    }
  }
  puVar5 = __doserrno();
  iVar4 = 0x16;
  *puVar5 = 0x16;
  FUN_140011e58();
LAB_140025558:
  FID_conflict___acrt_lock(0xb);
  return iVar4;
}



// Library Function - Single Match
//  char * __ptr64 __cdecl common_getenv_nolock<char>(char const * __ptr64 const)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

char * __cdecl common_getenv_nolock_char_(char *param_1)

{
  int iVar1;
  byte **ppbVar2;
  byte *pbVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  
  ppbVar2 = (byte **)__dcrt_get_or_create_narrow_environment_nolock();
  if ((ppbVar2 != (byte **)0x0) && (param_1 != (char *)0x0)) {
    uVar5 = 0xffffffffffffffff;
    do {
      uVar6 = uVar5;
      uVar5 = uVar6 + 1;
    } while (param_1[uVar5] != '\0');
    pbVar3 = *ppbVar2;
    while (pbVar3 != (byte *)0x0) {
      uVar4 = 0xffffffffffffffff;
      do {
        uVar4 = uVar4 + 1;
      } while (pbVar3[uVar4] != 0);
      if (((uVar5 < uVar4) && (pbVar3[uVar5] == 0x3d)) &&
         (iVar1 = FUN_140025280(pbVar3,(byte *)param_1,uVar5), iVar1 == 0)) {
        return (char *)(*ppbVar2 + uVar6 + 2);
      }
      ppbVar2 = ppbVar2 + 1;
      pbVar3 = *ppbVar2;
    }
  }
  return (char *)0x0;
}



// Library Function - Single Match
//  _strnicmp_l
// 
// Library: Visual Studio 2017 Release

int __cdecl _strnicmp_l(char *_Str1,char *_Str2,size_t _MaxCount,_locale_t _Locale)

{
  int iVar1;
  int iVar2;
  ulong *puVar3;
  longlong lVar4;
  longlong local_28;
  localeinfo_struct local_20;
  char local_10;
  
  if (_MaxCount == 0) {
    iVar1 = 0;
  }
  else {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(__crt_locale_pointers *)_Locale);
    iVar1 = 0x7fffffff;
    if (((_Str1 == (char *)0x0) || (_Str2 == (char *)0x0)) || (0x7fffffff < _MaxCount)) {
      puVar3 = __doserrno();
      *puVar3 = 0x16;
      FUN_140011e58();
    }
    else if ((local_20.locinfo)->locale_name[2] == (wchar_t *)0x0) {
      iVar1 = __ascii_strnicmp(_Str1,_Str2,_MaxCount);
    }
    else {
      lVar4 = (longlong)_Str1 - (longlong)_Str2;
      do {
        iVar1 = _tolower_l((uint)((byte *)_Str2)[lVar4],&local_20);
        iVar2 = _tolower_l((uint)(byte)*_Str2,&local_20);
        _Str2 = (char *)((byte *)_Str2 + 1);
        _MaxCount = _MaxCount - 1;
        if ((_MaxCount == 0) || (iVar1 == 0)) break;
      } while (iVar1 == iVar2);
      iVar1 = iVar1 - iVar2;
    }
    if (local_10 != '\0') {
      *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  __ascii_strnicmp
// 
// Library: Visual Studio 2017 Release

int __cdecl __ascii_strnicmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  byte bVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  
  if (_MaxCount == 0) {
    iVar4 = 0;
  }
  else {
    do {
      bVar1 = *_Str1;
      _Str1 = (char *)((byte *)_Str1 + 1);
      bVar2 = *_Str2;
      uVar3 = bVar1 + 0x20;
      if (0x19 < bVar1 - 0x41) {
        uVar3 = (uint)bVar1;
      }
      uVar5 = bVar2 + 0x20;
      _Str2 = (char *)((byte *)_Str2 + 1);
      if (0x19 < bVar2 - 0x41) {
        uVar5 = (uint)bVar2;
      }
      _MaxCount = _MaxCount - 1;
    } while (((_MaxCount != 0) && (uVar3 != 0)) && (uVar3 == uVar5));
    iVar4 = uVar3 - uVar5;
  }
  return iVar4;
}



// Library Function - Multiple Matches With Different Base Names
//  _sopen_s
//  _wsopen_s
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

errno_t __cdecl
FID_conflict__sopen_s
          (int *_FileHandle,char *_Filename,int _OpenFlag,int _ShareFlag,int _PermissionMode)

{
  ulong uVar1;
  
  uVar1 = FUN_140025bc8((LPCWSTR)_Filename,_OpenFlag,_ShareFlag,(ulonglong)(uint)_PermissionMode,
                        (uint *)_FileHandle,1);
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

ulong FUN_1400257e0(undefined4 *param_1,uint *param_2,LPCWSTR param_3,uint param_4,int param_5)

{
  byte *pbVar1;
  longlong lVar2;
  file_options fVar3;
  uint uVar4;
  DWORD DVar5;
  undefined7 extraout_var;
  ulong *puVar6;
  HANDLE pvVar7;
  ulonglong uVar8;
  uint _FileHandle;
  longlong lVar9;
  char local_98 [4];
  ulong local_94;
  undefined local_90 [4];
  uint uStack_8c;
  undefined8 uStack_88;
  undefined8 local_80;
  undefined8 local_78;
  ulonglong local_70;
  ulonglong local_68;
  _SECURITY_ATTRIBUTES local_60;
  undefined4 local_48;
  undefined4 uStack_44;
  undefined4 uStack_40;
  undefined4 uStack_3c;
  undefined8 local_38;
  
  fVar3 = decode_options((int)&local_48,param_4,param_5);
  _local_90 = *(undefined (*) [16])CONCAT71(extraout_var,fVar3);
  local_80 = *(undefined8 *)((undefined (*) [16])CONCAT71(extraout_var,fVar3))[1];
  local_68 = SUB168(_local_90 >> 0x60,0);
  DVar5 = SUB164(_local_90 >> 0x60,0);
  local_78 = local_80;
  if (DVar5 == 0xffffffff) {
    puVar6 = __doserrno();
    *puVar6 = 0;
    *param_2 = 0xffffffff;
    goto LAB_140025861;
  }
  uVar4 = FUN_14001e1ec();
  *param_2 = uVar4;
  if (uVar4 == 0xffffffff) {
    puVar6 = __doserrno();
    *puVar6 = 0;
    *param_2 = 0xffffffff;
    puVar6 = __doserrno();
    *puVar6 = 0x18;
    goto LAB_140025861;
  }
  local_80._0_4_ = (uint)((ulonglong)local_80 >> 0x20) | (uint)local_80;
  local_70 = (ulonglong)(uint)local_80;
  local_60.bInheritHandle = ~(param_4 >> 7) & 1;
  *param_1 = 1;
  local_60.nLength = 0x18;
  local_60.lpSecurityDescriptor = (LPVOID)0x0;
  pvVar7 = CreateFileW(param_3,SUB164(_local_90 >> 0x20,0),DVar5,&local_60,(DWORD)uStack_88,
                       (uint)local_80,(HANDLE)0x0);
  uVar4 = uStack_8c;
  if (pvVar7 == (HANDLE)0xffffffffffffffff) {
    if (((uStack_8c & 0xc0000000) == 0xc0000000) && ((param_4 & 1) != 0)) {
      uVar4 = uStack_8c & 0x7fffffff;
      _local_90 = _local_90 & (undefined  [16])0xffffffffffffffff;
      pvVar7 = CreateFileW(param_3,SUB164(_local_90 >> 0x20,0),DVar5,&local_60,(DWORD)uStack_88,
                           (uint)local_80,(HANDLE)0x0);
      if (pvVar7 != (HANDLE)0xffffffffffffffff) goto LAB_140025978;
    }
    pbVar1 = (byte *)((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x38 +
                     (ulonglong)(*param_2 & 0x3f) * 0x40);
    *pbVar1 = *pbVar1 & 0xfe;
    DVar5 = GetLastError();
    __acrt_errno_map_os_error(DVar5);
  }
  else {
LAB_140025978:
    DVar5 = GetFileType(pvVar7);
    if (DVar5 != 0) {
      if (DVar5 == 2) {
        local_90[0] = local_90[0] | 0x40;
      }
      else if (DVar5 == 3) {
        local_90[0] = local_90[0] | 8;
      }
      __acrt_lowio_set_os_handle(*param_2,pvVar7);
      _local_90 = CONCAT151(stack0xffffffffffffff71,local_90[0]) | (undefined  [16])0x1;
      *(byte *)((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x38 +
               (ulonglong)(*param_2 & 0x3f) * 0x40) = local_90[0] | 1;
      *(undefined *)
       ((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x39 + (ulonglong)(*param_2 & 0x3f) * 0x40)
           = 0;
      if (((param_4 & 2) == 0) || (local_94 = FUN_140025e98(*param_2), local_94 == 0)) {
        local_48 = local_90;
        uStack_44 = uStack_8c;
        uStack_40 = (DWORD)uStack_88;
        uStack_3c = uStack_88._4_4_;
        local_98[0] = '\0';
        local_38 = local_78;
        uVar8 = FUN_140025f5c(*param_2,(byte *)&local_48,param_4,local_98);
        _FileHandle = *param_2;
        local_94 = (ulong)uVar8;
        if (local_94 == 0) {
          *(char *)((&DAT_140039600)[(longlong)(int)_FileHandle >> 6] + 0x39 +
                   (ulonglong)(_FileHandle & 0x3f) * 0x40) = local_98[0];
          lVar9 = (ulonglong)(*param_2 & 0x3f) * 0x40;
          lVar2 = (&DAT_140039600)[(longlong)(int)*param_2 >> 6];
          pbVar1 = (byte *)(lVar2 + 0x3d + lVar9);
          *pbVar1 = *pbVar1 & 0xfe;
          pbVar1 = (byte *)(lVar2 + 0x3d + lVar9);
          *pbVar1 = *pbVar1 | (byte)(param_4 >> 0x10) & 1;
          if (((local_90[0] & 0x48) == 0) && ((param_4 & 8) != 0)) {
            pbVar1 = (byte *)((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x38 +
                             (ulonglong)(*param_2 & 0x3f) * 0x40);
            *pbVar1 = *pbVar1 | 0x20;
          }
          if (((uVar4 & 0xc0000000) == 0xc0000000) && ((param_4 & 1) != 0)) {
            CloseHandle(pvVar7);
            _local_90 = CONCAT88(uStack_88,CONCAT44(uVar4,local_90)) &
                        (undefined  [16])0xffffffffffffffff;
            pvVar7 = CreateFileW(param_3,SUB164(_local_90 >> 0x20,0),(DWORD)local_68,&local_60,
                                 (DWORD)uStack_88,(DWORD)local_70,(HANDLE)0x0);
            if (pvVar7 == (HANDLE)0xffffffffffffffff) {
              DVar5 = GetLastError();
              __acrt_errno_map_os_error(DVar5);
              pbVar1 = (byte *)((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x38 +
                               (ulonglong)(*param_2 & 0x3f) * 0x40);
              *pbVar1 = *pbVar1 & 0xfe;
              _free_osfhnd(*param_2);
              goto LAB_140025861;
            }
            *(HANDLE *)
             ((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x28 +
             (ulonglong)(*param_2 & 0x3f) * 0x40) = pvVar7;
          }
          return 0;
        }
      }
      else {
        _FileHandle = *param_2;
      }
      _close_nolock(_FileHandle);
      return local_94;
    }
    DVar5 = GetLastError();
    __acrt_errno_map_os_error(DVar5);
    pbVar1 = (byte *)((&DAT_140039600)[(longlong)(int)*param_2 >> 6] + 0x38 +
                     (ulonglong)(*param_2 & 0x3f) * 0x40);
    *pbVar1 = *pbVar1 & 0xfe;
    CloseHandle(pvVar7);
    if (DVar5 == 0) {
      puVar6 = __doserrno();
      *puVar6 = 0xd;
    }
  }
LAB_140025861:
  puVar6 = __doserrno();
  return *puVar6;
}



ulong FUN_140025bc8(LPCWSTR param_1,uint param_2,int param_3,ulonglong param_4,uint *param_5,
                   int param_6)

{
  byte *pbVar1;
  ulong uVar2;
  ulong *puVar3;
  int local_18;
  ulong local_14;
  
  if (((param_5 == (uint *)0x0) || (*param_5 = 0xffffffff, param_1 == (LPCWSTR)0x0)) ||
     ((param_6 != 0 && ((param_4 & 0xfffffe7f) != 0)))) {
    puVar3 = __doserrno();
    uVar2 = 0x16;
    *puVar3 = 0x16;
    FUN_140011e58();
  }
  else {
    local_18 = 0;
    local_14 = 0;
    uVar2 = FUN_1400257e0(&local_18,param_5,param_1,param_2,param_3);
    if (local_18 != 0) {
      if (uVar2 != 0) {
        pbVar1 = (byte *)((&DAT_140039600)[(longlong)(int)*param_5 >> 6] + 0x38 +
                         (ulonglong)(*param_5 & 0x3f) * 0x40);
        *pbVar1 = *pbVar1 & 0xfe;
      }
      local_14 = uVar2;
      FID_conflict___acrt_lowio_lock_fh(*param_5);
    }
    if (uVar2 != 0) {
      *param_5 = 0xffffffff;
    }
  }
  return uVar2;
}



// Library Function - Single Match
//  struct `anonymous namespace'::file_options __cdecl decode_options(int,int,int)
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

file_options __cdecl decode_options(int param_1,int param_2,int param_3)

{
  code *pcVar1;
  file_options fVar2;
  undefined4 uVar3;
  errno_t eVar4;
  ulong *puVar5;
  uint uVar6;
  int iVar7;
  undefined4 in_register_0000000c;
  byte *pbVar8;
  uint uVar9;
  byte in_R9B;
  int local_res10 [2];
  
  pbVar8 = (byte *)CONCAT44(in_register_0000000c,param_1);
  *pbVar8 = 0;
  uVar6 = param_2 & 3;
  uVar9 = 0xffffffff;
  if (uVar6 == 0) {
    iVar7 = -0x80000000;
  }
  else if (uVar6 == 1) {
    iVar7 = (-(uint)((param_2 & 0x70000U) != 0 && (param_2 & 8U) != 0) & 0x80000000) + 0x40000000;
  }
  else if (uVar6 == 2) {
    iVar7 = -0x40000000;
  }
  else {
    puVar5 = __doserrno();
    *puVar5 = 0x16;
    FUN_140011e58();
    iVar7 = -1;
  }
  *(int *)(pbVar8 + 4) = iVar7;
  uVar6 = param_2 & 0x700;
  if (uVar6 == 0) {
LAB_140025d75:
    uVar3 = 3;
  }
  else if (uVar6 == 0x100) {
    uVar3 = 4;
  }
  else if (uVar6 == 0x200) {
LAB_140025d67:
    uVar3 = 5;
  }
  else if (uVar6 == 0x300) {
    uVar3 = 2;
  }
  else {
    if (uVar6 == 0x400) goto LAB_140025d75;
    if (uVar6 != 0x500) {
      if (uVar6 == 0x600) goto LAB_140025d67;
      if (uVar6 != 0x700) {
        puVar5 = __doserrno();
        *puVar5 = 0x16;
        FUN_140011e58();
        iVar7 = *(int *)(pbVar8 + 4);
        uVar3 = 0xffffffff;
        goto LAB_140025d7a;
      }
    }
    uVar3 = 1;
  }
LAB_140025d7a:
  *(undefined4 *)(pbVar8 + 8) = uVar3;
  if (param_3 == 0x10) {
    uVar9 = 0;
  }
  else if (param_3 == 0x20) {
    uVar9 = 1;
  }
  else if (param_3 == 0x30) {
    uVar9 = 2;
  }
  else if (param_3 == 0x40) {
    uVar9 = 3;
  }
  else if (param_3 == 0x80) {
    uVar9 = (uint)(iVar7 == -0x80000000);
  }
  else {
    puVar5 = __doserrno();
    *puVar5 = 0x16;
    FUN_140011e58();
  }
  *(undefined4 *)(pbVar8 + 0x14) = 0;
  *(uint *)(pbVar8 + 0xc) = uVar9;
  *(undefined4 *)(pbVar8 + 0x10) = 0x80;
  if ((char)param_2 < '\0') {
    *pbVar8 = *pbVar8 | 0x10;
  }
  if ((param_2 & 0x8000U) == 0) {
    if ((param_2 & 0x74000U) == 0) {
      eVar4 = _get_fmode(local_res10);
      if (eVar4 != 0) {
        _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
        pcVar1 = (code *)swi(3);
        fVar2 = (file_options)(*pcVar1)();
        return fVar2;
      }
      if (local_res10[0] == 0x8000) goto LAB_140025e0b;
    }
    *pbVar8 = *pbVar8 | 0x80;
  }
LAB_140025e0b:
  if (((param_2 & 0x100U) != 0) && (-1 < (char)(~(byte)DAT_14003a0d8 & in_R9B))) {
    *(undefined4 *)(pbVar8 + 0x10) = 1;
  }
  if ((param_2 & 0x40U) != 0) {
    *(uint *)(pbVar8 + 0x14) = *(uint *)(pbVar8 + 0x14) | 0x4000000;
    *(uint *)(pbVar8 + 4) = *(uint *)(pbVar8 + 4) | 0x10000;
    *(uint *)(pbVar8 + 0xc) = *(uint *)(pbVar8 + 0xc) | 4;
  }
  if (((uint)param_2 >> 0xc & 1) != 0) {
    *(uint *)(pbVar8 + 0x10) = *(uint *)(pbVar8 + 0x10) | 0x100;
  }
  if (((uint)param_2 >> 0xd & 1) != 0) {
    *(uint *)(pbVar8 + 0x14) = *(uint *)(pbVar8 + 0x14) | 0x2000000;
  }
  if ((param_2 & 0x20U) == 0) {
    if ((param_2 & 0x10U) != 0) {
      *(uint *)(pbVar8 + 0x14) = *(uint *)(pbVar8 + 0x14) | 0x10000000;
    }
  }
  else {
    *(uint *)(pbVar8 + 0x14) = *(uint *)(pbVar8 + 0x14) | 0x8000000;
  }
  return SUB41(param_1,0);
}



ulong FUN_140025e98(uint param_1)

{
  byte bVar1;
  int iVar2;
  ulong uVar3;
  __int64 _Var4;
  ulong *puVar5;
  WCHAR local_res8 [4];
  
  bVar1 = *(byte *)((&DAT_140039600)[(longlong)(int)param_1 >> 6] + 0x38 +
                   (ulonglong)(param_1 & 0x3f) * 0x40);
  if (((bVar1 & 0x48) == 0) && ((char)bVar1 < '\0')) {
    _Var4 = common_lseek_nolock___int64_(param_1,-1,2);
    if (_Var4 == -1) {
      puVar5 = __doserrno();
      if (*puVar5 == 0x83) goto LAB_140025f47;
    }
    else {
      local_res8[0] = L'\0';
      iVar2 = FUN_14001fc8c(param_1,local_res8,1);
      if ((iVar2 == 0) && (local_res8[0] == L'\x1a')) {
        iVar2 = _chsize_nolock(param_1,_Var4);
        if (iVar2 == -1) goto LAB_140025efa;
      }
      _Var4 = common_lseek_nolock___int64_(param_1,0,0);
      if (_Var4 != -1) goto LAB_140025f47;
    }
LAB_140025efa:
    puVar5 = __doserrno();
    uVar3 = *puVar5;
  }
  else {
LAB_140025f47:
    uVar3 = 0;
  }
  return uVar3;
}



ulonglong FUN_140025f5c(uint param_1,byte *param_2,uint param_3,char *param_4)

{
  code *pcVar1;
  errno_t eVar2;
  int iVar3;
  ulong *puVar4;
  __int64 _Var5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  uint local_res8 [2];
  
  iVar9 = 0;
  *param_4 = '\0';
  if (-1 < *(char *)((&DAT_140039600)[(longlong)(int)param_1 >> 6] + 0x38 +
                    (ulonglong)(param_1 & 0x3f) * 0x40)) {
    return 0;
  }
  uVar8 = 0;
  if ((param_3 & 0x74000) == 0) {
    local_res8[0] = 0;
    eVar2 = _get_fmode((int *)local_res8);
    if (eVar2 != 0) {
      _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      pcVar1 = (code *)swi(3);
      uVar6 = (*pcVar1)();
      return uVar6;
    }
    if ((local_res8[0] & 0x74000) == 0) {
      param_3 = param_3 | 0x4000;
    }
    else {
      param_3 = param_3 | local_res8[0] & 0x74000;
    }
  }
  uVar7 = param_3 & 0x74000;
  if (uVar7 == 0x4000) {
    *param_4 = '\0';
  }
  else if ((uVar7 - 0x10000 & 0xffffbfff) == 0) {
    if ((param_3 & 0x301) == 0x301) goto LAB_140026026;
  }
  else if ((uVar7 - 0x20000 & 0xffffbfff) == 0) {
LAB_140026026:
    *param_4 = '\x02';
  }
  else if ((uVar7 - 0x40000 & 0xffffbfff) == 0) {
    *param_4 = '\x01';
  }
  if ((param_3 & 0x70000) == 0) {
    return 0;
  }
  if ((*param_2 & 0x40) != 0) {
    return 0;
  }
  uVar7 = *(uint *)(param_2 + 4) & 0xc0000000;
  iVar10 = iVar9;
  if (uVar7 == 0x40000000) {
LAB_140026067:
    uVar7 = *(uint *)(param_2 + 8);
    if (uVar7 == 0) {
      return 0;
    }
    if (uVar7 < 3) {
LAB_140026085:
      iVar10 = 1;
LAB_14002608a:
      if (uVar8 != 0) goto LAB_140026092;
      goto LAB_140026160;
    }
    if (4 < uVar7) {
      if (uVar7 != 5) {
        return 0;
      }
      goto LAB_140026085;
    }
    _Var5 = common_lseek_nolock___int64_(param_1,0,2);
    if (_Var5 != 0) {
      _Var5 = common_lseek_nolock___int64_(param_1,0,0);
      if (_Var5 == -1) goto LAB_1400260fd;
      uVar8 = *(uint *)(param_2 + 4) >> 0x1f;
      goto LAB_14002608a;
    }
  }
  else {
    if (uVar7 != 0x80000000) {
      if (uVar7 != 0xc0000000) {
        return 0;
      }
      goto LAB_140026067;
    }
LAB_140026092:
    local_res8[0] = 0;
    iVar3 = FUN_14001fc8c(param_1,(LPWSTR)local_res8,3);
    if ((0 < iVar3) && (iVar10 == 1)) {
      iVar10 = 0;
    }
    if (iVar3 == -1) goto LAB_1400260fd;
    if (iVar3 == 2) {
LAB_140026114:
      if ((local_res8[0] & 0xffff) == 0xfffe) {
        puVar4 = __doserrno();
        *puVar4 = 0x16;
        goto LAB_1400260fd;
      }
      if ((local_res8[0] & 0xffff) == 0xfeff) {
        _Var5 = common_lseek_nolock___int64_(param_1,2,0);
        if (_Var5 == -1) goto LAB_1400260fd;
        *param_4 = '\x02';
        goto LAB_140026160;
      }
    }
    else if (iVar3 == 3) {
      if (local_res8[0] == 0xbfbbef) {
        *param_4 = '\x01';
        goto LAB_140026160;
      }
      goto LAB_140026114;
    }
    _Var5 = common_lseek_nolock___int64_(param_1,0,0);
    if (_Var5 == -1) goto LAB_1400260fd;
LAB_140026160:
    if (iVar10 == 0) {
      return 0;
    }
  }
  local_res8[0] = 0;
  if (*param_4 == '\x01') {
    local_res8[0] = 0xbfbbef;
    iVar10 = 3;
LAB_140026191:
    if (iVar10 == 0) {
      return 0;
    }
  }
  else {
    iVar10 = iVar9;
    if (*param_4 != '\x02') goto LAB_140026191;
    local_res8[0] = 0xfeff;
    iVar10 = 2;
  }
  while (iVar3 = FUN_14001f008(param_1,(short *)((longlong)local_res8 + (longlong)iVar9),
                               iVar10 - iVar9), iVar3 != -1) {
    iVar9 = iVar9 + iVar3;
    if (iVar10 <= iVar9) {
      return 0;
    }
  }
LAB_1400260fd:
  puVar4 = __doserrno();
  return (ulonglong)*puVar4;
}



undefined2 FUN_1400261f0(undefined2 param_1)

{
  bool bVar1;
  BOOL BVar2;
  undefined7 extraout_var;
  undefined2 local_res8 [4];
  DWORD local_res10 [6];
  
  local_res8[0] = param_1;
  bVar1 = __dcrt_lowio_ensure_console_output_initialized();
  if (((int)CONCAT71(extraout_var,bVar1) == 0) ||
     (BVar2 = __dcrt_write_console(local_res8,1,local_res10), BVar2 == 0)) {
    local_res8[0] = 0xffff;
  }
  return local_res8[0];
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __acrt_stdio_allocate_buffer_nolock
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_stdio_allocate_buffer_nolock(undefined8 *param_1)

{
  LPVOID pvVar1;
  undefined4 uVar2;
  
  _DAT_140038dc8 = _DAT_140038dc8 + 1;
  uVar2 = 0x1000;
  pvVar1 = _malloc_base(0x1000);
  param_1[1] = pvVar1;
  _free_base((LPVOID)0x0);
  if (param_1[1] == 0) {
    LOCK();
    *(uint *)((longlong)param_1 + 0x14) = *(uint *)((longlong)param_1 + 0x14) | 0x400;
    uVar2 = 2;
    param_1[1] = (longlong)param_1 + 0x1c;
  }
  else {
    LOCK();
    *(uint *)((longlong)param_1 + 0x14) = *(uint *)((longlong)param_1 + 0x14) | 0x40;
  }
  *(undefined4 *)(param_1 + 4) = uVar2;
  *(undefined4 *)(param_1 + 2) = 0;
  *param_1 = param_1[1];
  return;
}



BOOL GetStringTypeW(DWORD dwInfoType,LPCWSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000140026294. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetStringTypeW(dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



// Library Function - Single Match
//  __strncnt
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

size_t __cdecl __strncnt(char *_String,size_t _Cnt)

{
  char cVar1;
  size_t sVar2;
  
  sVar2 = 0;
  cVar1 = *_String;
  while ((cVar1 != '\0' && (sVar2 != _Cnt))) {
    sVar2 = sVar2 + 1;
    cVar1 = _String[sVar2];
  }
  return sVar2;
}



void FUN_1400262b4(ulonglong param_1,byte *param_2,ulonglong param_3,undefined8 *param_4)

{
  byte bVar1;
  ushort uVar2;
  ulong *puVar3;
  uint uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  uint *puVar7;
  byte *pbVar8;
  ulonglong uVar9;
  byte bVar10;
  undefined8 *puVar11;
  ulonglong uVar12;
  undefined auStack_68 [24];
  uint auStack_50 [6];
  ulonglong local_38;
  
  local_38 = DAT_140038010 ^ (ulonglong)auStack_68;
  puVar11 = (undefined8 *)&DAT_14003a0d0;
  if (param_4 != (undefined8 *)0x0) {
    puVar11 = param_4;
  }
  pbVar8 = &DAT_140030e49;
  if (param_2 != (byte *)0x0) {
    pbVar8 = param_2;
  }
  uVar12 = 1;
  if (param_2 != (byte *)0x0) {
    uVar12 = param_3;
  }
  puVar7 = (uint *)(-(ulonglong)(param_2 != (byte *)0x0) & param_1);
  if (uVar12 == 0) goto LAB_140026471;
  uVar2 = *(ushort *)((longlong)puVar11 + 6);
  uVar9 = (ulonglong)uVar2;
  if (uVar2 == 0) {
    bVar1 = *pbVar8;
    pbVar8 = pbVar8 + 1;
    if (-1 < (char)bVar1) {
      if (puVar7 != (uint *)0x0) {
        *puVar7 = (uint)bVar1;
      }
      goto LAB_140026471;
    }
    if ((bVar1 & 0xe0) == 0xc0) {
      bVar10 = 2;
    }
    else if ((bVar1 & 0xf0) == 0xe0) {
      bVar10 = 3;
    }
    else {
      if ((bVar1 & 0xf8) != 0xf0) goto LAB_14002645d;
      bVar10 = 4;
    }
    uVar9 = (ulonglong)bVar10;
    uVar4 = (1 << (7 - bVar10 & 0x1f)) - 1U & (uint)bVar1;
LAB_1400263b2:
    uVar6 = uVar9 & 0xff;
    uVar5 = uVar6;
    if (uVar12 <= uVar6) {
      uVar5 = uVar12;
    }
    while ((ulonglong)((longlong)pbVar8 - (longlong)param_2) < uVar5) {
      bVar1 = *pbVar8;
      pbVar8 = pbVar8 + 1;
      if ((bVar1 & 0xc0) != 0x80) goto LAB_14002645d;
      uVar4 = bVar1 & 0x3f | uVar4 << 6;
    }
    if (uVar5 < uVar6) {
      *(ushort *)((longlong)puVar11 + 4) = (ushort)bVar10;
      *(ushort *)((longlong)puVar11 + 6) = (ushort)(byte)((char)uVar9 - (char)uVar5);
      *(uint *)puVar11 = uVar4;
      goto LAB_140026471;
    }
    if ((0x7ff < uVar4 - 0xd800) && (uVar4 < 0x110000)) {
      auStack_50[2] = 0x80;
      auStack_50[3] = 0x800;
      auStack_50[4] = 0x10000;
      if (auStack_50[bVar10] <= uVar4) {
        if (puVar7 != (uint *)0x0) {
          *puVar7 = uVar4;
        }
        *puVar11 = 0;
        goto LAB_140026471;
      }
    }
  }
  else {
    bVar10 = *(byte *)((longlong)puVar11 + 4);
    uVar4 = *(uint *)puVar11;
    if ((((byte)(bVar10 - 2) < 3) && ((byte)uVar2 != 0)) && ((byte)uVar2 < bVar10))
    goto LAB_1400263b2;
  }
LAB_14002645d:
  *puVar11 = 0;
  puVar3 = __doserrno();
  *puVar3 = 0x2a;
LAB_140026471:
  __security_check_cookie(local_38 ^ (ulonglong)auStack_68);
  return;
}



// Library Function - Single Match
//  fegetenv
// 
// Library: Visual Studio 2017 Release

undefined8 fegetenv(uint *param_1)

{
  uint uVar1;
  
  uVar1 = FUN_1400273f8();
  *param_1 = uVar1;
  uVar1 = FUN_14002731c();
  param_1[1] = uVar1;
  return 0;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Single Match
//  fesetenv
// 
// Library: Visual Studio 2017 Release

undefined8 fesetenv(int *param_1)

{
  undefined8 uVar1;
  undefined8 local_res8;
  
  __acrt_fenv_set_control();
  __acrt_fenv_set_status();
  local_res8 = 0;
  uVar1 = fegetenv((uint *)&local_res8);
  if ((((int)uVar1 == 0) && (*param_1 == (int)local_res8)) && (param_1[1] == local_res8._4_4_)) {
    uVar1 = 0;
  }
  else {
    uVar1 = 1;
  }
  return uVar1;
}



// Library Function - Single Match
//  feholdexcept
// 
// Library: Visual Studio 2015 Release

undefined8 feholdexcept(undefined8 *param_1)

{
  undefined8 uVar1;
  uint local_res10;
  undefined4 uStackX_14;
  
  local_res10 = 0;
  uStackX_14 = 0;
  uVar1 = fegetenv(&local_res10);
  if ((int)uVar1 == 0) {
    uVar1 = CONCAT44(uStackX_14,local_res10);
    local_res10 = local_res10 | 0x1f;
    *param_1 = uVar1;
    uVar1 = fesetenv((int *)&local_res10);
    if ((int)uVar1 == 0) {
      _clearfp();
      return 0;
    }
  }
  return 1;
}



// Library Function - Single Match
//  ceil
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

double __cdecl ceil(double _X)

{
  double dVar1;
  double extraout_XMM0_Qa;
  double dVar2;
  
  dVar1 = (double)((ulonglong)_X & 0x7fffffffffffffff);
  dVar2 = _X;
  if ((ulonglong)dVar1 < 0x4340000000000000) {
    if ((ulonglong)dVar1 < 0x3ff0000000000000) {
      if (dVar1 != 0.0) {
        if (_X == dVar1) {
          dVar2 = 1.0;
        }
        else {
          dVar2 = -0.0;
        }
      }
    }
    else {
      dVar2 = (double)(~((1L << (0x33U - (char)((ulonglong)_X >> 0x34) & 0x3f)) - 1U) &
                      (ulonglong)_X);
      if ((_X == dVar1) && (dVar2 != _X)) {
        dVar2 = dVar2 + 1.0;
      }
    }
  }
  else if (0x7ff0000000000000 < (ulonglong)dVar1) {
    _handle_nan((ulonglong)_X);
    return extraout_XMM0_Qa;
  }
  return dVar2;
}



// WARNING: Removing unreachable block (ram,0x00014002695d)
// WARNING: Removing unreachable block (ram,0x000140026b09)
// WARNING: Removing unreachable block (ram,0x00014002697b)
// WARNING: Removing unreachable block (ram,0x0001400269af)
// WARNING: Removing unreachable block (ram,0x00014002694f)
// WARNING: Removing unreachable block (ram,0x000140026b40)
// WARNING: Removing unreachable block (ram,0x000140026b42)
// WARNING: Removing unreachable block (ram,0x000140026a60)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  log10
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

double __cdecl log10(double _X)

{
  ulonglong uVar1;
  ulonglong uVar2;
  double dVar3;
  undefined auVar4 [16];
  undefined in_register_00001208 [24];
  double dVar5;
  double dVar6;
  double dVar7;
  double dVar8;
  undefined auVar9 [16];
  double dVar10;
  
  auVar4 = SUB3216(CONCAT248(in_register_00001208,_X),0);
  if (_DAT_14003a0e0 != 0) {
    auVar9 = vpsrlq_avx(auVar4,0x34);
    uVar1 = vmovq_avx(auVar4);
    auVar9 = vpsubq_avx(auVar9,_DAT_14002cce0);
    vcvtdq2pd_avx(auVar9);
    vpand_avx(auVar4,_DAT_14002ccb0);
    vcomisd_avx(ZEXT816(0x7ff0000000000000));
    if (uVar1 != 0x7ff0000000000000) {
      if (uVar1 == 0xfff0000000000000) {
        dVar10 = (double)_log10_special(_X,0xfff8000000000000,2);
        return dVar10;
      }
      _X = (double)_log10_special(_X,uVar1 | 0x8000000000000,3);
    }
    return _X;
  }
  if ((double)((ulonglong)_X & 0x7ff0000000000000) == INFINITY) {
    if (_X == INFINITY) {
      return INFINITY;
    }
    if (_X != -INFINITY) {
      return (double)((ulonglong)_X | 0x8000000000000);
    }
  }
  else {
    dVar10 = (double)(int)(((ulonglong)_X >> 0x34) - 0x3ff);
    if (0.0 < _X) {
      dVar3 = _X;
      dVar5 = (double)((ulonglong)_X & 0xfffffffffffff);
      if (dVar10 == -1023.0) {
        dVar10 = (double)((ulonglong)_X & 0xfffffffffffff | SUB168(_DAT_14002cd90,0)) - 1.0;
        dVar3 = (double)((ulonglong)dVar10 & SUB168(_DAT_14002cd00,0));
        dVar10 = (double)((uint)((ulonglong)dVar10 >> 0x34) - 0x7fd);
        dVar5 = dVar3;
      }
      uVar1 = ((ulonglong)dVar3 & 0xff00000000000) + ((ulonglong)dVar3 & 0x80000000000) * 2;
      if (0.0625 <= (double)((ulonglong)(_X - 1.0) & 0x7fffffffffffffff)) {
        uVar2 = uVar1 >> 0x2c;
        dVar5 = ((double)(uVar1 | SUB168(_DAT_14002cda0,0)) -
                (double)((ulonglong)dVar5 | SUB168(_DAT_14002cda0,0))) *
                *(double *)(&DAT_14002df10 + uVar2 * 8);
        dVar3 = dVar5 * dVar5;
        return *(double *)(&DAT_14002cef0 + uVar2 * 8) + dVar10 * 0.3010299950838089 +
               *(double *)(&DAT_14002d700 + uVar2 * 8) +
               (dVar10 * 5.801722962879576e-10 -
               ((dVar5 * 0.3333333333333333 + 0.5) * dVar3 + dVar5 +
               ((dVar5 * 0.1666666666666667 + 0.2) * dVar5 + 0.25) * dVar3 * dVar3) *
               0.4342944819032518);
      }
      dVar10 = _X - 1.0;
      dVar3 = dVar10 / (dVar10 + 2.0);
      dVar5 = dVar3 + dVar3;
      dVar6 = dVar5 * dVar5;
      dVar7 = dVar6 * dVar5;
      dVar8 = (double)((ulonglong)dVar10 & SUB168(_DAT_14002ced0,0));
      dVar10 = (((dVar6 * 0.01250000000377175 + 0.08333333333333179) * dVar7 +
                (dVar6 * 0.0004348877777076146 + 0.002232139987919448) * dVar7 * dVar7 * dVar5) -
               dVar10 * dVar3) + (dVar10 - dVar8);
      return dVar8 * 7.349550096401511e-07 + dVar10 * 7.349550096401511e-07 +
             dVar10 * 0.4342937469482422 + dVar8 * 0.4342937469482422;
    }
    if (_X == 0.0) {
      dVar10 = (double)_log10_special(_X,0xfff0000000000000,1);
      return dVar10;
    }
  }
  dVar10 = (double)_log10_special(_X,0xfff8000000000000,2);
                    // WARNING: Read-only address (ram,0x00014002ccb0) is written
                    // WARNING: Read-only address (ram,0x00014002cce0) is written
                    // WARNING: Read-only address (ram,0x00014002cd00) is written
                    // WARNING: Read-only address (ram,0x00014002cd90) is written
                    // WARNING: Read-only address (ram,0x00014002cda0) is written
                    // WARNING: Read-only address (ram,0x00014002ced0) is written
  return dVar10;
}



// Library Function - Single Match
//  __acrt_CompareStringW
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong __acrt_CompareStringW
                    (wchar_t *param_1,DWORD param_2,wchar_t *param_3,int param_4,wchar_t *param_5,
                    int param_6)

{
  size_t sVar1;
  ulonglong uVar2;
  
  if (0 < param_4) {
    sVar1 = wcsnlen(param_3,(longlong)param_4);
    param_4 = (int)sVar1;
  }
  if (0 < param_6) {
    sVar1 = wcsnlen(param_5,(longlong)param_6);
    param_6 = (int)sVar1;
  }
  if ((param_4 == 0) || (param_6 == 0)) {
    uVar2 = (ulonglong)((param_4 - param_6 >> 0x1f & 0xfffffffeU) + 3);
    if (param_4 - param_6 == 0) {
      uVar2 = 2;
    }
  }
  else {
    uVar2 = __acrt_CompareStringEx(param_1,param_2,param_3,param_4,param_5,param_6,0,0,0);
  }
  return uVar2;
}



// Library Function - Single Match
//  __acrt_CompareStringA
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __acrt_CompareStringA
               (__crt_locale_pointers *param_1,wchar_t *param_2,DWORD param_3,byte *param_4,
               int param_5,byte *param_6,int param_7,UINT param_8)

{
  longlong local_28;
  longlong local_20 [2];
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,param_1);
  FUN_140026d18(local_20,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  if (local_10 != '\0') {
    *(uint *)(local_28 + 0x3a8) = *(uint *)(local_28 + 0x3a8) & 0xfffffffd;
  }
  return;
}



// WARNING: Function: _alloca_probe replaced with injection: alloca_probe

void FUN_140026d18(longlong *param_1,wchar_t *param_2,DWORD param_3,byte *param_4,int param_5,
                  byte *param_6,int param_7,UINT param_8)

{
  byte bVar1;
  longlong lVar2;
  DWORD DVar3;
  wchar_t *pwVar4;
  BOOL BVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  size_t sVar9;
  BYTE *pBVar10;
  ulonglong uVar11;
  undefined4 *puVar12;
  undefined4 *puVar13;
  ulonglong uVar14;
  undefined *puVar15;
  undefined *puVar16;
  undefined *puVar17;
  undefined *puVar18;
  undefined8 uStackY_d0;
  undefined auStackY_c8 [32];
  DWORD local_80 [4];
  wchar_t *local_70;
  _cpinfo local_68;
  ulonglong local_50;
  
  puVar15 = auStackY_c8;
  puVar17 = auStackY_c8;
  local_50 = DAT_140038010 ^ (ulonglong)(local_80 + 2);
  local_80[2] = param_3;
  local_70 = param_2;
  if (param_5 < 1) {
    puVar18 = auStackY_c8;
    if (param_5 < -1) goto LAB_140027047;
  }
  else {
    uStackY_d0 = 0x140026d6d;
    sVar9 = __strncnt((char *)param_4,(longlong)param_5);
    param_5 = (int)sVar9;
  }
  if (param_7 < 1) {
    puVar18 = auStackY_c8;
    if (param_7 < -1) goto LAB_140027047;
  }
  else {
    uStackY_d0 = 0x140026d86;
    sVar9 = __strncnt((char *)param_6,(longlong)param_7);
    param_7 = (int)sVar9;
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*param_1 + 0xc);
  }
  if ((param_5 == 0) || (param_7 == 0)) {
    puVar18 = auStackY_c8;
    if ((param_5 == param_7) ||
       ((puVar18 = auStackY_c8, 1 < param_7 || (puVar18 = auStackY_c8, 1 < param_5))))
    goto LAB_140027047;
    uStackY_d0 = 0x140026df4;
    BVar5 = GetCPInfo(param_8,&local_68);
    puVar18 = auStackY_c8;
    if (BVar5 == 0) goto LAB_140027047;
    if (0 < param_5) {
      puVar18 = auStackY_c8;
      if (1 < local_68.MaxCharSize) {
        pBVar10 = local_68.LeadByte;
        while (((puVar18 = auStackY_c8, local_68.LeadByte[0] != 0 &&
                (puVar18 = auStackY_c8, pBVar10[1] != 0)) &&
               ((bVar1 = *param_4, bVar1 < *pBVar10 ||
                (puVar18 = auStackY_c8, pBVar10[1] <= bVar1 && bVar1 != pBVar10[1]))))) {
          pBVar10 = pBVar10 + 2;
          local_68.LeadByte[0] = *pBVar10;
        }
      }
      goto LAB_140027047;
    }
    if (0 < param_7) {
      puVar18 = auStackY_c8;
      if (1 < local_68.MaxCharSize) {
        pBVar10 = local_68.LeadByte;
        while (((puVar18 = auStackY_c8, local_68.LeadByte[0] != 0 &&
                (puVar18 = auStackY_c8, pBVar10[1] != 0)) &&
               ((bVar1 = *param_6, bVar1 < *pBVar10 ||
                (puVar18 = auStackY_c8, pBVar10[1] <= bVar1 && bVar1 != pBVar10[1]))))) {
          pBVar10 = pBVar10 + 2;
          local_68.LeadByte[0] = *pBVar10;
        }
      }
      goto LAB_140027047;
    }
  }
  uStackY_d0 = 0x140026e78;
  iVar6 = __acrt_MultiByteToWideChar(param_8,9,(LPCSTR)param_4,param_5,(LPWSTR)0x0,0);
  puVar18 = auStackY_c8;
  if (iVar6 == 0) goto LAB_140027047;
  uVar14 = (longlong)iVar6 * 2 + 0x10;
  uVar14 = -(ulonglong)((ulonglong)((longlong)iVar6 * 2) < uVar14) & uVar14;
  if (uVar14 == 0) {
    puVar12 = (undefined4 *)0x0;
LAB_140026ef7:
    if (puVar12 != (undefined4 *)0x0) {
      *(int *)(puVar17 + 0x28) = iVar6;
      *(undefined4 **)(puVar17 + 0x20) = puVar12;
      *(undefined8 *)(puVar17 + -8) = 0x140026f1d;
      iVar7 = __acrt_MultiByteToWideChar
                        (param_8,1,(LPCSTR)param_4,param_5,*(LPWSTR *)(puVar17 + 0x20),
                         *(int *)(puVar17 + 0x28));
      if (iVar7 != 0) {
        *(undefined4 *)(puVar17 + 0x28) = 0;
        *(undefined8 *)(puVar17 + 0x20) = 0;
        *(undefined8 *)(puVar17 + -8) = 0x140026f43;
        iVar7 = __acrt_MultiByteToWideChar
                          (param_8,9,(LPCSTR)param_6,param_7,*(LPWSTR *)(puVar17 + 0x20),
                           *(int *)(puVar17 + 0x28));
        if (iVar7 != 0) {
          uVar14 = (longlong)iVar7 * 2 + 0x10;
          uVar14 = -(ulonglong)((ulonglong)((longlong)iVar7 * 2) < uVar14) & uVar14;
          if (uVar14 == 0) {
            puVar13 = (undefined4 *)0x0;
LAB_140026fbb:
            if (puVar13 != (undefined4 *)0x0) {
              *(int *)(puVar17 + 0x28) = iVar7;
              *(undefined4 **)(puVar17 + 0x20) = puVar13;
              *(undefined8 *)(puVar17 + -8) = 0x140026fdd;
              iVar8 = __acrt_MultiByteToWideChar
                                (param_8,1,(LPCSTR)param_6,param_7,*(LPWSTR *)(puVar17 + 0x20),
                                 *(int *)(puVar17 + 0x28));
              if (iVar8 != 0) {
                *(undefined8 *)(puVar17 + 0x40) = 0;
                *(undefined8 *)(puVar17 + 0x38) = 0;
                *(undefined8 *)(puVar17 + 0x30) = 0;
                pwVar4 = local_70;
                DVar3 = local_80[2];
                *(int *)(puVar17 + 0x28) = iVar7;
                *(undefined4 **)(puVar17 + 0x20) = puVar13;
                *(undefined8 *)(puVar17 + -8) = 0x14002700f;
                __acrt_CompareStringEx
                          (pwVar4,DVar3,(PCNZWCH)puVar12,iVar6,*(PCNZWCH *)(puVar17 + 0x20),
                           *(int *)(puVar17 + 0x28),*(undefined8 *)(puVar17 + 0x30),
                           *(undefined8 *)(puVar17 + 0x38),*(undefined8 *)(puVar17 + 0x40));
              }
            }
          }
          else {
            if (0x400 < uVar14) {
              *(undefined8 *)(puVar17 + -8) = 0x140026fa5;
              puVar13 = (undefined4 *)_malloc_base(uVar14);
              if (puVar13 != (undefined4 *)0x0) {
                *puVar13 = 0xdddd;
                goto LAB_140026fb3;
              }
              goto LAB_140026fbb;
            }
            uVar11 = uVar14 + 0xf;
            if (uVar11 <= uVar14) {
              uVar11 = 0xffffffffffffff0;
            }
            *(undefined8 *)(puVar17 + -8) = 0x140026f88;
            lVar2 = -(uVar11 & 0xfffffffffffffff0);
            puVar16 = puVar17 + lVar2 + -8;
            puVar13 = (undefined4 *)(puVar17 + lVar2 + 0x48);
            puVar17 = puVar17 + lVar2 + -8;
            if (puVar13 != (undefined4 *)0x0) {
              *puVar13 = 0xcccc;
              puVar17 = puVar16;
LAB_140026fb3:
              puVar13 = puVar13 + 4;
              goto LAB_140026fbb;
            }
          }
          if ((puVar13 != (undefined4 *)0x0) && (puVar13[-4] == 0xdddd)) {
            *(undefined8 *)(puVar17 + -8) = 0x14002702b;
            _free_base(puVar13 + -4);
          }
        }
      }
    }
  }
  else {
    if (0x400 < uVar14) {
      uStackY_d0 = 0x140026ee1;
      puVar12 = (undefined4 *)_malloc_base(uVar14);
      puVar17 = auStackY_c8;
      if (puVar12 != (undefined4 *)0x0) {
        *puVar12 = 0xdddd;
        goto LAB_140026eef;
      }
      goto LAB_140026ef7;
    }
    uVar11 = uVar14 + 0xf;
    if (uVar11 <= uVar14) {
      uVar11 = 0xffffffffffffff0;
    }
    uStackY_d0 = 0x140026ec0;
    lVar2 = -(uVar11 & 0xfffffffffffffff0);
    puVar17 = auStackY_c8 + lVar2 + -8;
    puVar15 = auStackY_c8 + lVar2 + -8;
    puVar12 = (undefined4 *)((longlong)local_80 + lVar2);
    if (puVar12 != (undefined4 *)0x0) {
      *puVar12 = 0xcccc;
LAB_140026eef:
      puVar12 = puVar12 + 4;
      puVar17 = puVar15;
      goto LAB_140026ef7;
    }
  }
  puVar18 = puVar17;
  if ((puVar12 != (undefined4 *)0x0) && (puVar12[-4] == 0xdddd)) {
    *(undefined8 *)(puVar17 + -8) = 0x140027045;
    _free_base(puVar12 + -4);
  }
LAB_140027047:
  uVar14 = local_50 ^ (ulonglong)(local_80 + 2);
  *(undefined8 *)(puVar18 + -8) = 0x140027053;
  __security_check_cookie(uVar14);
  return;
}



// Library Function - Single Match
//  _chsize_nolock
// 
// Library: Visual Studio 2015 Release

int __cdecl _chsize_nolock(int _FileHandle,longlong _Size)

{
  ulong uVar1;
  int _Mode;
  int iVar2;
  BOOL BVar3;
  DWORD DVar4;
  __int64 _Var5;
  ulong *puVar6;
  __int64 _Var7;
  short *psVar8;
  HANDLE hFile;
  longlong lVar9;
  uint uVar10;
  
  _Var5 = common_lseek_nolock___int64_(_FileHandle,0,1);
  if ((_Var5 == -1) || (_Var7 = common_lseek_nolock___int64_(_FileHandle,0,2), _Var7 == -1))
  goto LAB_140027099;
  lVar9 = _Size - _Var7;
  if (lVar9 < 1) {
    if (lVar9 < 0) {
      _Var7 = common_lseek_nolock___int64_(_FileHandle,_Size,0);
      if (_Var7 == -1) goto LAB_140027099;
      hFile = (HANDLE)_get_osfhandle(_FileHandle);
      BVar3 = SetEndOfFile(hFile);
      if (BVar3 == 0) {
        puVar6 = __doserrno();
        *puVar6 = 0xd;
        puVar6 = __doserrno();
        DVar4 = GetLastError();
        *puVar6 = DVar4;
        goto LAB_140027099;
      }
    }
  }
  else {
    psVar8 = (short *)_calloc_base(0x1000,1);
    if (psVar8 == (short *)0x0) {
      puVar6 = __doserrno();
      *puVar6 = 0xc;
LAB_140027179:
      puVar6 = __doserrno();
      uVar1 = *puVar6;
      _free_base(psVar8);
      return uVar1;
    }
    _Mode = _setmode_nolock(_FileHandle,0x8000);
    do {
      uVar10 = (uint)lVar9;
      if (0xfff < lVar9) {
        uVar10 = 0x1000;
      }
      iVar2 = FUN_14001f0f4(_FileHandle,psVar8,uVar10);
      if (iVar2 == -1) {
        puVar6 = __doserrno();
        if (*puVar6 == 5) {
          puVar6 = __doserrno();
          *puVar6 = 0xd;
        }
        goto LAB_140027179;
      }
      lVar9 = lVar9 - iVar2;
    } while (0 < lVar9);
    _setmode_nolock(_FileHandle,_Mode);
    _free_base(psVar8);
  }
  _Var5 = common_lseek_nolock___int64_(_FileHandle,_Var5,0);
  if (_Var5 != -1) {
    return 0;
  }
LAB_140027099:
  puVar6 = __doserrno();
  return *puVar6;
}



// Library Function - Single Match
//  __dcrt_lowio_ensure_console_output_initialized
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

bool __dcrt_lowio_ensure_console_output_initialized(void)

{
  if (DAT_140038ae8 == (HANDLE)0xfffffffffffffffe) {
    DAT_140038ae8 = CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  }
  return DAT_140038ae8 != (HANDLE)0xffffffffffffffff;
}



// Library Function - Single Match
//  __dcrt_write_console
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

BOOL __dcrt_write_console(void *param_1,DWORD param_2,LPDWORD param_3)

{
  BOOL BVar1;
  DWORD DVar2;
  
  BVar1 = WriteConsoleW(DAT_140038ae8,param_1,param_2,param_3,(LPVOID)0x0);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 6) {
      if (DAT_140038ae8 < (HANDLE)0xfffffffffffffffe) {
        CloseHandle(DAT_140038ae8);
      }
      DAT_140038ae8 =
           CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
      BVar1 = WriteConsoleW(DAT_140038ae8,param_1,param_2,param_3,(LPVOID)0x0);
    }
  }
  return BVar1;
}



void FUN_140027300(void)

{
  if (DAT_140038ae8 < (HANDLE)0xfffffffffffffffe) {
    CloseHandle(DAT_140038ae8);
  }
  return;
}



uint FUN_14002731c(void)

{
  uint uVar1;
  uint in_MXCSR;
  
  uVar1 = in_MXCSR & 0x3f;
  uVar1 = (uVar1 >> 1 & 1) << 5 | (uVar1 >> 2 & 1) << 3 | (uVar1 >> 3 & 1) << 2 |
          (uVar1 >> 4 & 1) * 2 | (in_MXCSR & 1) << 4 | uVar1 >> 5;
  return uVar1 << 0x18 | uVar1;
}



// Library Function - Single Match
//  __acrt_fenv_set_status
// 
// Library: Visual Studio 2017 Release

void __acrt_fenv_set_status(void)

{
  return;
}



uint FUN_1400273f8(void)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint in_MXCSR;
  
  uVar4 = 0;
  uVar1 = (ushort)in_MXCSR & 0x8040;
  if (uVar1 == 0x8000) {
    uVar4 = 0xc00;
  }
  else if (uVar1 == 0x40) {
    uVar4 = 0x800;
  }
  else if (uVar1 == 0x8040) {
    uVar4 = 0x400;
  }
  uVar2 = in_MXCSR & 0x6000;
  if (uVar2 == 0) {
    uVar3 = 0;
  }
  else if (uVar2 == 0x2000) {
    uVar3 = 0x100;
  }
  else if (uVar2 == 0x4000) {
    uVar3 = 0x200;
  }
  else {
    uVar3 = 0x300;
    if (uVar2 != 0x6000) {
      uVar3 = 0;
    }
  }
  uVar2 = ((in_MXCSR & 0xffff) >> 8 & 1) << 5 | ((in_MXCSR & 0xffff) >> 7 & 1) << 4 |
          ((in_MXCSR & 0xffff) >> 9 & 1) << 3 | ((in_MXCSR & 0xffff) >> 10 & 1) << 2 |
          ((in_MXCSR & 0xffff) >> 0xb & 1) * 2 | (in_MXCSR & 0xffff) >> 0xc & 1;
  return uVar3 << 0x16 | uVar2 << 0x18 | uVar2 | uVar3 | uVar4;
}



// Library Function - Single Match
//  __acrt_fenv_set_control
// 
// Library: Visual Studio 2017 Release

void __acrt_fenv_set_control(void)

{
  return;
}



// Library Function - Single Match
//  _clearfp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint __cdecl _clearfp(void)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  uVar1 = _get_fpsr();
  _fclrf();
  uVar4 = 0;
  if ((uVar1 & 0x3f) != 0) {
    uVar2 = (uVar1 & 1) << 4;
    uVar4 = uVar2 | 8;
    if ((uVar1 & 4) == 0) {
      uVar4 = uVar2;
    }
    uVar2 = uVar4 | 4;
    if ((uVar1 & 8) == 0) {
      uVar2 = uVar4;
    }
    uVar3 = uVar2 | 2;
    if ((uVar1 & 0x10) == 0) {
      uVar3 = uVar2;
    }
    uVar4 = uVar3 | 1;
    if ((uVar1 & 0x20) == 0) {
      uVar4 = uVar3;
    }
    if ((uVar1 & 2) != 0) {
      uVar4 = uVar4 | 0x80000;
    }
  }
  return uVar4;
}



// Library Function - Single Match
//  _call_matherr
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8
_call_matherr(int param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
             undefined8 param_5,undefined8 param_6,uint param_7)

{
  undefined8 uVar1;
  int local_38 [2];
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  local_20 = param_5;
  local_18 = param_6;
  local_38[0] = param_1;
  local_30 = param_3;
  local_28 = param_4;
  _ctrlfp(param_7,0xffc0);
  uVar1 = __acrt_invoke_user_matherr(local_38);
  if ((int)uVar1 == 0) {
    _set_errno_from_matherr(param_1);
  }
  return local_18;
}



// Library Function - Single Match
//  _exception_enabled
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

bool _exception_enabled(uint param_1,ulonglong param_2)

{
  uint uVar1;
  
  uVar1 = param_1 & 0x1f;
  if (((param_1 & 8) == 0) || (-1 < (char)param_2)) {
    if (((param_1 & 4) == 0) || ((param_2 >> 9 & 1) == 0)) {
      if (((param_1 & 1) == 0) || ((param_2 >> 10 & 1) == 0)) {
        if (((param_1 & 2) != 0) && ((param_2 >> 0xb & 1) != 0)) {
          if ((param_1 & 0x10) != 0) {
            _set_statfp();
          }
          uVar1 = param_1 & 0x1d;
        }
      }
      else {
        _set_statfp();
        uVar1 = param_1 & 0x1e;
      }
    }
    else {
      _set_statfp();
      uVar1 = param_1 & 0x1b;
    }
  }
  else {
    _set_statfp();
    uVar1 = param_1 & 0x17;
  }
  if (((param_1 & 0x10) != 0) && ((param_2 >> 0xc & 1) != 0)) {
    _set_statfp();
    uVar1 = uVar1 & 0xffffffef;
  }
  return uVar1 == 0;
}



// Library Function - Single Match
//  _handle_nan
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong _handle_nan(ulonglong param_1)

{
  return 0x8000000000000;
}



// Library Function - Single Match
//  _handle_error
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _handle_error(undefined8 param_1,uint param_2,undefined8 param_3,int param_4,uint param_5,
                  uint param_6,undefined8 param_7,undefined8 param_8,int param_9)

{
  undefined8 uVar1;
  bool bVar2;
  uint uVar3;
  undefined4 extraout_var_00;
  undefined7 extraout_var;
  undefined auStackY_118 [32];
  ulonglong local_d8;
  undefined8 local_d0;
  undefined8 local_c8;
  uint local_b8 [12];
  undefined8 local_88;
  uint local_78;
  ulonglong local_48;
  
  local_48 = DAT_140038010 ^ (ulonglong)auStackY_118;
  uVar3 = _ctrlfp(0x1f80,0xffc0);
  local_d8 = CONCAT44(extraout_var_00,uVar3);
  local_d0 = param_3;
  local_c8 = param_3;
  bVar2 = _exception_enabled(param_5,local_d8);
  uVar1 = param_8;
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    if (param_9 == 2) {
      local_88 = param_8;
      local_78 = local_78 & 0xffffffe3 | 3;
    }
    _raise_exc(local_b8,&local_d8,(ulonglong)param_5,param_2,&param_7,&local_d0);
  }
  bVar2 = __acrt_has_user_matherr();
  if ((bVar2) && (param_4 != 0)) {
    _call_matherr(param_4,(ulonglong)param_6,param_1,param_7,uVar1,local_d0,(uint)local_d8);
  }
  else {
    _set_errno_from_matherr(param_4);
    _ctrlfp((uint)local_d8,0xffc0);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY_118);
  return;
}



// WARNING: Removing unreachable block (ram,0x000140027939)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __acrt_initialize_fma3
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 __acrt_initialize_fma3(void)

{
  longlong lVar1;
  byte in_XCR0;
  
  DAT_14003a0dc = 0;
  lVar1 = cpuid_Version_info(1);
  if ((*(uint *)(lVar1 + 0xc) & 0x18001000) == 0x18001000) {
    DAT_14003a0dc = (uint)((in_XCR0 & 6) == 6);
  }
  _DAT_14003a0e0 = DAT_14003a0dc;
  return 0;
}



// Library Function - Single Match
//  _log_special_common
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4
_log_special_common(undefined8 param_1,undefined8 param_2,int param_3,uint param_4,
                   undefined8 param_5)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  
  iVar1 = param_3 + -1;
  if (iVar1 == 0) {
    iVar4 = 1;
    iVar1 = 2;
    uVar3 = 0x22;
    uVar2 = 4;
  }
  else {
    if (iVar1 != 1) {
      return (int)param_2;
    }
    uVar3 = 0x21;
    uVar2 = 8;
    iVar4 = iVar1;
  }
  _handle_error(param_5,param_4,param_2,iVar1,uVar2,uVar3,param_1,0,iVar4);
  return (int)param_2;
}



// Library Function - Single Match
//  _log10_special
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _log10_special(undefined8 param_1,undefined8 param_2,int param_3)

{
  _log_special_common(param_1,param_2,param_3,0x1b,"log10");
  return;
}



// Library Function - Single Match
//  _get_fpsr
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 _get_fpsr(void)

{
  undefined4 in_MXCSR;
  
  return in_MXCSR;
}



void FUN_140027a70(void)

{
  return;
}



// Library Function - Single Match
//  _fclrf
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _fclrf(void)

{
  return;
}



// Library Function - Single Match
//  _set_errno_from_matherr
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void _set_errno_from_matherr(int param_1)

{
  ulong *puVar1;
  
  if (param_1 == 1) {
    puVar1 = __doserrno();
    *puVar1 = 0x21;
  }
  else if (param_1 - 2U < 2) {
    puVar1 = __doserrno();
    *puVar1 = 0x22;
  }
  return;
}



// Library Function - Single Match
//  _raise_exc
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _raise_exc(uint *param_1,ulonglong *param_2,ulonglong param_3,uint param_4,undefined8 *param_5,
               undefined8 *param_6)

{
  _raise_exc_ex(param_1,param_2,param_3,param_4,param_5,param_6,0);
  return;
}



// Library Function - Single Match
//  _raise_exc_ex
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _raise_exc_ex(uint *param_1,ulonglong *param_2,ulonglong param_3,uint param_4,
                  undefined8 *param_5,undefined8 *param_6,int param_7)

{
  uint uVar1;
  DWORD dwExceptionCode;
  uint *local_res8;
  
  dwExceptionCode = 0xc000000d;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  if ((param_3 & 0x10) != 0) {
    dwExceptionCode = 0xc000008f;
    param_1[1] = param_1[1] | 1;
  }
  if ((param_3 & 2) != 0) {
    dwExceptionCode = 0xc0000093;
    param_1[1] = param_1[1] | 2;
  }
  if ((param_3 & 1) != 0) {
    dwExceptionCode = 0xc0000091;
    param_1[1] = param_1[1] | 4;
  }
  if ((param_3 & 4) != 0) {
    dwExceptionCode = 0xc000008e;
    param_1[1] = param_1[1] | 8;
  }
  if ((param_3 & 8) != 0) {
    dwExceptionCode = 0xc0000090;
    param_1[1] = param_1[1] | 0x10;
  }
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 7) << 4) ^ param_1[2]) & 0x10;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 9) << 3) ^ param_1[2]) & 8;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 10) << 2) ^ param_1[2]) & 4;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 0xb) * 2) ^ param_1[2]) & 2;
  param_1[2] = param_1[2] ^ (~(*(uint *)param_2 >> 0xc) ^ param_1[2]) & 1;
  local_res8 = param_1;
  uVar1 = _statfp();
  if ((uVar1 & 1) != 0) {
    local_res8[3] = local_res8[3] | 0x10;
  }
  if ((uVar1 & 4) != 0) {
    local_res8[3] = local_res8[3] | 8;
  }
  if ((uVar1 & 8) != 0) {
    local_res8[3] = local_res8[3] | 4;
  }
  if ((uVar1 & 0x10) != 0) {
    local_res8[3] = local_res8[3] | 2;
  }
  if ((uVar1 & 0x20) != 0) {
    local_res8[3] = local_res8[3] | 1;
  }
  uVar1 = *(uint *)param_2 & 0x6000;
  if ((*(uint *)param_2 & 0x6000) == 0) {
    *local_res8 = *local_res8 & 0xfffffffc;
  }
  else if (uVar1 == 0x2000) {
    *local_res8 = *local_res8 & 0xfffffffd;
    *local_res8 = *local_res8 | 1;
  }
  else if (uVar1 == 0x4000) {
    *local_res8 = *local_res8 & 0xfffffffe;
    *local_res8 = *local_res8 | 2;
  }
  else if (uVar1 == 0x6000) {
    *local_res8 = *local_res8 | 3;
  }
  *local_res8 = *local_res8 & 0xfffe001f;
  *local_res8 = *local_res8 | (param_4 & 0xfff) << 5;
  local_res8[8] = local_res8[8] | 1;
  if (param_7 == 0) {
    local_res8[8] = local_res8[8] & 0xffffffe3 | 2;
    *(undefined8 *)(local_res8 + 4) = *param_5;
    local_res8[0x18] = local_res8[0x18] | 1;
    local_res8[0x18] = local_res8[0x18] & 0xffffffe3 | 2;
    *(undefined8 *)(local_res8 + 0x14) = *param_6;
  }
  else {
    local_res8[8] = local_res8[8] & 0xffffffe1;
    local_res8[4] = *(uint *)param_5;
    local_res8[0x18] = local_res8[0x18] | 1;
    local_res8[0x18] = local_res8[0x18] & 0xffffffe1;
    local_res8[0x14] = *(uint *)param_6;
  }
  _clrfp();
  RaiseException(dwExceptionCode,0,1,(ULONG_PTR *)&local_res8);
  uVar1 = local_res8[2];
  if ((uVar1 & 0x10) != 0) {
    *param_2 = *param_2 & 0xffffffffffffff7f;
    uVar1 = local_res8[2];
  }
  if ((uVar1 & 8) != 0) {
    *param_2 = *param_2 & 0xfffffffffffffdff;
    uVar1 = local_res8[2];
  }
  if ((uVar1 & 4) != 0) {
    *param_2 = *param_2 & 0xfffffffffffffbff;
    uVar1 = local_res8[2];
  }
  if ((uVar1 & 2) != 0) {
    *param_2 = *param_2 & 0xfffffffffffff7ff;
    uVar1 = local_res8[2];
  }
  if ((uVar1 & 1) != 0) {
    *param_2 = *param_2 & 0xffffffffffffefff;
  }
  uVar1 = *local_res8 & 3;
  if (uVar1 == 0) {
    *param_2 = *param_2 & 0xffffffffffff9fff;
  }
  else if (uVar1 == 1) {
    *param_2 = *param_2 & 0xffffffffffffbfff;
    *param_2 = *param_2 | 0x2000;
  }
  else if (uVar1 == 2) {
    *param_2 = *param_2 & 0xffffffffffffdfff;
    *param_2 = *param_2 | 0x4000;
  }
  else if (uVar1 == 3) {
    *param_2 = *param_2 | 0x6000;
  }
  if (param_7 == 0) {
    *param_6 = *(undefined8 *)(local_res8 + 0x14);
  }
  else {
    *(uint *)param_6 = local_res8[0x14];
  }
  return;
}



// Library Function - Single Match
//  _clrfp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint _clrfp(void)

{
  uint uVar1;
  
  uVar1 = _get_fpsr();
  _fclrf();
  return uVar1 & 0x3f;
}



// Library Function - Single Match
//  _ctrlfp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint _ctrlfp(uint param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = _get_fpsr();
  if ((DAT_140038af0 == '\0') ||
     ((((~param_2 | 0xffff807f) & uVar1 | param_1 & param_2) & 0x40) == 0)) {
    FUN_140027a70();
  }
  else {
    FUN_140027a70();
  }
  return uVar1;
}



// Library Function - Single Match
//  _statfp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint _statfp(void)

{
  uint uVar1;
  
  uVar1 = _get_fpsr();
  return uVar1 & 0x3f;
}



// Library Function - Single Match
//  _set_statfp
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void _set_statfp(void)

{
  _get_fpsr();
  FUN_140027a70();
  return;
}



// WARNING: This is an inlined function

void _guard_dispatch_icall(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
                    // WARNING: Could not recover jumptable at 0x000140027f00. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



int FUN_140027f10(undefined2 *param_1,longlong param_2,longlong param_3,undefined8 param_4)

{
  int iVar1;
  ulonglong uVar2;
  ulonglong *puVar3;
  undefined8 local_res20;
  undefined auStackY_68 [32];
  
  uVar2 = DAT_140038010 ^ (ulonglong)auStackY_68;
  local_res20 = param_4;
  puVar3 = (ulonglong *)FUN_140001080();
  iVar1 = common_vsprintf__(*puVar3,param_1,param_2,param_3,(__crt_locale_pointers *)0x0,
                            &local_res20);
  if (iVar1 < 0) {
    iVar1 = -1;
  }
  __security_check_cookie(uVar2 ^ (ulonglong)auStackY_68);
  return iVar1;
}



void FUN_140027f90(undefined *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  ulonglong *puVar2;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStackY_58 [32];
  
  uVar1 = DAT_140038010 ^ (ulonglong)auStackY_58;
  local_res18 = param_3;
  local_res20 = param_4;
  puVar2 = (ulonglong *)FUN_140001080();
  common_vsprintf__(*puVar2 | 1,param_1,-1,(longlong)"failed: %d",(__crt_locale_pointers *)0x0,
                    &local_res18);
  __security_check_cookie(uVar1 ^ (ulonglong)auStackY_58);
  return;
}



BOOL FUN_140028000(wchar_t *param_1,wchar_t *param_2)

{
  BOOL BVar1;
  size_t sVar2;
  size_t sVar3;
  
  sVar2 = wcslen(param_1);
  sVar3 = wcslen(param_2);
  if (0x103 < sVar3 + sVar2) {
    return 0;
  }
                    // WARNING: Could not recover jumptable at 0x00014002803f. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = PathAppendW(param_1,param_2);
  return BVar1;
}



undefined8 FUN_140028050(short *param_1)

{
  wchar_t *pwVar1;
  RPC_STATUS RVar2;
  size_t sVar3;
  undefined8 uVar4;
  undefined auStack_58 [32];
  wchar_t *local_38;
  UUID local_30;
  ulonglong local_20;
  
  local_20 = DAT_140038010 ^ (ulonglong)auStack_58;
  local_38 = (wchar_t *)0x0;
  RVar2 = UuidCreate(&local_30);
  uVar4 = 0;
  if (RVar2 == 0) {
    RVar2 = UuidToStringW(&local_30,(RPC_WSTR *)&local_38);
    pwVar1 = local_38;
    if ((RVar2 == 0) && (local_38 != (wchar_t *)0x0)) {
      sVar3 = wcslen(local_38);
      uVar4 = 0;
      if (sVar3 < 0x105) {
        FUN_14000b198(param_1,(longlong)pwVar1,0x105);
        RpcStringFreeW((RPC_WSTR *)&local_38);
        uVar4 = 1;
      }
    }
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack_58);
  return uVar4;
}



DWORD GetFileVersionInfoSizeW(LPCWSTR lptstrFilename,LPDWORD lpdwHandle)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000140028580. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetFileVersionInfoSizeW(lptstrFilename,lpdwHandle);
  return DVar1;
}



BOOL GetFileVersionInfoW(LPCWSTR lptstrFilename,DWORD dwHandle,DWORD dwLen,LPVOID lpData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000140028590. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetFileVersionInfoW(lptstrFilename,dwHandle,dwLen,lpData);
  return BVar1;
}



BOOL VerQueryValueW(LPCVOID pBlock,LPCWSTR lpSubBlock,LPVOID *lplpBuffer,PUINT puLen)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001400285a0. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VerQueryValueW(pBlock,lpSubBlock,lplpBuffer,puLen);
  return BVar1;
}



void SHGetKnownFolderPath(void)

{
                    // WARNING: Could not recover jumptable at 0x0001400285b0. Too many branches
                    // WARNING: Treating indirect jump as call
  SHGetKnownFolderPath();
  return;
}



LONG WinVerifyTrust(HWND hwnd,GUID *pgActionID,LPVOID pWVTData)

{
  LONG LVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001400285c0. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = WinVerifyTrust(hwnd,pgActionID,pWVTData);
  return LVar1;
}



void CreateToolhelp32Snapshot(void)

{
                    // WARNING: Could not recover jumptable at 0x0001400285d0. Too many branches
                    // WARNING: Treating indirect jump as call
  CreateToolhelp32Snapshot();
  return;
}



BOOL IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001400285e0. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



void Process32FirstW(void)

{
                    // WARNING: Could not recover jumptable at 0x0001400285f0. Too many branches
                    // WARNING: Treating indirect jump as call
  Process32FirstW();
  return;
}



void Process32NextW(void)

{
                    // WARNING: Could not recover jumptable at 0x000140028600. Too many branches
                    // WARNING: Treating indirect jump as call
  Process32NextW();
  return;
}


